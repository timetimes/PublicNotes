# 数据库

数据库（Database）是按照数据结构来组织、存储和管理数据的仓库。

## 关系型数据库(RDBMS)

数据库database、数据表table、数据行row、字段field

优点：
（1）容易理解，二维表的结构非常贴近现实世界，二维表格，容易理解。
（2）使用方便，通用的sql语句使得操作关系型数据库非常方便。
（3）易于维护，数据库的ACID属性，大大降低了数据冗余和数据不一致的概率
关系型数据库的最大优点就是事务的一致性，这个特性，使得关系型数据库中可以适用于一切要求一致性比较高的系统中。比如：银行系统。
缺点：
(1)海量数据的读写效率。对于网站的并发量高，往往达到每秒上万次的请求，对于传统关系型数据库来说，硬盘I/o是一个很大的挑战。
(2) 高扩展性和可用性。在基于web的结构中，数据库是最难以横向拓展的，当一个应用系统的用户量和访问量与日俱增的时候，数据库没有办法像web Server那样简单的通过添加更多的硬件和服务节点来拓展性能和负载能力。

最常用的有：Mysql，Oracle

### SQL

SQL (Structured Query Language:结构化查询语言) 是用于管理关系数据库管理系统（RDBMS）。 SQL 的范围包括数据插入、查询、更新和删除，数据库模式创建和修改，以及数据访问控制。

* **SELECT** - 从数据库中提取数据
* **UPDATE** - 更新数据库中的数据
* **DELETE** - 从数据库中删除数据
* **INSERT INTO** - 向数据库中插入新数据
* **CREATE DATABASE** - 创建新数据库
* **ALTER DATABASE** - 修改数据库
* **CREATE TABLE** - 创建新表
* **ALTER TABLE** - 变更（改变）数据库表
* **DROP TABLE** - 删除表
* **CREATE INDEX** - 创建索引（搜索键）
* **DROP INDEX** - 删除索引

1. 创建数据库 `CREATE DATABASE 数据库名;`
2. 删除数据库 `drop database 数据库名;`
3. 选择数据库 `use 数据库名;`
4. 创建数据表

#### 数据类型

数值类型
日期和时间类型
字符串类型

### MySQL

启动后在命令窗口内输入：`mysql -u root -p`，然后输入刚才生成的密码
在命令窗口内依次输入：
`ALTER USER 'root'@'localhost' IDENTIFIED BY 'password' PASSWORD EXPIRE NEVER;` # 修改加密规则
`ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'password';` # 更新一下用户的密码
`FLUSH PRIVILEGES;` # 刷新权限
`alter user 'root'@'localhost' identified by '123456';` # 更改root的密码为123456

**忘记 root 密码**

- 停止 MySQL 服务
- 使用 `--skip-grant-tables` 启动 MySQL
- 修改 root 密码
- 重启 MySQL 服务

备份
mysqldump -u username -p database_name > backup.sql
恢复
mysql -u username -p database_name < backup.sql

#### 安装mysql

Windows前往官网安装: [MySQL](https://dev.mysql.com/downloads/installer/)

使用 MySQL Installer安装：
运行安装程序选择安装类型："Developer Default" (开发默认) 或 "Server only" (仅服务器)
配置 MySQL 服务器，选择 "Standalone MySQL Server"，设置 root 用户密码，选择身份验证方法 (推荐使用 "Use Strong Password Encryption")，配置 Windows 服务名 (默认 "MySQL80")，确保选中 "Start the MySQL Server at System Startup"

使用 ZIP 归档安装：
MySQL8之后并不需要my.ini，会自动的生成data文件夹在解压之后的文件，端口默认3306,。若有这个文件，则初始化mysql不成功。
自己若新建并设置了my.ini 文件，有data文件的话，在初始化之前要删除。然后再初始化
在初始化之后会自动生成密码，要记下来，后续登上mysql需改密码之后才可后续操作。
要更改加密规则，不然无法使用工具连接mysql

以管理员身份启动终端 `cd C:~\mysql\bin`
在 5.7 需要初始化 data 目录：`mysqld --initialize-insecure`
初始化数据库 `mysqld --initialize --console`执行完成后，会输出 root 用户的初始默认密码 )5p>ufDS:c1#
输入以下安装命令 `mysqld install`
启动 `net start mysql`  停止 `net stop mysql`

最好将~\MySQL\bin配置环境变量，方便使用

---

Linux/UNIX:

1. 检测系统是否自带安装 MySQL `rpm -qa | grep mysql`
2. 如果你系统有安装，那可以选择进行卸载:普通删除模式 `rpm -e mysql`强力删除模式 `rpm -e --nodeps mysql`
3. 安装 MySQL `sudo apt update`
`sudo apt install mysql-server`
`sudo mysql_secure_installation`
4. 权限设置 `chown -R mysql:mysql /var/lib/mysql/`
5. 初始化 MySQL `mysqld --initialize`
6. 启动 MySQL `systemctl start mysqld`
7. 查看 MySQL 运行状态 `systemctl status mysqld`

停止服务
sudo systemctl stop mysql

重启服务
sudo systemctl restart mysql

设置开机启动
sudo systemctl enable mysql

Mysql安装成功后，默认的root用户密码为空，你可以使用以下命令来创建root用户的密码：
`mysqladmin -u root password "new_password";`

#### Navicat管理工具

当 MySQL 服务已经运行时, 我们可以通过 MySQL 自带的客户端工具登录到 MySQL 数据库中, 首先打开命令提示符, 输入以下格式的命名:`mysql -h 主机名-u 用户名-p`

* **-h** : 指定客户端所要登录的 MySQL 主机名, 登录本机(localhost 或 127.0.0.1)该参数可以省略;
* **-u** : 登录的用户名;
* **-p** : 告诉服务器将会使用一个密码来登录, 如果所要登录的用户名密码为空, 可以忽略此选项。

如果我们要登录本机的 MySQL 数据库，只需要输入 `mysql -u root -p`即可，`quit`退出

但是自带的客户端工具在命令提示符中使用很不方便，一般使用管理工具如Navicat：填写ip、端口、用户名、密码即可建立连接管理数据库

**navicat删用户出现1449错误，无法连接数据**
误删mysql.infoschema’@‘localhost用户导致，解决方法：
root用户登入MySQL自带的客户端工具
`use mysql;` 选择数据库mysql
`show tables;` 查看表，此时会报错
`select user,host from user;` 查看用户
`create user 'mysql.infoschema'@'localhost' identified by '123456';` 添加mysql.infoschema’@‘localhost用户，并设置密码
`grant all privileges on *.* to 'mysql.infoschema'@'localhost' with grant option;` 添加所有权限
`flush privileges;` 刷新权限
`show tables;` 查看表，此时不会报错正常显示，说明解决成功

## 非关系型数据库(NoSQL)

NoSQL提出了另一种理念，以键值来存储，且结构不稳定，每一个元组都可以有不一样的字段，这种就不会局限于固定的结构，可以减少一些时间和空间的开销。使用这种方式，为了获取用户的不同信息，不需要像关系型数据库中，需要进行多表查询。仅仅需要根据key来取出对应的value值即可。

但是由于Nosql约束少，所以也不能够像sql那样提供where字段属性的查询。因此适合存储较为简单的数据。有一些不能够持久化数据，所以需要和关系型数据库结合。

（1）面向高性能并发读写的key-value数据库
主要特点是具有极高的并发读写性能，例如Redis、Tokyo Cabint等。
（2）面向海量数据访问的面向文档数据库
特点是，可以在海量的数据库快速的查询数据。例如MongoDB以及CouchDB.
（3）面向可拓展的分布式数据库
解决的主要问题是传统数据库的扩展性上的缺陷。