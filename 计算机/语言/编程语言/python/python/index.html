
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
        <link rel="next" href="../../../%E5%85%B6%E4%BB%96%E8%AF%AD%E6%B3%95/HTML%2CCSS/">
      
      
      <link rel="icon" href="../../../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Python - notes</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#python" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../../.." title="notes" class="md-header__button md-logo" aria-label="notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Python
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="purple"  aria-label="切换到深色模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换到深色模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="pink"  aria-label="切换到浅色模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换到浅色模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
  计算机

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../%E6%95%B0%E5%AD%A6/%E4%BB%A3%E6%95%B0/%E9%AB%98%E7%AD%89%E4%BB%A3%E6%95%B0/" class="md-tabs__link">
          
  
  
  数学

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="notes" class="md-nav__button md-logo" aria-label="notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    计算机
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            计算机
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    语言
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_1">
            <span class="md-nav__icon md-icon"></span>
            语言
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      代码
    </span>
  </a>
  
    <nav class="md-nav" aria-label="代码">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      代码编写规范
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      基础语法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="基础语法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      注释与注解
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      输入和输出
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      变量
    </span>
  </a>
  
    <nav class="md-nav" aria-label="变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python_1" class="md-nav__link">
    <span class="md-ellipsis">
      Python 保留字符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      变量名
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      常量
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      数据类型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="数据类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      数字
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      字符串
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      数字格式化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="数字格式化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      元组
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      列表
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      字典
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      集合
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      数据类型转换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enum" class="md-nav__link">
    <span class="md-ellipsis">
      枚举Enum类型
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      表达式与运算符
    </span>
  </a>
  
    <nav class="md-nav" aria-label="表达式与运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      算术运算符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      比较运算符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      赋值运算符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      位运算符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      逻辑运算符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      成员运算符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      成员身份运算符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      运算符的优先级
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      语句
    </span>
  </a>
  
    <nav class="md-nav" aria-label="语句">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      条件语句
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      循环语句
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      函数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lambda" class="md-nav__link">
    <span class="md-ellipsis">
      lambda匿名函数
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      类
    </span>
  </a>
  
    <nav class="md-nav" aria-label="类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      对象保存（数据持久化）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      异常处理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      文件和数据格式化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="文件和数据格式化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      替换字符串
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      导入库
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python_2" class="md-nav__link">
    <span class="md-ellipsis">
      python标准
    </span>
  </a>
  
    <nav class="md-nav" aria-label="python标准">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python_3" class="md-nav__link">
    <span class="md-ellipsis">
      python内置函数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="python内置函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    <span class="md-ellipsis">
      入门函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    <span class="md-ellipsis">
      数学函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    <span class="md-ellipsis">
      数据类型函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    <span class="md-ellipsis">
      序列迭代器函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    <span class="md-ellipsis">
      对象函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    <span class="md-ellipsis">
      对象操作函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    <span class="md-ellipsis">
      对象属性函数
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_4" class="md-nav__link">
    <span class="md-ellipsis">
      python标准库
    </span>
  </a>
  
    <nav class="md-nav" aria-label="python标准库">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#random" class="md-nav__link">
    <span class="md-ellipsis">
      random（随机）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time" class="md-nav__link">
    <span class="md-ellipsis">
      time（时间）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#re" class="md-nav__link">
    <span class="md-ellipsis">
      re（正则表达式）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#turtle" class="md-nav__link">
    <span class="md-ellipsis">
      turtle（绘图）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tkinterui" class="md-nav__link">
    <span class="md-ellipsis">
      tkinter（UI）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="tkinter（UI）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tkinter" class="md-nav__link">
    <span class="md-ellipsis">
      tkinter 组件
    </span>
  </a>
  
    <nav class="md-nav" aria-label="tkinter 组件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#button" class="md-nav__link">
    <span class="md-ellipsis">
      Button
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#canvas" class="md-nav__link">
    <span class="md-ellipsis">
      Canvas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#urllib" class="md-nav__link">
    <span class="md-ellipsis">
      urllib（爬虫）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sqlite3" class="md-nav__link">
    <span class="md-ellipsis">
      SQLite3（数据库）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python_5" class="md-nav__link">
    <span class="md-ellipsis">
      python第三方库
    </span>
  </a>
  
    <nav class="md-nav" aria-label="python第三方库">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python_6" class="md-nav__link">
    <span class="md-ellipsis">
      Python管理工具
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python管理工具">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pip" class="md-nav__link">
    <span class="md-ellipsis">
      pip包管理工具
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#venv" class="md-nav__link">
    <span class="md-ellipsis">
      venv虚拟环境
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jupyter" class="md-nav__link">
    <span class="md-ellipsis">
      Jupyter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    <span class="md-ellipsis">
      运算工具
    </span>
  </a>
  
    <nav class="md-nav" aria-label="运算工具">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#numpy" class="md-nav__link">
    <span class="md-ellipsis">
      numpy（数组运算）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="numpy（数组运算）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    <span class="md-ellipsis">
      例子：生成质数表
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scipy" class="md-nav__link">
    <span class="md-ellipsis">
      scipy（科学计算）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="scipy（科学计算）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constants" class="md-nav__link">
    <span class="md-ellipsis">
      constants常量
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#special" class="md-nav__link">
    <span class="md-ellipsis">
      special 特殊函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimize" class="md-nav__link">
    <span class="md-ellipsis">
      optimize优化算法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    <span class="md-ellipsis">
      解方程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    <span class="md-ellipsis">
      微分方程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#misc" class="md-nav__link">
    <span class="md-ellipsis">
      misc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ndimage" class="md-nav__link">
    <span class="md-ellipsis">
      ndimage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sympy" class="md-nav__link">
    <span class="md-ellipsis">
      SymPy（符号计算）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numbacython" class="md-nav__link">
    <span class="md-ellipsis">
      numba、Cython
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    <span class="md-ellipsis">
      可视化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="可视化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matplotlib" class="md-nav__link">
    <span class="md-ellipsis">
      matplotlib（数据可视化）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="matplotlib（数据可视化）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplot" class="md-nav__link">
    <span class="md-ellipsis">
      Pyplot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pyplot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imshow" class="md-nav__link">
    <span class="md-ellipsis">
      imshow()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#animation" class="md-nav__link">
    <span class="md-ellipsis">
      animation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seabornmatplotlib" class="md-nav__link">
    <span class="md-ellipsis">
      Seaborn（matplotlib封装）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynimate" class="md-nav__link">
    <span class="md-ellipsis">
      pynimate（ 动态排序图）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mayavi3d" class="md-nav__link">
    <span class="md-ellipsis">
      mayavi（3D可视化）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plotly" class="md-nav__link">
    <span class="md-ellipsis">
      Plotly(可交互)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyecharts" class="md-nav__link">
    <span class="md-ellipsis">
      Pyecharts(可交互)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vpython3d" class="md-nav__link">
    <span class="md-ellipsis">
      VPython（3D图形和动画）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shapely" class="md-nav__link">
    <span class="md-ellipsis">
      Shapely(处理几何关系)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_49" class="md-nav__link">
    <span class="md-ellipsis">
      文件处理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="文件处理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pandas" class="md-nav__link">
    <span class="md-ellipsis">
      pandas（数据处理）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pandas（数据处理）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#excel" class="md-nav__link">
    <span class="md-ellipsis">
      Excel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pillow" class="md-nav__link">
    <span class="md-ellipsis">
      pillow（图像处理）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pillow（图像处理）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    <span class="md-ellipsis">
      创建图像实例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_51" class="md-nav__link">
    <span class="md-ellipsis">
      读写图像
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_52" class="md-nav__link">
    <span class="md-ellipsis">
      剪贴，粘贴、合并图像
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_53" class="md-nav__link">
    <span class="md-ellipsis">
      几何变换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_54" class="md-nav__link">
    <span class="md-ellipsis">
      颜色变换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_55" class="md-nav__link">
    <span class="md-ellipsis">
      图像增强
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_56" class="md-nav__link">
    <span class="md-ellipsis">
      动态图像
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imagedraw" class="md-nav__link">
    <span class="md-ellipsis">
      ImageDraw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#psdraw" class="md-nav__link">
    <span class="md-ellipsis">
      PSDraw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#draft" class="md-nav__link">
    <span class="md-ellipsis">
      配置加载器 draft
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gui" class="md-nav__link">
    <span class="md-ellipsis">
      图形界面GUI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="图形界面GUI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyqt5qt" class="md-nav__link">
    <span class="md-ellipsis">
      pyqt5（Qt）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wxpythonwxwidgets" class="md-nav__link">
    <span class="md-ellipsis">
      wxPython（wxWidgets）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pygtkgtk" class="md-nav__link">
    <span class="md-ellipsis">
      PyGTK（GTK+）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kivy" class="md-nav__link">
    <span class="md-ellipsis">
      Kivy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_57" class="md-nav__link">
    <span class="md-ellipsis">
      游戏开发
    </span>
  </a>
  
    <nav class="md-nav" aria-label="游戏开发">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pygame" class="md-nav__link">
    <span class="md-ellipsis">
      Pygame
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pygame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_58" class="md-nav__link">
    <span class="md-ellipsis">
      精灵
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_59" class="md-nav__link">
    <span class="md-ellipsis">
      事件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_60" class="md-nav__link">
    <span class="md-ellipsis">
      其他
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pygame_1" class="md-nav__link">
    <span class="md-ellipsis">
      Pygame小游戏
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pygame小游戏">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_61" class="md-nav__link">
    <span class="md-ellipsis">
      人物移动射击
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flappy-bird" class="md-nav__link">
    <span class="md-ellipsis">
      Flappy Bird
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_62" class="md-nav__link">
    <span class="md-ellipsis">
      双人乒乓
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manim" class="md-nav__link">
    <span class="md-ellipsis">
      manim（动画）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chardet" class="md-nav__link">
    <span class="md-ellipsis">
      chardet（编码检测）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web" class="md-nav__link">
    <span class="md-ellipsis">
      web开发
    </span>
  </a>
  
    <nav class="md-nav" aria-label="web开发">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sqlalchemy" class="md-nav__link">
    <span class="md-ellipsis">
      SQLAlchemy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fastapi" class="md-nav__link">
    <span class="md-ellipsis">
      FastAPI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mkdocsmarkdown" class="md-nav__link">
    <span class="md-ellipsis">
      Mkdocs（markdown静态网站）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djangoweb" class="md-nav__link">
    <span class="md-ellipsis">
      Django（Web 框架）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Django（Web 框架）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_63" class="md-nav__link">
    <span class="md-ellipsis">
      核心组件的使用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_64" class="md-nav__link">
    <span class="md-ellipsis">
      常用功能
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_65" class="md-nav__link">
    <span class="md-ellipsis">
      生产环境部署
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_66" class="md-nav__link">
    <span class="md-ellipsis">
      完整的示例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_67" class="md-nav__link">
    <span class="md-ellipsis">
      网络爬虫
    </span>
  </a>
  
    <nav class="md-nav" aria-label="网络爬虫">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requests" class="md-nav__link">
    <span class="md-ellipsis">
      requests（网络爬虫）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beautifulsoup" class="md-nav__link">
    <span class="md-ellipsis">
      beautifulsoup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dill" class="md-nav__link">
    <span class="md-ellipsis">
      dill（对象序列化）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywin32" class="md-nav__link">
    <span class="md-ellipsis">
      pywin32
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_68" class="md-nav__link">
    <span class="md-ellipsis">
      打包
    </span>
  </a>
  
    <nav class="md-nav" aria-label="打包">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyinstaller" class="md-nav__link">
    <span class="md-ellipsis">
      PyInstaller
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto-py-to-exe" class="md-nav__link">
    <span class="md-ellipsis">
      auto-py-to-exe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buildozer" class="md-nav__link">
    <span class="md-ellipsis">
      Buildozer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rich" class="md-nav__link">
    <span class="md-ellipsis">
      rich（终端美化）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rich（终端美化）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_69" class="md-nav__link">
    <span class="md-ellipsis">
      控制台
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_70" class="md-nav__link">
    <span class="md-ellipsis">
      显示高级内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_71" class="md-nav__link">
    <span class="md-ellipsis">
      进度条
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_72" class="md-nav__link">
    <span class="md-ellipsis">
      人工智能相关
    </span>
  </a>
  
    <nav class="md-nav" aria-label="人工智能相关">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      PyTorch
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PyTorch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_73" class="md-nav__link">
    <span class="md-ellipsis">
      保存和加载模型
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opencv" class="md-nav__link">
    <span class="md-ellipsis">
      openCV
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_74" class="md-nav__link">
    <span class="md-ellipsis">
      数据集
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jieba" class="md-nav__link">
    <span class="md-ellipsis">
      jieba（中文分词）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_75" class="md-nav__link">
    <span class="md-ellipsis">
      调用其他编程语言
    </span>
  </a>
  
    <nav class="md-nav" aria-label="调用其他编程语言">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#c" class="md-nav__link">
    <span class="md-ellipsis">
      c语言
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96%E8%AF%AD%E6%B3%95/HTML%2CCSS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Html,Css
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../JavaScript/JavaScript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Javascript
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数学
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            数学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    代数
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            代数
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../%E6%95%B0%E5%AD%A6/%E4%BB%A3%E6%95%B0/%E9%AB%98%E7%AD%89%E4%BB%A3%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线性代数
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    分析
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            分析
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../%E6%95%B0%E5%AD%A6/%E5%88%86%E6%9E%90/%E5%B8%B8%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    常微分方程
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    概率论
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            概率论
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../%E6%95%B0%E5%AD%A6/%E6%A6%82%E7%8E%87%E4%B8%8E%E7%BB%9F%E8%AE%A1%E5%AD%A6/%E6%A6%82%E7%8E%87%E8%AE%BA%E4%B8%8E%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概率论与数理统计
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      代码
    </span>
  </a>
  
    <nav class="md-nav" aria-label="代码">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      代码编写规范
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      基础语法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="基础语法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      注释与注解
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      输入和输出
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      变量
    </span>
  </a>
  
    <nav class="md-nav" aria-label="变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python_1" class="md-nav__link">
    <span class="md-ellipsis">
      Python 保留字符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      变量名
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      常量
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      数据类型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="数据类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      数字
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      字符串
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      数字格式化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="数字格式化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      元组
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      列表
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      字典
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      集合
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      数据类型转换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enum" class="md-nav__link">
    <span class="md-ellipsis">
      枚举Enum类型
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      表达式与运算符
    </span>
  </a>
  
    <nav class="md-nav" aria-label="表达式与运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      算术运算符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      比较运算符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      赋值运算符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      位运算符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      逻辑运算符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      成员运算符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      成员身份运算符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      运算符的优先级
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      语句
    </span>
  </a>
  
    <nav class="md-nav" aria-label="语句">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      条件语句
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      循环语句
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      函数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lambda" class="md-nav__link">
    <span class="md-ellipsis">
      lambda匿名函数
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      类
    </span>
  </a>
  
    <nav class="md-nav" aria-label="类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      对象保存（数据持久化）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      异常处理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      文件和数据格式化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="文件和数据格式化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      替换字符串
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      导入库
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python_2" class="md-nav__link">
    <span class="md-ellipsis">
      python标准
    </span>
  </a>
  
    <nav class="md-nav" aria-label="python标准">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python_3" class="md-nav__link">
    <span class="md-ellipsis">
      python内置函数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="python内置函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    <span class="md-ellipsis">
      入门函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    <span class="md-ellipsis">
      数学函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    <span class="md-ellipsis">
      数据类型函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    <span class="md-ellipsis">
      序列迭代器函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    <span class="md-ellipsis">
      对象函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    <span class="md-ellipsis">
      对象操作函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    <span class="md-ellipsis">
      对象属性函数
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_4" class="md-nav__link">
    <span class="md-ellipsis">
      python标准库
    </span>
  </a>
  
    <nav class="md-nav" aria-label="python标准库">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#random" class="md-nav__link">
    <span class="md-ellipsis">
      random（随机）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time" class="md-nav__link">
    <span class="md-ellipsis">
      time（时间）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#re" class="md-nav__link">
    <span class="md-ellipsis">
      re（正则表达式）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#turtle" class="md-nav__link">
    <span class="md-ellipsis">
      turtle（绘图）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tkinterui" class="md-nav__link">
    <span class="md-ellipsis">
      tkinter（UI）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="tkinter（UI）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tkinter" class="md-nav__link">
    <span class="md-ellipsis">
      tkinter 组件
    </span>
  </a>
  
    <nav class="md-nav" aria-label="tkinter 组件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#button" class="md-nav__link">
    <span class="md-ellipsis">
      Button
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#canvas" class="md-nav__link">
    <span class="md-ellipsis">
      Canvas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#urllib" class="md-nav__link">
    <span class="md-ellipsis">
      urllib（爬虫）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sqlite3" class="md-nav__link">
    <span class="md-ellipsis">
      SQLite3（数据库）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python_5" class="md-nav__link">
    <span class="md-ellipsis">
      python第三方库
    </span>
  </a>
  
    <nav class="md-nav" aria-label="python第三方库">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python_6" class="md-nav__link">
    <span class="md-ellipsis">
      Python管理工具
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python管理工具">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pip" class="md-nav__link">
    <span class="md-ellipsis">
      pip包管理工具
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#venv" class="md-nav__link">
    <span class="md-ellipsis">
      venv虚拟环境
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jupyter" class="md-nav__link">
    <span class="md-ellipsis">
      Jupyter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    <span class="md-ellipsis">
      运算工具
    </span>
  </a>
  
    <nav class="md-nav" aria-label="运算工具">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#numpy" class="md-nav__link">
    <span class="md-ellipsis">
      numpy（数组运算）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="numpy（数组运算）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    <span class="md-ellipsis">
      例子：生成质数表
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scipy" class="md-nav__link">
    <span class="md-ellipsis">
      scipy（科学计算）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="scipy（科学计算）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constants" class="md-nav__link">
    <span class="md-ellipsis">
      constants常量
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#special" class="md-nav__link">
    <span class="md-ellipsis">
      special 特殊函数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimize" class="md-nav__link">
    <span class="md-ellipsis">
      optimize优化算法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    <span class="md-ellipsis">
      解方程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    <span class="md-ellipsis">
      微分方程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#misc" class="md-nav__link">
    <span class="md-ellipsis">
      misc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ndimage" class="md-nav__link">
    <span class="md-ellipsis">
      ndimage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sympy" class="md-nav__link">
    <span class="md-ellipsis">
      SymPy（符号计算）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numbacython" class="md-nav__link">
    <span class="md-ellipsis">
      numba、Cython
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    <span class="md-ellipsis">
      可视化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="可视化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matplotlib" class="md-nav__link">
    <span class="md-ellipsis">
      matplotlib（数据可视化）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="matplotlib（数据可视化）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyplot" class="md-nav__link">
    <span class="md-ellipsis">
      Pyplot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pyplot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imshow" class="md-nav__link">
    <span class="md-ellipsis">
      imshow()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#animation" class="md-nav__link">
    <span class="md-ellipsis">
      animation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seabornmatplotlib" class="md-nav__link">
    <span class="md-ellipsis">
      Seaborn（matplotlib封装）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynimate" class="md-nav__link">
    <span class="md-ellipsis">
      pynimate（ 动态排序图）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mayavi3d" class="md-nav__link">
    <span class="md-ellipsis">
      mayavi（3D可视化）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plotly" class="md-nav__link">
    <span class="md-ellipsis">
      Plotly(可交互)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyecharts" class="md-nav__link">
    <span class="md-ellipsis">
      Pyecharts(可交互)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vpython3d" class="md-nav__link">
    <span class="md-ellipsis">
      VPython（3D图形和动画）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shapely" class="md-nav__link">
    <span class="md-ellipsis">
      Shapely(处理几何关系)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_49" class="md-nav__link">
    <span class="md-ellipsis">
      文件处理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="文件处理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pandas" class="md-nav__link">
    <span class="md-ellipsis">
      pandas（数据处理）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pandas（数据处理）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#excel" class="md-nav__link">
    <span class="md-ellipsis">
      Excel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pillow" class="md-nav__link">
    <span class="md-ellipsis">
      pillow（图像处理）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pillow（图像处理）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    <span class="md-ellipsis">
      创建图像实例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_51" class="md-nav__link">
    <span class="md-ellipsis">
      读写图像
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_52" class="md-nav__link">
    <span class="md-ellipsis">
      剪贴，粘贴、合并图像
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_53" class="md-nav__link">
    <span class="md-ellipsis">
      几何变换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_54" class="md-nav__link">
    <span class="md-ellipsis">
      颜色变换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_55" class="md-nav__link">
    <span class="md-ellipsis">
      图像增强
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_56" class="md-nav__link">
    <span class="md-ellipsis">
      动态图像
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imagedraw" class="md-nav__link">
    <span class="md-ellipsis">
      ImageDraw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#psdraw" class="md-nav__link">
    <span class="md-ellipsis">
      PSDraw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#draft" class="md-nav__link">
    <span class="md-ellipsis">
      配置加载器 draft
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gui" class="md-nav__link">
    <span class="md-ellipsis">
      图形界面GUI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="图形界面GUI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyqt5qt" class="md-nav__link">
    <span class="md-ellipsis">
      pyqt5（Qt）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wxpythonwxwidgets" class="md-nav__link">
    <span class="md-ellipsis">
      wxPython（wxWidgets）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pygtkgtk" class="md-nav__link">
    <span class="md-ellipsis">
      PyGTK（GTK+）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kivy" class="md-nav__link">
    <span class="md-ellipsis">
      Kivy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_57" class="md-nav__link">
    <span class="md-ellipsis">
      游戏开发
    </span>
  </a>
  
    <nav class="md-nav" aria-label="游戏开发">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pygame" class="md-nav__link">
    <span class="md-ellipsis">
      Pygame
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pygame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_58" class="md-nav__link">
    <span class="md-ellipsis">
      精灵
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_59" class="md-nav__link">
    <span class="md-ellipsis">
      事件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_60" class="md-nav__link">
    <span class="md-ellipsis">
      其他
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pygame_1" class="md-nav__link">
    <span class="md-ellipsis">
      Pygame小游戏
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pygame小游戏">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_61" class="md-nav__link">
    <span class="md-ellipsis">
      人物移动射击
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flappy-bird" class="md-nav__link">
    <span class="md-ellipsis">
      Flappy Bird
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_62" class="md-nav__link">
    <span class="md-ellipsis">
      双人乒乓
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manim" class="md-nav__link">
    <span class="md-ellipsis">
      manim（动画）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chardet" class="md-nav__link">
    <span class="md-ellipsis">
      chardet（编码检测）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web" class="md-nav__link">
    <span class="md-ellipsis">
      web开发
    </span>
  </a>
  
    <nav class="md-nav" aria-label="web开发">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sqlalchemy" class="md-nav__link">
    <span class="md-ellipsis">
      SQLAlchemy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fastapi" class="md-nav__link">
    <span class="md-ellipsis">
      FastAPI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mkdocsmarkdown" class="md-nav__link">
    <span class="md-ellipsis">
      Mkdocs（markdown静态网站）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djangoweb" class="md-nav__link">
    <span class="md-ellipsis">
      Django（Web 框架）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Django（Web 框架）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_63" class="md-nav__link">
    <span class="md-ellipsis">
      核心组件的使用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_64" class="md-nav__link">
    <span class="md-ellipsis">
      常用功能
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_65" class="md-nav__link">
    <span class="md-ellipsis">
      生产环境部署
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_66" class="md-nav__link">
    <span class="md-ellipsis">
      完整的示例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_67" class="md-nav__link">
    <span class="md-ellipsis">
      网络爬虫
    </span>
  </a>
  
    <nav class="md-nav" aria-label="网络爬虫">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requests" class="md-nav__link">
    <span class="md-ellipsis">
      requests（网络爬虫）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beautifulsoup" class="md-nav__link">
    <span class="md-ellipsis">
      beautifulsoup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dill" class="md-nav__link">
    <span class="md-ellipsis">
      dill（对象序列化）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pywin32" class="md-nav__link">
    <span class="md-ellipsis">
      pywin32
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_68" class="md-nav__link">
    <span class="md-ellipsis">
      打包
    </span>
  </a>
  
    <nav class="md-nav" aria-label="打包">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyinstaller" class="md-nav__link">
    <span class="md-ellipsis">
      PyInstaller
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto-py-to-exe" class="md-nav__link">
    <span class="md-ellipsis">
      auto-py-to-exe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buildozer" class="md-nav__link">
    <span class="md-ellipsis">
      Buildozer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rich" class="md-nav__link">
    <span class="md-ellipsis">
      rich（终端美化）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rich（终端美化）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_69" class="md-nav__link">
    <span class="md-ellipsis">
      控制台
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_70" class="md-nav__link">
    <span class="md-ellipsis">
      显示高级内容
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_71" class="md-nav__link">
    <span class="md-ellipsis">
      进度条
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_72" class="md-nav__link">
    <span class="md-ellipsis">
      人工智能相关
    </span>
  </a>
  
    <nav class="md-nav" aria-label="人工智能相关">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      PyTorch
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PyTorch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_73" class="md-nav__link">
    <span class="md-ellipsis">
      保存和加载模型
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opencv" class="md-nav__link">
    <span class="md-ellipsis">
      openCV
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_74" class="md-nav__link">
    <span class="md-ellipsis">
      数据集
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jieba" class="md-nav__link">
    <span class="md-ellipsis">
      jieba（中文分词）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_75" class="md-nav__link">
    <span class="md-ellipsis">
      调用其他编程语言
    </span>
  </a>
  
    <nav class="md-nav" aria-label="调用其他编程语言">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#c" class="md-nav__link">
    <span class="md-ellipsis">
      c语言
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="python">python</h1>
<p>Python 是一个高层次的结合了解释性、编译性、互动性和面向对象的脚本语言。</p>
<p>文件扩展名为 <code>.py</code></p>
<p><em>Python2中默认的编码格式是ASCII，在文件开头加入 <code># coding=utf-8</code>即可修改；而Python3开始默认使用utf-8编码</em></p>
<p>安装<a href="https://www.python.org/downloads/">python</a> <em>在安装过程中，请务必勾选“Add Python to PATH”选项，以便自动配置环境变量，否则需要自己设置。</em>
Vscode扩展：Python、Python Debugger</p>
<p>python运行机制： 首先将.py文件编译成字节码，存储在.pyc文件中（该字节码在虚拟机上运行非cpu）。当python程序第二次运行时，首先程序会在硬盘中寻找.pyc文件，如果找到直接运行，否则重复上述过程。
由于引入了字节码，其加载速度比之前的.py文件有所提高，而且还可以实现源码隐藏，一定程度上可以反编译</p>
<p><code>__pycache__</code>文件夹下保存着 .pyc/.pyo 文件</p>
<p>.py
最常见的Python代码文件后缀名，官方称Python源代码文件。</p>
<p>.ipynb
ipynb是Jupyter Notebook文件的扩展名，它代表"IPython Notebook"。</p>
<p>.pyi
.pyi文件是Python中的类型提示文件，用于提供代码的静态类型信息。
一般用于帮助开发人员进行类型检查和静态分析。</p>
<p>.pyc
.pyc是Python字节码文件的扩展名，用于存储已编译的Python源代码的中间表示形式，因为是二进制文件所以我们无法正常阅读里面的代码。
.pyc文件包含了已编译的字节码，它可以更快地被Python解释器加载和执行，因为解释器无需再次编译源代码。
.pyd</p>
<p>.pyd是Python扩展模块的扩展名，用于表示使用C或C++编写的二进制Python扩展模块文件。
.pyd文件是编译后的二进制文件，它包含了编译后的扩展模块代码以及与Python解释器交互所需的信息。
此外，.pyd文件通过import语句在Python中导入和使用，就像导入普通的Python模块一样。
由于C或C++的执行速度通常比纯Python代码快，可以使用扩展模块来优化Python代码的性能，尤其是对于计算密集型任务。</p>
<p>.pyw
.pyw是Python窗口化脚本文件的扩展名。
它表示一种特殊类型的Python脚本文件，用于创建没有命令行界面（即控制台窗口）的窗口化应用程序。
一般情况下，运行Python脚本会打开一个命令行窗口，其中显示脚本输出和接受用户输入。但是，对于某些应用程序，如图形用户界面（GUI）应用程序，不需要命令行界面，而是希望在窗口中显示交互界面。这时就可以使用.pyw文件。</p>
<p>.pyx
.pyx是Cython源代码文件的扩展名。
Cython是一种编译型的静态类型扩展语言，它允许在Python代码中使用C语言的语法和特性，以提高性能并与C语言库进行交互。</p>
<h2 id="_1">代码</h2>
<h3 id="_2">代码编写规范</h3>
<p>格式</p>
<p>编码与特殊字符
使用换行符（LF）换行，而非 CRLF 或 CR。（编辑器默认）
在每个文件的末尾使用一个换行符。（编辑器默认）
使用不带字节顺序标记的 UTF-8 编码。（编辑器默认）
使用制表符代替空格进行缩进。（编辑器默认）</p>
<p>缩进
每个缩进的缩进级别必须大于包含该缩进的代码块的缩进级别。</p>
<p>请在数组、字典和枚举的最后一行使用逗号，这样，在添加新元素时就不需要修改最后一行了，既能让版本控制中的重构更容易，也会让 Diff 也更美观。
单行列表中不需要行尾逗号，故在此情况下不要添加逗号。</p>
<p>用两个空行来包围函数和类定义
函数内部使用一个空行来分隔每个逻辑片段。</p>
<p>把每行代码控制在100个字符以内。</p>
<p>要避免将多个语句放在一行当中，包括条件语句，该规则的唯一例外便是三元运算符</p>
<p>如果你的 <code>if</code> 语句特别长，亦或如果一条语句是嵌套的三元表达式，把它们拆分成多行可以提高可读性。由于这几行连续的代码仍属于同一个表达式，故应该缩进两级而非一级。</p>
<p>避免在表达式和条件语句中使用括号，除非需要修改操作顺序或者将语句拆分多行编写，否则只会降低可读性</p>
<p>推荐使用英文布尔运算符，简单易懂，也可以在布尔运算符周围使用括号来消除歧义，这样还可以使长表达式更有可读性</p>
<p>使用pass语句代替</p>
<h2 id="_3">基础语法</h2>
<blockquote>
<p>展示语法格式：
<code>&lt;变量名&gt; [: 类型] [= &lt;初始值&gt;]</code>
其中尖括号引用的内容表示必须填写，并把尖括号内的东西换成该填入的字符，方括号表示可选填写</p>
</blockquote>
<p>Python 与其他语言最大的区别就是，Python 的代码块不使用大括号 <code>{}</code> 而是 <strong><code>缩进</code></strong> 来控制类，函数以及其他逻辑判断。缩进的空白数量是可变的，但是所有代码块语句必须包含相同的缩进空白数量</p>
<p>Python语句中一般以新行作为语句的结束符，但是我们可以使用斜杠 <code>\</code> 将一行的语句分为多行显示。语句中包含 [], {} 或 () 括号就不需要使用多行连接符。</p>
<p>Python 可以使用引号( ' )、双引号( " )、三引号( ''' 或 """ ) 来表示字符串，引号的开始与结束必须是相同类型的。其中三引号可以由多行组成，编写多行文本的快捷语法，常用于文档字符串，在文件的特定地点，被当做注释。</p>
<p>函数之间或类的方法之间用空行分隔，表示一段新的代码的开始。类和函数入口之间也用一行空行分隔，以突出函数入口的开始。空行与代码缩进不同，空行并不是Python语法的一部分。书写时不插入空行，Python解释器运行也不会出错。但是空行的作用在于分隔两段不同功能或含义的代码，便于日后代码的维护或重构。</p>
<p>Python可以在同一行中使用多条语句，语句之间使用分号(;)分割</p>
<p>在Python中，如果一行代码过长，可以使用多种方法来换行继续写，以提高代码的可读性。以下是一些常用的换行方法：
在行末尾添加反斜杠（\）可以将代码分成多行。
括号内的多行表达式或元素会被视为一行。
可以使用加号（+）连接多行字符串。
三引号可以定义包含多行文本的字符串。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;这是一个非常长的字符串，</span><span class="se">\</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="s2">它跨越了多行。&quot;</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">]</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;这是一个非常长的消息，&quot;</span> <span class="o">+</span> \
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="s2">&quot;它跨越了多行。&quot;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;这是一个非常长的消息，</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="s2">它跨越了多行。</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="s2">&quot;&quot;&quot;</span>
</span></code></pre></div>
<h3 id="_4">注释与注解</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># 单行注释</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="sd">多行注释</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="sd">多行注释</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="sd">&quot;&quot;&quot;</span>
</span></code></pre></div>
<p>Python3.0之后加入新特性Decorators，以@为标记修饰function和class。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># 注解对代码没有任何影响，仅仅是方便程序员阅读</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c1"># 函数注解：申明函数参数中变量类型，与返回值类型</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="c1"># 变量注解：</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="n">a2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span> <span class="c1"># a2为int型变量，赋值为123</span>
</span></code></pre></div>
<p>为了限制<code>score</code>的范围，可以通过一个<code>set_score()</code>方法来设置成绩，再通过一个<code>get_score()</code>来获取成绩</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Student</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_score</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_score</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;score must be an integer!&#39;</span><span class="p">)</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;score must between 0 ~ 100!&#39;</span><span class="p">)</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_score</span> <span class="o">=</span> <span class="n">value</span>
</span></code></pre></div>
<p>上面的调用方法又略显复杂，没有直接用属性这么直接简单。</p>
<p>Python内置的<code>@property</code>装饰器负责把一个方法变成属性调用
<code>@property</code>本身又创建了另一个装饰器<code>@score.setter</code>，负责把一个setter方法变成属性赋值</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Student</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="nd">@property</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_score</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="nd">@score</span><span class="o">.</span><span class="n">setter</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;score must be an integer!&#39;</span><span class="p">)</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;score must between 0 ~ 100!&#39;</span><span class="p">)</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_score</span> <span class="o">=</span> <span class="n">value</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>&gt;&gt;&gt; s = Student()
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>&gt;&gt;&gt; s.score = 60 # OK，实际转化为s.score(60)
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>&gt;&gt;&gt; s.score # 实际转化为s.score()
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>60
</span></code></pre></div>
<h3 id="_5">输入和输出</h3>
<p>input("输入文字")</p>
<p>Python两种输出值的方式: 表达式语句和 print() 函数。
第三种方式是使用文件对象的 write() 方法，标准输出文件可以用 sys.stdout 引用。
如果你希望输出的形式更加多样，可以使用 str.format() 函数来格式化输出值。
如果你希望将输出的值转成字符串，可以使用 repr() 或 str() 函数来实现。</p>
<h3 id="_6">变量</h3>
<p>Python 是动态语言，变量不需要类型声明。</p>
<p>每个变量在内存中创建，都包括变量的标识，名称和数据这些信息。
每个变量在使用前都必须赋值，变量赋值以后该变量才会被创建。
等号 = 用来给变量赋值。</p>
<p>Python允许你同时为多个变量赋值。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">a</span> <span class="c1"># 序列解包。利用元组或列表（可迭代对象）实现的，省略了括号</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="c1"># 输出2 1，因此可以使用 a,b=b,a 交换两变量值</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># 链式赋值。由于不可变数据类型链式赋值指向同一地址，会一起更改，所以不要使用</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="c1"># 使用星号表达式。将一个可迭代对象的剩余值赋给一个变量</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>  <span class="c1"># 输出 1 [2, 3, 4] 5</span>
</span></code></pre></div>
<h4 id="python_1">Python 保留字符</h4>
<p>下面的列表显示了在Python中的保留字。这些保留字不能用作常数或变数，或任何其他标识符名称。
所有 Python 的关键字只包含小写字母。</p>
<p>同时Python 的标准库提供了 keyword 模块，可以输出当前版本的所有关键字</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">keyword</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">keyword</span><span class="o">.</span><span class="n">kwlist</span><span class="p">)</span>
</span></code></pre></div>
<table>
    <tr>
        <td>and</td>
        <td>assert</td>
        <td>break</td>
        <td>class</td>
        <td>continue</td>
        <td>def</td>
    </tr>
    <tr>
        <td>del</td>
        <td>elif</td>
        <td>else</td>
        <td>except</td>
        <td>exec</td>
        <td>finally</td>
    </tr>
    <tr>
        <td>for</td>
        <td>from</td>
        <td>global</td>
        <td>if</td>
        <td>import</td>
        <td>in</td>
    </tr>
    <tr>
        <td>is</td>
        <td>lambda</td>
        <td>not</td>
        <td>or</td>
        <td>pass</td>
        <td>print</td>
    </tr>
    <tr>
        <td>raise</td>
        <td>return</td>
        <td>try</td>
        <td>while</td>
        <td>with</td>
        <td>yield</td>
    </tr>
</table>

<h4 id="_7">变量名</h4>
<p><strong>标识符</strong>：</p>
<blockquote>
<p>第一个字符必须是字母表中字母或下划线 _ 。
标识符的其他的部分由字母、数字和下划线组成。
标识符对大小写敏感。</p>
</blockquote>
<p><em>在 Python 3 中，可以用中文作为变量名，非 ASCII 标识符也是允许的了。</em></p>
<p>变量名，即变量的标识符</p>
<p>变量名只能用“_ ”，数字，字母组成，不可以是空格或者特殊字符（#？&lt; . , $￥*~！）
不能以数字开头
保留字符不能被使用
变量名区分大小写</p>
<p>通常使用驼峰式命名法、下划线分隔单词，且变量名具有实际意义。如：（studentName或student_name）
类：大驼峰命名法 StudentName
变量和函数：蛇形命名法 student_name
常量：全大写 ALL_CAPS
私有字段：前缀下划线的小驼峰命名法 _camelCase</p>
<h4 id="_8">常量</h4>
<p>在Python中，常量是指在程序执行期间其值不会发生变化的特殊变量。尽管Python没有内置的常量类型，但我们可以通过一些约定和设计模式来模拟常量的行为。（有的语言会使用关键字定义常量）</p>
<p><strong>使用变量声明常量</strong>：
常量的名称应全部大写</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">PI</span> <span class="o">=</span> <span class="mf">3.14159</span>
</span></code></pre></div>
<p>这种方法虽然简单，但只是一个约定，并不能阻止常量被重新赋值。</p>
<p><strong>使用模块定义常量</strong>：
创建一个名为constants.py的文件，并在其中定义所有的常量。然后，在其他模块中导入constants模块来使用这些常量</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># constants.py</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">PI</span> <span class="o">=</span> <span class="mf">3.14159</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="c1"># main.py</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">constants</span>
</span></code></pre></div>
<p>使用类封装常量
可以创建一个包含常量的类，并将这些常量作为类属性。这种方法的优点是可以利用类的封装特性，防止常量被意外修改。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># constants.py</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">Constants</span><span class="p">:</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>    <span class="n">PI</span> <span class="o">=</span> <span class="mf">3.14159</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="c1"># main.py</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">Constants</span>
</span></code></pre></div>
<p>使用装饰器或特殊方法实现常量
通过使用装饰器，我们可以定义一个将常量注入到全局命名空间的函数。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># constants.py</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">constant</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="nb">globals</span><span class="p">()[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="n">constant</span><span class="p">(</span><span class="s1">&#39;PI&#39;</span><span class="p">,</span> <span class="mf">3.14159</span><span class="p">)</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="c1"># main.py</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="kn">from</span><span class="w"> </span><span class="nn">constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">PI</span>
</span></code></pre></div>
<p>创建一个const.py模块，并在其中定义一个 <code>_const</code>类，该类通过重写 <code>__setattr__</code>方法来防止常量被重新赋值</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># const.py</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">_const</span><span class="p">:</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">ConstError</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span> <span class="k">pass</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">ConstError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t rebind const (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">_const</span><span class="p">()</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="c1"># main.py</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="kn">import</span><span class="w"> </span><span class="nn">const</span>
</span></code></pre></div>
<h3 id="_9">数据类型</h3>
<p>Python 中的变量不需要声明。每个变量在使用前都必须赋值，变量赋值以后该变量才会被创建。
Python 中，变量就是变量，它没有类型，我们所说的"类型"是变量所指的内存中对象的类型。</p>
<p>不可变数据类型：Number（数字）、String（字符串）、Tuple（元组）
可变数据类型：List（列表）、Dictionary（字典）、Set（集合）</p>
<p>隐式类型转换 - 自动完成 两种不同类型的数据进行运算，较低数据类型（如整数）就会转换为较高数据类型（如浮点数）以避免数据丢失
显式类型转换 - 需要使用类型函数来转换 int()、float()、str()等</p>
<p>通常用len统计个数</p>
<h4 id="_10">数字</h4>
<ul>
<li>整型(int) - 通常被称为是整型或整数，是正或负整数，不带小数点。Python3 整型是没有限制大小的，可以当作 Long 类型使用，所以 Python3 没有 Python2 的 Long 类型。布尔(bool)是整型的子类型。</li>
<li>浮点型(float) - 浮点型由整数部分与小数部分组成，浮点型也可以使用科学计数法表示（2.5e2 = 2.5 x 102 = 250）</li>
<li>复数( (complex)) - 复数由实数部分和虚数部分构成，可以用a + bj,或者complex(a,b)表示， 复数的实部a和虚部b都是浮点型。</li>
</ul>
<p>1）divmod() 函数把除数和余数运算结果结合起来，返回一个包含商和余数的元组(a // b, a % b)。
2)abs() 函数返回数字的绝对值。
3)pow() 方法返回 xy（x的y次方）的值。
4)round（x,n）返回浮点数x四舍五入后保留n位小数的值
5)nim(),max()会返回给定序列的最小/最大值</p>
<h4 id="_11">字符串</h4>
<p>转义字符串</p>
<table>
<thead>
<tr>
<th><strong>转义序列</strong></th>
<th><strong>转义为</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>\n</code></td>
<td>换行(line feed,LF)</td>
</tr>
<tr>
<td><code>\t</code></td>
<td>水平制表符（tab）</td>
</tr>
<tr>
<td><code>\r</code></td>
<td>回车（carriage return,CR）</td>
</tr>
<tr>
<td><code>\a</code></td>
<td>警报（蜂鸣/响铃）</td>
</tr>
<tr>
<td><code>\b</code></td>
<td>退格键（Backspace）</td>
</tr>
<tr>
<td><code>\f</code></td>
<td>换页符（form feed,FF）</td>
</tr>
<tr>
<td><code>\v</code></td>
<td>垂直制表符（tab）</td>
</tr>
<tr>
<td><code>\"</code></td>
<td>双引号</td>
</tr>
<tr>
<td><code>\'</code></td>
<td>单引号</td>
</tr>
<tr>
<td><code>\\</code></td>
<td>反斜杠</td>
</tr>
<tr>
<td><code>\uXXXX</code></td>
<td>Unicode UTF-16 码位 <code>XXXX</code> （16进制，不区分大小写）</td>
</tr>
<tr>
<td><code>\UXXXXXX</code></td>
<td>Unicode UTF-32 码位 <code>XXXXXX</code> （16进制，不区分大小写）</td>
</tr>
</tbody>
</table>
<p>f字符串{{}}转义{}</p>
<p>''/""
b"Hello world!" 这里的’b’代表二进制（bytes）的意思，它告诉Python这个字符串是以字节序列的形式表示的，而不是普通字符串
字符串是由Unicode码点序列构成的，而字节序列则是由8位字节构成的。因此，当我们需要表示一些非Unicode的文本数据时，就需要使用字节序列。
如果你想要将一个字符串转换成字节序列，你可以使用字符串的encode()方法
可以使用decode()方法将一个字节序列转换成字符串.如果字节序列中包含了一些不符合编码要求的字节，那么它就无法被正确地转换成字符串</p>
<p>在Python中，r字符串前缀是一种特殊的字符串前缀，用于表示原始字符串。当一个字符串以r前缀开始时，它将被视为原始字符串，其中的转义字符将被忽略。</p>
<p>当字符串前加上字母f，这表示该字符串是一个格式化字符串（f-string）。这是Python 3.6及更高版本中引入的一种新特性，允许在字符串内部直接插入变量和表达式的值</p>
<p>内插字符串 $""</p>
<p>chr() 用一个范围在 range（256）内的（就是0～255）整数作参数，返回一个对应的字符。
ord() 函数是 chr() 函数（对于8位的ASCII字符串）的配对函数，它以一个字符（长度为1的字符串）作为参数，返回对应的 ASCII 数值。
oct() 函数将一个整数转换成8进制字符串。
hex() 函数用于将10进制整数转换成16进制，以字符串形式表示。
len() 方法返回对象（字符、列表、元组等）长度或项目个数。
str()返回一个对象的string格式。
<strong>str也内置了很多对字符串进行操作的函数：</strong>
string.upper()转换string 中的小写字母为大写
string.lower()转换string 中的小写字母为小写
string.capitalize()把字符串的第一个字符大写
string.find(str,beg=0, end=len(string)) 检测 str 是否包含在 string 中，如果 beg 和end 指定范围，则检查是否包含在指定范围内，如果是返回 开始的索引值，否则返回-1
string.join(seq)以 string 作为分隔符，将 seq 中所有的元素(的字符串表示)合并为一个新的字符串
string.rfind(str,beg=0,end=len(string) ) 类似于 find()函数，不过是从右边开始查找.</p>
<p>s[start:stop:step]左包右不包  没填留空时，表示字符串最开始那个位置
<code>s[:-1]</code>表示从开始到倒数第二个字符的所有字符，s=s[:-1]即删除最后一个字符</p>
<p>字符串根据第一个字符的编码比较</p>
<p>Python replace方法把字符串中的old（旧字符串） 替换成new(新字符串)，如果指定第三个参数max，则设置替换次数不超过 max 次。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">[,</span> <span class="nb">max</span><span class="p">])</span>
</span></code></pre></div>
<p>Python的translate函数与replace函数一样，用于替换字符串的一部分。Translate只能处理单个字符，但translate可以同时进行多个替换任务。在使用translate函数进行转换之前。需要一个翻译表table，翻译表用于表示字符的替换关系，这个翻译表可以通过maketrans()方法获得。这个翻译表可翻译字符数为256，翻译表中的字符都要包含在ASCII码表（含扩展）中。translate()方法语法为：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nb">str</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</span></code></pre></div>
<p>re.sub 替换字符串</p>
<p>我们可以使用正则表达式来替换字符串。Python的re库就是常用的正则表达式匹配库（建议学一学很有用）。re库使用见模式匹配。这里主要使用re.sub函数替换字符串。re.sub()方法需要传入两个参数。第一个参数是一个字符串，用于取代发现的匹配。第二个参数是一个字符串，即正则表达式。sub()方法返回替换完成后的字符串。
re.sub(pattern, repl, text)
<code>re.sub(r'[\/\\\:\*\?\'\"\&lt;\&gt;\|\#. ]', '_', name)</code></p>
<p>转换为列表</p>
<p>str.format()</p>
<blockquote>
<blockquote>
<blockquote>
<p>"{} {}".format("hello", "world")    # 不设置指定位置，按默认顺序
'hello world'</p>
<p>"{0} {1}".format("hello", "world")  # 设置指定位置
'hello world'</p>
<p>"{1} {0} {1}".format("hello", "world")  # 设置指定位置
'world hello world'</p>
</blockquote>
</blockquote>
<h3 id="_12">数字格式化</h3>
<p><strong>^</strong>, <strong>&lt;</strong>, <strong>&gt;</strong> 分别是居中、左对齐、右对齐，后面带宽度， <strong>:</strong> 号后面带填充的字符，只能是一个字符，不指定则默认是用空格填充。</p>
<p><strong>+</strong> 表示在正数前显示 <strong>+</strong>，负数前显示 <strong>-</strong>；** ** （空格）表示在正数前加空格</p>
<p>b、d、o、x 分别是二进制、十进制、八进制、十六进制。</p>
<p>此外我们可以使用大括号 <strong>{}</strong> 来转义大括号</p>
</blockquote>
<ul>
<li>eval()函数：将字符串转换为Python表达式并计算返回结果。也就是说，它一般用于计算并返回单个表达式的值，并返回执行结果。</li>
<li>exec()函数：用于动态执行Python代码。也就是说，它可以执行任何字符串类型的Python代码，但是没有返回值。</li>
</ul>
<p>可能存在危险（任何内容都可能被执行，而不仅仅是简单条件，如果用户输入被包含在内，可能会被滥用）</p>
<h4 id="_13">元组</h4>
<h4 id="_14">列表</h4>
<p>创建列表可以直接 <span class="arithmatex"><span class="MathJax_Preview">l=[]</span><script type="math/tex">l=[]</script></span> 和使用函数 <span class="arithmatex"><span class="MathJax_Preview">l=list()</span><script type="math/tex">l=list()</script></span>
可以通过 <span class="arithmatex"><span class="MathJax_Preview">list(range())</span><script type="math/tex">list(range())</script></span> 快速创建等差整数列表</p>
<p>list.append(obj)在列表末尾添加新的对象
list.extend(seq)在列表末尾一次性追加另一个序列中的多个值（用新列表扩展原来的列表）
list.insert(index,obj)将对象插入列表
list.pop([index=-1])移除列表中的一个元素（默认最后一个元素），并且返回该元素的值
list.remove(obj)移除列表中某个值的第一个匹配项
list.reverse()反向列表中元素
list.sort(cmp=None,key=None, reverse=False)对原列表进行排序
list.count(obj)统计某个元素在列表中出现的次数</p>
<p>copy</p>
<p>sort 是 list 的一个方法，而 sorted 可以对所有可迭代的对象进行排序操作</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nb">list</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></code></pre></div>
<ul>
<li>key -- 用来进行比较的元素，只有一个参数，具体的函数的参数就是取自于可迭代对象中，指定可迭代对象中的一个元素来进行排序。</li>
<li>reverse -- 排序规则，<strong>reverse = True</strong> 降序， <strong>reverse = False</strong> 升序（默认）
  没有返回值，但是会对列表的对象进行排序</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">lt</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</span></code></pre></div>
<p>对于列表，可以使用list.index()方法结合max()函数来找到最大值的索引。对于NumPy数组，可以使用np.argmax()函数来获取最大值的索引。</p>
<p>列表去重：list(set(list_1)
字典在 Python 3.7 及以上版本中保持插入顺序
去重并保持顺序：list(dict.fromkeys(lst))
[unique_list.append(item) for item in lst if item not in unique_list]</p>
<h4 id="_15">字典</h4>
<p>dict.clear()删除字典内所有元素
dict.copy()返回一个字典的浅复制
dict.fromkeys(seq[, val])创建一个新字典，以序列 seq 中元素做字典的键，val 为字典所有键对应的初始值
dict.get(key,default=None)返回指定键的值，如果值不在字典中返回default值(如果使用dict[key]，如果值不在字典中会报错)
dict.has_key(key)如果键在字典dict里返回true，否则返回false
dict.items()以列表返回可遍历的(键, 值) 元组数组
dict.keys()以列表返回一个字典所有的键
dict.update(dict2)把字典dict2的键/值对更新到dict里
dict.values()以列表返回字典中的所有值
pop(key[,default])删除字典给定键 key 所对应的值，返回值为被删除的值。key值必须给出。否则，返回default值。
popitem()返回并删除字典中的最后一对键和值。</p>
<p><code>erase</code> 方法</p>
<p>直接迭代字典会返回字典的键，而不是键值对
可以使用 .items() 方法来迭代键值对</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">itrms</span><span class="p">():</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># 实现对字典的切片操作</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">dict_slice</span><span class="p">(</span><span class="n">adict</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>    <span class="n">keys</span> <span class="o">=</span> <span class="n">adict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>    <span class="n">dict_slice</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">keys</span><span class="p">)[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>        <span class="n">dict_slice</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">adict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>    <span class="k">return</span> <span class="n">dict_slice</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">dict_slice</span><span class="p">(</span><span class="n">adict</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">adict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">adict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]}</span>
</span></code></pre></div>
<h4 id="_16">集合</h4>
<p><strong>map()</strong> 是 Python 内置的高阶函数，它接收一个函数和一个或多个可迭代对象（如列表），并通过将函数依次作用于可迭代对象的每个元素，返回一个包含函数返回值的新迭代器</p>
<p>add(x)元素x添加到集合s中，如果元素已存在，则不进行任何操作。
remove(x)将元素x从集合s中移除，如果元素不存在，则会发生错误。
len() 计算集合s元素个数。
clear() 清空集合s。
pop()随机移除元素
symmetric_difference()返回两个集合中不重复的元素集合
union()返回两个集合的并集
symmetric_difference_update()移除当前集合中在另外一个指定集合相同的元素，并将另外一个指定集合中不同的元素插入到当前集合中。
difference()返回多个集合的差集</p>
<h4 id="_17">数据类型转换</h4>
<p>隐式（自动）类型转换 - 自动完成
显式（强制）类型转换 - 需要使用类型函数来转换</p>
<p>对两种不同类型的数据进行运算，较低数据类型（整数）就会转换为较高数据类型（浮点数）以避免数据丢失
使用 int()、float()、str() 等预定义函数来执行显式类型转换
会丢失非法字符，int表现为取整。。。</p>
<h4 id="enum">枚举Enum类型</h4>
<p>枚举类是一种特殊的数据类型，用于表示一组具有离散取值的常量。它将常量与有意义的名字关联起来，使得代码更易读、更易维护。枚举类的每个成员都有一个唯一的名称和一个关联的值。
在代码中使用枚举来代替魔术数字（不明确的常量值）可以增加代码的可读性。枚举为常量提供了有意义的名字，使得代码更容易理解。
枚举成员的名称通常应该使用大写字母，以便与常规变量和函数名称区分开。
枚举成员是不可变的，一旦创建就不能更改其值。这有助于确保枚举成员的稳定性，并防止意外的修改。
两个枚举成员的名称不能相同</p>
<p>在Python中，使用内置模块 <code>enum</code>来创建和使用枚举类。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Color</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>    <span class="n">RED</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>    <span class="n">GREEN</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    <span class="n">BLUE</span> <span class="o">=</span> <span class="mi">3</span>
</span></code></pre></div>
<p>定义枚举类，可以通过成员名来访问枚举成员 <code>print(Color.RED)</code>
获取枚举成员的关联值，可以使用成员的value属性 <code>print(Color.RED.value)</code>
枚举成员可以使用相等运算符进行比较。可以直接比较枚举成员，而不必比较它们的值。
使用 <code>for</code>循环来迭代枚举类的所有成员。
根据枚举成员的值来获取成员本身 <code>color = Color(1)</code></p>
<p>默认情况下，枚举允许多个名称作为同一个值的别名。若不想如此，可以使用 unique() 装饰器：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">unique</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="nd">@unique</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Color</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>    <span class="n">RED</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>    <span class="n">GREEN</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>    <span class="n">BLUE</span> <span class="o">=</span> <span class="mi">3</span>
</span></code></pre></div>
<p>如果具体的枚举值无所谓是什么，可以使用 auto:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Color</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>    <span class="n">RED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>    <span class="n">GREEN</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>    <span class="n">BLUE</span> <span class="o">=</span> <span class="mi">3</span>
</span></code></pre></div>
<h3 id="_18">表达式与运算符</h3>
<p>表达式是由一些值和运算符组成的式子，例如 <code>10 + 2</code></p>
<h4 id="_19">算术运算符</h4>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>+</td>
<td>加 - 两个对象相加</td>
</tr>
<tr>
<td>-</td>
<td>减 - 得到负数或是一个数减去另一个数</td>
</tr>
<tr>
<td>*</td>
<td>乘 - 两个数相乘或重复的字符串</td>
</tr>
<tr>
<td>/</td>
<td>除 - x 除以 y</td>
</tr>
<tr>
<td>%</td>
<td>取模 - 返回除法的余数</td>
</tr>
<tr>
<td>**</td>
<td>幂 - 返回x的y次幂</td>
</tr>
<tr>
<td>//</td>
<td>取整除 - 往小的方向取整数</td>
</tr>
</tbody>
</table>
<h4 id="_20">比较运算符</h4>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>==</td>
<td>等于 - 比较对象是否相等</td>
</tr>
<tr>
<td>!=</td>
<td>不等于 - 比较两个对象是否不相等</td>
</tr>
<tr>
<td>&gt;</td>
<td>大于 - 返回x是否大于y</td>
</tr>
<tr>
<td>&lt;</td>
<td>小于 - 返回x是否小于y</td>
</tr>
<tr>
<td>&gt;=</td>
<td>大于等于 - 返回x是否大于等于y。</td>
</tr>
<tr>
<td>&lt;=</td>
<td>小于等于 - 返回x是否小于等于y。</td>
</tr>
</tbody>
</table>
<p>所有比较运算符返回1(True)表示真，返回0(False)表示假
可以连续比较：如 <code>3&gt;2&gt;1</code>，在c语言中是先比较 <code>3&gt;2</code>值为1，然后 <code>1&gt;1</code>为假；在python中 <code>3&gt;2&gt;1</code>为真</p>
<h4 id="_21">赋值运算符</h4>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>=</td>
<td>简单的赋值运算符</td>
<td>c = a + b 将 a + b 的运算结果赋值为 c</td>
</tr>
<tr>
<td>+=</td>
<td>加法赋值运算符</td>
<td>c += a 等效于 c = c + a</td>
</tr>
<tr>
<td>-=</td>
<td>减法赋值运算符</td>
<td>c -= a 等效于 c = c - a</td>
</tr>
<tr>
<td>*=</td>
<td>乘法赋值运算符</td>
<td>c *= a 等效于 c = c * a</td>
</tr>
<tr>
<td>/=</td>
<td>除法赋值运算符</td>
<td>c /= a 等效于 c = c / a</td>
</tr>
<tr>
<td>%=</td>
<td>取模赋值运算符</td>
<td>c %= a 等效于 c = c % a</td>
</tr>
<tr>
<td>**=</td>
<td>幂赋值运算符</td>
<td>c **= a 等效于 c = c ** a</td>
</tr>
<tr>
<td>//=</td>
<td>取整除赋值运算符</td>
<td>c //= a 等效于 c = c // a</td>
</tr>
<tr>
<td>:=</td>
<td>海象运算符，可在表达式内部为变量赋值。Python3.8 新增</td>
<td>在这个示例中，赋值表达式可以避免调用 len() 两次:</td>
</tr>
</tbody>
</table>
<h4 id="_22">位运算符</h4>
<p>位运算符是把数字看作二进制来进行计算</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>&amp;</td>
<td>按位与运算符：参与运算的两个值,如果两个相应位都为1,则该位的结果为1,否则为0</td>
</tr>
<tr>
<td>|</td>
<td>按位或运算符：只要对应的二个二进位有一个为1时，结果位就为1</td>
</tr>
<tr>
<td>^</td>
<td>按位异或运算符：当两对应的二进位相异时，结果为1</td>
</tr>
<tr>
<td>~</td>
<td>按位取反运算符：对数据的每个二进制位取反,即把1变为0,把0变为1</td>
</tr>
<tr>
<td>&lt;&lt;</td>
<td>左移动运算符：运算数的各二进位全部左移若干位，由"&lt;&lt;"右边的数指定移动的位数，高位丢弃，低位补0</td>
</tr>
<tr>
<td>&gt;&gt;</td>
<td>右移动运算符：把"&gt;&gt;"左边的运算数的各二进位全部右移若干位，"&gt;&gt;"右边的数指定移动的位数</td>
</tr>
</tbody>
</table>
<h4 id="_23">逻辑运算符</h4>
<table>
<thead>
<tr>
<th>运算符</th>
<th>逻辑表达式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>and</td>
<td>x and y</td>
<td>布尔"与" - 如果 x 为 False，x and y 返回 x 的值，否则返回 y 的计算值。</td>
</tr>
<tr>
<td>or</td>
<td>x or y</td>
<td>布尔"或" - 如果 x 是 True，它返回 x 的值，否则它返回 y 的计算值。</td>
</tr>
<tr>
<td>not</td>
<td>not x</td>
<td>布尔"非" - 如果 x 为 True，返回 False 。如果 x 为 False，它返回 True。</td>
</tr>
</tbody>
</table>
<h4 id="_24">成员运算符</h4>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>in</td>
<td>如果在指定的序列中找到值返回 True，否则返回 False</td>
</tr>
<tr>
<td>not in</td>
<td>如果在指定的序列中没有找到值返回 True，否则返回 False</td>
</tr>
</tbody>
</table>
<h4 id="_25">成员身份运算符</h4>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>is</td>
<td>is 是判断两个标识符是不是引用自一个对象</td>
<td>x is y , 类似 id(x) == id(y) 如果引用的是同一个对象则返回 True，否则返回 False</td>
</tr>
<tr>
<td>is not</td>
<td>is not 是判断两个标识符是不是引用自不同对象</td>
<td>x is not y ，类似  id(x) != id(y) 如果引用的不是同一个对象则返回结果 True</td>
</tr>
</tbody>
</table>
<p><em>is 与 == 区别：is 用于判断两个变量引用对象是否为同一个， == 用于判断引用变量的值是否相等</em>。</p>
<h4 id="_26">运算符的优先级</h4>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>() [] {}</td>
<td>括号</td>
</tr>
<tr>
<td>x[index], x[index:index], x(arguments...), x.attribute</td>
<td>读取，切片，调用，属性引用</td>
</tr>
<tr>
<td>**</td>
<td>指数</td>
</tr>
<tr>
<td>~ + -</td>
<td>按位翻转, 一元加号和减号 (最后两个的方法名为 +@ 和 -@)</td>
</tr>
<tr>
<td>* / % //</td>
<td>乘，除，取模和取整除</td>
</tr>
<tr>
<td>+ -</td>
<td>加法减法</td>
</tr>
<tr>
<td>&gt;&gt; &lt;&lt;</td>
<td>右移，左移运算符</td>
</tr>
<tr>
<td>&amp;</td>
<td>位 'AND'</td>
</tr>
<tr>
<td>^|</td>
<td>位运算符</td>
</tr>
<tr>
<td>&lt;= &lt; &gt; &gt;=</td>
<td>比较运算符</td>
</tr>
<tr>
<td>&lt;&gt; == !=</td>
<td>等于运算符</td>
</tr>
<tr>
<td>= %= /= //= -= += <em>= </em>*=</td>
<td>赋值运算符</td>
</tr>
<tr>
<td>is is not</td>
<td>身份运算符</td>
</tr>
<tr>
<td>in not in</td>
<td>成员运算符</td>
</tr>
<tr>
<td>not and or</td>
<td>逻辑运算符</td>
</tr>
</tbody>
</table>
<h3 id="_27">语句</h3>
<p>语句一般来说都可以嵌套</p>
<h4 id="_28">条件语句</h4>
<p><strong>if – elif – else</strong>：（可以没有elif或else，也可以有多个elif）</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1"># 如果 &quot;condition_1&quot; 为 True 将执行 &quot;statement_block_1&quot; 块语句</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="k">if</span> <span class="o">&lt;</span><span class="n">condition_1</span><span class="o">&gt;</span><span class="p">:</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>    <span class="o">&lt;</span><span class="n">statement_block_1</span><span class="o">&gt;</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="c1"># 如果 &quot;condition_1&quot; 为False，将判断 &quot;condition_2&quot;</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="c1"># 如果&quot;condition_2&quot; 为 True 将执行 &quot;statement_block_2&quot; 块语句 </span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="k">elif</span> <span class="o">&lt;</span><span class="n">condition_2</span><span class="o">&gt;</span><span class="p">:</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>    <span class="o">&lt;</span><span class="n">statement_block_2</span><span class="o">&gt;</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="c1"># 如果 &quot;condition_2&quot; 为False，将执行&quot;statement_block_3&quot;块语句</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="k">else</span><span class="p">:</span>   
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>    <span class="o">&lt;</span><span class="n">statement_block_3</span><span class="o">&gt;</span>
</span></code></pre></div>
<p><strong>match...case</strong>：（Python 3.10 增加）</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1"># match 后的对象会依次与 case 后的内容进行匹配</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="c1"># 如果匹配成功，则执行匹配到的表达式，否则跳过</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="k">match</span> <span class="n">subject</span><span class="p">:</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>    <span class="k">case</span> <span class="o">&lt;</span><span class="n">pattern_1</span><span class="o">&gt;</span><span class="p">:</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>        <span class="o">&lt;</span><span class="n">action_1</span><span class="o">&gt;</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>    <span class="k">case</span> <span class="o">&lt;</span><span class="n">pattern_2</span><span class="o">&gt;</span><span class="p">:</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>        <span class="o">&lt;</span><span class="n">action_2</span><span class="o">&gt;</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>    <span class="k">case</span> <span class="o">&lt;</span><span class="n">pattern_3</span><span class="o">&gt;</span><span class="p">:</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>        <span class="o">&lt;</span><span class="n">action_3</span><span class="o">&gt;</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span> <span class="c1"># _ 可以匹配一切</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>        <span class="o">&lt;</span><span class="n">action_wildcard</span><span class="o">&gt;</span>
</span></code></pre></div>
<h4 id="_29">循环语句</h4>
<p><strong>while-else</strong>：（可以没有else）</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c1"># condition为真，执行statements语句</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="c1"># 有时需要设置条件恒为True实现死循环（控制台使用CTRL+C来退出当前的无限循环）</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="k">while</span> <span class="o">&lt;</span><span class="n">condition</span><span class="o">&gt;</span><span class="p">:</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>    <span class="o">&lt;</span><span class="n">statements</span><span class="o">&gt;</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="c1"># condition为假，执行additional_statements语句</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>    <span class="o">&lt;</span><span class="n">additional_statements</span><span class="o">&gt;</span>
</span></code></pre></div>
<p><strong>for-in-else</strong>：遍历（可以没有else）</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1"># iterable必须是可迭代对象，如一个列表或者一个字符串</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="c1"># 循环可以遍历iterable，得到每一个item</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="k">for</span> <span class="o">&lt;</span><span class="n">item</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">iterable</span><span class="o">&gt;</span><span class="p">:</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>    <span class="o">&lt;</span><span class="n">statements</span><span class="o">&gt;</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="c1"># 遍历完iterable中的所有元素后执行一段代码</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>    <span class="o">&lt;</span><span class="n">additional_statements</span><span class="o">&gt;</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="c1"># 可以使用内置 range() 函数快速创建一个可迭代的数字序列 range([start=0,] stop[, step=1])</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p>循环控制语句：
<strong>break</strong> 语句 跳出 for 和 while 的循环体（如果循环嵌套，只会跳出一层循环）。如果循环中止，任何对应的循环 else 块将不执行。
<strong>continue</strong> 语句 跳过当前循环块中的剩余语句，然后继续进行下一轮循环。
return</p>
<p><strong>推导式</strong>：
<code>int_list = [int(x) for x in str_list]</code></p>
<h3 id="_30">函数</h3>
<p>函数本质上就是一堆代码的集合，这些代码共同构成某些功能
  把某段常用的代码保存成函数是一个良好的习惯，这样做可以减少代码数量，提高代码复用率</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">def</span><span class="w"> </span><span class="o">&lt;</span><span class="n">方法名称</span><span class="o">&gt;</span><span class="p">([</span><span class="n">参数列表</span><span class="p">]):</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>    <span class="o">&lt;</span><span class="n">方法体</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>参数可以写很多个，每个参数之间使用逗号分隔 （可选参数）</p>
<p>返回值其实就是一个函数的计算结果，使用 <code>return</code> 关键字表示返回值
当结果产生时函数就没必要继续执行了，所以 <code>return</code> 关键字还会停止函数的执行</p>
<p>单星号参数用于接收任意数量的位置参数，并将其存储在一个元组中。
双星号参数用于接收任意数量的关键字参数，并将其存储在一个字典中。</p>
<h4 id="lambda">lambda匿名函数</h4>
<p>lambda 函数是一种小型、匿名的、内联函数，它可以具有任意数量的参数，但只能有一个表达式，不需要使用 def 关键字定义完整函数</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="k">lambda</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">expression</span>
</span></code></pre></div>
<ul>
<li><code>lambda</code>是 Python 的关键字，用于定义 lambda 函数。</li>
<li><code>arguments</code> 是参数列表，可以包含零个或多个参数，但必须在冒号(<code>:</code>)前指定。</li>
<li><code>expression</code> 是一个表达式，用于计算并返回函数的结果。</li>
</ul>
<blockquote>
<p>将lambda函数赋值给一个变量，通过这个变量间接调用该lambda函数
将lambda函数赋值给其他函数，从而将其他函数用该lambda函数替换
将lambda函数作为<strong>参数传递</strong>给其他函数</p>
</blockquote>
<div class="language-python highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="n">x</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="p">:</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="c1"># map(function, iterable, ...)</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="n">squared</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">numbers</span><span class="p">))</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="nb">print</span><span class="p">(</span><span class="n">squared</span><span class="p">)</span>  <span class="c1"># 输出: [1, 4, 9, 16, 25]</span>
</span></code></pre></div>
<h3 id="_31">类</h3>
<p>面向对象技术简介
类(Class): 用来描述具有相同的属性和方法的对象的集合。它定义了该集合中每个对象所共有的属性和方法。==对象是类的实例==。
方法：==方法是类中定义的函数==。
类变量：类变量在整个实例化的对象中是公用的。类变量定义在类中且在函数体之外。类变量通常不作为实例变量使用。
数据成员：类变量或者实例变量用于处理类及其实例对象的相关的数据。
方法重写：如果从父类继承的方法不能满足子类的需求，可以对其进行改写，这个过程叫方法的覆盖（override），也称为方法的重写。
局部变量：定义在方法中的变量，只作用于当前实例的类。
实例变量：在类的声明中，属性是用变量来表示的，这种变量就称为实例变量，实例变量就是一个用 self 修饰的变量。
继承：即一个派生类（derived class）继承基类（base class）的字段和方法。继承也允许把一个派生类的对象作为一个基类对象对待。例如，有这样一个设计：一个Dog类型的对象派生自Animal类，这是模拟"是一个（is-a）"关系（例图，Dog是一个Animal）。
实例化：创建一个类的实例，类的具体对象。
对象：通过类定义的数据结构实例。对象包括两个数据成员（类变量和实例变量）和方法。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyClass</span><span class="p">:</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;一个简单的类实例&quot;&quot;&quot;</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">12345</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>        <span class="k">return</span> <span class="s1">&#39;hello world&#39;</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="c1"># 实例化类</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="n">x</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">()</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="c1"># 访问类的属性和方法</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MyClass 类的属性 i 为：&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">i</span><span class="p">)</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MyClass 类的方法 f 输出为：&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">f</span><span class="p">())</span>
</span></code></pre></div>
<p>类有一个名为 <strong>init</strong>() 的特殊方法（构造方法），该方法在类实例化时会自动调用
类的方法与普通的函数只有一个特别的区别——它们必须有一个额外的第一个参数名称, self 不是 python 关键字,按照惯例它的名称是 self。
在类的内部，使用 def 关键字来定义一个方法，与一般函数定义不同，类方法必须包含参数 self, 且为第一个参数，self 代表的是类的实例。</p>
<p>继承
Python 支持类的继承，如果一种语言不支持继承，类就没有什么意义。派生类的定义如下所示:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">DerivedClassName</span><span class="p">(</span><span class="n">BaseClassName</span><span class="p">):</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>    <span class="o">&lt;</span><span class="n">statement</span><span class="o">-</span><span class="mi">1</span><span class="o">&gt;</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>    <span class="o">.</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>    <span class="o">.</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>    <span class="o">.</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>    <span class="o">&lt;</span><span class="n">statement</span><span class="o">-</span><span class="n">N</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>子类（派生类 DerivedClassName）会继承父类（基类 BaseClassName）的属性和方法。
多继承
Python有限的支持多继承形式。多继承的类定义形如下例:</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">DerivedClassName</span><span class="p">(</span><span class="n">Base1</span><span class="p">,</span> <span class="n">Base2</span><span class="p">,</span> <span class="n">Base3</span><span class="p">):</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>    <span class="o">&lt;</span><span class="n">statement</span><span class="o">-</span><span class="mi">1</span><span class="o">&gt;</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>    <span class="o">.</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>    <span class="o">.</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>    <span class="o">.</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>    <span class="o">&lt;</span><span class="n">statement</span><span class="o">-</span><span class="n">N</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>需要注意圆括号中父类的顺序，若是父类中有相同的方法名，而在子类使用时未指定，python从左至右搜索 即方法在子类中未找到时，从左到右查找父类中是否包含方法。</p>
<p>如果你的父类方法的功能不能满足你的需求，你可以在子类重写你父类的方法</p>
<p>类属性与方法
类的私有属性
__private_attrs：两个下划线开头，声明该属性为私有，不能在类的外部被使用或直接访问。在类内部的方法中使用时 self.__private_attrs。</p>
<p>类的方法
在类的内部，使用 def 关键字来定义一个方法，与一般函数定义不同，类方法必须包含参数 self，且为第一个参数，self 代表的是类的实例。</p>
<p>self 的名字并不是规定死的，也可以使用 this，但是最好还是按照约定使用 self。</p>
<p>类的私有方法
__private_method：两个下划线开头，声明该方法为私有方法，只能在类的内部调用 ，不能在类的外部调用。self.__private_methods。</p>
<p>类的专有方法：
<strong>init</strong> : 构造函数，在生成对象时调用
<strong>del</strong> : 析构函数，释放对象时使用
<strong>repr</strong> : 打印，转换
<strong>setitem</strong> : 按照索引赋值
<strong>getitem</strong>: 按照索引获取值
<strong>len</strong>: 获得长度
<strong>cmp</strong>: 比较运算
<strong>call</strong>: 函数调用
<strong>add</strong>: 加运算
<strong>sub</strong>: 减运算
<strong>mul</strong>: 乘运算
<strong>truediv</strong>: 除运算
<strong>mod</strong>: 求余运算
<strong>pow</strong>: 乘方</p>
<p>创建实例：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Blog</span><span class="p">:</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>   <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>       <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a new object num is&quot;</span><span class="p">,</span><span class="n">num</span><span class="p">)</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>       <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">num</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>   <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>       <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="c1"># 循环建立四个对象，locals()函数可以将字符串转换为变量名！</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="c1">#具体的操作和含义我并不清楚，大家可以自行百度～</span>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>    <span class="nb">locals</span><span class="p">()[</span><span class="s1">&#39;blog_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Blog</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></code></pre></div>
<p><code>type()</code> 函数是Python的一个内置函数，通常用来查看一个对象的类型。但是，它也可以用来动态创建类。<code>type()</code> 函数可以接收三个参数：类名（字符串）、父类元组和属性字典。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>    <span class="n">class_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;DynamicClass</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>    <span class="n">class_attributes</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>        <span class="s2">&quot;attribute&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>        <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Method of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>    <span class="p">}</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>    <span class="n">new_class</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="p">(</span><span class="nb">object</span><span class="p">,),</span> <span class="n">class_attributes</span><span class="p">)</span>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>    <span class="n">instance</span> <span class="o">=</span> <span class="n">new_class</span><span class="p">()</span>
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">method</span><span class="p">())</span>
</span></code></pre></div>
<p><code>dir()</code>函数返回一个包含对象中所有属性和方法的列表。然后，我们可以使用循环来遍历这个列表，并对每个属性进行操作。</p>
<p><code>hasattr (object, name)</code> 判断对象是否包含对应的属性</p>
<p>﻿setattr()、getattr()、hasattr()函数</p>
<h4 id="_32">对象保存（数据持久化）</h4>
<p>对象保存是指将内存中的对象转换为可存储或传输的形式，并在需要时恢复为对象的过程。在实际开发中，对象保存很常见，它可以用于数据持久化，数据传输，或者在不同的系统之间共享对象。</p>
<p>1)<strong>Pickle</strong> 是Python标准库中用于对象保存的模块。它可以将对象序列化为字节流，以便存储或传输，并且能够将字节流反序列化为原始对象。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Person</span><span class="p">:</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="n">person</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="c1"># 保存对象到文件</span>
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;person.pickle&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a>    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">person</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a>
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a><span class="c1"># 从文件中加载对象</span>
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;person.pickle&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a>    <span class="n">loaded_person</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a>
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a><span class="nb">print</span><span class="p">(</span><span class="n">loaded_person</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># 输出：Alice</span>
</span><span id="__span-34-19"><a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a><span class="nb">print</span><span class="p">(</span><span class="n">loaded_person</span><span class="o">.</span><span class="n">age</span><span class="p">)</span>  <span class="c1"># 输出：25</span>
</span></code></pre></div>
<p><strong>dill</strong>库[[#dill（对象序列化）]]，作为pickle的加强版，提供了更加强大和灵活的序列化功能</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dill</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Person</span><span class="p">:</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="c1"># 创建一个Person实例</span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="n">person</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a><span class="c1"># 序列化实例到文件</span>
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;person_instance.dill&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>    <span class="n">dill</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">person</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="__span-35-14"><a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a>
</span><span id="__span-35-15"><a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a><span class="c1"># 反序列化实例</span>
</span><span id="__span-35-16"><a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;person_instance.dill&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-35-17"><a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a>    <span class="n">new_person</span> <span class="o">=</span> <span class="n">dill</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></code></pre></div>
<p>2)<strong>JSON</strong>（JavaScript Object Notation）是一种轻量级的数据交换格式。它以文本形式来表示结构化数据，并且易于阅读和理解。在Python中，可以通过内置的json模块来实现对象的JSON保存和加载。
JSON与Pickle相比，具有平台无关性，可以被多种编程语言解析和生成。然而，JSON只能保存一些基本的数据类型，例如整数、浮点数、字符串、布尔值、数组和字典等。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Person</span><span class="p">:</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="n">person</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="c1"># 将对象保存为JSON字符串</span>
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="n">person_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">person</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>
</span><span id="__span-36-13"><a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a><span class="c1"># 将JSON字符串保存到文件</span>
</span><span id="__span-36-14"><a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;person.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="__span-36-15"><a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a>    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">person_json</span><span class="p">)</span>
</span><span id="__span-36-16"><a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a>
</span><span id="__span-36-17"><a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a><span class="c1"># 从文件中加载JSON字符串并转换为对象</span>
</span><span id="__span-36-18"><a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;person.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="__span-36-19"><a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a>    <span class="n">loaded_person_json</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="__span-36-20"><a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a>    <span class="n">loaded_person_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">loaded_person_json</span><span class="p">)</span>
</span><span id="__span-36-21"><a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a>    <span class="n">loaded_person</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="o">**</span><span class="n">loaded_person_dict</span><span class="p">)</span>
</span><span id="__span-36-22"><a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a>
</span><span id="__span-36-23"><a id="__codelineno-36-23" name="__codelineno-36-23" href="#__codelineno-36-23"></a><span class="nb">print</span><span class="p">(</span><span class="n">loaded_person</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># 输出：Alice</span>
</span><span id="__span-36-24"><a id="__codelineno-36-24" name="__codelineno-36-24" href="#__codelineno-36-24"></a><span class="nb">print</span><span class="p">(</span><span class="n">loaded_person</span><span class="o">.</span><span class="n">age</span><span class="p">)</span>  <span class="c1"># 输出：25</span>
</span></code></pre></div>
<p>3)如果需要保存大量数据并进行高效查询，可以使用数据库来完成。在Python中，可以使用内置的<strong>sqlite3</strong>模块来操作SQLite数据库。
SQLite是一种嵌入式数据库引擎，它不需要单独的服务器进程，而是将整个数据库作为一个文件存储在磁盘上。SQLite支持标准的SQL语法，并提供了轻量级的事务支持。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Person</span><span class="p">:</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a><span class="n">person</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>
</span><span id="__span-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a><span class="c1"># 连接数据库并创建表格</span>
</span><span id="__span-37-11"><a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;person.db&quot;</span><span class="p">)</span>
</span><span id="__span-37-12"><a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a><span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="__span-37-13"><a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE IF NOT EXISTS persons (name TEXT, age INTEGER)&quot;</span><span class="p">)</span>
</span><span id="__span-37-14"><a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a>
</span><span id="__span-37-15"><a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a><span class="c1"># 将对象保存到数据库</span>
</span><span id="__span-37-16"><a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO persons VALUES (?, ?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">person</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">person</span><span class="o">.</span><span class="n">age</span><span class="p">))</span>
</span><span id="__span-37-17"><a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-37-18"><a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a>
</span><span id="__span-37-19"><a id="__codelineno-37-19" name="__codelineno-37-19" href="#__codelineno-37-19"></a><span class="c1"># 从数据库中加载对象</span>
</span><span id="__span-37-20"><a id="__codelineno-37-20" name="__codelineno-37-20" href="#__codelineno-37-20"></a><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM persons&quot;</span><span class="p">)</span>
</span><span id="__span-37-21"><a id="__codelineno-37-21" name="__codelineno-37-21" href="#__codelineno-37-21"></a><span class="n">loaded_person_row</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
</span><span id="__span-37-22"><a id="__codelineno-37-22" name="__codelineno-37-22" href="#__codelineno-37-22"></a><span class="n">loaded_person</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="o">*</span><span class="n">loaded_person_row</span><span class="p">)</span>
</span><span id="__span-37-23"><a id="__codelineno-37-23" name="__codelineno-37-23" href="#__codelineno-37-23"></a>
</span><span id="__span-37-24"><a id="__codelineno-37-24" name="__codelineno-37-24" href="#__codelineno-37-24"></a><span class="nb">print</span><span class="p">(</span><span class="n">loaded_person</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># 输出：Alice</span>
</span><span id="__span-37-25"><a id="__codelineno-37-25" name="__codelineno-37-25" href="#__codelineno-37-25"></a><span class="nb">print</span><span class="p">(</span><span class="n">loaded_person</span><span class="o">.</span><span class="n">age</span><span class="p">)</span>  <span class="c1"># 输出：25</span>
</span><span id="__span-37-26"><a id="__codelineno-37-26" name="__codelineno-37-26" href="#__codelineno-37-26"></a>
</span><span id="__span-37-27"><a id="__codelineno-37-27" name="__codelineno-37-27" href="#__codelineno-37-27"></a><span class="c1"># 关闭数据库连接</span>
</span><span id="__span-37-28"><a id="__codelineno-37-28" name="__codelineno-37-28" href="#__codelineno-37-28"></a><span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-37-29"><a id="__codelineno-37-29" name="__codelineno-37-29" href="#__codelineno-37-29"></a><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></code></pre></div>
<p>4)<strong>CSV</strong>文件
如果想将对象保存为表格形式，可以使用CSV（逗号分隔值）文件。Python提供了csv模块，方便我们进行CSV文件的读写操作。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">csv</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Person</span><span class="p">:</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="n">persons</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a>    <span class="n">Person</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a>    <span class="n">Person</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a><span class="p">]</span>
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a>
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a><span class="c1"># 将对象保存到CSV文件</span>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;persons.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a>    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="__span-38-16"><a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a>    <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">persons</span><span class="p">:</span>
</span><span id="__span-38-17"><a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a>        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="n">person</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">person</span><span class="o">.</span><span class="n">age</span><span class="p">])</span>
</span><span id="__span-38-18"><a id="__codelineno-38-18" name="__codelineno-38-18" href="#__codelineno-38-18"></a>
</span><span id="__span-38-19"><a id="__codelineno-38-19" name="__codelineno-38-19" href="#__codelineno-38-19"></a><span class="c1"># 从CSV文件中加载对象</span>
</span><span id="__span-38-20"><a id="__codelineno-38-20" name="__codelineno-38-20" href="#__codelineno-38-20"></a><span class="n">loaded_persons</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-38-21"><a id="__codelineno-38-21" name="__codelineno-38-21" href="#__codelineno-38-21"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;persons.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="__span-38-22"><a id="__codelineno-38-22" name="__codelineno-38-22" href="#__codelineno-38-22"></a>    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="__span-38-23"><a id="__codelineno-38-23" name="__codelineno-38-23" href="#__codelineno-38-23"></a>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
</span><span id="__span-38-24"><a id="__codelineno-38-24" name="__codelineno-38-24" href="#__codelineno-38-24"></a>        <span class="n">loaded_persons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Person</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="__span-38-25"><a id="__codelineno-38-25" name="__codelineno-38-25" href="#__codelineno-38-25"></a>
</span><span id="__span-38-26"><a id="__codelineno-38-26" name="__codelineno-38-26" href="#__codelineno-38-26"></a><span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">loaded_persons</span><span class="p">:</span>
</span><span id="__span-38-27"><a id="__codelineno-38-27" name="__codelineno-38-27" href="#__codelineno-38-27"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">person</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">person</span><span class="o">.</span><span class="n">age</span><span class="p">)</span>
</span></code></pre></div>
<p>5)<strong>YAML</strong>（YAML Ain’t Markup Language）是一种人类可读的数据序列化格式。它以简洁、清晰的结构来表示数据，并且支持复杂的数据类型，如列表、字典、甚至嵌套的数据结构。在Python中，可以使用pyyaml库来处理YAML文件。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Person</span><span class="p">:</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="n">person</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a><span class="c1"># 将对象保存到YAML文件</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;person.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a>    <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">person</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a>
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a><span class="c1"># 从YAML文件中加载对象</span>
</span><span id="__span-39-15"><a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;person.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="__span-39-16"><a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a>    <span class="n">loaded_person_dict</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">SafeLoader</span><span class="p">)</span>
</span><span id="__span-39-17"><a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a>    <span class="n">loaded_person</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="o">**</span><span class="n">loaded_person_dict</span><span class="p">)</span>
</span><span id="__span-39-18"><a id="__codelineno-39-18" name="__codelineno-39-18" href="#__codelineno-39-18"></a>
</span><span id="__span-39-19"><a id="__codelineno-39-19" name="__codelineno-39-19" href="#__codelineno-39-19"></a><span class="nb">print</span><span class="p">(</span><span class="n">loaded_person</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># 输出：Alice</span>
</span><span id="__span-39-20"><a id="__codelineno-39-20" name="__codelineno-39-20" href="#__codelineno-39-20"></a><span class="nb">print</span><span class="p">(</span><span class="n">loaded_person</span><span class="o">.</span><span class="n">age</span><span class="p">)</span>  <span class="c1"># 输出：25</span>
</span></code></pre></div>
<h3 id="_33">异常处理</h3>
<p><em>异常</em>指程序运行错误；<em>错误</em>指程序运行和程序逻辑错误</p>
<p>异常即是一个事件，该事件会在程序执行过程中发生，影响了程序的正常执行。
一般情况下，在Python无法正常处理程序时就会发生一个异常。
当Python脚本发生异常时我们需要捕获处理它，否则程序会终止执行。
所有异常处理可以提高代码的稳健性。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="k">try</span><span class="p">:</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>    <span class="o">&lt;</span><span class="n">语句</span><span class="o">&gt;</span>        <span class="c1"># 运行别的代码</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="k">except</span> <span class="o">&lt;</span><span class="n">名字</span><span class="o">&gt;</span><span class="err">：</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>    <span class="o">&lt;</span><span class="n">语句</span><span class="o">&gt;</span>        <span class="c1"># 如果在try部份引发了&#39;name&#39;异常</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="k">except</span> <span class="o">&lt;</span><span class="n">名字</span><span class="o">&gt;</span><span class="err">，</span><span class="o">&lt;</span><span class="n">数据</span><span class="o">&gt;</span><span class="p">:</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a>    <span class="o">&lt;</span><span class="n">语句</span><span class="o">&gt;</span>        <span class="c1"># 如果引发了&#39;name&#39;异常，获得附加的数据</span>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a>    <span class="o">&lt;</span><span class="n">语句</span><span class="o">&gt;</span>        <span class="c1"># 如果没有异常发生</span>
</span></code></pre></div>
<p>你可以不带任何异常类型使用except捕获所有发生的异常。但这不是一个很好的方式，我们不能通过该程序识别出具体的异常信息。因为它捕获所有的异常。
你也可以使用相同的except语句来处理多个异常信息</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="k">try</span><span class="p">:</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>    <span class="o">&lt;</span><span class="n">语句</span><span class="o">&gt;</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="k">finally</span><span class="p">:</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>    <span class="o">&lt;</span><span class="n">语句</span><span class="o">&gt;</span>    <span class="c1"># 无论是否发生异常都将执行</span>
</span></code></pre></div>
<p>一个异常可以带上参数，可作为输出的异常信息参数</p>
<p>我们可以使用raise语句自己触发异常raise语法格式如下：
<code>raise [Exception [, args [, traceback]]]</code></p>
<p>用户自定义异常</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Networkerror</span><span class="p">(</span><span class="ne">RuntimeError</span><span class="p">):</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">arg</span>
</span></code></pre></div>
<table>
<thead>
<tr>
<th>异常名称</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>BaseException</td>
<td>所有异常的基类</td>
</tr>
<tr>
<td>SystemExit</td>
<td>解释器请求退出</td>
</tr>
<tr>
<td>KeyboardInterrupt</td>
<td>用户中断执行(通常是输入^C)</td>
</tr>
<tr>
<td>Exception</td>
<td>常规错误的基类</td>
</tr>
<tr>
<td>StopIteration</td>
<td>迭代器没有更多的值</td>
</tr>
<tr>
<td>GeneratorExit</td>
<td>生成器(generator)发生异常来通知退出</td>
</tr>
<tr>
<td>StandardError</td>
<td>所有的内建标准异常的基类</td>
</tr>
<tr>
<td>ArithmeticError</td>
<td>所有数值计算错误的基类</td>
</tr>
<tr>
<td>FloatingPointError</td>
<td>浮点计算错误</td>
</tr>
<tr>
<td>OverflowError</td>
<td>数值运算超出最大限制</td>
</tr>
<tr>
<td>ZeroDivisionError</td>
<td>除(或取模)零 (所有数据类型)</td>
</tr>
<tr>
<td>AssertionError</td>
<td>断言语句失败</td>
</tr>
<tr>
<td>AttributeError</td>
<td>对象没有这个属性</td>
</tr>
<tr>
<td>EOFError</td>
<td>没有内建输入,到达EOF 标记</td>
</tr>
<tr>
<td>EnvironmentError</td>
<td>操作系统错误的基类</td>
</tr>
<tr>
<td>IOError</td>
<td>输入/输出操作失败</td>
</tr>
<tr>
<td>OSError</td>
<td>操作系统错误</td>
</tr>
<tr>
<td>WindowsError</td>
<td>系统调用失败</td>
</tr>
<tr>
<td>ImportError</td>
<td>导入模块/对象失败</td>
</tr>
<tr>
<td>LookupError</td>
<td>无效数据查询的基类</td>
</tr>
<tr>
<td>IndexError</td>
<td>序列中没有此索引(index)</td>
</tr>
<tr>
<td>KeyError</td>
<td>映射中没有这个键</td>
</tr>
<tr>
<td>MemoryError</td>
<td>内存溢出错误(对于Python 解释器不是致命的)</td>
</tr>
<tr>
<td>NameError</td>
<td>未声明/初始化对象 (没有属性)</td>
</tr>
<tr>
<td>UnboundLocalError</td>
<td>访问未初始化的本地变量</td>
</tr>
<tr>
<td>ReferenceError</td>
<td>弱引用(Weak reference)试图访问已经垃圾回收了的对象</td>
</tr>
<tr>
<td>RuntimeError</td>
<td>一般的运行时错误</td>
</tr>
<tr>
<td>NotImplementedError</td>
<td>尚未实现的方法</td>
</tr>
<tr>
<td>SyntaxError</td>
<td>Python 语法错误</td>
</tr>
<tr>
<td>IndentationError</td>
<td>缩进错误</td>
</tr>
<tr>
<td>TabError</td>
<td>Tab 和空格混用</td>
</tr>
<tr>
<td>SystemError</td>
<td>一般的解释器系统错误</td>
</tr>
<tr>
<td>TypeError</td>
<td>对类型无效的操作</td>
</tr>
<tr>
<td>ValueError</td>
<td>传入无效的参数</td>
</tr>
<tr>
<td>UnicodeError</td>
<td>Unicode 相关的错误</td>
</tr>
<tr>
<td>UnicodeDecodeError</td>
<td>Unicode 解码时的错误</td>
</tr>
<tr>
<td>UnicodeEncodeError</td>
<td>Unicode 编码时错误</td>
</tr>
<tr>
<td>UnicodeTranslateError</td>
<td>Unicode 转换时错误</td>
</tr>
<tr>
<td>Warning</td>
<td>警告的基类</td>
</tr>
<tr>
<td>DeprecationWarning</td>
<td>关于被弃用的特征的警告</td>
</tr>
<tr>
<td>FutureWarning</td>
<td>关于构造将来语义会有改变的警告</td>
</tr>
<tr>
<td>OverflowWarning</td>
<td>旧的关于自动提升为长整型(long)的警告</td>
</tr>
<tr>
<td>PendingDeprecationWarning</td>
<td>关于特性将会被废弃的警告</td>
</tr>
<tr>
<td>RuntimeWarning</td>
<td>可疑的运行时行为(runtime behavior)的警告</td>
</tr>
<tr>
<td>SyntaxWarning</td>
<td>可疑的语法的警告</td>
</tr>
<tr>
<td>UserWarning</td>
<td>用户代码生成的警告</td>
</tr>
</tbody>
</table>
<h3 id="_34">文件和数据格式化</h3>
<p>open() 方法用于打开一个文件，并返回文件对象。
在对文件进行处理过程都需要使用到这个函数，如果该文件无法被打开，会抛出 OSError。
注意：使用 open() 方法一定要保证关闭文件对象，即调用 close() 方法。</p>
<p>open(file, mode='r'[, buffering=-1, encoding=None, errors=None, newline=None, closefd=True, opener=None])</p>
<ul>
<li>file: 必需，文件路径（相对或者绝对路径）。</li>
<li>mode: 可选，文件打开模式</li>
<li>buffering: 设置缓冲</li>
<li>encoding: 一般使用utf8</li>
<li>errors: 报错级别</li>
<li>newline: 区分换行符</li>
<li>closefd: 传入的file参数类型</li>
<li>opener: 设置自定义开启器，开启器的返回值必须是一个打开的文件描述符。</li>
</ul>
<table>
<thead>
<tr>
<th>模式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>t</td>
<td>文本模式 (默认)。</td>
</tr>
<tr>
<td>x</td>
<td>写模式，新建一个文件，如果该文件已存在则会报错。</td>
</tr>
<tr>
<td>b</td>
<td>二进制模式。</td>
</tr>
<tr>
<td>+</td>
<td>打开一个文件进行更新(可读可写)。</td>
</tr>
<tr>
<td>U</td>
<td>通用换行模式（<strong>Python 3 不支持</strong> ）。</td>
</tr>
<tr>
<td>r</td>
<td>以只读方式打开文件。文件的指针将会放在文件的开头。这是默认模式。</td>
</tr>
<tr>
<td>rb</td>
<td>以二进制格式打开一个文件用于只读。文件指针将会放在文件的开头。这是默认模式。一般用于非文本文件如图片等。</td>
</tr>
<tr>
<td>r+</td>
<td>打开一个文件用于读写。文件指针将会放在文件的开头。</td>
</tr>
<tr>
<td>rb+</td>
<td>以二进制格式打开一个文件用于读写。文件指针将会放在文件的开头。一般用于非文本文件如图片等。</td>
</tr>
<tr>
<td>w</td>
<td>打开一个文件只用于写入。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。</td>
</tr>
<tr>
<td>wb</td>
<td>以二进制格式打开一个文件只用于写入。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。一般用于非文本文件如图片等。</td>
</tr>
<tr>
<td>w+</td>
<td>打开一个文件用于读写。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。</td>
</tr>
<tr>
<td>wb+</td>
<td>以二进制格式打开一个文件用于读写。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。一般用于非文本文件如图片等。</td>
</tr>
<tr>
<td>a</td>
<td>打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</td>
</tr>
<tr>
<td>ab</td>
<td>以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</td>
</tr>
<tr>
<td>a+</td>
<td>打开一个文件用于读写。如果该文件已存在，文件指针将会放在文件的结尾。文件打开时会是追加模式。如果该文件不存在，创建新文件用于读写。</td>
</tr>
<tr>
<td>ab+</td>
<td>以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。如果该文件不存在，创建新文件用于读写。</td>
</tr>
</tbody>
</table>
<p>file.close()关闭文件。关闭后文件不能再进行读写操作。</p>
<p>file.flush()刷新文件内部缓冲，直接把内部缓冲区的数据立刻写入文件, 而不是被动的等待输出缓冲区写入。</p>
<p>file.fileno()返回一个整型的文件描述符(file descriptor FD 整型), 可以用在如os模块的read方法等一些底层操作上。</p>
<p>file.isatty()如果文件连接到一个终端设备返回 True，否则返回 False。</p>
<p><strong>file.read([size])</strong>从文件读取指定的字节数，如果未给定或为负则读取所有。</p>
<p>file.readline([size])读取整行，包括 "\n" 字符。</p>
<p>file.readlines([sizeint])读取所有行并返回列表，若给定sizeint&gt;0，返回总和大约为sizeint字节的行, 实际读取值可能比 sizeint 较大, 因为需要填充缓冲区。</p>
<p>file.seek(offset[, whence])移动文件读取指针到指定位置</p>
<p>file.tell()返回文件当前位置。</p>
<p>file.truncate([size])
从文件的首行首字符开始截断，截断文件为 size 个字符，无 size 表示从当前位置截断；截断之后后面的所有字符被删除，其中 windows 系统下的换行代表2个字符大小。</p>
<p><strong>file.write(str)</strong>将字符串写入文件，返回的是写入的字符长度。</p>
<p>file.writelines(sequence)向文件写入一个序列字符串列表，如果需要换行则要自己加入每行的换行符。</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>fs=open(&#39;&#39;,&#39;w&#39;,encoding=&#39;utf8&#39;)
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>fs.write()
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>fs.close()
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>with open() as fs: //不需要close
</span></code></pre></div>
<h4 id="_35">替换字符串</h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>def alter(file,old_str,new_str):
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>    &quot;&quot;&quot;
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>    替换文件中的字符串
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>    :param file:文件名
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>    :param old_str:就字符串
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a>    :param new_str:新字符串
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>    :return:
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a>    &quot;&quot;&quot;
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a>    file_data = &quot;&quot;
</span><span id="__span-44-10"><a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a>    with open(file, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:
</span><span id="__span-44-11"><a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a>        for line in f:
</span><span id="__span-44-12"><a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a>            if old_str in line:
</span><span id="__span-44-13"><a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a>                line = line.replace(old_str,new_str)
</span><span id="__span-44-14"><a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a>            file_data += line
</span><span id="__span-44-15"><a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a>    with open(file,&quot;w&quot;,encoding=&quot;utf-8&quot;) as f:
</span><span id="__span-44-16"><a id="__codelineno-44-16" name="__codelineno-44-16" href="#__codelineno-44-16"></a>        f.write(file_data)
</span><span id="__span-44-17"><a id="__codelineno-44-17" name="__codelineno-44-17" href="#__codelineno-44-17"></a>
</span><span id="__span-44-18"><a id="__codelineno-44-18" name="__codelineno-44-18" href="#__codelineno-44-18"></a>alter(&quot;file1&quot;, &quot;09876&quot;, &quot;python&quot;)
</span><span id="__span-44-19"><a id="__codelineno-44-19" name="__codelineno-44-19" href="#__codelineno-44-19"></a>
</span><span id="__span-44-20"><a id="__codelineno-44-20" name="__codelineno-44-20" href="#__codelineno-44-20"></a>
</span><span id="__span-44-21"><a id="__codelineno-44-21" name="__codelineno-44-21" href="#__codelineno-44-21"></a>import os
</span><span id="__span-44-22"><a id="__codelineno-44-22" name="__codelineno-44-22" href="#__codelineno-44-22"></a>def alter(file,old_str,new_str):
</span><span id="__span-44-23"><a id="__codelineno-44-23" name="__codelineno-44-23" href="#__codelineno-44-23"></a>    &quot;&quot;&quot;
</span><span id="__span-44-24"><a id="__codelineno-44-24" name="__codelineno-44-24" href="#__codelineno-44-24"></a>    将替换的字符串写到一个新的文件中，然后将原文件删除，新文件改为原来文件的名字
</span><span id="__span-44-25"><a id="__codelineno-44-25" name="__codelineno-44-25" href="#__codelineno-44-25"></a>    :param file: 文件路径
</span><span id="__span-44-26"><a id="__codelineno-44-26" name="__codelineno-44-26" href="#__codelineno-44-26"></a>    :param old_str: 需要替换的字符串
</span><span id="__span-44-27"><a id="__codelineno-44-27" name="__codelineno-44-27" href="#__codelineno-44-27"></a>    :param new_str: 替换的字符串
</span><span id="__span-44-28"><a id="__codelineno-44-28" name="__codelineno-44-28" href="#__codelineno-44-28"></a>    :return: None
</span><span id="__span-44-29"><a id="__codelineno-44-29" name="__codelineno-44-29" href="#__codelineno-44-29"></a>    &quot;&quot;&quot;
</span><span id="__span-44-30"><a id="__codelineno-44-30" name="__codelineno-44-30" href="#__codelineno-44-30"></a>    with open(file, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f1,open(&quot;%s.bak&quot; % file, &quot;w&quot;, encoding=&quot;utf-8&quot;) as f2:
</span><span id="__span-44-31"><a id="__codelineno-44-31" name="__codelineno-44-31" href="#__codelineno-44-31"></a>        for line in f1:
</span><span id="__span-44-32"><a id="__codelineno-44-32" name="__codelineno-44-32" href="#__codelineno-44-32"></a>            if old_str in line:
</span><span id="__span-44-33"><a id="__codelineno-44-33" name="__codelineno-44-33" href="#__codelineno-44-33"></a>                line = line.replace(old_str, new_str)
</span><span id="__span-44-34"><a id="__codelineno-44-34" name="__codelineno-44-34" href="#__codelineno-44-34"></a>            f2.write(line)
</span><span id="__span-44-35"><a id="__codelineno-44-35" name="__codelineno-44-35" href="#__codelineno-44-35"></a>    os.remove(file)
</span><span id="__span-44-36"><a id="__codelineno-44-36" name="__codelineno-44-36" href="#__codelineno-44-36"></a>    os.rename(&quot;%s.bak&quot; % file, file)
</span><span id="__span-44-37"><a id="__codelineno-44-37" name="__codelineno-44-37" href="#__codelineno-44-37"></a>
</span><span id="__span-44-38"><a id="__codelineno-44-38" name="__codelineno-44-38" href="#__codelineno-44-38"></a>alter(&quot;file1&quot;, &quot;python&quot;, &quot;测试&quot;)
</span><span id="__span-44-39"><a id="__codelineno-44-39" name="__codelineno-44-39" href="#__codelineno-44-39"></a>
</span><span id="__span-44-40"><a id="__codelineno-44-40" name="__codelineno-44-40" href="#__codelineno-44-40"></a>
</span><span id="__span-44-41"><a id="__codelineno-44-41" name="__codelineno-44-41" href="#__codelineno-44-41"></a>import re,os
</span><span id="__span-44-42"><a id="__codelineno-44-42" name="__codelineno-44-42" href="#__codelineno-44-42"></a>def alter(file,old_str,new_str):
</span><span id="__span-44-43"><a id="__codelineno-44-43" name="__codelineno-44-43" href="#__codelineno-44-43"></a>
</span><span id="__span-44-44"><a id="__codelineno-44-44" name="__codelineno-44-44" href="#__codelineno-44-44"></a>    with open(file, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f1,open(&quot;%s.bak&quot; % file, &quot;w&quot;, encoding=&quot;utf-8&quot;) as f2:
</span><span id="__span-44-45"><a id="__codelineno-44-45" name="__codelineno-44-45" href="#__codelineno-44-45"></a>        for line in f1:
</span><span id="__span-44-46"><a id="__codelineno-44-46" name="__codelineno-44-46" href="#__codelineno-44-46"></a>            f2.write(re.sub(old_str,new_str,line))
</span><span id="__span-44-47"><a id="__codelineno-44-47" name="__codelineno-44-47" href="#__codelineno-44-47"></a>    os.remove(file)
</span><span id="__span-44-48"><a id="__codelineno-44-48" name="__codelineno-44-48" href="#__codelineno-44-48"></a>    os.rename(&quot;%s.bak&quot; % file, file)
</span><span id="__span-44-49"><a id="__codelineno-44-49" name="__codelineno-44-49" href="#__codelineno-44-49"></a>alter(&quot;file1&quot;, &quot;admin&quot;, &quot;password&quot;)
</span><span id="__span-44-50"><a id="__codelineno-44-50" name="__codelineno-44-50" href="#__codelineno-44-50"></a>
</span><span id="__span-44-51"><a id="__codelineno-44-51" name="__codelineno-44-51" href="#__codelineno-44-51"></a>def alter(file,list_alter):
</span><span id="__span-44-52"><a id="__codelineno-44-52" name="__codelineno-44-52" href="#__codelineno-44-52"></a>    file_data = &quot;&quot;
</span><span id="__span-44-53"><a id="__codelineno-44-53" name="__codelineno-44-53" href="#__codelineno-44-53"></a>    with open(file, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:
</span><span id="__span-44-54"><a id="__codelineno-44-54" name="__codelineno-44-54" href="#__codelineno-44-54"></a>        for line in f:
</span><span id="__span-44-55"><a id="__codelineno-44-55" name="__codelineno-44-55" href="#__codelineno-44-55"></a>            for i in range(len(list_alter[0])):
</span><span id="__span-44-56"><a id="__codelineno-44-56" name="__codelineno-44-56" href="#__codelineno-44-56"></a>                if list_alter[0][i] in line:
</span><span id="__span-44-57"><a id="__codelineno-44-57" name="__codelineno-44-57" href="#__codelineno-44-57"></a>                    line = line.replace(list_alter[0][i],list_alter[1][i])
</span><span id="__span-44-58"><a id="__codelineno-44-58" name="__codelineno-44-58" href="#__codelineno-44-58"></a>            file_data += line
</span><span id="__span-44-59"><a id="__codelineno-44-59" name="__codelineno-44-59" href="#__codelineno-44-59"></a>    return file_data
</span></code></pre></div>
<h3 id="_36">导入库</h3>
<p>模块module：一个.py 文件就是个模块，由函数和类组成；
包package：多个模块放在一个文件夹，就是一个包；
库library：只是一个通俗的说法，平时说的库既可以是一个模块也可以是一个包 。</p>
<p><strong>直接导入库</strong>：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</span></code></pre></div>
<p><em>也可以导入库时起别名</em>：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">m</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</span></code></pre></div>
<p><strong>通过名称直接导入函数</strong>：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">sin</span> <span class="k">as</span> <span class="n">s</span><span class="p">,</span> <span class="n">cos</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</span></code></pre></div>
<p><strong>导入库中所有函数</strong>：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</span></code></pre></div>
<p>如果需要导入自己的 <code>moduleA.py</code>模块，只需要 <code>import moduleA</code>，而不是 ~<code>import moduleA.py</code>~
为了便于导库，在写 <code>moduleA.py</code>时需要使用 <code>if __name__ == '__main__':</code>，如：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="n">a</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="c1"># 否则在另一个文件中导库时，会执行print(a)操作</span>
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a>
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="c1"># 为了形式简便，通常定义main函数</span>
</span><span id="__span-49-7"><a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span id="__span-49-8"><a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a>    <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-49-9"><a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="__span-49-10"><a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span><span id="__span-49-11"><a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a>    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
<p>如果需要导入自己的 <code>packageA</code> 包中的  <code>moduleA.py</code> 模块可以使用 <code>import packageA.moduleA</code>
直接使用~<code>import packageA</code>~ 是无法识别的，需要定义一个 <code>__init__.py</code> 文件初始化</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="c1"># __init__.py</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;1.0.0&#39;</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;lain&#39;</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">moduleA</span>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;moduleA&#39;</span><span class="p">]</span>
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a>
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a><span class="c1"># moduleA.py</span>
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a><span class="nb">print</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a>
</span><span id="__span-50-12"><a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a><span class="c1"># main.py</span>
</span><span id="__span-50-13"><a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pacageA</span>
</span></code></pre></div>
<h2 id="python_2">python标准</h2>
<h3 id="python_3">python内置函数</h3>
<p>Python 解释器自带的函数叫做内置函数，这些函数可以直接使用，不需要导入某个模块</p>
<h4 id="_37">入门函数</h4>
<p><strong><code>input([prompt])</code></strong> 接受一个标准输入数据，返回为 string 类型</p>
<ul>
<li>prompt: 提示信息，可选</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="n">name</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;请输入用户名&quot;</span><span class="p">)</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;请输入三角形三边的长：&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="c1"># 因为是字符串类型，可以使用字符串分割函数</span>
</span></code></pre></div>
<p><strong><code>print(*objects, sep=' ', end='\n', file=None, flush=False)</code></strong> 将 objects 打印输出至 file 指定的文本流，以 sep 分隔并在末尾加上 end</p>
<ul>
<li>objects: 输出对象。可以一次输出多个对象，此时需要用 , 分隔 <em>如果没有给出 objects，将只写入 end</em></li>
<li>sep: 用来间隔多个对象，默认值是一个空格</li>
<li>end: 用来设定以什么结尾，默认值是换行符 \n</li>
<li>file: 要写入的文件对象 <em>file 参数必须是一个具有 write(string) 方法的对象；如果参数不存在或为 None，则将使用 sys.stdout</em></li>
<li>flush: 输出缓冲通常由 file 确定。 但是，如果 flush 为真值，流将被强制刷新</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="n">a</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a+2=&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c1"># 控制台输出，设置没有间隔</span>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;1.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>       <span class="c1"># 打开文件</span>
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hello world&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>    <span class="c1"># 写入文件</span>
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a>
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">time</span><span class="w"> </span><span class="kn">import</span> <span class="n">sleep</span>
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    <span class="c1"># 强制刷新流</span>
</span><span id="__span-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a>    <span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>  
</span></code></pre></div>
<p><code>help()</code>启动内置的帮助系统</p>
<h4 id="_38">数学函数</h4>
<p>sum()
max()
min()
divmod()</p>
<p><strong><code>abs(x)</code></strong> 返回一个数的绝对值</p>
<ul>
<li>参数可以是整数、浮点数或任何实现了 <code>__abs__()</code> 的对象。 如果参数是一个复数，则返回它的模。</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="nb">print</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="p">))</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="nb">print</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="n">j</span><span class="p">))</span>
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a>
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a><span class="k">class</span><span class="w"> </span><span class="nc">Data</span><span class="p">:</span>
</span><span id="__span-53-6"><a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-53-7"><a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a>        <span class="k">return</span> <span class="mi">10</span>
</span><span id="__span-53-8"><a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a><span class="nb">print</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Data</span><span class="p">()))</span>
</span></code></pre></div>
<p>pow()
round()</p>
<h4 id="_39">数据类型函数</h4>
<p>int()
str()
bool()
float()
tuple()
list()
dict()
set()</p>
<h4 id="_40">序列迭代器函数</h4>
<p>len()
slice()
sorted()
reverse()
filter()
all()
any()
iter()
next()
range()
enumerate()
zip()
map()</p>
<h4 id="_41">对象函数</h4>
<p>id()
type()
isinstance()
issubclass()
staticmethod()
super()</p>
<h4 id="_42">对象操作函数</h4>
<p>format()
repr()
eval()
exec()
open()</p>
<h4 id="_43">对象属性函数</h4>
<p>setattr()
getattr()
hasattr()
delattr()
property()
vars()</p>
<h3 id="python_4">python标准库</h3>
<p><strong>文本</strong>
string：通用字符串操作
re：正则表达式操作
difflib：差异计算工具
textwrap：文本填充
unicodedata：Unicode字符数据库
stringprep：互联网字符串准备工具
readline：GNU按行读取接口
rlcompleter：GNU按行读取的实现函数
struct：将字节解析为打包的二进制数据
codecs：注册表与基类的编解码器
<strong>数据类型</strong>
datetime：基于日期与时间工具
calendar：通用月份函数
collections：容器数据类型
collections.abc：容器虚基类
heapq：堆队列算法
bisect：数组二分算法
array：高效数值数组
weakref：弱引用
types：内置类型的动态创建与命名
copy：浅拷贝与深拷贝
reprlib：交替repr()的实现
<strong>数学</strong>
numbers：数值的虚基类
math：数学函数
cmath：复数的数学函数
decimal：定点数与浮点数计算
fractions：有理数
random：生成伪随机数
<strong>函数式编程</strong>
itertools：为高效循环生成迭代器
functools：可调用对象上的高阶函数与操作
operator：针对函数的标准操作
<strong>文件与目录</strong>
os.path：通用路径名控制
fileinput：从多输入流中遍历行
stat：解释stat()的结果
filecmp：文件与目录的比较函数
tempfile：生成临时文件与目录
glob：Unix风格路径名格式的扩展
fnmatch：Unix风格路径名格式的比对
linecache：文本行的随机存储
shutil：高级文件操作
macpath：MacOS 9路径控制函数
<strong>持久化</strong>
pickle：Python对象序列化
copyreg：注册机对pickle的支持函数
shelve：Python对象持久化
marshal：内部Python对象序列化
dbm：Unix“数据库”接口
sqlite3：针对SQLite数据库的API2.0
<strong>压缩</strong>
zlib：兼容gzip的压缩
gzip：对gzip文件的支持
bz2：对bzip2压缩的支持
lzma：使用LZMA算法的压缩
zipfile：操作ZIP存档
tarfile：读写tar存档文件
<strong>加密</strong>
hashlib：安全散列与消息摘要
hmac：针对消息认证的键散列
<strong>操作系统工具</strong>
os：多方面的操作系统接口
io：流核心工具
time：时间的查询与转化
argparser：命令行选项、参数和子命令的解析器
optparser：命令行选项解析器
getopt：C风格的命令行选项解析器
logging：Python日志工具
logging.config：日志配置
logging.handlers：日志处理器
getpass：简易密码输入
curses：字符显示的终端处理
curses.textpad：curses程序的文本输入域
curses.ascii：ASCII字符集工具
curses.panel：curses的控件栈扩展
platform：访问底层平台认证数据
errno：标准错误记号
ctypes：Python外部函数库
<strong>并发</strong>
threading：基于线程的并行
multiprocessing：基于进程的并行
concurrent：并发包
concurrent.futures：启动并行任务
subprocess：子进程管理
sched：事件调度
queue：同步队列
select：等待I / O完成
dummy_threading：threading模块的替代（当_thread不可用时）
_ thread：底层的线程API（threading基于其上）
_ dummy_thread：_ thread模块的替代（当_thread不可用时）
<strong>进程间通信</strong>
socket：底层网络接口
ssl：socket对象的TLS / SSL填充器
asyncore：异步套接字处理器
asynchat：异步套接字命令 / 响应处理器
signal：异步事务信号处理器
mmap：内存映射文件支持
<strong>互联网</strong>
email：邮件与MIME处理包
json：JSON编码与解码
mailcap：mailcap文件处理
mailbox：多种格式控制邮箱
mimetypes：文件名与MIME类型映射
base64：RFC3548：Base16、Base32、Base64编码
binhex：binhex4文件编码与解码
binascii：二进制码与ASCII码间的转化
quopri：MIMEquoted - printable数据的编码与解码
uu：uuencode文件的编码与解码
<strong>互联网协议与支持</strong>
webbrowser：简易Web浏览器控制器
cgi：CGI支持
cgitb：CGI脚本反向追踪管理器
wsgiref：WSGI工具与引用实现
urllib：URL处理模块
urllib.request：打开URL连接的扩展库
urllib.response：urllib模块的响应类
urllib.parse：将URL解析成组件
urllib.error：urllib.request引发的异常类
urllib.robotparser：robots.txt的解析器
http：HTTP模块
http.client：HTTP协议客户端
ftplib：FTP协议客户端
poplib：POP协议客户端
imaplib：IMAP4协议客户端
nntplib：NNTP协议客户端
smtplib：SMTP协议客户端
smtpd：SMTP服务器
telnetlib：Telnet客户端
uuid：RFC4122的UUID对象
socketserver：网络服务器框架
http.server：HTTP服务器
http.cookies：HTTPCookie状态管理器
http.cookiejar：HTTP客户端的Cookie处理
xmlrpc：XML - RPC服务器和客户端模块
xmlrpc.client：XML - RPC客户端访问
xmlrpc.server：XML - RPC服务器基础
ipaddress：IPv4 / IPv6控制库
<strong>多媒体</strong>
audioop：处理原始音频数据
aifc：读写AIFF和AIFC文件
sunau：读写Sun AU文件
wave：读写WAV文件
chunk：读取IFF大文件
colorsys：颜色系统间转化
imghdr：指定图像类型
sndhdr：指定声音文件类型
ossaudiodev：访问兼容OSS的音频设备
<strong>国际化</strong>
gettext：多语言的国际化服务
locale：国际化服务
<strong>编程框架</strong>
turtle：Turtle图形库
cmd：基于行的命令解释器支持
shlex：简单词典分析
<strong>Tk图形用户接口</strong>
tkinter：Tcl / Tk接口
tkinter.ttk：Tk主题控件
tkinter.tix：Tk扩展控件
tkinter.scrolledtext：滚轴文本控件
<strong>开发工具</strong>
pydoc：文档生成器和在线帮助系统
doctest：交互式Python示例
unittest：单元测试框架
unittest.mock：模拟对象库
test：Python回归测试包
test.support：Python测试工具套件
venv：虚拟环境搭建
<strong>调试</strong>
bdb：调试框架
faulthandler：Python反向追踪库
pdb：Python调试器
timeit：小段代码执行时间测算
trace：Python执行状态追踪
<strong>运行时</strong>
sys：系统相关的参数与函数
sysconfig：访问Python配置信息
builtins：内置对象
main：顶层脚本环境
warnings：警告控制
contextlib：with状态的上下文工具
abc：虚基类
atexit：出口处理器
traceback：打印或读取一条栈的反向追踪
future：未来状态定义
gc：垃圾回收接口
inspect：检查存活的对象
site：址相关的配置钩子（hook）
fpectl：浮点数异常控制
distutils：生成和安装Python模块
<strong>解释器</strong>
code：基类解释器
codeop：编译Python代码
<strong>导入模块</strong>
imp：访问import模块的内部
zipimport：从ZIP归档中导入模块
pkgutil：包扩展工具
modulefinder：通过脚本查找模块
runpy：定位并执行Python模块
importlib：import的一种实施
Python语言
parser：访问Python解析树
ast：抽象句法树
symtable：访问编译器符号表
symbol：Python解析树中的常量
token：Python解析树中的常量
keyword：Python关键字测试
tokenize：Python源文件分词
tabnany：模糊缩进检测
pyclbr：Python类浏览支持
py_compile：编译Python源文件
compileall：按字节编译Python库
dis：Python字节码的反汇编器
pickletools：序列化开发工具
<strong>其他</strong>
formatter：通用格式化输出
Windows相关
msilib：读写Windows的Installer文件
msvcrt：MS VC + + Runtime的有用程序
winreg：Windows注册表访问
winsound：Windows声音播放接口
Unix相关
posix：最常用的POSIX调用
pwd：密码数据库
spwd：影子密码数据库
grp：组数据库
crypt：Unix密码验证
termios：POSIX风格的tty控制
tty：终端控制函数
pty：伪终端工具
fcntl：系统调用fcntl()和ioctl()
pipes：shell管道接口
resource：资源可用信息
nis：Sun的NIS的接口
syslog：Unix 日志服务</p>
<h4 id="random">random（随机）</h4>
<p>seed()随机数种子、random()生成一个0到~1~的随机符点数、randint()生成一个指定范围内的整数、getrandbits()生成一个k比特长的随机整数、randrange()从指定范围内，按指定基数递增的整数集合中 获取一个随机数、uniform()生成一个指定范围内的随机符点数、choice()从序列中获取一个随机元素、shuffle()将一个列表中的元素打乱、sample()从指定序列中随机获取指定长度的片断</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.runoob.com/python3/python3-func-number-seed.html">seed()</a></td>
<td>初始化随机数生成器</td>
</tr>
<tr>
<td>getstate()</td>
<td>返回捕获生成器当前内部状态的对象。</td>
</tr>
<tr>
<td>setstate()</td>
<td>state 应该是从之前调用 getstate() 获得的，并且 setstate() 将生成器的内部状态恢复到 getstate() 被调用时的状态。</td>
</tr>
<tr>
<td>getrandbits(k)</td>
<td>返回具有 k 个随机比特位的非负 Python 整数。 此方法随 MersenneTwister 生成器一起提供，其他一些生成器也可能将其作为 API 的可选部分提供。 在可能的情况下，getrandbits() 会启用 randrange() 来处理任意大的区间。</td>
</tr>
<tr>
<td><a href="https://www.runoob.com/python3/ref-random-randrange.html">randrange()</a></td>
<td>从 range(start, stop, step) 返回一个随机选择的元素。</td>
</tr>
<tr>
<td><a href="https://www.runoob.com/python3/ref-random-randint.html">randint(a, b)</a></td>
<td>返回随机整数 N 满足 a &lt;= N &lt;= b。</td>
</tr>
<tr>
<td><a href="https://www.runoob.com/python3/python3-func-number-choice.html">choice(seq)</a></td>
<td>从非空序列 seq 返回一个随机元素。 如果 seq 为空，则引发 IndexError。</td>
</tr>
<tr>
<td>choices(population, weights=None, *, cum_weights=None, k=1)</td>
<td>从 population 中选择替换，返回大小为 k 的元素列表。 如果 population 为空，则引发 IndexError。</td>
</tr>
<tr>
<td><a href="https://www.runoob.com/python3/python3-func-number-shuffle.html">shuffle(x[, random])</a></td>
<td>将序列 x 随机打乱位置。</td>
</tr>
<tr>
<td>sample(population, k, *, counts=None)</td>
<td>返回从总体序列或集合中选择的唯一元素的 k 长度列表。 用于无重复的随机抽样。</td>
</tr>
<tr>
<td><a href="https://www.runoob.com/python3/python3-func-number-random.html">random()</a></td>
<td>返回 [0.0, 1.0) 范围内的下一个随机浮点数。</td>
</tr>
<tr>
<td><a href="https://www.runoob.com/python3/python3-func-number-uniform.html">uniform()</a></td>
<td>返回一个随机浮点数 N ，当 a &lt;= b 时 a &lt;= N &lt;= b ，当 b &lt; a 时 b &lt;= N &lt;= a 。</td>
</tr>
<tr>
<td>triangular(low, high, mode)</td>
<td>返回一个随机浮点数 N ，使得 low &lt;= N &lt;= high 并在这些边界之间使用指定的 mode 。 low 和 high 边界默认为零和一。 mode 参数默认为边界之间的中点，给出对称分布。</td>
</tr>
<tr>
<td>betavariate(alpha, beta)</td>
<td>Beta 分布。 参数的条件是 alpha &gt; 0 和 beta &gt; 0。 返回值的范围介于 0 和 1 之间。</td>
</tr>
<tr>
<td>expovariate(lambd)</td>
<td>指数分布。 lambd 是 1.0 除以所需的平均值，它应该是非零的。</td>
</tr>
<tr>
<td>gammavariate()</td>
<td>Gamma 分布（ 不是伽马函数） 参数的条件是 alpha &gt; 0 和 beta &gt; 0。</td>
</tr>
<tr>
<td>gauss(mu, sigma)</td>
<td>正态分布，也称高斯分布。 mu 为平均值，而 sigma 为标准差。 此函数要稍快于下面所定义的 normalvariate() 函数。</td>
</tr>
<tr>
<td>lognormvariate(mu, sigma)</td>
<td>对数正态分布。 如果你采用这个分布的自然对数，你将得到一个正态分布，平均值为 mu 和标准差为 sigma 。 mu 可以是任何值，sigma 必须大于零。</td>
</tr>
<tr>
<td>normalvariate(mu, sigma)</td>
<td>正态分布。 mu 是平均值，sigma 是标准差。</td>
</tr>
<tr>
<td>vonmisesvariate(mu, kappa)</td>
<td>冯·米塞斯分布。 mu 是平均角度，以弧度表示，介于0和 2<em>pi 之间，kappa 是浓度参数，必须大于或等于零。 如果 kappa 等于零，则该分布在 0 到 2</em>pi 的范围内减小到均匀的随机角度。</td>
</tr>
<tr>
<td>paretovariate(alpha)</td>
<td>帕累托分布。 alpha 是形状参数。</td>
</tr>
<tr>
<td>weibullvariate(alpha, beta)</td>
<td>威布尔分布。 alpha 是比例参数，beta 是形状参数。</td>
</tr>
</tbody>
</table>
<h4 id="time">time（时间）</h4>
<p>time库是Python中处理时间的标准库;提供获取系统时间并格式化输出功能;提供系统级精确计时功能，用于程序性能分析</p>
<ul>
<li>时间处理函数：time()、gmtime()、localtime()、ctime()</li>
<li>时间格式化函数：mktime()、strftime()、strptime()</li>
<li>计时函数：sleep()、perf_counter()</li>
</ul>
<p>1.时间获取：
（1）time函数
获取当前时间戳（从世界标准时间的1970年1月1日00：00：00开始到当前这一时刻为止的总秒数），即计算机内部时间值，浮点数。</p>
<p>（2）localtime（）函数和gmtime()函数
Python提供了可以获取结构化时间的localtime（）函数和gmtime函数</p>
<p>获取当前时间，表示为计算机可处理的时间格式（struct_time格式）</p>
<p>localtime()函数和gmtime()函数都可将时间戳转换为以元组表示的时间对象（struct_time格式)，但是localtime()函数得到的是当地时间，gmtime()函数得到的是世界统一时间。</p>
<p>格式如下所示：</p>
<p>localtime([secs])</p>
<p>gmtime([secs])</p>
<p>其中secs是一个表示时间戳的浮点数，若不提供该参数，默认以time（）函数获取的时间戳作为参数。</p>
<p>（3）ctime（）函数（与asctime（）函数为一对互补函数）
读取当前时间并以易读方式表示，返回字符串。</p>
<p>ctime（）函数用于将一个时间戳（以s为单位的浮点数）转换为“Sat Jan 13 21:56:34 2018"这种形式（若该函数未收到参数，则默认以time.time()作为参数），转换成的形式为”星期 月份 当月号 时分秒 年份“。</p>
<p>时间格式化：
将时间以合理的方式展示出来</p>
<p>格式化：类似字符串格式化，需要有展示模板</p>
<p>展示模板由特定的格式化控制符组成</p>
<p>（1）strftime（）函数（将时间格式输出为字符串，与strptime函数互补）。strftime(格式，时间 )主要决定时间的输出格式
strftime()函数借助时间格式控制符来输出格式化的时间字符串，其中%a,%d,%b等是time库预定义的用于控制不同时间或时间成分的格式控制符。</p>
<div class="language-text highlight"><pre><span></span><code>time库中常用的时间格式控制符及其说明如下所示
</code></pre></div>
<p>时间格式控制符 说明
%Y  四位数的年份，取值范围为0001~9999,如1900
%m  月份（01~12），例如10
%d  月中的一天（01~31）例如：25
%B  本地完整的月份名称，比如January
%b  本地简化的月份名称，比如Jan
%a  本地简化的周日期，Mon~Sun,例如Wed
%A  本地完整周日期，”Monday~Sunday,例如Wednesday
%H  24小时制小时数（00~23),例如：12
%l  12小时制小时数（01~12），例如：7
%p  上下午，取值为AM或PM
%M  分钟数（00~59），例如26
%S  秒（00~59），例如26
strftime()函数有两条参数，其中一个为tpl(格式化的模板字符串参数，用来定义输出效果），另一个为ts(是计算机内部时间类型变量）</p>
<p>（2）strptime()函数，strptime(字符串，格式），主要将该格式的字符串输出为struct_time.
strptime(str,tpl)tpl(是格式化模板字符串，用来定义输入效果）</p>
<p>str是字符串形式的时间值，所以他的格式为前面为字符串，后面为字符串的格式，然后输出的格式为struct_time。
在对时间的理解上，我们可以这样认为：在计算机中为了表达时间，它其实只有一个浮点数，前面提到的这个浮点数是从1970年1月1日开始的，然后为了让其他的程序能够更好的处理这个浮点数，我们把它定义一个程序能够理解的格式，这个格式就是用gmtime来获取的struct_time格式。</p>
<p>struct_time格式，它包含了许多元素，这些元素的值都是通过浮点数来提供的。</p>
<p>反过来，我们也可以使用一个字符串赋予一个时间给我们的strptime类型，然后并由这个类型进一步生成浮点数。</p>
<p>程序计时：
程序计时应用广泛</p>
<p>程序计时指测量起止动作所经历时间的过程</p>
<p>测量时间指的是能够记录时间的流逝: perf_counter()获取计算机中CPU也就是中央处理器以其频率运行的时钟纳秒计算，非常精确。</p>
<p>产生时间函数:sleep</p>
<p>让程序去休眠或者产生一定的时间</p>
<p>perf_counter()返回一个CPU级别的精确时间计数值，单位为秒，由于这个计数值起点不确定，连续调用差值才有意义</p>
<p>sleep（s)  s拟休眠的时间，单位是秒，可以是浮点数</p>
<h4 id="re">re（正则表达式）</h4>
<p>[[../../其他语法/正则表达式|正则表达式]]是一个特殊的字符序列，它能帮助你方便的检查一个字符串是否与某种模式匹配。
Python 自1.5版本起增加了re 模块，它提供 Perl 风格的正则表达式模式。</p>
<p><code>re.match(pattern, string, flags=0)</code>
 尝试从字符串的起始位置匹配一个模式，如果不是起始位置匹配成功的话，match() 就返回 none</p>
<p><code>re.search(pattern, string, flags=0)</code>
 扫描整个字符串并返回第一个成功的匹配</p>
<ul>
<li>pattern   匹配的正则表达式</li>
<li>string    要匹配的字符串。</li>
<li>flags 标志位，用于控制正则表达式的匹配方式，如：是否区分大小写，多行匹配等等</li>
</ul>
<p><code>re.sub(pattern, repl, string, count=0, flags=0)</code>
替换字符串中的匹配项</p>
<ul>
<li>pattern : 正则中的模式字符串。</li>
<li>repl : 替换的字符串，也可为一个函数。</li>
<li>string : 要被查找替换的原始字符串。</li>
<li>count : 模式匹配后替换的最大次数，默认 0 表示替换所有的匹配。</li>
</ul>
<p><code>re.compile(pattern[, flags])</code>
用于编译正则表达式，生成一个正则表达式（ Pattern ）对象，可以给 match() 、 search() 以及 findall 等函数使用。</p>
<ul>
<li>pattern : 一个字符串形式的正则表达式</li>
<li>flags : 可选，表示匹配模式，比如忽略大小写，多行模式等，具体参数为：</li>
</ul>
<p><code>re.findall(string[, pos[, endpos]])</code>
在字符串中找到正则表达式所匹配的所有子串，并返回一个列表，如果有多个匹配模式，则返回元组列表，如果没有找到匹配的，则返回空列表。
<strong>注意：</strong> match 和 search 是匹配一次，findall 是匹配所有。</p>
<ul>
<li>string : 待匹配的字符串。</li>
<li>pos : 可选参数，指定字符串的起始位置，默认为 0。</li>
<li>endpos : 可选参数，指定字符串的结束位置，默认为字符串的长度。</li>
</ul>
<p><code>re.finditer(pattern, string, flags=0)</code>
和 findall 类似，在字符串中找到正则表达式所匹配的所有子串，并把它们作为一个迭代器返回</p>
<p><code>re.split(pattern, string[, maxsplit=0, flags=0])</code>
split 方法按照能够匹配的子串将字符串分割后返回列表</p>
<ul>
<li>pattern   匹配的正则表达式</li>
<li>string    要匹配的字符串。</li>
<li>maxsplit  分隔次数，maxsplit=1 分隔一次，默认为 0，不限制次数。</li>
<li>flags 标志位，用于控制正则表达式的匹配方式</li>
</ul>
<table>
<thead>
<tr>
<th>flags修饰符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>re.I</td>
<td>使匹配对大小写不敏感</td>
</tr>
<tr>
<td>re.L</td>
<td>做本地化识别（locale-aware）匹配</td>
</tr>
<tr>
<td>re.M</td>
<td>多行匹配，影响 ^ 和 $</td>
</tr>
<tr>
<td>re.S</td>
<td>使 . 匹配包括换行在内的所有字符</td>
</tr>
<tr>
<td>re.U</td>
<td>根据Unicode字符集解析字符。这个标志影响 \w, \W, \b, \B.</td>
</tr>
<tr>
<td>re.X</td>
<td>该标志通过给予你更灵活的格式以便你将正则表达式写得更易于理解。</td>
</tr>
</tbody>
</table>
<h4 id="turtle">turtle（绘图）</h4>
<p><em>想象有一只海龟在窗体正中心，在画布上游走，走过的轨迹形成了绘制的图形，海龟由程序控制，可以自由改变颜色、方向宽度等</em>
使用 turtle 之前需要先在代码的最前面导入turtle这个模块。为了让完成绘图后画布不消失，需要在程序的最后添加 turtle.mainloop()</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="c1"># 导入turtle</span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">turtle</span>  
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a>
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a><span class="c1"># (--------中间写绘图过程----------)</span>
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a>
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a><span class="c1"># 让画布一直存在，这句代码需要放在最后</span>
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a><span class="n">turtle</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</span></code></pre></div>
<p><strong>画布</strong>：</p>
<blockquote>
<p><code>turtle.screensize(canvwidth=None, canvheight=None, bg=None)</code> 画布的宽(单位像素), 高, 背景颜色
<code>turtle.setup(宽度, 高度)</code> - 设置画布的宽度和高度
width, height: 输入宽和高为整数时, 表示像素; 为小数时, 表示占据电脑屏幕的比例
(startx, starty): 这一坐标表示 矩形窗口左上角顶点的位置, 如果为空,则窗口位于屏幕中心
<code>turtle.title(标题)</code> - 设置标题</p>
<p><code>turtle.clear()</code>清空turtle窗口，但是turtle的位置和状态不会改变;<code>turtle.reset()</code>清空窗口，重置turtle状态为起始状态</p>
</blockquote>
<div class="language-python highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="n">turtle</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="n">turtle</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>设置画笔</strong>：</p>
<blockquote>
<p><code>turtle.pencolor(颜色)</code> - 设置画笔画出的线的颜色（颜色名称如'red' 或 HEX颜色如'#555' 或RGB颜色元组如(0.2, 0.8, 0.55)）
<code>turtle.width(线宽)</code> - 设置线宽
<code>turtle.speed(速度值)</code> - 设置笔移动的速度（速度值是1-10逐渐变快，0速度最大。如果数字大于10或小于0.5，则设置为0）
<code>turtle.hideturtle()</code> - 隐藏箭头显示 <code>turtle.showturtle()</code></p>
</blockquote>
<p><em>画笔对应的光标默认是在画布的中心，方向默认是水平向右。</em></p>
<p><strong>控制笔移动</strong>：</p>
<blockquote>
<p><code>turtle.forward(距离) / turtle.fd(距离)</code> - 控制笔前进指定距离
<code>turtle.back(距离)/turtle.bk(距离)</code> - 控制笔后退指定距离
<code>turtle.goto(x坐标, y坐标)/ turtle.setx(x坐标) / turtle.sety(y坐标)</code> - 控制笔移动到指定位置（坐标原点在画布的中心）
<code>turtle.home()</code> - 笔回到初始状态（回到初始位置和初始方向）</p>
</blockquote>
<p><strong>控制笔的方向</strong>：</p>
<p>笔的方向默认水平向右，所以前进的时候笔是往右移动的，后退笔向左移动。在移动之前改变笔的方向，前进和后退的代码就会改变移动轨迹。</p>
<blockquote>
<p><code>turtle.left(角度)</code> - 向左旋转指定角度lt
<code>turtle.right(角度)</code> - 向右旋转指定角度rt
<code>turtle.setheading(角度)</code> - 设置绝对角度值指定度数seth</p>
</blockquote>
<p><strong>抬起笔和放下笔</strong>：</p>
<p>有的时候移动笔不需要在画布上留下痕迹，那在移动笔之前需要先抬起笔。</p>
<blockquote>
<p><code>turtle.up()</code> - 抬起笔
<code>turtle.down()</code> - 放下笔</p>
</blockquote>
<p><strong>画圆</strong>：</p>
<p>1.画圆环</p>
<p><code>turtle.circle(半径, [角度/多边形边数])</code> - 画完整的圆/指定角度对应的圆弧/圆正切内多边形
当半径值为正数时，圆心在当前位置/小海龟左侧；当角度值为正数时，顺小海龟当前方向绘制</p>
<p>2.画实心圆</p>
<p><code>turtle.dot(直径, 颜色)</code> - 直径为指定值的画实心圆</p>
<p><strong>填充</strong>：</p>
<p>在使用填充的时候需要注意，写代码的时候先写需要填充的轮廓对应的代码。再在轮廓代码前面开始填充，轮廓代码的后面结束填充。</p>
<blockquote>
<p><code>turtle.fillcolor(颜色)</code> - 设置填充颜色
<code>turtle.begin_fill()</code> - 开始填充
<code>turtle.end_fill()</code> - 结束填充</p>
</blockquote>
<div class="language-python highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="c1"># 设置填充颜色</span>
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="n">turtle</span><span class="o">.</span><span class="n">fillcolor</span><span class="p">(</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="c1"># 开始填充</span>
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="n">turtle</span><span class="o">.</span><span class="n">begin_fill</span><span class="p">()</span>
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>
</span><span id="__span-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a><span class="c1"># ========以下代码是画需要填充的轮廓对应的代码（一个三角形）========</span>
</span><span id="__span-56-7"><a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a><span class="n">turtle</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="__span-56-8"><a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a><span class="n">turtle</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
</span><span id="__span-56-9"><a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a><span class="n">turtle</span><span class="o">.</span><span class="n">left</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span>
</span><span id="__span-56-10"><a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a><span class="n">turtle</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span>
</span><span id="__span-56-11"><a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a><span class="n">turtle</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>
</span><span id="__span-56-12"><a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a><span class="c1"># ==========================================================</span>
</span><span id="__span-56-13"><a id="__codelineno-56-13" name="__codelineno-56-13" href="#__codelineno-56-13"></a>
</span><span id="__span-56-14"><a id="__codelineno-56-14" name="__codelineno-56-14" href="#__codelineno-56-14"></a><span class="c1"># 结束填充</span>
</span><span id="__span-56-15"><a id="__codelineno-56-15" name="__codelineno-56-15" href="#__codelineno-56-15"></a><span class="n">turtle</span><span class="o">.</span><span class="n">end_fill</span><span class="p">()</span>
</span></code></pre></div>
<p><strong>文字</strong>：</p>
<blockquote>
<p><code>turtle.write(文字内容, font=(字体名称, 字体大小, 文字类型))</code></p>
</blockquote>
<div class="language-python highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="c1"># 字体类型：normal、bold、italic</span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="n">turtle</span><span class="o">.</span><span class="n">pencolor</span><span class="p">(</span><span class="s1">&#39;pink&#39;</span><span class="p">)</span>
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a><span class="n">turtle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;你输入的文字&#39;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;宋体&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">))</span>
</span></code></pre></div>
<h4 id="tkinterui">tkinter（UI）</h4>
<p>Tkinter： Tkinter 模块(Tk 接口)是 Python 的标准 Tk GUI 工具包的接口.</p>
<p>创建一个GUI程序:
1、导入 Tkinter 模块(import tkinter或from tkinter import *，前者需要使用 <code>tkinter.Tk()</code>，后者只需要 <code>Tk()</code>)
2、创建控件
3、指定这个控件的 master， 即这个控件属于哪一个
4、告诉 GM(geometry manager) 有一个控件产生了。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tkinter</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>   <span class="c1"># 导库</span>
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a><span class="n">window</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>   <span class="c1"># 创建窗口</span>
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a><span class="n">window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;标题&#39;</span><span class="p">)</span> <span class="c1"># 指定窗口标题</span>
</span><span id="__span-58-5"><a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a><span class="n">window</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s1">&#39;300x200+100+100&#39;</span><span class="p">)</span>    <span class="c1"># 窗口的宽度为300像素，高度为200像素，并将窗口的左上角坐标设定为(100, 100)</span>
</span><span id="__span-58-6"><a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a><span class="c1"># 如果需要将窗口打开在屏幕的特定位置，可以使用winfo_screenwidth和winfo_screenheight方法来确定屏幕的宽度和高度:</span>
</span><span id="__span-58-7"><a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a><span class="c1"># screen_width = window.winfo_screenwidth()</span>
</span><span id="__span-58-8"><a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a><span class="c1"># screen_height = window.winfo_screenheight()</span>
</span><span id="__span-58-9"><a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a><span class="c1"># window_width = 300</span>
</span><span id="__span-58-10"><a id="__codelineno-58-10" name="__codelineno-58-10" href="#__codelineno-58-10"></a><span class="c1"># window_height = 200</span>
</span><span id="__span-58-11"><a id="__codelineno-58-11" name="__codelineno-58-11" href="#__codelineno-58-11"></a><span class="c1"># x_position = int((screen_width/2) - (window_width/2))</span>
</span><span id="__span-58-12"><a id="__codelineno-58-12" name="__codelineno-58-12" href="#__codelineno-58-12"></a><span class="c1"># y_position = int((screen_height/2) - (window_height/2))</span>
</span><span id="__span-58-13"><a id="__codelineno-58-13" name="__codelineno-58-13" href="#__codelineno-58-13"></a><span class="c1"># window.geometry(f&quot;{window_width}x{window_height}+{x_position}+{y_position}&quot;)</span>
</span><span id="__span-58-14"><a id="__codelineno-58-14" name="__codelineno-58-14" href="#__codelineno-58-14"></a>
</span><span id="__span-58-15"><a id="__codelineno-58-15" name="__codelineno-58-15" href="#__codelineno-58-15"></a><span class="n">window</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>   <span class="c1"># 进入消息循环</span>
</span><span id="__span-58-16"><a id="__codelineno-58-16" name="__codelineno-58-16" href="#__codelineno-58-16"></a>
</span><span id="__span-58-17"><a id="__codelineno-58-17" name="__codelineno-58-17" href="#__codelineno-58-17"></a><span class="c1"># window.destroy() # 删除窗口</span>
</span></code></pre></div>
<h5 id="tkinter">tkinter 组件</h5>
<table>
<thead>
<tr>
<th style="text-align: center;">控件</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Button</td>
<td>按钮控件；在程序中显示按钮。</td>
</tr>
<tr>
<td style="text-align: center;">Canvas</td>
<td>画布控件；显示图形元素如线条或文本</td>
</tr>
<tr>
<td style="text-align: center;">Checkbutton</td>
<td>多选框控件；用于在程序中提供多项选择框</td>
</tr>
<tr>
<td style="text-align: center;">Entry</td>
<td>输入控件；用于显示简单的文本内容</td>
</tr>
<tr>
<td style="text-align: center;">Frame</td>
<td>框架控件；在屏幕上显示一个矩形区域，多用来作为容器</td>
</tr>
<tr>
<td style="text-align: center;">Label</td>
<td>标签控件；可以显示文本和位图</td>
</tr>
<tr>
<td style="text-align: center;">Listbox</td>
<td>列表框控件；在Listbox窗口小部件是用来显示一个字符串列表给用户</td>
</tr>
<tr>
<td style="text-align: center;">Menubutton</td>
<td>菜单按钮控件，用于显示菜单项。</td>
</tr>
<tr>
<td style="text-align: center;">Menu</td>
<td>菜单控件；显示菜单栏,下拉菜单和弹出菜单</td>
</tr>
<tr>
<td style="text-align: center;">Message</td>
<td>消息控件；用来显示多行文本，与label比较类似</td>
</tr>
<tr>
<td style="text-align: center;">Radiobutton</td>
<td>单选按钮控件；显示一个单选的按钮状态</td>
</tr>
<tr>
<td style="text-align: center;">Scale</td>
<td>范围控件；显示一个数值刻度，为输出限定范围的数字区间</td>
</tr>
<tr>
<td style="text-align: center;">Scrollbar</td>
<td>滚动条控件，当内容超过可视化区域时使用，如列表框。.</td>
</tr>
<tr>
<td style="text-align: center;">Text</td>
<td>文本控件；用于显示多行文本</td>
</tr>
<tr>
<td style="text-align: center;">Toplevel</td>
<td>容器控件；用来提供一个单独的对话框，和Frame比较类似</td>
</tr>
<tr>
<td style="text-align: center;">Spinbox</td>
<td>输入控件；与Entry类似，但是可以指定输入范围值</td>
</tr>
<tr>
<td style="text-align: center;">PanedWindow</td>
<td>一个窗口布局管理的插件，可以包含一个或者多个子控件。</td>
</tr>
<tr>
<td style="text-align: center;">LabelFrame</td>
<td>一个简单的容器控件。常用于复杂的窗口布局。</td>
</tr>
<tr>
<td style="text-align: center;">tkMessageBox</td>
<td>用于显示你应用程序的消息框。</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>标准属性</strong>:所有控件的共同属性</p>
<table>
<thead>
<tr>
<th style="text-align: center;">属性</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Dimension</td>
<td>控件大小</td>
</tr>
<tr>
<td style="text-align: center;">Color</td>
<td>控件颜色</td>
</tr>
<tr>
<td style="text-align: center;">Font</td>
<td>控件字体</td>
</tr>
<tr>
<td style="text-align: center;">Anchor</td>
<td>锚点</td>
</tr>
<tr>
<td style="text-align: center;">Relief</td>
<td>控件样式</td>
</tr>
<tr>
<td style="text-align: center;">Bitmap</td>
<td>位图</td>
</tr>
<tr>
<td style="text-align: center;">Cursor</td>
<td>光标</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>几何管理</strong>:Tkinter控件有特定的几何状态管理方法，管理整个控件区域组织</p>
<table>
<thead>
<tr>
<th>几何方法</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>grid()</td>
<td>网格</td>
</tr>
<tr>
<td>pack()</td>
<td>包装</td>
</tr>
<tr>
<td>place()</td>
<td>位置</td>
</tr>
</tbody>
</table>
<div class="language-python highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="c1">#几何管理器(1)-----网格管理器</span>
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a><span class="sd">网格管理器将小构件，放在一个不可见网格的每个单元内。可以将小构件放在某个特定的行和列内，也可以使</span>
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a><span class="sd">用rowspan和columnspan参数将小构件放在多行和多列中。</span>
</span><span id="__span-59-5"><a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-59-6"><a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a>
</span><span id="__span-59-7"><a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tkinter</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-59-8"><a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a>
</span><span id="__span-59-9"><a id="__codelineno-59-9" name="__codelineno-59-9" href="#__codelineno-59-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">GridManagerDemo</span><span class="p">:</span>
</span><span id="__span-59-10"><a id="__codelineno-59-10" name="__codelineno-59-10" href="#__codelineno-59-10"></a>    <span class="n">window</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
</span><span id="__span-59-11"><a id="__codelineno-59-11" name="__codelineno-59-11" href="#__codelineno-59-11"></a>    <span class="n">window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Grid Manager Demo&quot;</span><span class="p">)</span>
</span><span id="__span-59-12"><a id="__codelineno-59-12" name="__codelineno-59-12" href="#__codelineno-59-12"></a>
</span><span id="__span-59-13"><a id="__codelineno-59-13" name="__codelineno-59-13" href="#__codelineno-59-13"></a>    <span class="n">message</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;This Message widget occupies three rows and two columns&quot;</span><span class="p">)</span>
</span><span id="__span-59-14"><a id="__codelineno-59-14" name="__codelineno-59-14" href="#__codelineno-59-14"></a>    <span class="n">message</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rowspan</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">columnspan</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-59-15"><a id="__codelineno-59-15" name="__codelineno-59-15" href="#__codelineno-59-15"></a>
</span><span id="__span-59-16"><a id="__codelineno-59-16" name="__codelineno-59-16" href="#__codelineno-59-16"></a>    <span class="n">Label</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;First Name:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="__span-59-17"><a id="__codelineno-59-17" name="__codelineno-59-17" href="#__codelineno-59-17"></a>    <span class="n">Entry</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">padx</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">pady</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="__span-59-18"><a id="__codelineno-59-18" name="__codelineno-59-18" href="#__codelineno-59-18"></a>
</span><span id="__span-59-19"><a id="__codelineno-59-19" name="__codelineno-59-19" href="#__codelineno-59-19"></a>    <span class="n">Label</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Last Name:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="__span-59-20"><a id="__codelineno-59-20" name="__codelineno-59-20" href="#__codelineno-59-20"></a>    <span class="n">Entry</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="__span-59-21"><a id="__codelineno-59-21" name="__codelineno-59-21" href="#__codelineno-59-21"></a>
</span><span id="__span-59-22"><a id="__codelineno-59-22" name="__codelineno-59-22" href="#__codelineno-59-22"></a>    <span class="n">Button</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Get Name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padx</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">pady</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span><span class="n">column</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span> <span class="o">=</span> <span class="n">E</span><span class="p">)</span>
</span><span id="__span-59-23"><a id="__codelineno-59-23" name="__codelineno-59-23" href="#__codelineno-59-23"></a>
</span><span id="__span-59-24"><a id="__codelineno-59-24" name="__codelineno-59-24" href="#__codelineno-59-24"></a>    <span class="n">window</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</span><span id="__span-59-25"><a id="__codelineno-59-25" name="__codelineno-59-25" href="#__codelineno-59-25"></a>
</span><span id="__span-59-26"><a id="__codelineno-59-26" name="__codelineno-59-26" href="#__codelineno-59-26"></a><span class="n">GridManagerDemo</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="c1">#几何管理器(2)-----包管理器</span>
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a><span class="sd">包含管理器将小构件依次的一个放置在另一个的顶部或将他们一个挨着一个的放置。</span>
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a>
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a><span class="c1">#第一种</span>
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tkinter</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-60-8"><a id="__codelineno-60-8" name="__codelineno-60-8" href="#__codelineno-60-8"></a>
</span><span id="__span-60-9"><a id="__codelineno-60-9" name="__codelineno-60-9" href="#__codelineno-60-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">PackManagerDemo</span><span class="p">:</span>
</span><span id="__span-60-10"><a id="__codelineno-60-10" name="__codelineno-60-10" href="#__codelineno-60-10"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-60-11"><a id="__codelineno-60-11" name="__codelineno-60-11" href="#__codelineno-60-11"></a>        <span class="n">window</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
</span><span id="__span-60-12"><a id="__codelineno-60-12" name="__codelineno-60-12" href="#__codelineno-60-12"></a>        <span class="n">window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pack Mananger Demo 1&quot;</span><span class="p">)</span>
</span><span id="__span-60-13"><a id="__codelineno-60-13" name="__codelineno-60-13" href="#__codelineno-60-13"></a>
</span><span id="__span-60-14"><a id="__codelineno-60-14" name="__codelineno-60-14" href="#__codelineno-60-14"></a>        <span class="n">Label</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="__span-60-15"><a id="__codelineno-60-15" name="__codelineno-60-15" href="#__codelineno-60-15"></a>        <span class="c1"># fill通过X，Y，BOTH 来填充水平，垂直，或者两个方向的空间</span>
</span><span id="__span-60-16"><a id="__codelineno-60-16" name="__codelineno-60-16" href="#__codelineno-60-16"></a>        <span class="c1">#expand告诉管理器分配额外的空间给小构件</span>
</span><span id="__span-60-17"><a id="__codelineno-60-17" name="__codelineno-60-17" href="#__codelineno-60-17"></a>        <span class="n">Label</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">bg</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-60-18"><a id="__codelineno-60-18" name="__codelineno-60-18" href="#__codelineno-60-18"></a>        <span class="n">Label</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="n">bg</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="n">BOTH</span><span class="p">)</span>
</span><span id="__span-60-19"><a id="__codelineno-60-19" name="__codelineno-60-19" href="#__codelineno-60-19"></a>
</span><span id="__span-60-20"><a id="__codelineno-60-20" name="__codelineno-60-20" href="#__codelineno-60-20"></a>        <span class="n">window</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</span><span id="__span-60-21"><a id="__codelineno-60-21" name="__codelineno-60-21" href="#__codelineno-60-21"></a>
</span><span id="__span-60-22"><a id="__codelineno-60-22" name="__codelineno-60-22" href="#__codelineno-60-22"></a><span class="n">PackManagerDemo</span><span class="p">()</span>
</span><span id="__span-60-23"><a id="__codelineno-60-23" name="__codelineno-60-23" href="#__codelineno-60-23"></a>
</span><span id="__span-60-24"><a id="__codelineno-60-24" name="__codelineno-60-24" href="#__codelineno-60-24"></a><span class="c1">#第二种</span>
</span><span id="__span-60-25"><a id="__codelineno-60-25" name="__codelineno-60-25" href="#__codelineno-60-25"></a><span class="k">class</span><span class="w"> </span><span class="nc">PackManagerDemoWithSide</span><span class="p">:</span>
</span><span id="__span-60-26"><a id="__codelineno-60-26" name="__codelineno-60-26" href="#__codelineno-60-26"></a>    <span class="n">window</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
</span><span id="__span-60-27"><a id="__codelineno-60-27" name="__codelineno-60-27" href="#__codelineno-60-27"></a>    <span class="n">window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pack Manager Demo 2&quot;</span><span class="p">)</span>
</span><span id="__span-60-28"><a id="__codelineno-60-28" name="__codelineno-60-28" href="#__codelineno-60-28"></a>
</span><span id="__span-60-29"><a id="__codelineno-60-29" name="__codelineno-60-29" href="#__codelineno-60-29"></a>    <span class="c1">#side可以是LEFT, RIGHT, TOP, BOTTOM,默认是TOP。</span>
</span><span id="__span-60-30"><a id="__codelineno-60-30" name="__codelineno-60-30" href="#__codelineno-60-30"></a>    <span class="n">Label</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">LEFT</span><span class="p">)</span>
</span><span id="__span-60-31"><a id="__codelineno-60-31" name="__codelineno-60-31" href="#__codelineno-60-31"></a>    <span class="n">Label</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">bg</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">LEFT</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-60-32"><a id="__codelineno-60-32" name="__codelineno-60-32" href="#__codelineno-60-32"></a>    <span class="n">Label</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="n">bg</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="n">LEFT</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">BOTH</span><span class="p">)</span>
</span><span id="__span-60-33"><a id="__codelineno-60-33" name="__codelineno-60-33" href="#__codelineno-60-33"></a>
</span><span id="__span-60-34"><a id="__codelineno-60-34" name="__codelineno-60-34" href="#__codelineno-60-34"></a>    <span class="n">window</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</span><span id="__span-60-35"><a id="__codelineno-60-35" name="__codelineno-60-35" href="#__codelineno-60-35"></a>
</span><span id="__span-60-36"><a id="__codelineno-60-36" name="__codelineno-60-36" href="#__codelineno-60-36"></a><span class="n">PackManagerDemoWithSide</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="c1">#几何管理器(3)-----位置管理器</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a><span class="sd">位置管理器将小构件放在绝对位置上。</span>
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a>
</span><span id="__span-61-6"><a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tkinter</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-61-7"><a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a>
</span><span id="__span-61-8"><a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">PlaceManagerDemo</span><span class="p">:</span>
</span><span id="__span-61-9"><a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-61-10"><a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a>        <span class="n">window</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
</span><span id="__span-61-11"><a id="__codelineno-61-11" name="__codelineno-61-11" href="#__codelineno-61-11"></a>        <span class="n">window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Place Manager Demo&quot;</span><span class="p">)</span>
</span><span id="__span-61-12"><a id="__codelineno-61-12" name="__codelineno-61-12" href="#__codelineno-61-12"></a>
</span><span id="__span-61-13"><a id="__codelineno-61-13" name="__codelineno-61-13" href="#__codelineno-61-13"></a>        <span class="n">Label</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="n">bg</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
</span><span id="__span-61-14"><a id="__codelineno-61-14" name="__codelineno-61-14" href="#__codelineno-61-14"></a>        <span class="n">Label</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="n">bg</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
</span><span id="__span-61-15"><a id="__codelineno-61-15" name="__codelineno-61-15" href="#__codelineno-61-15"></a>        <span class="n">Label</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="n">bg</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">80</span><span class="p">)</span>
</span><span id="__span-61-16"><a id="__codelineno-61-16" name="__codelineno-61-16" href="#__codelineno-61-16"></a>
</span><span id="__span-61-17"><a id="__codelineno-61-17" name="__codelineno-61-17" href="#__codelineno-61-17"></a>        <span class="n">window</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</span><span id="__span-61-18"><a id="__codelineno-61-18" name="__codelineno-61-18" href="#__codelineno-61-18"></a>
</span><span id="__span-61-19"><a id="__codelineno-61-19" name="__codelineno-61-19" href="#__codelineno-61-19"></a><span class="n">PlaceManagerDemo</span><span class="p">()</span>
</span></code></pre></div>
<h6 id="button">Button</h6>
<p><code>w = Button ( master, option=value, ... )</code></p>
<ul>
<li>master: 按钮的父容器。</li>
<li>options: 可选项，即该按钮的可设置的属性。这些选项可以用键 = 值的形式设置，并以逗号分隔。</li>
</ul>
<table>
<thead>
<tr>
<th>序号</th>
<th style="text-align: left;">可选项 &amp; 描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td style="text-align: left;"><strong>activebackground</strong>当鼠标放上去时，按钮的背景色</td>
</tr>
<tr>
<td>2</td>
<td style="text-align: left;"><strong>activeforeground</strong>当鼠标放上去时，按钮的前景色</td>
</tr>
<tr>
<td>3</td>
<td style="text-align: left;"><strong>bd</strong>按钮边框的大小，默认为 2 个像素</td>
</tr>
<tr>
<td>4</td>
<td style="text-align: left;"><strong>bg</strong>按钮的背景色</td>
</tr>
<tr>
<td>5</td>
<td style="text-align: left;"><strong>command</strong>按钮关联的函数，当按钮被点击时，执行该函数</td>
</tr>
<tr>
<td>6</td>
<td style="text-align: left;"><strong>fg</strong>按钮的前景色（按钮文本的颜色）</td>
</tr>
<tr>
<td>7</td>
<td style="text-align: left;"><strong>font</strong>文本字体</td>
</tr>
<tr>
<td>8</td>
<td style="text-align: left;"><strong>height</strong>按钮的高度</td>
</tr>
<tr>
<td>9</td>
<td style="text-align: left;"><strong>highlightcolor</strong>要高亮的颜色</td>
</tr>
<tr>
<td>10</td>
<td style="text-align: left;"><strong>image</strong>按钮上要显示的图片</td>
</tr>
<tr>
<td>11</td>
<td style="text-align: left;"><strong>justify</strong>显示多行文本的时候,设置不同行之间的对齐方式，可选项包括LEFT, RIGHT, CENTER</td>
</tr>
<tr>
<td>12</td>
<td style="text-align: left;"><strong>padx</strong>按钮在x轴方向上的内边距(padding)，是指按钮的内容与按钮边缘的距离</td>
</tr>
<tr>
<td>13</td>
<td style="text-align: left;"><strong>pady</strong>按钮在y轴方向上的内边距(padding)</td>
</tr>
<tr>
<td>14</td>
<td style="text-align: left;"><strong>relief</strong>边框样式，设置控件3D效果，可选的有：FLAT、SUNKEN、RAISED、GROOVE、RIDGE。默认为 FLAT。</td>
</tr>
<tr>
<td>15</td>
<td style="text-align: left;"><strong>state</strong>设置按钮组件状态,可选的有NORMAL、ACTIVE、 DISABLED。默认 NORMAL。</td>
</tr>
<tr>
<td>16</td>
<td style="text-align: left;"><strong>underline</strong>下划线。默认按钮上的文本都不带下划线。取值就是带下划线的字符串索引</td>
</tr>
<tr>
<td>17</td>
<td style="text-align: left;"><strong>width</strong>按钮的宽度，如未设置此项，其大小以适应按钮的内容（文本或图片的大小）</td>
</tr>
<tr>
<td>18</td>
<td style="text-align: left;"><strong>wraplength</strong>限制按钮每行显示的字符的数量</td>
</tr>
<tr>
<td>19</td>
<td style="text-align: left;"><strong>text</strong>按钮的文本内容</td>
</tr>
<tr>
<td>19</td>
<td style="text-align: left;"><strong>anchor</strong>锚选项，控制文本的位置，默认为中心</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: center;">方法</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">deselect()</td>
<td>清除单选按钮的状态</td>
</tr>
<tr>
<td style="text-align: center;">flash()</td>
<td>在激活状态颜色和正常颜色之间闪烁几次单选按钮，但保持它开始时的状态。</td>
</tr>
<tr>
<td style="text-align: center;">invoke()</td>
<td>可以调用此方法来获得与用户单击单选按钮以更改其状态时发生的操作相同的操作</td>
</tr>
<tr>
<td style="text-align: center;">select()</td>
<td>设置单选按钮为选中。</td>
</tr>
</tbody>
</table>
<div class="language-python highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">tkinter</span>
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a><span class="n">window</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a>
</span><span id="__span-62-5"><a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a><span class="n">B</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">activebackground</span> <span class="o">=</span> <span class="s1">&#39;#008000&#39;</span><span class="p">,</span> <span class="n">activeforeground</span> <span class="o">=</span> <span class="s1">&#39;#FF0000&#39;</span><span class="p">,</span> <span class="n">bd</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">bg</span> <span class="o">=</span> <span class="s1">&#39;#7FFFD4&#39;</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">quit</span><span class="p">,</span> <span class="n">fg</span> <span class="o">=</span> <span class="s1">&#39;#800080&#39;</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span><span class="s2">&quot;退出&quot;</span><span class="p">,</span> <span class="n">underline</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-62-6"><a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a><span class="n">B</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="__span-62-7"><a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a><span class="n">window</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</span></code></pre></div>
<p><strong>如果需要给 <code>command</code>中的函数传参：</strong>
可以使用 <code>partial</code>封装</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tkinter</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>
</span><span id="__span-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a>
</span><span id="__span-63-4"><a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a><span class="n">a</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-63-5"><a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a>
</span><span id="__span-63-6"><a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-63-7"><a id="__codelineno-63-7" name="__codelineno-63-7" href="#__codelineno-63-7"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-63-8"><a id="__codelineno-63-8" name="__codelineno-63-8" href="#__codelineno-63-8"></a>
</span><span id="__span-63-9"><a id="__codelineno-63-9" name="__codelineno-63-9" href="#__codelineno-63-9"></a><span class="n">window</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
</span><span id="__span-63-10"><a id="__codelineno-63-10" name="__codelineno-63-10" href="#__codelineno-63-10"></a><span class="n">Button</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;打印a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
</span><span id="__span-63-11"><a id="__codelineno-63-11" name="__codelineno-63-11" href="#__codelineno-63-11"></a><span class="n">window</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</span></code></pre></div>
<h6 id="canvas">Canvas</h6>
<p><code>w = Canvas ( master, option=value, ... )</code></p>
<ul>
<li>master: 按钮的父容器。</li>
<li>options: 可选项，即该按钮的可设置的属性。这些选项可以用键 = 值的形式设置，并以逗号分隔。</li>
</ul>
<table>
<thead>
<tr>
<th>序号</th>
<th>可选项 &amp; 描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><strong>bd</strong>边框宽度，单位像素，默认为 2 像素。</td>
</tr>
<tr>
<td>2</td>
<td><strong>bg</strong>背景色</td>
</tr>
<tr>
<td>3</td>
<td><strong>confine</strong>如果为 true (默认), 画布不能滚动到可滑动的区域外。</td>
</tr>
<tr>
<td>4</td>
<td><strong>cursor</strong>光标的形状设定，如arrow, circle, cross, plus 等</td>
</tr>
<tr>
<td>5</td>
<td><strong>height</strong>高度</td>
</tr>
<tr>
<td>6</td>
<td><strong>highlightcolor</strong>要高亮的颜色</td>
</tr>
<tr>
<td>7</td>
<td><strong>relief</strong>边框样式,可选值为 FLAT、SUNKEN、RAISED、GROOVE、RIDGE。 默认为 FLAT。</td>
</tr>
<tr>
<td>8</td>
<td><strong>scrollregion</strong>一个元组tuple(w, n, e, s)，定义了画布可滚动的最大区域，w 为左边，n 为头部，e 为右边，s 为底部。</td>
</tr>
<tr>
<td>9</td>
<td><strong>width</strong>画布在 X 坐标轴上的大小。</td>
</tr>
<tr>
<td>10</td>
<td><strong>xscrollincrement</strong>用于滚动请求水平滚动的数量值。</td>
</tr>
<tr>
<td>11</td>
<td><strong>xscrollcommand</strong>水平滚动条，如果画布是可滚动的，则该属性是水平滚动条的 .set（）方法。</td>
</tr>
<tr>
<td>12</td>
<td><strong>yscrollincrement</strong>类似 xscrollincrement, 但是垂直方向。</td>
</tr>
<tr>
<td>13</td>
<td><strong>yscrollcommand</strong>垂直滚动条，如果画布是可滚动的，则该属性是垂直滚动条的 .set（）方法。</td>
</tr>
</tbody>
</table>
<p><strong>Canvas 组件支持以下标准选项：</strong></p>
<p>arc − 创建一个扇形</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="n">coord</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span><span class="mi">210</span>
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="n">arc</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>image − 创建图像</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="n">filename</span> <span class="o">=</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span><span class="s2">&quot;sunshine.gif&quot;</span><span class="p">)</span>
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a><span class="n">image</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">NE</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
</span></code></pre></div>
<p>line − 创建线条</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="n">line</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span><span class="o">...</span><span class="p">,</span> <span class="n">xn</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span></code></pre></div>
<p>oval − 创建一个圆</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="n">oval</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">create_oval</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span></code></pre></div>
<p>polygon − 创建一个至少有三个顶点的多边形</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="n">oval</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">create_polygon</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span><span class="o">...</span><span class="n">xn</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="urllib">urllib（爬虫）</h4>
<p>Python urllib 库用于操作网页 URL，并对网页的内容进行抓取处理。</p>
<ul>
<li>urllib.request - 打开和读取 URL。</li>
<li>urllib.error - 包含 urllib.request 抛出的异常。</li>
<li>urllib.parse - 解析 URL。</li>
<li>urllib.robotparser - 解析 robots.txt 文件。</li>
</ul>
<p>使用封装好的[[#requests|request库]]更方便
具体应用参考[[../../../计算机安全/网络安全/Python网络爬虫|Python网络爬虫]]</p>
<p>urllib.request：</p>
<p>rs = urllib.request.urlopen('http://www.baidu.com')
print(type(rs))
HTTPResponse类型
con = response.read(5)
读5个字节
con1 = response.readline()
读取一行
con2 = response.readlines()
按行读</p>
<p>print(response.getcode())
返回状态码（200正确）
print(response.geturl())
返回url地址
print(response.getheaders())
返回响应头</p>
<p>下载网页、图片、视频
urllib.request.urlretrieve(url='文件url地址',filename='保存路径')</p>
<h4 id="sqlite3">SQLite3（数据库）</h4>
<p>SQLite 是一个用 C 语言编写的小巧嵌入式数据库，它的数据库就是一个文件，不需要单独的服务器进程或操作系统，不需要配置</p>
<p>[[../../其他语法/数据库查询语言|SQL语法]]</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span> <span class="c1"># 导入sqlite3模块</span>
</span><span id="__span-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a>
</span><span id="__span-69-3"><a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a><span class="c1"># 创建与数据库的连接，返回一个Connection对象与数据库进行交互。</span>
</span><span id="__span-69-4"><a id="__codelineno-69-4" name="__codelineno-69-4" href="#__codelineno-69-4"></a><span class="c1"># 数据库文件的格式是filename.db，如果数据库文件不存在，那么会被自动创建。</span>
</span><span id="__span-69-5"><a id="__codelineno-69-5" name="__codelineno-69-5" href="#__codelineno-69-5"></a><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;test.db&#39;</span><span class="p">)</span>
</span><span id="__span-69-6"><a id="__codelineno-69-6" name="__codelineno-69-6" href="#__codelineno-69-6"></a><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;数据库打开成功&quot;</span><span class="p">)</span>
</span><span id="__span-69-7"><a id="__codelineno-69-7" name="__codelineno-69-7" href="#__codelineno-69-7"></a><span class="c1"># 还可以在内存中创建数据库，只要输入特殊参数值:memory:即可，该数据库只存在于内存中，不会生成本地数据库文件。</span>
</span><span id="__span-69-8"><a id="__codelineno-69-8" name="__codelineno-69-8" href="#__codelineno-69-8"></a><span class="c1"># conn = sqlite3.connect(&#39;:memory:&#39;)</span>
</span><span id="__span-69-9"><a id="__codelineno-69-9" name="__codelineno-69-9" href="#__codelineno-69-9"></a><span class="c1">#创建一个游标 cursor对象</span>
</span><span id="__span-69-10"><a id="__codelineno-69-10" name="__codelineno-69-10" href="#__codelineno-69-10"></a><span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="__span-69-11"><a id="__codelineno-69-11" name="__codelineno-69-11" href="#__codelineno-69-11"></a>
</span><span id="__span-69-12"><a id="__codelineno-69-12" name="__codelineno-69-12" href="#__codelineno-69-12"></a>
</span><span id="__span-69-13"><a id="__codelineno-69-13" name="__codelineno-69-13" href="#__codelineno-69-13"></a><span class="c1"># 游标对象的.execute()方法可以执行sql命令</span>
</span><span id="__span-69-14"><a id="__codelineno-69-14" name="__codelineno-69-14" href="#__codelineno-69-14"></a><span class="c1"># 建表的sql语句</span>
</span><span id="__span-69-15"><a id="__codelineno-69-15" name="__codelineno-69-15" href="#__codelineno-69-15"></a><span class="n">sql_text_1</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;CREATE TABLE scores</span>
</span><span id="__span-69-16"><a id="__codelineno-69-16" name="__codelineno-69-16" href="#__codelineno-69-16"></a><span class="s1">           (姓名 TEXT,</span>
</span><span id="__span-69-17"><a id="__codelineno-69-17" name="__codelineno-69-17" href="#__codelineno-69-17"></a><span class="s1">            班级 TEXT,</span>
</span><span id="__span-69-18"><a id="__codelineno-69-18" name="__codelineno-69-18" href="#__codelineno-69-18"></a><span class="s1">            性别 TEXT,</span>
</span><span id="__span-69-19"><a id="__codelineno-69-19" name="__codelineno-69-19" href="#__codelineno-69-19"></a><span class="s1">            成绩 NUMBER);&#39;&#39;&#39;</span>
</span><span id="__span-69-20"><a id="__codelineno-69-20" name="__codelineno-69-20" href="#__codelineno-69-20"></a><span class="k">try</span><span class="p">:</span>
</span><span id="__span-69-21"><a id="__codelineno-69-21" name="__codelineno-69-21" href="#__codelineno-69-21"></a>    <span class="c1"># 执行sql语句</span>
</span><span id="__span-69-22"><a id="__codelineno-69-22" name="__codelineno-69-22" href="#__codelineno-69-22"></a>    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql_text_1</span><span class="p">)</span>
</span><span id="__span-69-23"><a id="__codelineno-69-23" name="__codelineno-69-23" href="#__codelineno-69-23"></a>    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;数据表创建成功&quot;</span><span class="p">)</span>
</span><span id="__span-69-24"><a id="__codelineno-69-24" name="__codelineno-69-24" href="#__codelineno-69-24"></a><span class="k">except</span><span class="p">:</span>
</span><span id="__span-69-25"><a id="__codelineno-69-25" name="__codelineno-69-25" href="#__codelineno-69-25"></a>    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;数据表已存在&quot;</span><span class="p">)</span>
</span><span id="__span-69-26"><a id="__codelineno-69-26" name="__codelineno-69-26" href="#__codelineno-69-26"></a>
</span><span id="__span-69-27"><a id="__codelineno-69-27" name="__codelineno-69-27" href="#__codelineno-69-27"></a>
</span><span id="__span-69-28"><a id="__codelineno-69-28" name="__codelineno-69-28" href="#__codelineno-69-28"></a><span class="c1"># 提交改动</span>
</span><span id="__span-69-29"><a id="__codelineno-69-29" name="__codelineno-69-29" href="#__codelineno-69-29"></a><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-69-30"><a id="__codelineno-69-30" name="__codelineno-69-30" href="#__codelineno-69-30"></a><span class="c1"># 回滚改动</span>
</span><span id="__span-69-31"><a id="__codelineno-69-31" name="__codelineno-69-31" href="#__codelineno-69-31"></a><span class="c1"># conn.rollback()</span>
</span><span id="__span-69-32"><a id="__codelineno-69-32" name="__codelineno-69-32" href="#__codelineno-69-32"></a>
</span><span id="__span-69-33"><a id="__codelineno-69-33" name="__codelineno-69-33" href="#__codelineno-69-33"></a>
</span><span id="__span-69-34"><a id="__codelineno-69-34" name="__codelineno-69-34" href="#__codelineno-69-34"></a><span class="c1"># 插入单条数据</span>
</span><span id="__span-69-35"><a id="__codelineno-69-35" name="__codelineno-69-35" href="#__codelineno-69-35"></a><span class="n">sql_text_2</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO scores VALUES(&#39;A&#39;, &#39;一班&#39;, &#39;男&#39;, 94)&quot;</span>
</span><span id="__span-69-36"><a id="__codelineno-69-36" name="__codelineno-69-36" href="#__codelineno-69-36"></a><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql_text_2</span><span class="p">)</span>
</span><span id="__span-69-37"><a id="__codelineno-69-37" name="__codelineno-69-37" href="#__codelineno-69-37"></a><span class="c1"># 插入多条数据</span>
</span><span id="__span-69-38"><a id="__codelineno-69-38" name="__codelineno-69-38" href="#__codelineno-69-38"></a><span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;一班&#39;</span><span class="p">,</span> <span class="s1">&#39;女&#39;</span><span class="p">,</span> <span class="mi">87</span><span class="p">),</span>
</span><span id="__span-69-39"><a id="__codelineno-69-39" name="__codelineno-69-39" href="#__codelineno-69-39"></a>        <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;一班&#39;</span><span class="p">,</span> <span class="s1">&#39;男&#39;</span><span class="p">,</span> <span class="mi">84</span><span class="p">),</span>
</span><span id="__span-69-40"><a id="__codelineno-69-40" name="__codelineno-69-40" href="#__codelineno-69-40"></a>        <span class="p">]</span>
</span><span id="__span-69-41"><a id="__codelineno-69-41" name="__codelineno-69-41" href="#__codelineno-69-41"></a><span class="n">cur</span><span class="o">.</span><span class="n">executemany</span><span class="p">(</span><span class="s1">&#39;INSERT INTO scores VALUES (?,?,?,?)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="__span-69-42"><a id="__codelineno-69-42" name="__codelineno-69-42" href="#__codelineno-69-42"></a><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-69-43"><a id="__codelineno-69-43" name="__codelineno-69-43" href="#__codelineno-69-43"></a>
</span><span id="__span-69-44"><a id="__codelineno-69-44" name="__codelineno-69-44" href="#__codelineno-69-44"></a><span class="c1"># 执行多个 SQL 语句。它首先执行 COMMIT 语句，然后执行作为参数传入的 SQL 脚本。所有的 SQL 语句应该用分号 ; 分隔。</span>
</span><span id="__span-69-45"><a id="__codelineno-69-45" name="__codelineno-69-45" href="#__codelineno-69-45"></a><span class="c1"># cur.executescript(sql_script)</span>
</span><span id="__span-69-46"><a id="__codelineno-69-46" name="__codelineno-69-46" href="#__codelineno-69-46"></a>
</span><span id="__span-69-47"><a id="__codelineno-69-47" name="__codelineno-69-47" href="#__codelineno-69-47"></a><span class="c1"># 返回自数据库连接打开以来被修改、插入或删除的数据库总行数。</span>
</span><span id="__span-69-48"><a id="__codelineno-69-48" name="__codelineno-69-48" href="#__codelineno-69-48"></a><span class="nb">print</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">total_changes</span><span class="p">)</span>
</span><span id="__span-69-49"><a id="__codelineno-69-49" name="__codelineno-69-49" href="#__codelineno-69-49"></a>
</span><span id="__span-69-50"><a id="__codelineno-69-50" name="__codelineno-69-50" href="#__codelineno-69-50"></a>
</span><span id="__span-69-51"><a id="__codelineno-69-51" name="__codelineno-69-51" href="#__codelineno-69-51"></a><span class="c1"># 查询数据</span>
</span><span id="__span-69-52"><a id="__codelineno-69-52" name="__codelineno-69-52" href="#__codelineno-69-52"></a><span class="n">sql_text_3</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM scores&quot;</span>
</span><span id="__span-69-53"><a id="__codelineno-69-53" name="__codelineno-69-53" href="#__codelineno-69-53"></a><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql_text_3</span><span class="p">)</span>
</span><span id="__span-69-54"><a id="__codelineno-69-54" name="__codelineno-69-54" href="#__codelineno-69-54"></a><span class="c1"># 获取所有查询结果</span>
</span><span id="__span-69-55"><a id="__codelineno-69-55" name="__codelineno-69-55" href="#__codelineno-69-55"></a><span class="nb">print</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span id="__span-69-56"><a id="__codelineno-69-56" name="__codelineno-69-56" href="#__codelineno-69-56"></a><span class="c1"># 获取查询结果的下一行</span>
</span><span id="__span-69-57"><a id="__codelineno-69-57" name="__codelineno-69-57" href="#__codelineno-69-57"></a><span class="c1"># cur.fetchone()</span>
</span><span id="__span-69-58"><a id="__codelineno-69-58" name="__codelineno-69-58" href="#__codelineno-69-58"></a><span class="c1"># 获取查询结果的下一行组</span>
</span><span id="__span-69-59"><a id="__codelineno-69-59" name="__codelineno-69-59" href="#__codelineno-69-59"></a><span class="c1"># cur.fetchmany(size=2)</span>
</span><span id="__span-69-60"><a id="__codelineno-69-60" name="__codelineno-69-60" href="#__codelineno-69-60"></a>
</span><span id="__span-69-61"><a id="__codelineno-69-61" name="__codelineno-69-61" href="#__codelineno-69-61"></a>
</span><span id="__span-69-62"><a id="__codelineno-69-62" name="__codelineno-69-62" href="#__codelineno-69-62"></a><span class="c1"># 关闭连接，关闭前需要手动提交改动</span>
</span><span id="__span-69-63"><a id="__codelineno-69-63" name="__codelineno-69-63" href="#__codelineno-69-63"></a><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a>+----+-----+--------+------+------+
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>| id | 姓名 | 班级   | 性别  | 成绩 |
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a>+----+-----+--------+------+------+
</span><span id="__span-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a>| 1  |  A  |  一班   |  男  | 94   |
</span><span id="__span-70-5"><a id="__codelineno-70-5" name="__codelineno-70-5" href="#__codelineno-70-5"></a>| 2  |  B  |  一班   |  女  | 87   |
</span><span id="__span-70-6"><a id="__codelineno-70-6" name="__codelineno-70-6" href="#__codelineno-70-6"></a>| 3  |  C  |  一班   |  男  | 84   |
</span><span id="__span-70-7"><a id="__codelineno-70-7" name="__codelineno-70-7" href="#__codelineno-70-7"></a>+----+-----+--------+------+------+
</span></code></pre></div>
<h2 id="python_5">python第三方库</h2>
<h3 id="python_6">Python管理工具</h3>
<ul>
<li>Python 版本管理</li>
<li>包管理</li>
<li>环境管理（主要涉及虚拟环境）</li>
<li>包构建</li>
<li>包发布</li>
</ul>
<h4 id="pip">pip包管理工具</h4>
<p>pip 是 Python 包管理工具，该工具提供了对 Python 包的查找、下载、安装、卸载的功能。
（在Python终端中输入命令）</p>
<p>目前如果你在 python.org 下载最新版本的安装包，则是已经自带了该工具。
如果你的系统中没有pip/pip3命令，或者不小心卸载了(<code>python -m pip uninstall pip</code>):</p>
<ul>
<li>windows:<code>py -m ensurepip --upgrade</code>
  此时只能使用 <code>python -m pip -V</code>或 <code>pip3 -V</code>
  <code>python -m pip --upgrade pip</code>更新后就可以正常使用 <code>pip -V</code></li>
<li>linux:<code>python -m ensurepip --upgrade</code>;也可以在root/sudo身份下，运行 <code>apt install python3-pip</code></li>
<li>macOS:<code>python -m ensurepip --upgrade</code></li>
</ul>
<hr />
<p>大多数系统将 python 命令默认指向 Python 2。Python 3 发布后，为了兼容性，许多系统将 python3 命令指向 Python 3，而 python 仍然指向 Python 2。pip与pip3同理。
因此在较老版本的Linux中应注意使用python3和pip3命令</p>
<p><em><code>pip --version</code>/<code>pip -V</code>查看已安装的版本和路径
<code>pip --help</code>/<code>pip -h</code>查看帮助
<code>pip install -U pip</code>升级pip</em></p>
<ol>
<li><strong><code>pip install 包名</code></strong> 安装包（可以通过使用 ==, &gt;=, &lt;=, &gt;, &lt; 来指定一个版本号。也可以同时指定多个包名）</li>
<li><code>pip install --upgrade 包名</code>升级包</li>
<li><code>pip uninstall 包名</code>卸载包</li>
<li><code>pip list</code>列出已安装的包</li>
<li><code>-o</code>查看可升级的包</li>
<li><code>-l</code>只列出在虚拟环境中安装的包</li>
<li><code>--not-required</code>列出那些不是已安装包的依赖项的包</li>
<li><code>--format &lt;list_format&gt;</code>设置输出格式，可选的值有 columns(默认), freeze, json 或 legacy</li>
<li><code>pip list | findstr 包名</code>在所有已安装的包中查找该包名</li>
<li><code>pip show 包名</code>显示包的详细信息</li>
</ol>
<hr />
<p>可以使用 <code>pip install -i 下载源</code>临时更换下载源，如：
清华<a href="https://pypi.tuna.tsinghua.edu.cn/simple">https://pypi.tuna.tsinghua.edu.cn/simple</a>
阿里<a href="https://mirrors.aliyun.com/pypi/simple/">https://mirrors.aliyun.com/pypi/simple/</a>
中科大<a href="https://mirrors.bfsu.edu.cn/pypi/web/simple/">https://mirrors.bfsu.edu.cn/pypi/web/simple/</a>
豆瓣<a href="https://pypi.doubanio.com/simple/">https://pypi.doubanio.com/simple/</a></p>
<p>如果需要直接更改默认源，使用 <code>pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple</code>命令</p>
<p>或者更改配置文件：Unix/Linux/MacOS创建 ~/.pip/pip.conf 文件；Windows创建 %APPDATA%\pip\pip.ini 文件，添加以下内容：</p>
<div class="language-ini highlight"><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="k">[global]</span>
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a><span class="na">index-url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">https://mirrors.aliyun.com/pypi/simple/</span>
</span></code></pre></div>
<hr />
<p>如果一个项目需要安装很多库，可以将他们放入一个文件 requirements.txt
requirements.txt 文件内容格式</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a>包名1==版本号1
</span><span id="__span-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a>包名2==版本号2      #指定版本号
</span><span id="__span-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a>包名3               #不指定版本号
</span></code></pre></div>
<p>使用 <code>pip freeze &gt; requirements.txt</code>自动导出requirements.txt文件（<code>--all</code>包括自带包pip等;<code>-l</code>只列出在虚拟环境中安装的包）
使用 <code>pip install -y -r requirements.txt</code>批量安装（<code>-y</code>自动全部同意，<code>-r</code>读取文件）
使用 <code>pip uninstall -y -r requirements.txt</code>批量卸载</p>
<hr />
<p>批量更新所有可更新的包：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pkg_resources</span>
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">subprocess</span><span class="w"> </span><span class="kn">import</span> <span class="n">call</span>
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a>
</span><span id="__span-73-4"><a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a><span class="k">for</span> <span class="n">packages</span> <span class="ow">in</span> <span class="p">[</span><span class="n">dist</span><span class="o">.</span><span class="n">project_name</span> <span class="k">for</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">working_set</span><span class="p">]:</span>
</span><span id="__span-73-5"><a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a>    <span class="n">call</span><span class="p">(</span><span class="s2">&quot;pip3 install --upgrade &quot;</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">packages</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; --user&#39;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<p><em>查看并删除不被依赖的库</em>
<code>pip list --not-required --format freeze &gt; unrequirements.txt</code>然后打开txt文件，手动排除pip等需要的库
<code>pip uninstall -y -r unrequirements.txt</code></p>
<p><em>卸载包时查看并删除依赖库</em>
<code>pip uninstall</code>不会删除对应的依赖包，可以 <code>pip show</code>查看依赖然后手动删除
也可以使用下面代码</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a><span class="c1"># 白名单，避免被误删</span>
</span><span id="__span-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a><span class="n">WHITELIST</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pip&#39;</span><span class="p">,</span> <span class="s1">&#39;setuptools&#39;</span><span class="p">]</span>
</span><span id="__span-74-4"><a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a><span class="c1"># 需要删除的模块列表</span>
</span><span id="__span-74-5"><a id="__codelineno-74-5" name="__codelineno-74-5" href="#__codelineno-74-5"></a><span class="n">REMOVELIST</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-74-6"><a id="__codelineno-74-6" name="__codelineno-74-6" href="#__codelineno-74-6"></a>
</span><span id="__span-74-7"><a id="__codelineno-74-7" name="__codelineno-74-7" href="#__codelineno-74-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_requires</span><span class="p">(</span><span class="n">module_name</span><span class="p">):</span>
</span><span id="__span-74-8"><a id="__codelineno-74-8" name="__codelineno-74-8" href="#__codelineno-74-8"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-74-9"><a id="__codelineno-74-9" name="__codelineno-74-9" href="#__codelineno-74-9"></a><span class="sd">    查看一个模块的依赖</span>
</span><span id="__span-74-10"><a id="__codelineno-74-10" name="__codelineno-74-10" href="#__codelineno-74-10"></a><span class="sd">    :param module_name: 模块名</span>
</span><span id="__span-74-11"><a id="__codelineno-74-11" name="__codelineno-74-11" href="#__codelineno-74-11"></a><span class="sd">    :return: module_name 所依赖的模块的列表</span>
</span><span id="__span-74-12"><a id="__codelineno-74-12" name="__codelineno-74-12" href="#__codelineno-74-12"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-74-13"><a id="__codelineno-74-13" name="__codelineno-74-13" href="#__codelineno-74-13"></a>    <span class="k">with</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s1">&#39;pip show </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">module_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="__span-74-14"><a id="__codelineno-74-14" name="__codelineno-74-14" href="#__codelineno-74-14"></a>        <span class="n">requires</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="__span-74-15"><a id="__codelineno-74-15" name="__codelineno-74-15" href="#__codelineno-74-15"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">requires</span><span class="p">):</span>
</span><span id="__span-74-16"><a id="__codelineno-74-16" name="__codelineno-74-16" href="#__codelineno-74-16"></a>            <span class="k">return</span> <span class="p">[]</span>
</span><span id="__span-74-17"><a id="__codelineno-74-17" name="__codelineno-74-17" href="#__codelineno-74-17"></a>
</span><span id="__span-74-18"><a id="__codelineno-74-18" name="__codelineno-74-18" href="#__codelineno-74-18"></a>        <span class="n">reqs</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="__span-74-19"><a id="__codelineno-74-19" name="__codelineno-74-19" href="#__codelineno-74-19"></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">requires</span><span class="p">:</span>
</span><span id="__span-74-20"><a id="__codelineno-74-20" name="__codelineno-74-20" href="#__codelineno-74-20"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Requires:&#39;</span><span class="p">):</span>
</span><span id="__span-74-21"><a id="__codelineno-74-21" name="__codelineno-74-21" href="#__codelineno-74-21"></a>                <span class="k">continue</span>
</span><span id="__span-74-22"><a id="__codelineno-74-22" name="__codelineno-74-22" href="#__codelineno-74-22"></a>            <span class="n">reqs</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-74-23"><a id="__codelineno-74-23" name="__codelineno-74-23" href="#__codelineno-74-23"></a>
</span><span id="__span-74-24"><a id="__codelineno-74-24" name="__codelineno-74-24" href="#__codelineno-74-24"></a>        <span class="n">requires</span> <span class="o">=</span> <span class="n">reqs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-74-25"><a id="__codelineno-74-25" name="__codelineno-74-25" href="#__codelineno-74-25"></a>        <span class="k">if</span> <span class="n">requires</span><span class="p">:</span>
</span><span id="__span-74-26"><a id="__codelineno-74-26" name="__codelineno-74-26" href="#__codelineno-74-26"></a>            <span class="n">requires</span> <span class="o">=</span> <span class="n">requires</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span><span id="__span-74-27"><a id="__codelineno-74-27" name="__codelineno-74-27" href="#__codelineno-74-27"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-74-28"><a id="__codelineno-74-28" name="__codelineno-74-28" href="#__codelineno-74-28"></a>            <span class="n">requires</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-74-29"><a id="__codelineno-74-29" name="__codelineno-74-29" href="#__codelineno-74-29"></a>        <span class="k">return</span> <span class="n">requires</span>
</span><span id="__span-74-30"><a id="__codelineno-74-30" name="__codelineno-74-30" href="#__codelineno-74-30"></a>
</span><span id="__span-74-31"><a id="__codelineno-74-31" name="__codelineno-74-31" href="#__codelineno-74-31"></a>
</span><span id="__span-74-32"><a id="__codelineno-74-32" name="__codelineno-74-32" href="#__codelineno-74-32"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_required_bys</span><span class="p">(</span><span class="n">module_name</span><span class="p">):</span>
</span><span id="__span-74-33"><a id="__codelineno-74-33" name="__codelineno-74-33" href="#__codelineno-74-33"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-74-34"><a id="__codelineno-74-34" name="__codelineno-74-34" href="#__codelineno-74-34"></a><span class="sd">    查看一个模块被哪些模块依赖</span>
</span><span id="__span-74-35"><a id="__codelineno-74-35" name="__codelineno-74-35" href="#__codelineno-74-35"></a><span class="sd">    :param module_name: 模块名</span>
</span><span id="__span-74-36"><a id="__codelineno-74-36" name="__codelineno-74-36" href="#__codelineno-74-36"></a><span class="sd">    :return: module_name 被依赖的模块的列表</span>
</span><span id="__span-74-37"><a id="__codelineno-74-37" name="__codelineno-74-37" href="#__codelineno-74-37"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-74-38"><a id="__codelineno-74-38" name="__codelineno-74-38" href="#__codelineno-74-38"></a>    <span class="k">with</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s1">&#39;pip show </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">module_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="__span-74-39"><a id="__codelineno-74-39" name="__codelineno-74-39" href="#__codelineno-74-39"></a>        <span class="n">req_by</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="__span-74-40"><a id="__codelineno-74-40" name="__codelineno-74-40" href="#__codelineno-74-40"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">req_by</span><span class="p">):</span>
</span><span id="__span-74-41"><a id="__codelineno-74-41" name="__codelineno-74-41" href="#__codelineno-74-41"></a>            <span class="k">return</span> <span class="p">[]</span>
</span><span id="__span-74-42"><a id="__codelineno-74-42" name="__codelineno-74-42" href="#__codelineno-74-42"></a>
</span><span id="__span-74-43"><a id="__codelineno-74-43" name="__codelineno-74-43" href="#__codelineno-74-43"></a>        <span class="n">required</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="__span-74-44"><a id="__codelineno-74-44" name="__codelineno-74-44" href="#__codelineno-74-44"></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">req_by</span><span class="p">:</span>
</span><span id="__span-74-45"><a id="__codelineno-74-45" name="__codelineno-74-45" href="#__codelineno-74-45"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Required-by:&#39;</span><span class="p">):</span>
</span><span id="__span-74-46"><a id="__codelineno-74-46" name="__codelineno-74-46" href="#__codelineno-74-46"></a>                <span class="k">continue</span>
</span><span id="__span-74-47"><a id="__codelineno-74-47" name="__codelineno-74-47" href="#__codelineno-74-47"></a>            <span class="n">required</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-74-48"><a id="__codelineno-74-48" name="__codelineno-74-48" href="#__codelineno-74-48"></a>
</span><span id="__span-74-49"><a id="__codelineno-74-49" name="__codelineno-74-49" href="#__codelineno-74-49"></a>        <span class="n">req_by</span> <span class="o">=</span> <span class="n">required</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-74-50"><a id="__codelineno-74-50" name="__codelineno-74-50" href="#__codelineno-74-50"></a>        <span class="k">if</span> <span class="n">req_by</span><span class="p">:</span>
</span><span id="__span-74-51"><a id="__codelineno-74-51" name="__codelineno-74-51" href="#__codelineno-74-51"></a>            <span class="n">req_by</span> <span class="o">=</span> <span class="n">req_by</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span><span id="__span-74-52"><a id="__codelineno-74-52" name="__codelineno-74-52" href="#__codelineno-74-52"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-74-53"><a id="__codelineno-74-53" name="__codelineno-74-53" href="#__codelineno-74-53"></a>            <span class="n">req_by</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-74-54"><a id="__codelineno-74-54" name="__codelineno-74-54" href="#__codelineno-74-54"></a>        <span class="k">return</span> <span class="n">req_by</span>
</span><span id="__span-74-55"><a id="__codelineno-74-55" name="__codelineno-74-55" href="#__codelineno-74-55"></a>
</span><span id="__span-74-56"><a id="__codelineno-74-56" name="__codelineno-74-56" href="#__codelineno-74-56"></a>
</span><span id="__span-74-57"><a id="__codelineno-74-57" name="__codelineno-74-57" href="#__codelineno-74-57"></a><span class="k">def</span><span class="w"> </span><span class="nf">install</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
</span><span id="__span-74-58"><a id="__codelineno-74-58" name="__codelineno-74-58" href="#__codelineno-74-58"></a>    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;pip install </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-74-59"><a id="__codelineno-74-59" name="__codelineno-74-59" href="#__codelineno-74-59"></a>
</span><span id="__span-74-60"><a id="__codelineno-74-60" name="__codelineno-74-60" href="#__codelineno-74-60"></a>
</span><span id="__span-74-61"><a id="__codelineno-74-61" name="__codelineno-74-61" href="#__codelineno-74-61"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_all_requires</span><span class="p">(</span><span class="n">module_name</span><span class="p">):</span>
</span><span id="__span-74-62"><a id="__codelineno-74-62" name="__codelineno-74-62" href="#__codelineno-74-62"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-74-63"><a id="__codelineno-74-63" name="__codelineno-74-63" href="#__codelineno-74-63"></a><span class="sd">    递归地获取一个模块所有的依赖</span>
</span><span id="__span-74-64"><a id="__codelineno-74-64" name="__codelineno-74-64" href="#__codelineno-74-64"></a><span class="sd">    :param module_name: 模块名称</span>
</span><span id="__span-74-65"><a id="__codelineno-74-65" name="__codelineno-74-65" href="#__codelineno-74-65"></a><span class="sd">    :return: None</span>
</span><span id="__span-74-66"><a id="__codelineno-74-66" name="__codelineno-74-66" href="#__codelineno-74-66"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-74-67"><a id="__codelineno-74-67" name="__codelineno-74-67" href="#__codelineno-74-67"></a>    <span class="n">dependents</span> <span class="o">=</span> <span class="n">get_requires</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
</span><span id="__span-74-68"><a id="__codelineno-74-68" name="__codelineno-74-68" href="#__codelineno-74-68"></a>    <span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">dependents</span><span class="p">:</span>
</span><span id="__span-74-69"><a id="__codelineno-74-69" name="__codelineno-74-69" href="#__codelineno-74-69"></a>        <span class="k">if</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">WHITELIST</span><span class="p">:</span>
</span><span id="__span-74-70"><a id="__codelineno-74-70" name="__codelineno-74-70" href="#__codelineno-74-70"></a>            <span class="c1">#print(f&#39;[{package}] in white list&#39;)</span>
</span><span id="__span-74-71"><a id="__codelineno-74-71" name="__codelineno-74-71" href="#__codelineno-74-71"></a>            <span class="k">continue</span>
</span><span id="__span-74-72"><a id="__codelineno-74-72" name="__codelineno-74-72" href="#__codelineno-74-72"></a>        <span class="n">get_all_requires</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>
</span><span id="__span-74-73"><a id="__codelineno-74-73" name="__codelineno-74-73" href="#__codelineno-74-73"></a>    <span class="n">REMOVELIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
</span><span id="__span-74-74"><a id="__codelineno-74-74" name="__codelineno-74-74" href="#__codelineno-74-74"></a>
</span><span id="__span-74-75"><a id="__codelineno-74-75" name="__codelineno-74-75" href="#__codelineno-74-75"></a>
</span><span id="__span-74-76"><a id="__codelineno-74-76" name="__codelineno-74-76" href="#__codelineno-74-76"></a><span class="k">def</span><span class="w"> </span><span class="nf">remove</span><span class="p">(</span><span class="n">module_name</span><span class="p">):</span>
</span><span id="__span-74-77"><a id="__codelineno-74-77" name="__codelineno-74-77" href="#__codelineno-74-77"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Scanning packages...&#39;</span><span class="p">)</span>
</span><span id="__span-74-78"><a id="__codelineno-74-78" name="__codelineno-74-78" href="#__codelineno-74-78"></a>    <span class="n">get_all_requires</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
</span><span id="__span-74-79"><a id="__codelineno-74-79" name="__codelineno-74-79" href="#__codelineno-74-79"></a>    <span class="n">s_packages</span> <span class="o">=</span>  <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">REMOVELIST</span><span class="p">)</span>
</span><span id="__span-74-80"><a id="__codelineno-74-80" name="__codelineno-74-80" href="#__codelineno-74-80"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[INFO]Found packages: </span><span class="si">{</span><span class="n">s_packages</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-74-81"><a id="__codelineno-74-81" name="__codelineno-74-81" href="#__codelineno-74-81"></a>
</span><span id="__span-74-82"><a id="__codelineno-74-82" name="__codelineno-74-82" href="#__codelineno-74-82"></a>    <span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">REMOVELIST</span><span class="p">:</span>
</span><span id="__span-74-83"><a id="__codelineno-74-83" name="__codelineno-74-83" href="#__codelineno-74-83"></a>        <span class="n">req_bys</span> <span class="o">=</span> <span class="n">get_required_bys</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>
</span><span id="__span-74-84"><a id="__codelineno-74-84" name="__codelineno-74-84" href="#__codelineno-74-84"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[INFO]removing:&#39;</span><span class="p">,</span> <span class="n">package</span><span class="p">)</span>
</span><span id="__span-74-85"><a id="__codelineno-74-85" name="__codelineno-74-85" href="#__codelineno-74-85"></a>        <span class="c1">#print(package, &#39;is required by:&#39;, req_bys)</span>
</span><span id="__span-74-86"><a id="__codelineno-74-86" name="__codelineno-74-86" href="#__codelineno-74-86"></a>        <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-74-87"><a id="__codelineno-74-87" name="__codelineno-74-87" href="#__codelineno-74-87"></a>        <span class="k">for</span> <span class="n">req_by</span> <span class="ow">in</span> <span class="n">req_bys</span><span class="p">:</span>
</span><span id="__span-74-88"><a id="__codelineno-74-88" name="__codelineno-74-88" href="#__codelineno-74-88"></a>            <span class="k">if</span> <span class="n">req_by</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">REMOVELIST</span><span class="p">:</span>
</span><span id="__span-74-89"><a id="__codelineno-74-89" name="__codelineno-74-89" href="#__codelineno-74-89"></a>                <span class="n">flag</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-74-90"><a id="__codelineno-74-90" name="__codelineno-74-90" href="#__codelineno-74-90"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[NOTICE]As &quot;</span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s1">&quot; is required by &quot;</span><span class="si">{</span><span class="n">req_by</span><span class="si">}</span><span class="s1">&quot; which is not in </span><span class="si">{</span><span class="n">REMOVELIST</span><span class="si">}</span><span class="s1">, skipped...</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-74-91"><a id="__codelineno-74-91" name="__codelineno-74-91" href="#__codelineno-74-91"></a>                <span class="k">break</span>
</span><span id="__span-74-92"><a id="__codelineno-74-92" name="__codelineno-74-92" href="#__codelineno-74-92"></a>        <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
</span><span id="__span-74-93"><a id="__codelineno-74-93" name="__codelineno-74-93" href="#__codelineno-74-93"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-74-94"><a id="__codelineno-74-94" name="__codelineno-74-94" href="#__codelineno-74-94"></a>            <span class="c1">#os.system(&#39;pip uninstall -y %s&#39; % package)</span>
</span><span id="__span-74-95"><a id="__codelineno-74-95" name="__codelineno-74-95" href="#__codelineno-74-95"></a>
</span><span id="__span-74-96"><a id="__codelineno-74-96" name="__codelineno-74-96" href="#__codelineno-74-96"></a>
</span><span id="__span-74-97"><a id="__codelineno-74-97" name="__codelineno-74-97" href="#__codelineno-74-97"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span><span id="__span-74-98"><a id="__codelineno-74-98" name="__codelineno-74-98" href="#__codelineno-74-98"></a>    <span class="n">pkg_name</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;请输入要卸载的第三方模块包: &#39;</span><span class="p">)</span>
</span><span id="__span-74-99"><a id="__codelineno-74-99" name="__codelineno-74-99" href="#__codelineno-74-99"></a>    <span class="c1">#install(pkg_name)</span>
</span><span id="__span-74-100"><a id="__codelineno-74-100" name="__codelineno-74-100" href="#__codelineno-74-100"></a>    <span class="n">remove</span><span class="p">(</span><span class="n">pkg_name</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<p>报错Fatal error in launcher: Unable to create process using xxx</p>
<p>更改了python的安装路径和环境变量或者修改了虚拟环境的路径</p>
<p><code>python -m pip install -U --force-reinstall pip</code>重装pip即可
删除虚拟环境重新创建</p>
<h4 id="venv">venv虚拟环境</h4>
<p>有可能需要使用一个包的不同版本
在打包成exe文件时配置所需包，而不是打包电脑中所有包，减少体积</p>
<p>虚拟环境就是一个独立的环境（文件夹），用于存放所需的包和开发工具</p>
<ol>
<li><code>python -m venv 虚拟环境文件夹名</code>创建虚拟环境，会创建一个文件夹</li>
<li><code>source 文件夹名/bin/active</code>(linux、macos)
   <code>文件夹名/scripts/activate</code>(windows)
   命令行前出现 <code>(虚拟环境名)</code>代表激活成功</li>
<li><code>deactivate</code> 退出虚拟环境</li>
<li>删除虚拟环境，直接删除虚拟环境所在的目录就可以</li>
</ol>
<h3 id="jupyter">Jupyter</h3>
<p><code>pip install jupyter</code> 安装 Jupyter notebook 应用程序(Ipython解释器的基于 Web 的界面)
终端输入 <code>jupyter notebook</code> 运行(<code>jupyter notebook --port &lt;port_number&gt;</code>指定端口)</p>
<p>首次使用可以 <code>pip install jupyterlab-language-pack-zh-CN</code> 下载中文包
<code>jupyter notebook</code> 运行后在setting——language修改为中文</p>
<p>可以使用ipykernel把一个包虚拟环境安装成jupyter内核（内核≠虚拟环境，内核就指向虚拟环境）
<code>python -m ipykernel install --user --name=内核真名 --display-name 在内核选择时显示的内核假名</code>
<code>jupyter kernelspec remove 内核名称</code> 删除指定内核</p>
<p>后缀名为 <code>.ipynb</code>的 <code>JSON</code>格式文件
在文件中可以实现：</p>
<ol>
<li>编程时具有「语法高亮」、缩进、tab补全的功能。</li>
<li>可直接通过浏览器运行代码，同时在代码块下方展示运行结果。</li>
<li>以富媒体格式展示计算结果。富媒体格式包括：HTML，LaTeX，PNG，SVG等。</li>
<li>对代码编写说明文档或语句时，支持Markdown语法。</li>
<li>支持使用LaTeX编写数学性说明。</li>
</ol>
<p>在Vscode下载Jupyter插件后可以直接在Vscode中打开ipynb文件，不需要运行jupyter notebook在浏览器中打开</p>
<h3 id="_44">运算工具</h3>
<h4 id="numpy">numpy（数组运算）</h4>
<p>NumPy(Numerical Python) 是 Python 语言的一个扩展程序库，支持大量的维度数组与矩阵运算，此外也针对数组运算提供大量的数学函数库。</p>
<p>b = a.copy()
np.pi
np.e
np.power()
np.arange(起始值，结束值，间隔)
np.linspace(起始值，结束值，起始值和结束值之间的个数)
np.logspac</p>
<p>np.zeros(长度),ones 初始化
利用多重赋值技巧可以批量初始化 <code>a,b,c=np.zeros([3,10])</code></p>
<p>在使用np.frompyfunc构造ufunc时，numpy后台实际上是把原函数调用了多次，调用次数等于x为维度，每次调用顺次取x中一个元素。所以，此时的x已经失去了数组的那些特性，比如shape属性，它就成一个单独的数字了</p>
<p><strong>numpy.asfarray()</strong> 函数用于将输入转换为浮点型数组。输入可以是标量、列表、元组、列表的元组、元组的元组、ndarray 等</p>
<p>将多维转换为一维</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a><span class="n">mulArrays</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]]</span>
</span><span id="__span-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a>
</span><span id="__span-75-4"><a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mulArrays</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span><span id="__span-75-5"><a id="__codelineno-75-5" name="__codelineno-75-5" href="#__codelineno-75-5"></a><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">mulArrays</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">))</span>
</span><span id="__span-75-6"><a id="__codelineno-75-6" name="__codelineno-75-6" href="#__codelineno-75-6"></a><span class="nb">sum</span><span class="p">(</span><span class="n">mulArrays</span><span class="p">,[])</span>
</span><span id="__span-75-7"><a id="__codelineno-75-7" name="__codelineno-75-7" href="#__codelineno-75-7"></a><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">mulArrays</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">]</span>
</span><span id="__span-75-8"><a id="__codelineno-75-8" name="__codelineno-75-8" href="#__codelineno-75-8"></a><span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">mulArrays</span><span class="p">)</span>
</span><span id="__span-75-9"><a id="__codelineno-75-9" name="__codelineno-75-9" href="#__codelineno-75-9"></a><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">mulArrays</span><span class="p">)</span>
</span></code></pre></div>
<p>将一维转换为多维</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="n">array1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</span><span id="__span-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a><span class="n">array1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></code></pre></div>
<p>弱类型语言，a.b复杂度高，应m = a.b,不要反复查询（对于java a.b 按地址访问复杂度）</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a><span class="n">numpy</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.18e</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">footer</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="s1">&#39;# &#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="n">source</span><span class="p">]</span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a><span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="__span-77-3"><a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a><span class="n">a</span><span class="o">.</span><span class="n">savetxt</span><span class="p">()</span>
</span></code></pre></div>
<p><strong>数组各种复制或查看的比较</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a>
</span><span id="__span-78-3"><a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a><span class="c1"># 数组各种复制或查看的比较</span>
</span><span id="__span-78-4"><a id="__codelineno-78-4" name="__codelineno-78-4" href="#__codelineno-78-4"></a><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</span><span id="__span-78-5"><a id="__codelineno-78-5" name="__codelineno-78-5" href="#__codelineno-78-5"></a><span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
</span><span id="__span-78-6"><a id="__codelineno-78-6" name="__codelineno-78-6" href="#__codelineno-78-6"></a><span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-78-7"><a id="__codelineno-78-7" name="__codelineno-78-7" href="#__codelineno-78-7"></a><span class="n">d</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
</span><span id="__span-78-8"><a id="__codelineno-78-8" name="__codelineno-78-8" href="#__codelineno-78-8"></a><span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="__span-78-9"><a id="__codelineno-78-9" name="__codelineno-78-9" href="#__codelineno-78-9"></a><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="__span-78-10"><a id="__codelineno-78-10" name="__codelineno-78-10" href="#__codelineno-78-10"></a>
</span><span id="__span-78-11"><a id="__codelineno-78-11" name="__codelineno-78-11" href="#__codelineno-78-11"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;b是a吗？&#39;</span><span class="p">,</span> <span class="n">b</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># b是a吗？ True</span>
</span><span id="__span-78-12"><a id="__codelineno-78-12" name="__codelineno-78-12" href="#__codelineno-78-12"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;b是以a为基础建立的吗&#39;</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">base</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># b是以a为基础建立的吗 False</span>
</span><span id="__span-78-13"><a id="__codelineno-78-13" name="__codelineno-78-13" href="#__codelineno-78-13"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;c是a吗？&#39;</span><span class="p">,</span> <span class="n">c</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># c是a吗？ False</span>
</span><span id="__span-78-14"><a id="__codelineno-78-14" name="__codelineno-78-14" href="#__codelineno-78-14"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;c是以a为基础建立的吗&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">base</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># c是以a为基础建立的吗 False</span>
</span><span id="__span-78-15"><a id="__codelineno-78-15" name="__codelineno-78-15" href="#__codelineno-78-15"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;d是a吗？&#39;</span><span class="p">,</span> <span class="n">d</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># d是a吗？ False</span>
</span><span id="__span-78-16"><a id="__codelineno-78-16" name="__codelineno-78-16" href="#__codelineno-78-16"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;d是以a为基础建立的吗&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">base</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># d是以a为基础建立的吗 True</span>
</span><span id="__span-78-17"><a id="__codelineno-78-17" name="__codelineno-78-17" href="#__codelineno-78-17"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;e是a吗？&#39;</span><span class="p">,</span> <span class="n">e</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># e是a吗？ False</span>
</span><span id="__span-78-18"><a id="__codelineno-78-18" name="__codelineno-78-18" href="#__codelineno-78-18"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;e是以a为基础建立的吗&#39;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">base</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># e是以a为基础建立的吗 False</span>
</span><span id="__span-78-19"><a id="__codelineno-78-19" name="__codelineno-78-19" href="#__codelineno-78-19"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;f是a吗？&#39;</span><span class="p">,</span> <span class="n">f</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># f是a吗？ True</span>
</span><span id="__span-78-20"><a id="__codelineno-78-20" name="__codelineno-78-20" href="#__codelineno-78-20"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;f是以a为基础建立的吗&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">base</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># f是以a为基础建立的吗 False</span>
</span><span id="__span-78-21"><a id="__codelineno-78-21" name="__codelineno-78-21" href="#__codelineno-78-21"></a><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="__span-78-22"><a id="__codelineno-78-22" name="__codelineno-78-22" href="#__codelineno-78-22"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;b[0]:&#39;</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># b[0]: 4</span>
</span><span id="__span-78-23"><a id="__codelineno-78-23" name="__codelineno-78-23" href="#__codelineno-78-23"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;c[0]:&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># c[0]: 1</span>
</span><span id="__span-78-24"><a id="__codelineno-78-24" name="__codelineno-78-24" href="#__codelineno-78-24"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;d[0]:&#39;</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># d[0]: 4</span>
</span><span id="__span-78-25"><a id="__codelineno-78-25" name="__codelineno-78-25" href="#__codelineno-78-25"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;e[0]:&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># e[0]: 1</span>
</span><span id="__span-78-26"><a id="__codelineno-78-26" name="__codelineno-78-26" href="#__codelineno-78-26"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;f[0]:&#39;</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># f[0]: 4</span>
</span><span id="__span-78-27"><a id="__codelineno-78-27" name="__codelineno-78-27" href="#__codelineno-78-27"></a><span class="c1"># 特别的：</span>
</span><span id="__span-78-28"><a id="__codelineno-78-28" name="__codelineno-78-28" href="#__codelineno-78-28"></a><span class="c1"># 可以用np.array(arr, dtype=float)改变数组中的数据类型</span>
</span><span id="__span-78-29"><a id="__codelineno-78-29" name="__codelineno-78-29" href="#__codelineno-78-29"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a数组中的数据类型&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># a数组中的数据类型 int32</span>
</span><span id="__span-78-30"><a id="__codelineno-78-30" name="__codelineno-78-30" href="#__codelineno-78-30"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;e数组中的数据类型&#39;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># e数组中的数据类型 int32</span>
</span><span id="__span-78-31"><a id="__codelineno-78-31" name="__codelineno-78-31" href="#__codelineno-78-31"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;f数组中的数据类型&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># f数组中的数据类型 int32</span>
</span><span id="__span-78-32"><a id="__codelineno-78-32" name="__codelineno-78-32" href="#__codelineno-78-32"></a><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="__span-78-33"><a id="__codelineno-78-33" name="__codelineno-78-33" href="#__codelineno-78-33"></a><span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="__span-78-34"><a id="__codelineno-78-34" name="__codelineno-78-34" href="#__codelineno-78-34"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;更改后e数组中的数据类型&#39;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># 更改后e数组中的数据类型 float64</span>
</span><span id="__span-78-35"><a id="__codelineno-78-35" name="__codelineno-78-35" href="#__codelineno-78-35"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;更改后f数组中的数据类型&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># 更改后f数组中的数据类型 int32</span>
</span><span id="__span-78-36"><a id="__codelineno-78-36" name="__codelineno-78-36" href="#__codelineno-78-36"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;e是a吗？&#39;</span><span class="p">,</span> <span class="n">e</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># e是a吗？ False</span>
</span><span id="__span-78-37"><a id="__codelineno-78-37" name="__codelineno-78-37" href="#__codelineno-78-37"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;e是以a为基础建立的吗&#39;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">base</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># e是以a为基础建立的吗 False</span>
</span><span id="__span-78-38"><a id="__codelineno-78-38" name="__codelineno-78-38" href="#__codelineno-78-38"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;f是a吗？&#39;</span><span class="p">,</span> <span class="n">f</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># f是a吗？ False</span>
</span><span id="__span-78-39"><a id="__codelineno-78-39" name="__codelineno-78-39" href="#__codelineno-78-39"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;f是以a为基础建立的吗&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">base</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># f是以a为基础建立的吗 False</span>
</span></code></pre></div>
<h5 id="_45">例子：生成质数表</h5>
<div class="language-python highlight"><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a>
</span><span id="__span-79-3"><a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a><span class="n">primeArr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-79-4"><a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a>
</span><span id="__span-79-5"><a id="__codelineno-79-5" name="__codelineno-79-5" href="#__codelineno-79-5"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="__span-79-6"><a id="__codelineno-79-6" name="__codelineno-79-6" href="#__codelineno-79-6"></a>    <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-79-7"><a id="__codelineno-79-7" name="__codelineno-79-7" href="#__codelineno-79-7"></a>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="__span-79-8"><a id="__codelineno-79-8" name="__codelineno-79-8" href="#__codelineno-79-8"></a>        <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="__span-79-9"><a id="__codelineno-79-9" name="__codelineno-79-9" href="#__codelineno-79-9"></a>            <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-79-10"><a id="__codelineno-79-10" name="__codelineno-79-10" href="#__codelineno-79-10"></a>            <span class="k">break</span>
</span><span id="__span-79-11"><a id="__codelineno-79-11" name="__codelineno-79-11" href="#__codelineno-79-11"></a>    <span class="k">if</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
</span><span id="__span-79-12"><a id="__codelineno-79-12" name="__codelineno-79-12" href="#__codelineno-79-12"></a>        <span class="n">primeArr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">primeArr</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="__span-79-13"><a id="__codelineno-79-13" name="__codelineno-79-13" href="#__codelineno-79-13"></a>
</span><span id="__span-79-14"><a id="__codelineno-79-14" name="__codelineno-79-14" href="#__codelineno-79-14"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span><span id="__span-79-15"><a id="__codelineno-79-15" name="__codelineno-79-15" href="#__codelineno-79-15"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">primeArr</span><span class="p">)</span>
</span><span id="__span-79-16"><a id="__codelineno-79-16" name="__codelineno-79-16" href="#__codelineno-79-16"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;primeArr.py&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="__span-79-17"><a id="__codelineno-79-17" name="__codelineno-79-17" href="#__codelineno-79-17"></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;import numpy&#39;</span><span class="p">)</span>
</span><span id="__span-79-18"><a id="__codelineno-79-18" name="__codelineno-79-18" href="#__codelineno-79-18"></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-79-19"><a id="__codelineno-79-19" name="__codelineno-79-19" href="#__codelineno-79-19"></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;primeArr = numpy.array([&#39;</span><span class="p">)</span>
</span><span id="__span-79-20"><a id="__codelineno-79-20" name="__codelineno-79-20" href="#__codelineno-79-20"></a>        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">primeArr</span><span class="p">:</span>
</span><span id="__span-79-21"><a id="__codelineno-79-21" name="__codelineno-79-21" href="#__codelineno-79-21"></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span><span id="__span-79-22"><a id="__codelineno-79-22" name="__codelineno-79-22" href="#__codelineno-79-22"></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p>因为数组很大，如果 <code>file.write(str(primeArr))</code>结果为 <code>[   2    3    5...994999679973]</code>
如果仅仅需要打印数组，可以使用 <code>np.savetxt('primeArr.txt', prime, fmt='%d')</code></p>
<h4 id="scipy">scipy（科学计算）</h4>
<p>SciPy 是一个开源的 Python 算法库和数学工具包，是基于 Numpy 的科学计算库，包含的模块有最优化、线性代数、积分、插值、特殊函数、快速傅里叶变换、信号处理和图像处理、常微分方程求解和其他科学与工程中常用的计算。</p>
<table>
<thead>
<tr>
<th>模块名</th>
<th>功能</th>
<th>参考文档</th>
</tr>
</thead>
<tbody>
<tr>
<td>scipy.cluster</td>
<td>向量量化</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/cluster.html">cluster API</a></td>
</tr>
<tr>
<td>scipy.constants</td>
<td>常量</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/constants.html">constants API</a></td>
</tr>
<tr>
<td>scipy.fft</td>
<td>快速傅里叶变换</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/fft.html">fft API</a></td>
</tr>
<tr>
<td>scipy.integrate</td>
<td>积分</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/integrate.html">integrate API</a></td>
</tr>
<tr>
<td>scipy.interpolate</td>
<td>插值</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/interpolate.html">interpolate API</a></td>
</tr>
<tr>
<td>scipy.io</td>
<td>数据输入输出</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/io.html">io API</a></td>
</tr>
<tr>
<td>scipy.linalg</td>
<td>线性代数</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/linalg.html">linalg API</a></td>
</tr>
<tr>
<td>scipy.misc</td>
<td>图像处理</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/misc.html">misc API</a></td>
</tr>
<tr>
<td>scipy.ndimage</td>
<td>N 维图像</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/ndimage.html">ndimage API</a></td>
</tr>
<tr>
<td>scipy.odr</td>
<td>正交距离回归</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/odr.html">odr API</a></td>
</tr>
<tr>
<td>scipy.optimize</td>
<td>优化算法</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/optimize.html">optimize API</a></td>
</tr>
<tr>
<td>scipy.signal</td>
<td>信号处理</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/signal.html">signal API</a></td>
</tr>
<tr>
<td>scipy.sparse</td>
<td>稀疏矩阵</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/sparse.html">sparse API</a></td>
</tr>
<tr>
<td>scipy.spatial</td>
<td>空间数据结构和算法</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/spatial.html">spatial API</a></td>
</tr>
<tr>
<td>scipy.special</td>
<td>特殊数学函数</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/special.html">special API</a></td>
</tr>
<tr>
<td>scipy.stats</td>
<td>统计函数</td>
<td><a href="https://docs.scipy.org/doc/scipy/reference/stats.mstats.html">stats.mstats API</a></td>
</tr>
</tbody>
</table>
<h5 id="constants">constants常量</h5>
<p>提供了许多内置的常量，如pi</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">constants</span>
</span><span id="__span-80-2"><a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a>
</span><span id="__span-80-3"><a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">//</span> <span class="n">圆周率</span>
</span><span id="__span-80-4"><a id="__codelineno-80-4" name="__codelineno-80-4" href="#__codelineno-80-4"></a><span class="o">//</span> <span class="nb">print</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">constants</span><span class="p">))</span> <span class="o">//</span> <span class="n">使用dir</span><span class="p">()</span><span class="n">函数来查看constants模块包含了哪些常量</span>
</span></code></pre></div>
<h5 id="special">special 特殊函数</h5>
<h5 id="optimize">optimize优化算法</h5>
<p>提供了常用的最优化算法函数实现，我们可以直接调用这些函数完成我们的优化问题</p>
<p>迭代法解方程 <code>root(fun, x0)</code> fun为函数；x0为根的初始猜测</p>
<h5 id="_46">解方程</h5>
<p>线性方程组</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a>from sympy import symbols, Eq, solve
</span><span id="__span-81-2"><a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a>
</span><span id="__span-81-3"><a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a>x, y = symbols(&#39;x y&#39;)
</span><span id="__span-81-4"><a id="__codelineno-81-4" name="__codelineno-81-4" href="#__codelineno-81-4"></a>eq1 = Eq(x + y, 3)
</span><span id="__span-81-5"><a id="__codelineno-81-5" name="__codelineno-81-5" href="#__codelineno-81-5"></a>eq2 = Eq(2 * x - y, 1)
</span><span id="__span-81-6"><a id="__codelineno-81-6" name="__codelineno-81-6" href="#__codelineno-81-6"></a>
</span><span id="__span-81-7"><a id="__codelineno-81-7" name="__codelineno-81-7" href="#__codelineno-81-7"></a>sol = solve((eq1, eq2), (x, y))
</span><span id="__span-81-8"><a id="__codelineno-81-8" name="__codelineno-81-8" href="#__codelineno-81-8"></a>
</span><span id="__span-81-9"><a id="__codelineno-81-9" name="__codelineno-81-9" href="#__codelineno-81-9"></a>print(sol)
</span></code></pre></div>
<p>非线性方程</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a>import scipy.optimize as opt
</span><span id="__span-82-2"><a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a>
</span><span id="__span-82-3"><a id="__codelineno-82-3" name="__codelineno-82-3" href="#__codelineno-82-3"></a>def equation(x):
</span><span id="__span-82-4"><a id="__codelineno-82-4" name="__codelineno-82-4" href="#__codelineno-82-4"></a>    return x**2 - 4
</span><span id="__span-82-5"><a id="__codelineno-82-5" name="__codelineno-82-5" href="#__codelineno-82-5"></a>
</span><span id="__span-82-6"><a id="__codelineno-82-6" name="__codelineno-82-6" href="#__codelineno-82-6"></a># 使用二分法求解方程
</span><span id="__span-82-7"><a id="__codelineno-82-7" name="__codelineno-82-7" href="#__codelineno-82-7"></a>sol = opt.bisect(equation, 0, 3)
</span><span id="__span-82-8"><a id="__codelineno-82-8" name="__codelineno-82-8" href="#__codelineno-82-8"></a>
</span><span id="__span-82-9"><a id="__codelineno-82-9" name="__codelineno-82-9" href="#__codelineno-82-9"></a>print(sol)
</span></code></pre></div>
<p>隐函数方程</p>
<h5 id="_47">微分方程</h5>
<div class="language-text highlight"><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a>import numpy as np
</span><span id="__span-83-2"><a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a>from scipy.integrate import odeint
</span><span id="__span-83-3"><a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a>import matplotlib.pyplot as plt
</span><span id="__span-83-4"><a id="__codelineno-83-4" name="__codelineno-83-4" href="#__codelineno-83-4"></a>
</span><span id="__span-83-5"><a id="__codelineno-83-5" name="__codelineno-83-5" href="#__codelineno-83-5"></a># 定义微分方程
</span><span id="__span-83-6"><a id="__codelineno-83-6" name="__codelineno-83-6" href="#__codelineno-83-6"></a>def model(y, t):
</span><span id="__span-83-7"><a id="__codelineno-83-7" name="__codelineno-83-7" href="#__codelineno-83-7"></a>    V, E = y
</span><span id="__span-83-8"><a id="__codelineno-83-8" name="__codelineno-83-8" href="#__codelineno-83-8"></a>    dV_dt = -V * (1 - V ** 2) * E
</span><span id="__span-83-9"><a id="__codelineno-83-9" name="__codelineno-83-9" href="#__codelineno-83-9"></a>    dE_dt = V * (28 - E)
</span><span id="__span-83-10"><a id="__codelineno-83-10" name="__codelineno-83-10" href="#__codelineno-83-10"></a>    return [dV_dt, dE_dt]
</span><span id="__span-83-11"><a id="__codelineno-83-11" name="__codelineno-83-11" href="#__codelineno-83-11"></a>
</span><span id="__span-83-12"><a id="__codelineno-83-12" name="__codelineno-83-12" href="#__codelineno-83-12"></a># 初始条件和时间范围
</span><span id="__span-83-13"><a id="__codelineno-83-13" name="__codelineno-83-13" href="#__codelineno-83-13"></a>y0 = [0.0, 1.0]  # 初始状态[V0, E0]
</span><span id="__span-83-14"><a id="__codelineno-83-14" name="__codelineno-83-14" href="#__codelineno-83-14"></a>t = np.linspace(0, 200, 1001)  # 时间范围
</span><span id="__span-83-15"><a id="__codelineno-83-15" name="__codelineno-83-15" href="#__codelineno-83-15"></a>
</span><span id="__span-83-16"><a id="__codelineno-83-16" name="__codelineno-83-16" href="#__codelineno-83-16"></a># 使用odeint解微分方程
</span><span id="__span-83-17"><a id="__codelineno-83-17" name="__codelineno-83-17" href="#__codelineno-83-17"></a>solution = odeint(model, y0, t)
</span><span id="__span-83-18"><a id="__codelineno-83-18" name="__codelineno-83-18" href="#__codelineno-83-18"></a>
</span><span id="__span-83-19"><a id="__codelineno-83-19" name="__codelineno-83-19" href="#__codelineno-83-19"></a># 画图
</span><span id="__span-83-20"><a id="__codelineno-83-20" name="__codelineno-83-20" href="#__codelineno-83-20"></a>plt.figure()
</span><span id="__span-83-21"><a id="__codelineno-83-21" name="__codelineno-83-21" href="#__codelineno-83-21"></a>plt.plot(t, solution[:, 0], label=&#39;V(t)&#39;)
</span><span id="__span-83-22"><a id="__codelineno-83-22" name="__codelineno-83-22" href="#__codelineno-83-22"></a>plt.plot(t, solution[:, 1], label=&#39;E(t)&#39;)
</span><span id="__span-83-23"><a id="__codelineno-83-23" name="__codelineno-83-23" href="#__codelineno-83-23"></a>plt.xlabel(&#39;t&#39;)
</span><span id="__span-83-24"><a id="__codelineno-83-24" name="__codelineno-83-24" href="#__codelineno-83-24"></a>plt.ylabel(&#39;Value&#39;)
</span><span id="__span-83-25"><a id="__codelineno-83-25" name="__codelineno-83-25" href="#__codelineno-83-25"></a>plt.title(&#39;Solution of the differential equations&#39;)
</span><span id="__span-83-26"><a id="__codelineno-83-26" name="__codelineno-83-26" href="#__codelineno-83-26"></a>plt.legend()
</span><span id="__span-83-27"><a id="__codelineno-83-27" name="__codelineno-83-27" href="#__codelineno-83-27"></a>plt.show()
</span></code></pre></div>
<h5 id="misc">misc</h5>
<p>scipy在新版本的misc库中弃用(imread，imresize，imsave)函数
解决办法1：降低scipy的版本 <code>pip install scipy==1.2.1</code>
解决方法2：更换库</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="c1"># from scipy import misc </span>
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a><span class="c1"># img = misc.imread(image_path)</span>
</span><span id="__span-84-3"><a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">imageio</span>
</span><span id="__span-84-4"><a id="__codelineno-84-4" name="__codelineno-84-4" href="#__codelineno-84-4"></a><span class="n">img</span> <span class="o">=</span> <span class="n">imageio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
</span><span id="__span-84-5"><a id="__codelineno-84-5" name="__codelineno-84-5" href="#__codelineno-84-5"></a>
</span><span id="__span-84-6"><a id="__codelineno-84-6" name="__codelineno-84-6" href="#__codelineno-84-6"></a><span class="c1"># from scipy import misc </span>
</span><span id="__span-84-7"><a id="__codelineno-84-7" name="__codelineno-84-7" href="#__codelineno-84-7"></a><span class="c1"># scaled_temp = misc.imresize(cropped_temp, (image_size, image_size), interp=&#39;bilinear&#39;)</span>
</span><span id="__span-84-8"><a id="__codelineno-84-8" name="__codelineno-84-8" href="#__codelineno-84-8"></a><span class="kn">from</span><span class="w"> </span><span class="nn">skimage.transform</span><span class="w"> </span><span class="kn">import</span> <span class="n">resize</span> 
</span><span id="__span-84-9"><a id="__codelineno-84-9" name="__codelineno-84-9" href="#__codelineno-84-9"></a><span class="n">scaled_temp</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">cropped_temp</span><span class="p">,</span><span class="n">output_shape</span><span class="o">=</span><span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="n">image_size</span><span class="p">))</span>
</span><span id="__span-84-10"><a id="__codelineno-84-10" name="__codelineno-84-10" href="#__codelineno-84-10"></a>
</span><span id="__span-84-11"><a id="__codelineno-84-11" name="__codelineno-84-11" href="#__codelineno-84-11"></a><span class="c1"># from scipy import misc </span>
</span><span id="__span-84-12"><a id="__codelineno-84-12" name="__codelineno-84-12" href="#__codelineno-84-12"></a><span class="c1"># misc.imsave(output_filename, scaled_temp)</span>
</span><span id="__span-84-13"><a id="__codelineno-84-13" name="__codelineno-84-13" href="#__codelineno-84-13"></a><span class="kn">import</span><span class="w"> </span><span class="nn">imageio</span> 
</span><span id="__span-84-14"><a id="__codelineno-84-14" name="__codelineno-84-14" href="#__codelineno-84-14"></a><span class="n">imageio</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">output_filename</span><span class="p">,</span><span class="n">scaled_temp</span><span class="p">)</span>
</span></code></pre></div>
<h5 id="ndimage">ndimage</h5>
<div class="language-python highlight"><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">scipy.ndimage</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nd</span>
</span><span id="__span-85-2"><a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a><span class="n">img_array_rotate</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">img_array</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">cval</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">reshape</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="__span-85-3"><a id="__codelineno-85-3" name="__codelineno-85-3" href="#__codelineno-85-3"></a><span class="c1"># 把图片数组逆时针旋转10度</span>
</span></code></pre></div>
<h5 id="sympy">SymPy（符号计算）</h5>
<p>SymPy 是一个由 Python 语言编写的符号计算库。
SageMath 便是将 SymPy 作为其子模块，然后再加入其他模块，构建出一个功能齐全的数学软件。</p>
<p>处理数学对象的计算称为符号计算。在符号计算中，数学对象是精确表示的，而不是近似的，未计算的数学表达式会以符号形式保留。
例如：数值计算结果无法精确地表示出 sin⁡π，只能用一个很小的浮点数 (1.22×10−16) 表示，而符号计算结果则得出 sin⁡π=0</p>
<p>计算机代数系统（Computer Algebra System，缩写作：CAS）是进行符号运算的软件。在计算机代数系统中运算的对象是数学表达式</p>
<h4 id="numbacython">numba、Cython</h4>
<p>python由于它动态解释性语言的特性，跑起代码来相比java、c++要慢很多，尤其在做科学计算的时候，十亿百亿级别的运算，让python的这种劣势更加凸显。</p>
<p>numba是一款可以将python函数编译为机器代码的JIT编译器，经过numba编译的python代码（仅限数组运算），其运行速度可以接近C或FORTRAN语言。</p>
<p>JIT 即时编译技术是在运行时（runtime）将调用的函数或程序段编译成机器码载入内存，以加快程序的执行。
python之所以慢，是因为它是靠CPython编译的，numba的作用是给python换一种编译器。numba 就是通过 JIT 加速了 python 代码</p>
<p>Numba是一款可以将python函数编译为机器代码的JIT编译器，经过Numba编译的python代码（仅限数组运算），其运行速度可以接近C或FORTRAN语言。普通python语言靠CPython编译的，但是Numba使用Jit编译器可以直接将一个函数转化为机器码。</p>
<p>使用numpy数组做大量科学计算时
使用for循环时</p>
<p>明确指定数据类型加速才快
如np.array([], np.float64)</p>
<h3 id="_48">可视化</h3>
<p><strong>Matplotlib、Pyecharts、Seaborn、Plotly、Bokeh</strong></p>
<h4 id="matplotlib">matplotlib（数据可视化）</h4>
<p>Matplotlib 是 Python 的绘图库，它能让使用者很轻松地将数据图形化，并且提供多样化的输出格式。</p>
<ul>
<li><code>plot()</code>：用于绘制线图和散点图</li>
<li><code>scatter()</code>：用于绘制散点图</li>
<li><code>bar()</code>：用于绘制垂直条形图和水平条形图</li>
<li><code>hist()</code>：用于绘制直方图</li>
<li><code>pie()</code>：用于绘制饼图</li>
<li><code>imshow()</code>：用于绘制图像</li>
<li><code>subplots()</code>：用于创建子图</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
</span><span id="__span-86-2"><a id="__codelineno-86-2" name="__codelineno-86-2" href="#__codelineno-86-2"></a><span class="c1"># 指定默认字体：解决plot不能显示中文问题</span>
</span><span id="__span-86-3"><a id="__codelineno-86-3" name="__codelineno-86-3" href="#__codelineno-86-3"></a><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Microsoft YaHei&#39;</span><span class="p">]</span>
</span><span id="__span-86-4"><a id="__codelineno-86-4" name="__codelineno-86-4" href="#__codelineno-86-4"></a><span class="c1"># 解决保存图像是负号&#39;-&#39;显示为方块的问题</span>
</span><span id="__span-86-5"><a id="__codelineno-86-5" name="__codelineno-86-5" href="#__codelineno-86-5"></a><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.unicode_minus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-86-6"><a id="__codelineno-86-6" name="__codelineno-86-6" href="#__codelineno-86-6"></a>
</span><span id="__span-86-7"><a id="__codelineno-86-7" name="__codelineno-86-7" href="#__codelineno-86-7"></a><span class="c1"># 黑体 SimHei</span>
</span><span id="__span-86-8"><a id="__codelineno-86-8" name="__codelineno-86-8" href="#__codelineno-86-8"></a><span class="c1"># 微软雅黑 Microsoft YaHei</span>
</span><span id="__span-86-9"><a id="__codelineno-86-9" name="__codelineno-86-9" href="#__codelineno-86-9"></a><span class="c1"># 微软正黑体 Microsoft JHengHei</span>
</span><span id="__span-86-10"><a id="__codelineno-86-10" name="__codelineno-86-10" href="#__codelineno-86-10"></a><span class="c1"># 新宋体 NSimSun</span>
</span><span id="__span-86-11"><a id="__codelineno-86-11" name="__codelineno-86-11" href="#__codelineno-86-11"></a><span class="c1"># 新细明体 PMingLiU</span>
</span><span id="__span-86-12"><a id="__codelineno-86-12" name="__codelineno-86-12" href="#__codelineno-86-12"></a><span class="c1"># 细明体 MingLiU</span>
</span><span id="__span-86-13"><a id="__codelineno-86-13" name="__codelineno-86-13" href="#__codelineno-86-13"></a><span class="c1"># 标楷体 DFKai-SB</span>
</span><span id="__span-86-14"><a id="__codelineno-86-14" name="__codelineno-86-14" href="#__codelineno-86-14"></a><span class="c1"># 仿宋 FangSong</span>
</span><span id="__span-86-15"><a id="__codelineno-86-15" name="__codelineno-86-15" href="#__codelineno-86-15"></a><span class="c1"># 楷体 KaiTi</span>
</span><span id="__span-86-16"><a id="__codelineno-86-16" name="__codelineno-86-16" href="#__codelineno-86-16"></a><span class="c1"># 仿宋-GB2312 FangSong_GB2312</span>
</span><span id="__span-86-17"><a id="__codelineno-86-17" name="__codelineno-86-17" href="#__codelineno-86-17"></a><span class="c1"># 楷体-GB2312 KaiTi_GB2312</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a><span class="c1"># 使用原始字符串和 $ 符号在 matplotlib 中显示希腊字母</span>
</span><span id="__span-87-2"><a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\alpha$&quot;</span><span class="p">)</span>
</span><span id="__span-87-3"><a id="__codelineno-87-3" name="__codelineno-87-3" href="#__codelineno-87-3"></a><span class="c1"># 使用 `chr()` 函数</span>
</span><span id="__span-87-4"><a id="__codelineno-87-4" name="__codelineno-87-4" href="#__codelineno-87-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="mi">945</span><span class="p">))</span>
</span><span id="__span-87-5"><a id="__codelineno-87-5" name="__codelineno-87-5" href="#__codelineno-87-5"></a><span class="c1"># 在 Python 3 及以上版本可以直接使用希腊字母</span>
</span><span id="__span-87-6"><a id="__codelineno-87-6" name="__codelineno-87-6" href="#__codelineno-87-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;α&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h5 id="pyplot">Pyplot</h5>
<p>画各种静态图</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a><span class="c1"># 设置一个 1200 x 600 的画布</span>
</span><span id="__span-88-2"><a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="__span-88-3"><a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a><span class="c1"># 全局设置画布大小 1280 x 720 像素</span>
</span><span id="__span-88-4"><a id="__codelineno-88-4" name="__codelineno-88-4" href="#__codelineno-88-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="mf">12.8</span><span class="p">,</span> <span class="mf">7.2</span><span class="p">)</span>
</span><span id="__span-88-5"><a id="__codelineno-88-5" name="__codelineno-88-5" href="#__codelineno-88-5"></a><span class="c1"># 使用样式表文件style.mpstyle，文件内容：figure.figsize:12.8,7.2</span>
</span><span id="__span-88-6"><a id="__codelineno-88-6" name="__codelineno-88-6" href="#__codelineno-88-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;style.mpstyle&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p>将画布保存为'xiang.png'，还可以保存为jpg、svg格式图片
plt.savefig('xiang.png')</p>
<h6 id="plot">plot()</h6>
<p><code>plot([x], y, [fmt], [x2], y2, [fmt2], ..., **kwargs)</code></p>
<ul>
<li><code>x, y</code>：点或线的节点，x 为 x 轴数据，y 为 y 轴数据，数据可以列表或数组</li>
<li><code>fmt</code>：可选，定义基本格式 <code>'[marker][line][color]'</code></li>
<li>标记样式：'.' 点标记，',' 像素标记(极小点)，'o' 实心圈标记，'v' 倒三角标记，'^' 上三角标记，'&gt;' 右三角标记，'&lt;' 左三角标记...</li>
<li>线的类型：'‐' 实线，'‐‐' 破折线，'‐.' 点划线，':' 虚线。</li>
<li>标记和线的颜色：'b' 蓝色，'m' 洋红色，'g' 绿色，'y' 黄色，'r' 红色，'k' 黑色，'w' 白色，'c' 青绿色，'#008000' RGB 颜色符串。多条曲线不指定颜色时，会自动选择不同颜色</li>
<li><code>**kwargs</code>：可选，用在二维平面图上，设置指定属性，如标签，线的宽度等</li>
<li><code>marker</code>标记样式;<code>ms</code>标记的大小;<code>mfc</code>标记内部的颜色;<code>mec</code>标记边框的颜色</li>
<li><code>ls</code>线的类型;<code>c</code>线的颜色;<code>lw</code>线的宽度</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-89-2"><a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-89-3"><a id="__codelineno-89-3" name="__codelineno-89-3" href="#__codelineno-89-3"></a>
</span><span id="__span-89-4"><a id="__codelineno-89-4" name="__codelineno-89-4" href="#__codelineno-89-4"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="__span-89-5"><a id="__codelineno-89-5" name="__codelineno-89-5" href="#__codelineno-89-5"></a><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-89-6"><a id="__codelineno-89-6" name="__codelineno-89-6" href="#__codelineno-89-6"></a>
</span><span id="__span-89-7"><a id="__codelineno-89-7" name="__codelineno-89-7" href="#__codelineno-89-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;#fff&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-89-8"><a id="__codelineno-89-8" name="__codelineno-89-8" href="#__codelineno-89-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p>绘制多个图形 <code>plt.subplot()</code></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-90-2"><a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a>
</span><span id="__span-90-3"><a id="__codelineno-90-3" name="__codelineno-90-3" href="#__codelineno-90-3"></a><span class="c1"># 第一个图形的数据</span>
</span><span id="__span-90-4"><a id="__codelineno-90-4" name="__codelineno-90-4" href="#__codelineno-90-4"></a><span class="n">x1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</span><span id="__span-90-5"><a id="__codelineno-90-5" name="__codelineno-90-5" href="#__codelineno-90-5"></a><span class="n">y1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
</span><span id="__span-90-6"><a id="__codelineno-90-6" name="__codelineno-90-6" href="#__codelineno-90-6"></a>
</span><span id="__span-90-7"><a id="__codelineno-90-7" name="__codelineno-90-7" href="#__codelineno-90-7"></a><span class="c1"># 第二个图形的数据</span>
</span><span id="__span-90-8"><a id="__codelineno-90-8" name="__codelineno-90-8" href="#__codelineno-90-8"></a><span class="n">x2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</span><span id="__span-90-9"><a id="__codelineno-90-9" name="__codelineno-90-9" href="#__codelineno-90-9"></a><span class="n">y2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
</span><span id="__span-90-10"><a id="__codelineno-90-10" name="__codelineno-90-10" href="#__codelineno-90-10"></a>
</span><span id="__span-90-11"><a id="__codelineno-90-11" name="__codelineno-90-11" href="#__codelineno-90-11"></a><span class="c1"># 创建图形</span>
</span><span id="__span-90-12"><a id="__codelineno-90-12" name="__codelineno-90-12" href="#__codelineno-90-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="__span-90-13"><a id="__codelineno-90-13" name="__codelineno-90-13" href="#__codelineno-90-13"></a>
</span><span id="__span-90-14"><a id="__codelineno-90-14" name="__codelineno-90-14" href="#__codelineno-90-14"></a><span class="c1"># 绘制第一个图形</span>
</span><span id="__span-90-15"><a id="__codelineno-90-15" name="__codelineno-90-15" href="#__codelineno-90-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># 表示2行1列的子图，当前为第1个</span>
</span><span id="__span-90-16"><a id="__codelineno-90-16" name="__codelineno-90-16" href="#__codelineno-90-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>  <span class="c1"># &#39;r-&#39;表示红色实线</span>
</span><span id="__span-90-17"><a id="__codelineno-90-17" name="__codelineno-90-17" href="#__codelineno-90-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;First Plot&#39;</span><span class="p">)</span>  <span class="c1"># 添加标题</span>
</span><span id="__span-90-18"><a id="__codelineno-90-18" name="__codelineno-90-18" href="#__codelineno-90-18"></a>
</span><span id="__span-90-19"><a id="__codelineno-90-19" name="__codelineno-90-19" href="#__codelineno-90-19"></a><span class="c1"># 绘制第二个图形</span>
</span><span id="__span-90-20"><a id="__codelineno-90-20" name="__codelineno-90-20" href="#__codelineno-90-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># 表示2行1列的子图，当前为第2个</span>
</span><span id="__span-90-21"><a id="__codelineno-90-21" name="__codelineno-90-21" href="#__codelineno-90-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>  <span class="c1"># &#39;b-&#39;表示蓝色实线</span>
</span><span id="__span-90-22"><a id="__codelineno-90-22" name="__codelineno-90-22" href="#__codelineno-90-22"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Second Plot&#39;</span><span class="p">)</span>  <span class="c1"># 添加标题</span>
</span><span id="__span-90-23"><a id="__codelineno-90-23" name="__codelineno-90-23" href="#__codelineno-90-23"></a>
</span><span id="__span-90-24"><a id="__codelineno-90-24" name="__codelineno-90-24" href="#__codelineno-90-24"></a><span class="c1"># 显示图形</span>
</span><span id="__span-90-25"><a id="__codelineno-90-25" name="__codelineno-90-25" href="#__codelineno-90-25"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-90-26"><a id="__codelineno-90-26" name="__codelineno-90-26" href="#__codelineno-90-26"></a>
</span><span id="__span-90-27"><a id="__codelineno-90-27" name="__codelineno-90-27" href="#__codelineno-90-27"></a><span class="c1"># --------------设置子图标题-----------------</span>
</span><span id="__span-90-28"><a id="__codelineno-90-28" name="__codelineno-90-28" href="#__codelineno-90-28"></a><span class="c1"># 创建一个2x2的子图网格</span>
</span><span id="__span-90-29"><a id="__codelineno-90-29" name="__codelineno-90-29" href="#__codelineno-90-29"></a><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-90-30"><a id="__codelineno-90-30" name="__codelineno-90-30" href="#__codelineno-90-30"></a>
</span><span id="__span-90-31"><a id="__codelineno-90-31" name="__codelineno-90-31" href="#__codelineno-90-31"></a><span class="c1"># 为每个子图设置标题</span>
</span><span id="__span-90-32"><a id="__codelineno-90-32" name="__codelineno-90-32" href="#__codelineno-90-32"></a><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;第一个子图的标题&#39;</span><span class="p">)</span>
</span><span id="__span-90-33"><a id="__codelineno-90-33" name="__codelineno-90-33" href="#__codelineno-90-33"></a><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;第二个子图的标题&#39;</span><span class="p">)</span>
</span><span id="__span-90-34"><a id="__codelineno-90-34" name="__codelineno-90-34" href="#__codelineno-90-34"></a><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;第三个子图的标题&#39;</span><span class="p">)</span>
</span><span id="__span-90-35"><a id="__codelineno-90-35" name="__codelineno-90-35" href="#__codelineno-90-35"></a><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;第四个子图的标题&#39;</span><span class="p">)</span>
</span><span id="__span-90-36"><a id="__codelineno-90-36" name="__codelineno-90-36" href="#__codelineno-90-36"></a>
</span><span id="__span-90-37"><a id="__codelineno-90-37" name="__codelineno-90-37" href="#__codelineno-90-37"></a><span class="c1"># 显示图形</span>
</span><span id="__span-90-38"><a id="__codelineno-90-38" name="__codelineno-90-38" href="#__codelineno-90-38"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p>可以通过指定 <code>plt.xlim()</code> 和 <code>plt.ylim()</code> 来设置绘图区域的x轴和y轴范围 <code>axis</code>
<code>plt.xticks()</code> 和 <code>plt.yticks()</code> 调整x轴和y轴的标签值
<code>plt.xlabel</code> 设置坐标轴标题
hold on\hold off\drawnow
xticks(ticks, [labels], <strong>kwargs)
ticks：数组类型，用于设置X轴刻度间隔
[labels]：数组类型，用于设置每个间隔的显示标签
</strong>kwargs：用于设置标签字体倾斜度和颜色等外观属性。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-91-2"><a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">animation</span>
</span><span id="__span-91-3"><a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-91-4"><a id="__codelineno-91-4" name="__codelineno-91-4" href="#__codelineno-91-4"></a>
</span><span id="__span-91-5"><a id="__codelineno-91-5" name="__codelineno-91-5" href="#__codelineno-91-5"></a><span class="c1"># 初始化数据</span>
</span><span id="__span-91-6"><a id="__codelineno-91-6" name="__codelineno-91-6" href="#__codelineno-91-6"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
</span><span id="__span-91-7"><a id="__codelineno-91-7" name="__codelineno-91-7" href="#__codelineno-91-7"></a><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-91-8"><a id="__codelineno-91-8" name="__codelineno-91-8" href="#__codelineno-91-8"></a><span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="__span-91-9"><a id="__codelineno-91-9" name="__codelineno-91-9" href="#__codelineno-91-9"></a>
</span><span id="__span-91-10"><a id="__codelineno-91-10" name="__codelineno-91-10" href="#__codelineno-91-10"></a><span class="c1"># 更新数据的函数</span>
</span><span id="__span-91-11"><a id="__codelineno-91-11" name="__codelineno-91-11" href="#__codelineno-91-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span id="__span-91-12"><a id="__codelineno-91-12" name="__codelineno-91-12" href="#__codelineno-91-12"></a>    <span class="k">global</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</span><span id="__span-91-13"><a id="__codelineno-91-13" name="__codelineno-91-13" href="#__codelineno-91-13"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">data</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="__span-91-14"><a id="__codelineno-91-14" name="__codelineno-91-14" href="#__codelineno-91-14"></a>    <span class="n">line</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="__span-91-15"><a id="__codelineno-91-15" name="__codelineno-91-15" href="#__codelineno-91-15"></a>    <span class="k">return</span> <span class="n">line</span><span class="p">,</span>
</span><span id="__span-91-16"><a id="__codelineno-91-16" name="__codelineno-91-16" href="#__codelineno-91-16"></a>
</span><span id="__span-91-17"><a id="__codelineno-91-17" name="__codelineno-91-17" href="#__codelineno-91-17"></a><span class="c1"># 创建动画</span>
</span><span id="__span-91-18"><a id="__codelineno-91-18" name="__codelineno-91-18" href="#__codelineno-91-18"></a><span class="k">def</span><span class="w"> </span><span class="nf">animate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span id="__span-91-19"><a id="__codelineno-91-19" name="__codelineno-91-19" href="#__codelineno-91-19"></a>    <span class="n">anim</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">(),</span> <span class="n">update</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="__span-91-20"><a id="__codelineno-91-20" name="__codelineno-91-20" href="#__codelineno-91-20"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-91-21"><a id="__codelineno-91-21" name="__codelineno-91-21" href="#__codelineno-91-21"></a>
</span><span id="__span-91-22"><a id="__codelineno-91-22" name="__codelineno-91-22" href="#__codelineno-91-22"></a><span class="c1"># 运行动画</span>
</span><span id="__span-91-23"><a id="__codelineno-91-23" name="__codelineno-91-23" href="#__codelineno-91-23"></a><span class="n">animate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-91-24"><a id="__codelineno-91-24" name="__codelineno-91-24" href="#__codelineno-91-24"></a>
</span><span id="__span-91-25"><a id="__codelineno-91-25" name="__codelineno-91-25" href="#__codelineno-91-25"></a><span class="c1">#---matlab</span>
</span><span id="__span-91-26"><a id="__codelineno-91-26" name="__codelineno-91-26" href="#__codelineno-91-26"></a><span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span> <span class="o">%</span> <span class="n">创建一个线性空间向量</span>
</span><span id="__span-91-27"><a id="__codelineno-91-27" name="__codelineno-91-27" href="#__codelineno-91-27"></a><span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="o">%</span> <span class="n">计算正弦值</span>
</span><span id="__span-91-28"><a id="__codelineno-91-28" name="__codelineno-91-28" href="#__codelineno-91-28"></a>
</span><span id="__span-91-29"><a id="__codelineno-91-29" name="__codelineno-91-29" href="#__codelineno-91-29"></a><span class="n">figure</span><span class="p">;</span> <span class="o">%</span> <span class="n">创建一个新的图形窗口</span>
</span><span id="__span-91-30"><a id="__codelineno-91-30" name="__codelineno-91-30" href="#__codelineno-91-30"></a><span class="n">axis</span><span class="p">([</span><span class="mi">0</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">1</span><span class="p">]);</span> <span class="o">%</span> <span class="n">设置坐标轴范围</span>
</span><span id="__span-91-31"><a id="__codelineno-91-31" name="__codelineno-91-31" href="#__codelineno-91-31"></a><span class="n">hold</span> <span class="n">on</span><span class="p">;</span> <span class="o">%</span> <span class="n">保持当前图形</span><span class="err">，</span><span class="n">以便添加新的数据</span>
</span><span id="__span-91-32"><a id="__codelineno-91-32" name="__codelineno-91-32" href="#__codelineno-91-32"></a>
</span><span id="__span-91-33"><a id="__codelineno-91-33" name="__codelineno-91-33" href="#__codelineno-91-33"></a><span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-91-34"><a id="__codelineno-91-34" name="__codelineno-91-34" href="#__codelineno-91-34"></a>    <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">);</span> <span class="o">%</span> <span class="n">绘制到当前点的正弦曲线</span>
</span><span id="__span-91-35"><a id="__codelineno-91-35" name="__codelineno-91-35" href="#__codelineno-91-35"></a>    <span class="n">drawnow</span><span class="p">;</span> <span class="o">%</span> <span class="n">强制图形更新</span>
</span><span id="__span-91-36"><a id="__codelineno-91-36" name="__codelineno-91-36" href="#__codelineno-91-36"></a>    <span class="n">pause</span><span class="p">(</span><span class="mf">0.05</span><span class="p">);</span> <span class="o">%</span> <span class="n">暂停一小段时间以创建动画效果</span>
</span><span id="__span-91-37"><a id="__codelineno-91-37" name="__codelineno-91-37" href="#__codelineno-91-37"></a><span class="n">end</span>
</span><span id="__span-91-38"><a id="__codelineno-91-38" name="__codelineno-91-38" href="#__codelineno-91-38"></a><span class="n">hold</span> <span class="n">off</span><span class="p">;</span> <span class="o">%</span> <span class="n">关闭hold状态</span>
</span></code></pre></div>
<p>figure对象 <code>fig=plt.figure(figsize=(6,3))</code> figsize设置窗口大小
图例通过 <code>plt.legend()</code>实现，标题通过 <code>plt.suptitle("这是图像标题")</code>和 <code>plt.title("这是子图标题")</code>实现（其实是调用了当前figure对象的suptitle方法）
获取默认窗口标题 <code>fig.canvas.manager.window.windowTitle()</code> 修改窗口标题可以使用 <code>fig.canvas.set_window_title("这是窗口标题")</code> 或 <code>fig.canvas.manager.window.setWindowTitle("这是窗口标题")</code></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-92-1"><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
</span><span id="__span-92-2"><a id="__codelineno-92-2" name="__codelineno-92-2" href="#__codelineno-92-2"></a>
</span><span id="__span-92-3"><a id="__codelineno-92-3" name="__codelineno-92-3" href="#__codelineno-92-3"></a><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.sans-serif&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SimHei&quot;</span><span class="p">]</span>
</span><span id="__span-92-4"><a id="__codelineno-92-4" name="__codelineno-92-4" href="#__codelineno-92-4"></a><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;axes.unicode_minus&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-92-5"><a id="__codelineno-92-5" name="__codelineno-92-5" href="#__codelineno-92-5"></a>
</span><span id="__span-92-6"><a id="__codelineno-92-6" name="__codelineno-92-6" href="#__codelineno-92-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-92-7"><a id="__codelineno-92-7" name="__codelineno-92-7" href="#__codelineno-92-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-92-8"><a id="__codelineno-92-8" name="__codelineno-92-8" href="#__codelineno-92-8"></a>
</span><span id="__span-92-9"><a id="__codelineno-92-9" name="__codelineno-92-9" href="#__codelineno-92-9"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
</span><span id="__span-92-10"><a id="__codelineno-92-10" name="__codelineno-92-10" href="#__codelineno-92-10"></a><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-92-11"><a id="__codelineno-92-11" name="__codelineno-92-11" href="#__codelineno-92-11"></a><span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-92-12"><a id="__codelineno-92-12" name="__codelineno-92-12" href="#__codelineno-92-12"></a>
</span><span id="__span-92-13"><a id="__codelineno-92-13" name="__codelineno-92-13" href="#__codelineno-92-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\sin(x)$&quot;</span><span class="p">)</span>
</span><span id="__span-92-14"><a id="__codelineno-92-14" name="__codelineno-92-14" href="#__codelineno-92-14"></a><span class="c1"># 用r”$text1$”对文本内容text进行渲染，有r表示该字符串是raw strings，字符串按照TeX规范进行解析</span>
</span><span id="__span-92-15"><a id="__codelineno-92-15" name="__codelineno-92-15" href="#__codelineno-92-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\cos(x)$&quot;</span><span class="p">)</span>
</span><span id="__span-92-16"><a id="__codelineno-92-16" name="__codelineno-92-16" href="#__codelineno-92-16"></a>
</span><span id="__span-92-17"><a id="__codelineno-92-17" name="__codelineno-92-17" href="#__codelineno-92-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="__span-92-18"><a id="__codelineno-92-18" name="__codelineno-92-18" href="#__codelineno-92-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;正弦函数和余弦函数的折线图&quot;</span><span class="p">)</span> <span class="c1"># 添加标题</span>
</span><span id="__span-92-19"><a id="__codelineno-92-19" name="__codelineno-92-19" href="#__codelineno-92-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><code>matplotlib.pyplot.grid(b=None, which='major', axis='both', )</code>
b：可选，默认为 None，可以设置布尔值，true 为显示网格线，false 为不显示，如果设置 <strong>kwargs 参数，则值为 true。
which：可选，可选值有 'major'、'minor' 和 'both'，默认为 'major'，表示应用更改的网格线。
axis：可选，设置显示哪个方向的网格线，可以是取 'both'（默认），'x' 或 'y'，分别表示两个方向，x 轴方向或 y 轴方向。
</strong>kwargs：可选，设置网格样式，可以是 color='r', linestyle='-' 和 linewidth=2，分别表示网格线的颜色，样式和宽度。</p>
<h6 id="imshow">imshow()</h6>
<p>imshow() 函数是 Matplotlib 库中的一个函数，用于显示图像。
imshow() 函数常用于绘制二维的灰度图像或彩色图像。
imshow() 函数可用于绘制矩阵、热力图、地图等。</p>
<p><code>imshow(X, cmap=None, norm=None, aspect=None, interpolation=None, alpha=None, vmin=None, vmax=None, origin=None, extent=None, shape=None, filternorm=1, filterrad=4.0, imlim=None, resample=None, url=None, *, data=None, **kwargs)</code></p>
<p><strong>参数说明：</strong></p>
<ul>
<li><code>X</code>：输入数据。可以是二维数组、三维数组、PIL图像对象、matplotlib路径对象等。</li>
<li><code>cmap</code>：颜色映射。用于控制图像中不同数值所对应的颜色。可以选择内置的颜色映射，如 <code>gray</code>、<code>hot</code>、<code>jet</code>等，也可以自定义颜色映射。</li>
<li><code>norm</code>：用于控制数值的归一化方式。可以选择 <code>Normalize</code>、<code>LogNorm</code>等归一化方法。</li>
<li><code>aspect</code>：控制图像纵横比（aspect ratio）。可以设置为 <code>auto</code>或一个数字。</li>
<li><code>interpolation</code>：插值方法。用于控制图像的平滑程度和细节程度。可以选择 <code>nearest</code>、<code>bilinear</code>、<code>bicubic</code>等插值方法。</li>
<li><code>alpha</code>：图像透明度。取值范围为0~1。</li>
<li><code>origin</code>：坐标轴原点的位置。可以设置为 <code>upper</code>或 <code>lower</code>。</li>
<li><code>extent</code>：控制显示的数据范围。可以设置为 <code>[xmin, xmax, ymin, ymax]</code>。</li>
<li><code>vmin</code>、<code>vmax</code>：控制颜色映射的值域范围。</li>
<li><code>filternorm 和 filterrad</code>：用于图像滤波的对象。可以设置为 <code>None</code>、<code>antigrain</code>、<code>freetype</code>等。</li>
<li><code>imlim</code>： 用于指定图像显示范围。</li>
<li><code>resample</code>：用于指定图像重采样方式。</li>
<li><code>url</code>：用于指定图像链接。</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-93-1"><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-93-2"><a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-93-3"><a id="__codelineno-93-3" name="__codelineno-93-3" href="#__codelineno-93-3"></a>
</span><span id="__span-93-4"><a id="__codelineno-93-4" name="__codelineno-93-4" href="#__codelineno-93-4"></a><span class="c1"># 生成一个二维随机数组</span>
</span><span id="__span-93-5"><a id="__codelineno-93-5" name="__codelineno-93-5" href="#__codelineno-93-5"></a><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="__span-93-6"><a id="__codelineno-93-6" name="__codelineno-93-6" href="#__codelineno-93-6"></a><span class="c1"># 绘制灰度图像</span>
</span><span id="__span-93-7"><a id="__codelineno-93-7" name="__codelineno-93-7" href="#__codelineno-93-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
</span><span id="__span-93-8"><a id="__codelineno-93-8" name="__codelineno-93-8" href="#__codelineno-93-8"></a><span class="c1"># 隐藏坐标轴  </span>
</span><span id="__span-93-9"><a id="__codelineno-93-9" name="__codelineno-93-9" href="#__codelineno-93-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</span><span id="__span-93-10"><a id="__codelineno-93-10" name="__codelineno-93-10" href="#__codelineno-93-10"></a><span class="c1"># 显示图像</span>
</span><span id="__span-93-11"><a id="__codelineno-93-11" name="__codelineno-93-11" href="#__codelineno-93-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<h5 id="animation">animation</h5>
<p><code>FuncAnimation(fig, func, frames, init_func, interval, blit)</code>
主要参数的含义如下</p>
<ul>
<li>fig: 绘制动图的画布名称</li>
<li>func: 回调函数，每次更新时调用，即下边程序定义的函数update，可以在这个方法中更新 line2d 对象。</li>
<li>frames: 真个动画 frame 的取值范围，在函数运行时，其值会传递给函数 update(n) 的形参 n。</li>
<li>init_func: 自定义开始帧，即传入刚定义的函数init,初始化函数。</li>
<li>interval: frame之间的更新频率，以 ms 计。</li>
</ul>
<p>用 FuncAnimation 生成的动图，如果要存 mp4，需要安装 ffmpeg，如果要存 gif，需要安装 imagemagick
ani.save("animation.mp4", fps=20, writer="ffmpeg")
ani.save("animation.gif", fps=50, writer="imagemagick")</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-94-1"><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-94-2"><a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-94-3"><a id="__codelineno-94-3" name="__codelineno-94-3" href="#__codelineno-94-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="kn">import</span> <span class="n">FuncAnimation</span>
</span><span id="__span-94-4"><a id="__codelineno-94-4" name="__codelineno-94-4" href="#__codelineno-94-4"></a>
</span><span id="__span-94-5"><a id="__codelineno-94-5" name="__codelineno-94-5" href="#__codelineno-94-5"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="__span-94-6"><a id="__codelineno-94-6" name="__codelineno-94-6" href="#__codelineno-94-6"></a><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-94-7"><a id="__codelineno-94-7" name="__codelineno-94-7" href="#__codelineno-94-7"></a>
</span><span id="__span-94-8"><a id="__codelineno-94-8" name="__codelineno-94-8" href="#__codelineno-94-8"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
</span><span id="__span-94-9"><a id="__codelineno-94-9" name="__codelineno-94-9" href="#__codelineno-94-9"></a><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
</span><span id="__span-94-10"><a id="__codelineno-94-10" name="__codelineno-94-10" href="#__codelineno-94-10"></a><span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;cornflowerblue&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span><span id="__span-94-11"><a id="__codelineno-94-11" name="__codelineno-94-11" href="#__codelineno-94-11"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
</span><span id="__span-94-12"><a id="__codelineno-94-12" name="__codelineno-94-12" href="#__codelineno-94-12"></a>
</span><span id="__span-94-13"><a id="__codelineno-94-13" name="__codelineno-94-13" href="#__codelineno-94-13"></a><span class="c1"># 清空当前帧</span>
</span><span id="__span-94-14"><a id="__codelineno-94-14" name="__codelineno-94-14" href="#__codelineno-94-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">init</span><span class="p">():</span>
</span><span id="__span-94-15"><a id="__codelineno-94-15" name="__codelineno-94-15" href="#__codelineno-94-15"></a>    <span class="n">line</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="__span-94-16"><a id="__codelineno-94-16" name="__codelineno-94-16" href="#__codelineno-94-16"></a>    <span class="k">return</span> <span class="n">line</span><span class="p">,</span>
</span><span id="__span-94-17"><a id="__codelineno-94-17" name="__codelineno-94-17" href="#__codelineno-94-17"></a>
</span><span id="__span-94-18"><a id="__codelineno-94-18" name="__codelineno-94-18" href="#__codelineno-94-18"></a><span class="c1"># 更新新一帧的数据</span>
</span><span id="__span-94-19"><a id="__codelineno-94-19" name="__codelineno-94-19" href="#__codelineno-94-19"></a><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
</span><span id="__span-94-20"><a id="__codelineno-94-20" name="__codelineno-94-20" href="#__codelineno-94-20"></a>    <span class="n">line</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="p">))</span>
</span><span id="__span-94-21"><a id="__codelineno-94-21" name="__codelineno-94-21" href="#__codelineno-94-21"></a>    <span class="k">return</span> <span class="n">line</span><span class="p">,</span>
</span><span id="__span-94-22"><a id="__codelineno-94-22" name="__codelineno-94-22" href="#__codelineno-94-22"></a>
</span><span id="__span-94-23"><a id="__codelineno-94-23" name="__codelineno-94-23" href="#__codelineno-94-23"></a><span class="c1"># 调用 FuncAnimation</span>
</span><span id="__span-94-24"><a id="__codelineno-94-24" name="__codelineno-94-24" href="#__codelineno-94-24"></a><span class="n">ani</span> <span class="o">=</span> <span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span>
</span><span id="__span-94-25"><a id="__codelineno-94-25" name="__codelineno-94-25" href="#__codelineno-94-25"></a>                   <span class="p">,</span><span class="n">update</span>
</span><span id="__span-94-26"><a id="__codelineno-94-26" name="__codelineno-94-26" href="#__codelineno-94-26"></a>                   <span class="p">,</span><span class="n">init_func</span><span class="o">=</span><span class="n">init</span>
</span><span id="__span-94-27"><a id="__codelineno-94-27" name="__codelineno-94-27" href="#__codelineno-94-27"></a>                   <span class="p">,</span><span class="n">frames</span><span class="o">=</span><span class="mi">200</span>
</span><span id="__span-94-28"><a id="__codelineno-94-28" name="__codelineno-94-28" href="#__codelineno-94-28"></a>                   <span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mi">2</span>
</span><span id="__span-94-29"><a id="__codelineno-94-29" name="__codelineno-94-29" href="#__codelineno-94-29"></a>                   <span class="p">,</span><span class="n">blit</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-94-30"><a id="__codelineno-94-30" name="__codelineno-94-30" href="#__codelineno-94-30"></a>                   <span class="p">)</span>
</span><span id="__span-94-31"><a id="__codelineno-94-31" name="__codelineno-94-31" href="#__codelineno-94-31"></a>
</span><span id="__span-94-32"><a id="__codelineno-94-32" name="__codelineno-94-32" href="#__codelineno-94-32"></a><span class="n">ani</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;animation.gif&quot;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="s2">&quot;imagemagick&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="seabornmatplotlib">Seaborn（matplotlib封装）</h4>
<p>Seaborn 是基于 Python 且非常受欢迎的图形可视化库，在 Matplotlib 的基础上，进行了更高级的封装，使得作图更加方便快捷。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-95-1"><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
</span><span id="__span-95-2"><a id="__codelineno-95-2" name="__codelineno-95-2" href="#__codelineno-95-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-95-3"><a id="__codelineno-95-3" name="__codelineno-95-3" href="#__codelineno-95-3"></a>
</span><span id="__span-95-4"><a id="__codelineno-95-4" name="__codelineno-95-4" href="#__codelineno-95-4"></a><span class="c1"># 设置主题和颜色调色板</span>
</span><span id="__span-95-5"><a id="__codelineno-95-5" name="__codelineno-95-5" href="#__codelineno-95-5"></a><span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;pastel&quot;</span><span class="p">)</span>
</span><span id="__span-95-6"><a id="__codelineno-95-6" name="__codelineno-95-6" href="#__codelineno-95-6"></a><span class="c1"># 示例数据</span>
</span><span id="__span-95-7"><a id="__codelineno-95-7" name="__codelineno-95-7" href="#__codelineno-95-7"></a><span class="n">products</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Product A&quot;</span><span class="p">,</span> <span class="s2">&quot;Product B&quot;</span><span class="p">,</span> <span class="s2">&quot;Product C&quot;</span><span class="p">,</span> <span class="s2">&quot;Product D&quot;</span><span class="p">]</span>
</span><span id="__span-95-8"><a id="__codelineno-95-8" name="__codelineno-95-8" href="#__codelineno-95-8"></a><span class="n">sales</span> <span class="o">=</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">180</span><span class="p">]</span>
</span><span id="__span-95-9"><a id="__codelineno-95-9" name="__codelineno-95-9" href="#__codelineno-95-9"></a><span class="c1"># 创建柱状图</span>
</span><span id="__span-95-10"><a id="__codelineno-95-10" name="__codelineno-95-10" href="#__codelineno-95-10"></a><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">products</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">sales</span><span class="p">)</span>
</span><span id="__span-95-11"><a id="__codelineno-95-11" name="__codelineno-95-11" href="#__codelineno-95-11"></a><span class="c1"># 添加标签和标题</span>
</span><span id="__span-95-12"><a id="__codelineno-95-12" name="__codelineno-95-12" href="#__codelineno-95-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Products&quot;</span><span class="p">)</span>
</span><span id="__span-95-13"><a id="__codelineno-95-13" name="__codelineno-95-13" href="#__codelineno-95-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Sales&quot;</span><span class="p">)</span>
</span><span id="__span-95-14"><a id="__codelineno-95-14" name="__codelineno-95-14" href="#__codelineno-95-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Product Sales by Category&quot;</span><span class="p">)</span>
</span><span id="__span-95-15"><a id="__codelineno-95-15" name="__codelineno-95-15" href="#__codelineno-95-15"></a><span class="c1"># 显示图表</span>
</span><span id="__span-95-16"><a id="__codelineno-95-16" name="__codelineno-95-16" href="#__codelineno-95-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><code>sns.set_theme(style="whitegrid", palette="pastel")</code>
主题（style）：darkgrid（默认）：深色网格主题；whitegrid：浅色网格主题；dark：深色主题，没有网格；white：浅色主题，没有网格；ticks：深色主题，带有刻度标记
模板（context）：paper：适用于小图，具有较小的标签和线条；notebook（默认）：适用于笔记本电脑和类似环境，具有中等大小的标签和线条；talk：适用于演讲幻灯片，具有大尺寸的标签和线条；poster：适用于海报，具有非常大的标签和线条
调色板（palette）：分类色板：deep, muted, <strong>pastel</strong>, bright, dark, colorblind.；连续色板：rocket,<strong>crest</strong>,mako,flare；离散色板：vlag,icefire；自定义：单色渐变sns.color_palette('Blues')</p>
<ol>
<li>散点图 - sns.scatterplot()</li>
<li>折线图 - sns.lineplot()</li>
<li>柱状图 - sns.barplot()</li>
<li>箱线图 - sns.boxplot()</li>
<li>热力图 - sns.heatmap()</li>
<li>小提琴图 - sns.violinplot()</li>
</ol>
<p>计数图 - countplot
散点图stripplot/swarmplot
回归图regplot/lmplot</p>
<h4 id="pynimate">pynimate（ 动态排序图）</h4>
<p>输入的数据必须是pandas数据结构DataFrame：</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-96-1"><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a>time, col1, col2, col3  
</span><span id="__span-96-2"><a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a>2012   1     2     1  
</span><span id="__span-96-3"><a id="__codelineno-96-3" name="__codelineno-96-3" href="#__codelineno-96-3"></a>2013   1     1     2  
</span><span id="__span-96-4"><a id="__codelineno-96-4" name="__codelineno-96-4" href="#__codelineno-96-4"></a>2014   2     1.5   3  
</span><span id="__span-96-5"><a id="__codelineno-96-5" name="__codelineno-96-5" href="#__codelineno-96-5"></a>2015   2.5   2     3.5
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-97-1"><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>  
</span><span id="__span-97-2"><a id="__codelineno-97-2" name="__codelineno-97-2" href="#__codelineno-97-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>  
</span><span id="__span-97-3"><a id="__codelineno-97-3" name="__codelineno-97-3" href="#__codelineno-97-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pynimate</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nim</span>  
</span><span id="__span-97-4"><a id="__codelineno-97-4" name="__codelineno-97-4" href="#__codelineno-97-4"></a>
</span><span id="__span-97-5"><a id="__codelineno-97-5" name="__codelineno-97-5" href="#__codelineno-97-5"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>  
</span><span id="__span-97-6"><a id="__codelineno-97-6" name="__codelineno-97-6" href="#__codelineno-97-6"></a>    <span class="p">{</span>  
</span><span id="__span-97-7"><a id="__codelineno-97-7" name="__codelineno-97-7" href="#__codelineno-97-7"></a>        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1960-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;1961-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;1962-01-01&quot;</span><span class="p">],</span>  
</span><span id="__span-97-8"><a id="__codelineno-97-8" name="__codelineno-97-8" href="#__codelineno-97-8"></a>        <span class="s2">&quot;Afghanistan&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>  
</span><span id="__span-97-9"><a id="__codelineno-97-9" name="__codelineno-97-9" href="#__codelineno-97-9"></a>        <span class="s2">&quot;Angola&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>  
</span><span id="__span-97-10"><a id="__codelineno-97-10" name="__codelineno-97-10" href="#__codelineno-97-10"></a>        <span class="s2">&quot;Albania&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>  
</span><span id="__span-97-11"><a id="__codelineno-97-11" name="__codelineno-97-11" href="#__codelineno-97-11"></a>        <span class="s2">&quot;USA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>  
</span><span id="__span-97-12"><a id="__codelineno-97-12" name="__codelineno-97-12" href="#__codelineno-97-12"></a>        <span class="s2">&quot;Argentina&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>  
</span><span id="__span-97-13"><a id="__codelineno-97-13" name="__codelineno-97-13" href="#__codelineno-97-13"></a>    <span class="p">}</span>  
</span><span id="__span-97-14"><a id="__codelineno-97-14" name="__codelineno-97-14" href="#__codelineno-97-14"></a><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>  
</span><span id="__span-97-15"><a id="__codelineno-97-15" name="__codelineno-97-15" href="#__codelineno-97-15"></a><span class="c1"># df = pd.read_csv(&#39;data&#39;csv&#39;).set_index(&#39;time&#39;)</span>
</span><span id="__span-97-16"><a id="__codelineno-97-16" name="__codelineno-97-16" href="#__codelineno-97-16"></a>
</span><span id="__span-97-17"><a id="__codelineno-97-17" name="__codelineno-97-17" href="#__codelineno-97-17"></a><span class="c1"># 定义画布</span>
</span><span id="__span-97-18"><a id="__codelineno-97-18" name="__codelineno-97-18" href="#__codelineno-97-18"></a><span class="n">cnv</span> <span class="o">=</span> <span class="n">nim</span><span class="o">.</span><span class="n">Canvas</span><span class="p">()</span>
</span><span id="__span-97-19"><a id="__codelineno-97-19" name="__codelineno-97-19" href="#__codelineno-97-19"></a><span class="c1"># 设置插值频率为5d，可自定义调节</span>
</span><span id="__span-97-20"><a id="__codelineno-97-20" name="__codelineno-97-20" href="#__codelineno-97-20"></a><span class="n">bar</span> <span class="o">=</span> <span class="n">nim</span><span class="o">.</span><span class="n">Barplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;5d&quot;</span><span class="p">)</span>  
</span><span id="__span-97-21"><a id="__codelineno-97-21" name="__codelineno-97-21" href="#__codelineno-97-21"></a><span class="c1"># 使用回调函数接收对应格式化的年月信息</span>
</span><span id="__span-97-22"><a id="__codelineno-97-22" name="__codelineno-97-22" href="#__codelineno-97-22"></a><span class="n">bar</span><span class="o">.</span><span class="n">set_time</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">datafier</span><span class="p">:</span> <span class="n">datafier</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> 
</span><span id="__span-97-23"><a id="__codelineno-97-23" name="__codelineno-97-23" href="#__codelineno-97-23"></a><span class="c1"># 添加条形图到画布</span>
</span><span id="__span-97-24"><a id="__codelineno-97-24" name="__codelineno-97-24" href="#__codelineno-97-24"></a><span class="n">cnv</span><span class="o">.</span><span class="n">add_plot</span><span class="p">(</span><span class="n">bar</span><span class="p">)</span>  
</span><span id="__span-97-25"><a id="__codelineno-97-25" name="__codelineno-97-25" href="#__codelineno-97-25"></a><span class="n">cnv</span><span class="o">.</span><span class="n">animate</span><span class="p">()</span>  
</span><span id="__span-97-26"><a id="__codelineno-97-26" name="__codelineno-97-26" href="#__codelineno-97-26"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-97-27"><a id="__codelineno-97-27" name="__codelineno-97-27" href="#__codelineno-97-27"></a>
</span><span id="__span-97-28"><a id="__codelineno-97-28" name="__codelineno-97-28" href="#__codelineno-97-28"></a><span class="c1"># 两种格式存储，git和mp4(需要安装相应的库)</span>
</span><span id="__span-97-29"><a id="__codelineno-97-29" name="__codelineno-97-29" href="#__codelineno-97-29"></a><span class="n">cnv</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s2">&quot;gif&quot;</span><span class="p">)</span>
</span><span id="__span-97-30"><a id="__codelineno-97-30" name="__codelineno-97-30" href="#__codelineno-97-30"></a><span class="c1"># cnv.save(&quot;file&quot;, 24, &quot;mp4&quot;)</span>
</span></code></pre></div>
<h4 id="mayavi3d">mayavi（3D可视化）</h4>
<h4 id="plotly">Plotly(可交互)</h4>
<p><a href="https://plotly.com/python/">Plotly Python 绘图库 </a> 是一个开源的代码库，它基于 plot.js，而后者基于 d3.js。</p>
<p>可以生成交互式图表。图表以 JavaScript 对象表示法(JSON) 数据格式存储，以便可以使用其他编程语言读取。图表可以导出为各种光栅和矢量图像格式</p>
<p><code>pip install plotly</code>
<code>pip install jupyter</code> 安装 Jupyter notebook 应用程序</p>
<p>Plotly中绘制图像有在线和离线两种方式，在线绘图需要注册账号获取API key。
离线绘图又有plotly.offline.plot()和plotly.offline.iplot()两种方法，前者是以离线的方式在当前工作目录下生成html格式的图像文件，并自动打开；后者是在jupyter notebook中专用的方法，即将生成的图形嵌入到后缀名为 <code>.ipynb</code>的 <code>JSON</code>格式文件中</p>
<p>在.ipynb文件中运行下列代码：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-98-1"><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">plotly</span>
</span><span id="__span-98-2"><a id="__codelineno-98-2" name="__codelineno-98-2" href="#__codelineno-98-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>
</span><span id="__span-98-3"><a id="__codelineno-98-3" name="__codelineno-98-3" href="#__codelineno-98-3"></a>
</span><span id="__span-98-4"><a id="__codelineno-98-4" name="__codelineno-98-4" href="#__codelineno-98-4"></a><span class="sd">&#39;&#39;&#39;初始化jupyter notebook中的绘图模式&#39;&#39;&#39;</span>
</span><span id="__span-98-5"><a id="__codelineno-98-5" name="__codelineno-98-5" href="#__codelineno-98-5"></a><span class="n">plotly</span><span class="o">.</span><span class="n">offline</span><span class="o">.</span><span class="n">init_notebook_mode</span><span class="p">()</span>
</span><span id="__span-98-6"><a id="__codelineno-98-6" name="__codelineno-98-6" href="#__codelineno-98-6"></a>
</span><span id="__span-98-7"><a id="__codelineno-98-7" name="__codelineno-98-7" href="#__codelineno-98-7"></a><span class="sd">&#39;&#39;&#39;绘制一个基本的折线图，控制其尺寸为1600x600&#39;&#39;&#39;</span>
</span><span id="__span-98-8"><a id="__codelineno-98-8" name="__codelineno-98-8" href="#__codelineno-98-8"></a><span class="n">plotly</span><span class="o">.</span><span class="n">offline</span><span class="o">.</span><span class="n">iplot</span><span class="p">([{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">]}],</span>
</span><span id="__span-98-9"><a id="__codelineno-98-9" name="__codelineno-98-9" href="#__codelineno-98-9"></a>                    <span class="n">image_height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
</span><span id="__span-98-10"><a id="__codelineno-98-10" name="__codelineno-98-10" href="#__codelineno-98-10"></a>                    <span class="n">image_width</span><span class="o">=</span><span class="mi">1600</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-99-1"><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-99-2"><a id="__codelineno-99-2" name="__codelineno-99-2" href="#__codelineno-99-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">plotly</span>
</span><span id="__span-99-3"><a id="__codelineno-99-3" name="__codelineno-99-3" href="#__codelineno-99-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>
</span><span id="__span-99-4"><a id="__codelineno-99-4" name="__codelineno-99-4" href="#__codelineno-99-4"></a>
</span><span id="__span-99-5"><a id="__codelineno-99-5" name="__codelineno-99-5" href="#__codelineno-99-5"></a><span class="sd">&#39;&#39;&#39;创建仿真数据&#39;&#39;&#39;</span>
</span><span id="__span-99-6"><a id="__codelineno-99-6" name="__codelineno-99-6" href="#__codelineno-99-6"></a><span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="__span-99-7"><a id="__codelineno-99-7" name="__codelineno-99-7" href="#__codelineno-99-7"></a><span class="n">random_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span><span id="__span-99-8"><a id="__codelineno-99-8" name="__codelineno-99-8" href="#__codelineno-99-8"></a><span class="n">random_y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span>
</span><span id="__span-99-9"><a id="__codelineno-99-9" name="__codelineno-99-9" href="#__codelineno-99-9"></a><span class="n">random_y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</span><span id="__span-99-10"><a id="__codelineno-99-10" name="__codelineno-99-10" href="#__codelineno-99-10"></a><span class="n">random_y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="mi">5</span>
</span><span id="__span-99-11"><a id="__codelineno-99-11" name="__codelineno-99-11" href="#__codelineno-99-11"></a>
</span><span id="__span-99-12"><a id="__codelineno-99-12" name="__codelineno-99-12" href="#__codelineno-99-12"></a><span class="sd">&#39;&#39;&#39;构造trace0&#39;&#39;&#39;</span>
</span><span id="__span-99-13"><a id="__codelineno-99-13" name="__codelineno-99-13" href="#__codelineno-99-13"></a><span class="n">trace0</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
</span><span id="__span-99-14"><a id="__codelineno-99-14" name="__codelineno-99-14" href="#__codelineno-99-14"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">random_x</span><span class="p">,</span>
</span><span id="__span-99-15"><a id="__codelineno-99-15" name="__codelineno-99-15" href="#__codelineno-99-15"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">random_y0</span><span class="p">,</span>
</span><span id="__span-99-16"><a id="__codelineno-99-16" name="__codelineno-99-16" href="#__codelineno-99-16"></a>    <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;markers&#39;</span><span class="p">,</span>
</span><span id="__span-99-17"><a id="__codelineno-99-17" name="__codelineno-99-17" href="#__codelineno-99-17"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;markers&#39;</span>
</span><span id="__span-99-18"><a id="__codelineno-99-18" name="__codelineno-99-18" href="#__codelineno-99-18"></a><span class="p">)</span>
</span><span id="__span-99-19"><a id="__codelineno-99-19" name="__codelineno-99-19" href="#__codelineno-99-19"></a>
</span><span id="__span-99-20"><a id="__codelineno-99-20" name="__codelineno-99-20" href="#__codelineno-99-20"></a><span class="sd">&#39;&#39;&#39;构造trace1&#39;&#39;&#39;</span>
</span><span id="__span-99-21"><a id="__codelineno-99-21" name="__codelineno-99-21" href="#__codelineno-99-21"></a><span class="n">trace1</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
</span><span id="__span-99-22"><a id="__codelineno-99-22" name="__codelineno-99-22" href="#__codelineno-99-22"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">random_x</span><span class="p">,</span>
</span><span id="__span-99-23"><a id="__codelineno-99-23" name="__codelineno-99-23" href="#__codelineno-99-23"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">random_y1</span><span class="p">,</span>
</span><span id="__span-99-24"><a id="__codelineno-99-24" name="__codelineno-99-24" href="#__codelineno-99-24"></a>    <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
</span><span id="__span-99-25"><a id="__codelineno-99-25" name="__codelineno-99-25" href="#__codelineno-99-25"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;lines+markers&#39;</span>
</span><span id="__span-99-26"><a id="__codelineno-99-26" name="__codelineno-99-26" href="#__codelineno-99-26"></a><span class="p">)</span>
</span><span id="__span-99-27"><a id="__codelineno-99-27" name="__codelineno-99-27" href="#__codelineno-99-27"></a>
</span><span id="__span-99-28"><a id="__codelineno-99-28" name="__codelineno-99-28" href="#__codelineno-99-28"></a><span class="sd">&#39;&#39;&#39;构造trace2&#39;&#39;&#39;</span>
</span><span id="__span-99-29"><a id="__codelineno-99-29" name="__codelineno-99-29" href="#__codelineno-99-29"></a><span class="n">trace2</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
</span><span id="__span-99-30"><a id="__codelineno-99-30" name="__codelineno-99-30" href="#__codelineno-99-30"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">random_x</span><span class="p">,</span>
</span><span id="__span-99-31"><a id="__codelineno-99-31" name="__codelineno-99-31" href="#__codelineno-99-31"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">random_y2</span><span class="p">,</span>
</span><span id="__span-99-32"><a id="__codelineno-99-32" name="__codelineno-99-32" href="#__codelineno-99-32"></a>    <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
</span><span id="__span-99-33"><a id="__codelineno-99-33" name="__codelineno-99-33" href="#__codelineno-99-33"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span>
</span><span id="__span-99-34"><a id="__codelineno-99-34" name="__codelineno-99-34" href="#__codelineno-99-34"></a><span class="p">)</span>
</span><span id="__span-99-35"><a id="__codelineno-99-35" name="__codelineno-99-35" href="#__codelineno-99-35"></a>
</span><span id="__span-99-36"><a id="__codelineno-99-36" name="__codelineno-99-36" href="#__codelineno-99-36"></a><span class="sd">&#39;&#39;&#39;将所有trace保存在列表中&#39;&#39;&#39;</span>
</span><span id="__span-99-37"><a id="__codelineno-99-37" name="__codelineno-99-37" href="#__codelineno-99-37"></a><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">trace0</span><span class="p">,</span> <span class="n">trace1</span><span class="p">,</span> <span class="n">trace2</span><span class="p">]</span>
</span><span id="__span-99-38"><a id="__codelineno-99-38" name="__codelineno-99-38" href="#__codelineno-99-38"></a>
</span><span id="__span-99-39"><a id="__codelineno-99-39" name="__codelineno-99-39" href="#__codelineno-99-39"></a><span class="sd">&#39;&#39;&#39;构造layout对象，设置标题和图例&#39;&#39;&#39;</span>
</span><span id="__span-99-40"><a id="__codelineno-99-40" name="__codelineno-99-40" href="#__codelineno-99-40"></a><span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
</span><span id="__span-99-41"><a id="__codelineno-99-41" name="__codelineno-99-41" href="#__codelineno-99-41"></a>    <span class="n">title</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-99-42"><a id="__codelineno-99-42" name="__codelineno-99-42" href="#__codelineno-99-42"></a>        <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s2">&quot;Plotly&quot;</span><span class="p">,</span>
</span><span id="__span-99-43"><a id="__codelineno-99-43" name="__codelineno-99-43" href="#__codelineno-99-43"></a>        <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="__span-99-44"><a id="__codelineno-99-44" name="__codelineno-99-44" href="#__codelineno-99-44"></a>        <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span>
</span><span id="__span-99-45"><a id="__codelineno-99-45" name="__codelineno-99-45" href="#__codelineno-99-45"></a>        <span class="s1">&#39;xanchor&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
</span><span id="__span-99-46"><a id="__codelineno-99-46" name="__codelineno-99-46" href="#__codelineno-99-46"></a>        <span class="s1">&#39;yanchor&#39;</span><span class="p">:</span> <span class="s1">&#39;top&#39;</span><span class="p">},</span>
</span><span id="__span-99-47"><a id="__codelineno-99-47" name="__codelineno-99-47" href="#__codelineno-99-47"></a>    <span class="n">legend</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-99-48"><a id="__codelineno-99-48" name="__codelineno-99-48" href="#__codelineno-99-48"></a>        <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-99-49"><a id="__codelineno-99-49" name="__codelineno-99-49" href="#__codelineno-99-49"></a>        <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
</span><span id="__span-99-50"><a id="__codelineno-99-50" name="__codelineno-99-50" href="#__codelineno-99-50"></a><span class="p">)</span>
</span><span id="__span-99-51"><a id="__codelineno-99-51" name="__codelineno-99-51" href="#__codelineno-99-51"></a>
</span><span id="__span-99-52"><a id="__codelineno-99-52" name="__codelineno-99-52" href="#__codelineno-99-52"></a><span class="sd">&#39;&#39;&#39;构造figure对象&#39;&#39;&#39;</span>
</span><span id="__span-99-53"><a id="__codelineno-99-53" name="__codelineno-99-53" href="#__codelineno-99-53"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
</span><span id="__span-99-54"><a id="__codelineno-99-54" name="__codelineno-99-54" href="#__codelineno-99-54"></a>
</span><span id="__span-99-55"><a id="__codelineno-99-55" name="__codelineno-99-55" href="#__codelineno-99-55"></a><span class="sd">&#39;&#39;&#39;启动绘图&#39;&#39;&#39;</span>
</span><span id="__span-99-56"><a id="__codelineno-99-56" name="__codelineno-99-56" href="#__codelineno-99-56"></a><span class="n">plotly</span><span class="o">.</span><span class="n">offline</span><span class="o">.</span><span class="n">init_notebook_mode</span><span class="p">()</span>
</span><span id="__span-99-57"><a id="__codelineno-99-57" name="__codelineno-99-57" href="#__codelineno-99-57"></a><span class="n">plotly</span><span class="o">.</span><span class="n">offline</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;scatter-mode&#39;</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="pyecharts">Pyecharts(可交互)</h4>
<p><a href="https://05x-docs.pyecharts.org/#/zh-cn/prepare"> pyecharts</a>是一个基于 ECharts 的 Python 数据可视化库，它允许用户使用 Python 语言生成各种类型的交互式图表和数据可视化。
ECharts 是一个使用 JavaScript 实现的由百度开源的可视化库，而 Pyecharts 则是 ECharts 的 Python 封装，使得在 Python 中使用 ECharts 变得更加方便。</p>
<p><code>pip install pyecharts</code></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-100-1"><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pyecharts</span><span class="w"> </span><span class="kn">import</span> <span class="n">options</span> <span class="k">as</span> <span class="n">opts</span>
</span><span id="__span-100-2"><a id="__codelineno-100-2" name="__codelineno-100-2" href="#__codelineno-100-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pyecharts.charts</span><span class="w"> </span><span class="kn">import</span> <span class="n">Bar</span>
</span><span id="__span-100-3"><a id="__codelineno-100-3" name="__codelineno-100-3" href="#__codelineno-100-3"></a>
</span><span id="__span-100-4"><a id="__codelineno-100-4" name="__codelineno-100-4" href="#__codelineno-100-4"></a><span class="c1"># 准备数据</span>
</span><span id="__span-100-5"><a id="__codelineno-100-5" name="__codelineno-100-5" href="#__codelineno-100-5"></a><span class="n">x_data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;一月&#39;</span><span class="p">,</span> <span class="s1">&#39;二月&#39;</span><span class="p">,</span> <span class="s1">&#39;三月&#39;</span><span class="p">,</span> <span class="s1">&#39;四月&#39;</span><span class="p">,</span> <span class="s1">&#39;五月&#39;</span><span class="p">]</span>
</span><span id="__span-100-6"><a id="__codelineno-100-6" name="__codelineno-100-6" href="#__codelineno-100-6"></a><span class="n">y_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
</span><span id="__span-100-7"><a id="__codelineno-100-7" name="__codelineno-100-7" href="#__codelineno-100-7"></a>
</span><span id="__span-100-8"><a id="__codelineno-100-8" name="__codelineno-100-8" href="#__codelineno-100-8"></a><span class="c1"># 创建柱状图</span>
</span><span id="__span-100-9"><a id="__codelineno-100-9" name="__codelineno-100-9" href="#__codelineno-100-9"></a><span class="n">bar_chart</span> <span class="o">=</span> <span class="n">Bar</span><span class="p">()</span>
</span><span id="__span-100-10"><a id="__codelineno-100-10" name="__codelineno-100-10" href="#__codelineno-100-10"></a><span class="n">bar_chart</span><span class="o">.</span><span class="n">add_xaxis</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
</span><span id="__span-100-11"><a id="__codelineno-100-11" name="__codelineno-100-11" href="#__codelineno-100-11"></a><span class="n">bar_chart</span><span class="o">.</span><span class="n">add_yaxis</span><span class="p">(</span><span class="s2">&quot;销售额&quot;</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
</span><span id="__span-100-12"><a id="__codelineno-100-12" name="__codelineno-100-12" href="#__codelineno-100-12"></a>
</span><span id="__span-100-13"><a id="__codelineno-100-13" name="__codelineno-100-13" href="#__codelineno-100-13"></a><span class="c1"># 配置全局属性</span>
</span><span id="__span-100-14"><a id="__codelineno-100-14" name="__codelineno-100-14" href="#__codelineno-100-14"></a><span class="n">bar_chart</span><span class="o">.</span><span class="n">set_global_opts</span><span class="p">(</span>
</span><span id="__span-100-15"><a id="__codelineno-100-15" name="__codelineno-100-15" href="#__codelineno-100-15"></a>    <span class="n">title_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">TitleOpts</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;月度销售额柱状图&quot;</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="s2">&quot;副标题&quot;</span><span class="p">),</span>
</span><span id="__span-100-16"><a id="__codelineno-100-16" name="__codelineno-100-16" href="#__codelineno-100-16"></a>    <span class="n">xaxis_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">AxisOpts</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;月份&quot;</span><span class="p">),</span>
</span><span id="__span-100-17"><a id="__codelineno-100-17" name="__codelineno-100-17" href="#__codelineno-100-17"></a>    <span class="n">yaxis_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">AxisOpts</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;销售额（万元）&quot;</span><span class="p">),</span>
</span><span id="__span-100-18"><a id="__codelineno-100-18" name="__codelineno-100-18" href="#__codelineno-100-18"></a>    <span class="n">legend_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">LegendOpts</span><span class="p">(</span><span class="n">pos_left</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">pos_top</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">),</span>
</span><span id="__span-100-19"><a id="__codelineno-100-19" name="__codelineno-100-19" href="#__codelineno-100-19"></a>    <span class="n">toolbox_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">ToolboxOpts</span><span class="p">(),</span>
</span><span id="__span-100-20"><a id="__codelineno-100-20" name="__codelineno-100-20" href="#__codelineno-100-20"></a>    <span class="n">tooltip_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">TooltipOpts</span><span class="p">(</span><span class="n">trigger</span><span class="o">=</span><span class="s2">&quot;axis&quot;</span><span class="p">,</span> <span class="n">axis_pointer_type</span><span class="o">=</span><span class="s2">&quot;cross&quot;</span><span class="p">),</span>
</span><span id="__span-100-21"><a id="__codelineno-100-21" name="__codelineno-100-21" href="#__codelineno-100-21"></a><span class="p">)</span>
</span><span id="__span-100-22"><a id="__codelineno-100-22" name="__codelineno-100-22" href="#__codelineno-100-22"></a>
</span><span id="__span-100-23"><a id="__codelineno-100-23" name="__codelineno-100-23" href="#__codelineno-100-23"></a><span class="c1"># 渲染图表，生成本地 HTML 文件</span>
</span><span id="__span-100-24"><a id="__codelineno-100-24" name="__codelineno-100-24" href="#__codelineno-100-24"></a><span class="n">bar_chart</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;global_options_bar_chart.html&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="vpython3d">VPython（3D图形和动画）</h4>
<p>VPython，全称为Visual Python，是一个用于创建3D图形和动画的Python库。它为用户提供了简单易用的工具，用于绘制3D图形、创建动画效果和交互式应用程序。</p>
<h3 id="shapely">Shapely(处理几何关系)</h3>
<p>Shapely 是一个用于处理几何对象的 Python 库，用于使用广泛部署的 GEOS 库中的函数进行平面特征的集合论分析和操作。GEOS 是 Java 拓扑套件（JTS）的移植，是 PostgreSQL RDBMS 空间扩展 PostGIS 的几何引擎。</p>
<p>Shapely是一个平面几何库，在几何分析中忽略了z，只有z值不同的坐标图元是不能相互区分的</p>
<p>Shapely 实现的几何对象的基本类型是点、曲线和曲面。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-101-1"><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">Point</span><span class="p">,</span> <span class="n">LineString</span><span class="p">,</span> <span class="n">Polygon</span>
</span><span id="__span-101-2"><a id="__codelineno-101-2" name="__codelineno-101-2" href="#__codelineno-101-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRing</span><span class="p">,</span> <span class="n">box</span>
</span><span id="__span-101-3"><a id="__codelineno-101-3" name="__codelineno-101-3" href="#__codelineno-101-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-101-4"><a id="__codelineno-101-4" name="__codelineno-101-4" href="#__codelineno-101-4"></a>
</span><span id="__span-101-5"><a id="__codelineno-101-5" name="__codelineno-101-5" href="#__codelineno-101-5"></a><span class="c1"># 创建基本几何对象，在所有构造函数中数字值被转换为float类型</span>
</span><span id="__span-101-6"><a id="__codelineno-101-6" name="__codelineno-101-6" href="#__codelineno-101-6"></a><span class="n">point</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>                      <span class="c1"># 点</span>
</span><span id="__span-101-7"><a id="__codelineno-101-7" name="__codelineno-101-7" href="#__codelineno-101-7"></a><span class="n">line</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span> <span class="c1"># 折线</span>
</span><span id="__span-101-8"><a id="__codelineno-101-8" name="__codelineno-101-8" href="#__codelineno-101-8"></a><span class="n">polygon</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span> <span class="c1"># 多边形</span>
</span><span id="__span-101-9"><a id="__codelineno-101-9" name="__codelineno-101-9" href="#__codelineno-101-9"></a>
</span><span id="__span-101-10"><a id="__codelineno-101-10" name="__codelineno-101-10" href="#__codelineno-101-10"></a><span class="n">ring</span> <span class="o">=</span> <span class="n">LinearRing</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>　<span class="c1"># 线性环</span>
</span><span id="__span-101-11"><a id="__codelineno-101-11" name="__codelineno-101-11" href="#__codelineno-101-11"></a><span class="n">box</span> <span class="o">=</span> <span class="n">box</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>　<span class="c1"># 矩形多边形</span>
</span><span id="__span-101-12"><a id="__codelineno-101-12" name="__codelineno-101-12" href="#__codelineno-101-12"></a>
</span><span id="__span-101-13"><a id="__codelineno-101-13" name="__codelineno-101-13" href="#__codelineno-101-13"></a><span class="c1"># 可视化</span>
</span><span id="__span-101-14"><a id="__codelineno-101-14" name="__codelineno-101-14" href="#__codelineno-101-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</span><span id="__span-101-15"><a id="__codelineno-101-15" name="__codelineno-101-15" href="#__codelineno-101-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">point</span><span class="o">.</span><span class="n">xy</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Point&quot;</span><span class="p">)</span>
</span><span id="__span-101-16"><a id="__codelineno-101-16" name="__codelineno-101-16" href="#__codelineno-101-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">line</span><span class="o">.</span><span class="n">xy</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Line&quot;</span><span class="p">)</span>
</span><span id="__span-101-17"><a id="__codelineno-101-17" name="__codelineno-101-17" href="#__codelineno-101-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">polygon</span><span class="o">.</span><span class="n">exterior</span><span class="o">.</span><span class="n">xy</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Polygon&quot;</span><span class="p">)</span>
</span><span id="__span-101-18"><a id="__codelineno-101-18" name="__codelineno-101-18" href="#__codelineno-101-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-101-19"><a id="__codelineno-101-19" name="__codelineno-101-19" href="#__codelineno-101-19"></a><span class="c1"># 在jupyter中直接写几何对象名称即可显示，不过只显示一个</span>
</span><span id="__span-101-20"><a id="__codelineno-101-20" name="__codelineno-101-20" href="#__codelineno-101-20"></a><span class="n">polygon</span>
</span></code></pre></div>
<p>构造函数也接受另一个实例，从而产生一个副本</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-102-1"><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a><span class="n">Point</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</span><span id="__span-102-2"><a id="__codelineno-102-2" name="__codelineno-102-2" href="#__codelineno-102-2"></a><span class="n">LineString</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="__span-102-3"><a id="__codelineno-102-3" name="__codelineno-102-3" href="#__codelineno-102-3"></a><span class="n">LineString</span><span class="p">(</span><span class="n">ring</span><span class="p">)</span>
</span><span id="__span-102-4"><a id="__codelineno-102-4" name="__codelineno-102-4" href="#__codelineno-102-4"></a><span class="n">LinearRing</span><span class="p">(</span><span class="n">ring</span><span class="p">)</span>
</span><span id="__span-102-5"><a id="__codelineno-102-5" name="__codelineno-102-5" href="#__codelineno-102-5"></a><span class="n">LinearRing</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="__span-102-6"><a id="__codelineno-102-6" name="__codelineno-102-6" href="#__codelineno-102-6"></a><span class="n">Polygon</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="__span-102-7"><a id="__codelineno-102-7" name="__codelineno-102-7" href="#__codelineno-102-7"></a><span class="n">Polygon</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="__span-102-8"><a id="__codelineno-102-8" name="__codelineno-102-8" href="#__codelineno-102-8"></a><span class="n">Polygon</span><span class="p">(</span><span class="n">ring</span><span class="p">)</span>
</span><span id="__span-102-9"><a id="__codelineno-102-9" name="__codelineno-102-9" href="#__codelineno-102-9"></a><span class="n">Polygon</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
</span></code></pre></div>
<p>几何对象具有面积（area）、长度（length）、坐标（coords）和边界（bounds）属性</p>
<p>集合</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-103-1"><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a><span class="n">a</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
</span><span id="__span-103-2"><a id="__codelineno-103-2" name="__codelineno-103-2" href="#__codelineno-103-2"></a><span class="n">b</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
</span><span id="__span-103-3"><a id="__codelineno-103-3" name="__codelineno-103-3" href="#__codelineno-103-3"></a><span class="c1"># 交集</span>
</span><span id="__span-103-4"><a id="__codelineno-103-4" name="__codelineno-103-4" href="#__codelineno-103-4"></a><span class="n">a</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="__span-103-5"><a id="__codelineno-103-5" name="__codelineno-103-5" href="#__codelineno-103-5"></a><span class="n">a</span><span class="o">&amp;</span><span class="n">b</span>
</span><span id="__span-103-6"><a id="__codelineno-103-6" name="__codelineno-103-6" href="#__codelineno-103-6"></a><span class="c1"># 并集</span>
</span><span id="__span-103-7"><a id="__codelineno-103-7" name="__codelineno-103-7" href="#__codelineno-103-7"></a><span class="n">a</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="__span-103-8"><a id="__codelineno-103-8" name="__codelineno-103-8" href="#__codelineno-103-8"></a><span class="n">a</span><span class="o">|</span><span class="n">b</span>
</span><span id="__span-103-9"><a id="__codelineno-103-9" name="__codelineno-103-9" href="#__codelineno-103-9"></a><span class="c1"># 差集</span>
</span><span id="__span-103-10"><a id="__codelineno-103-10" name="__codelineno-103-10" href="#__codelineno-103-10"></a><span class="n">a</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="__span-103-11"><a id="__codelineno-103-11" name="__codelineno-103-11" href="#__codelineno-103-11"></a><span class="n">a</span><span class="o">-</span><span class="n">b</span>
</span><span id="__span-103-12"><a id="__codelineno-103-12" name="__codelineno-103-12" href="#__codelineno-103-12"></a><span class="c1"># 异或</span>
</span><span id="__span-103-13"><a id="__codelineno-103-13" name="__codelineno-103-13" href="#__codelineno-103-13"></a><span class="n">a</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="__span-103-14"><a id="__codelineno-103-14" name="__codelineno-103-14" href="#__codelineno-103-14"></a><span class="n">a</span><span class="o">^</span><span class="n">b</span>
</span><span id="__span-103-15"><a id="__codelineno-103-15" name="__codelineno-103-15" href="#__codelineno-103-15"></a><span class="p">(</span><span class="n">a</span><span class="o">|</span><span class="n">b</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a</span><span class="o">&amp;</span><span class="n">b</span><span class="p">)</span> <span class="c1"># 图形一样但是 (a^b)==((a|b)-(a&amp;b)) 为False</span>
</span><span id="__span-103-16"><a id="__codelineno-103-16" name="__codelineno-103-16" href="#__codelineno-103-16"></a>
</span><span id="__span-103-17"><a id="__codelineno-103-17" name="__codelineno-103-17" href="#__codelineno-103-17"></a><span class="n">a</span> <span class="ow">and</span> <span class="n">b</span> <span class="c1"># a</span>
</span><span id="__span-103-18"><a id="__codelineno-103-18" name="__codelineno-103-18" href="#__codelineno-103-18"></a><span class="n">a</span> <span class="ow">or</span> <span class="n">b</span> <span class="c1"># b</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-104-1"><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiPoint</span><span class="p">,</span> <span class="n">MultiLineString</span><span class="p">,</span> <span class="n">MultiPolygon</span>
</span><span id="__span-104-2"><a id="__codelineno-104-2" name="__codelineno-104-2" href="#__codelineno-104-2"></a><span class="n">points</span> <span class="o">=</span> <span class="n">MultiPoint</span><span class="p">([(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)])</span> <span class="c1"># 点的集合</span>
</span><span id="__span-104-3"><a id="__codelineno-104-3" name="__codelineno-104-3" href="#__codelineno-104-3"></a><span class="n">lines</span> <span class="o">=</span> <span class="n">MultiLineString</span><span class="p">([((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))])</span> <span class="c1"># 线条的集合</span>
</span><span id="__span-104-4"><a id="__codelineno-104-4" name="__codelineno-104-4" href="#__codelineno-104-4"></a><span class="n">polygons</span> <span class="o">=</span> <span class="n">MultiPolygon</span><span class="p">([</span><span class="n">polygon</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">])</span> <span class="c1"># 多边形的集合</span>
</span><span id="__span-104-5"><a id="__codelineno-104-5" name="__codelineno-104-5" href="#__codelineno-104-5"></a><span class="c1"># Empty空特征可以通过调用各种没有参数的构造函数来创建。空特征几乎不支持任何操作。</span>
</span><span id="__span-104-6"><a id="__codelineno-104-6" name="__codelineno-104-6" href="#__codelineno-104-6"></a>
</span><span id="__span-104-7"><a id="__codelineno-104-7" name="__codelineno-104-7" href="#__codelineno-104-7"></a><span class="n">point1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-104-8"><a id="__codelineno-104-8" name="__codelineno-104-8" href="#__codelineno-104-8"></a><span class="n">point2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-104-9"><a id="__codelineno-104-9" name="__codelineno-104-9" href="#__codelineno-104-9"></a><span class="n">points</span><span class="o">==</span><span class="p">(</span><span class="n">point1</span><span class="o">|</span><span class="n">point2</span><span class="p">)</span> <span class="c1"># True</span>
</span></code></pre></div>
<p>多点集合的成员可以通过 <code>geoms</code> 属性或使用 <code>in</code> 或 <code>list()</code> 的迭代器协议来访问</p>
<p>object.minimum_clearance
返回一个节点被移动以产生无效几何体的最小距离。
object.distance(other)
返回到另一个几何对象的最小距离
object.hausdorff_distance(other)
返回到另一个几何体的Hausdorff距离（float）。两个几何体之间的Hausdorff距离是任何一个几何体上的一个点与另一个几何体上的最近点之间的最远距离。
object.representative_point( )
返回一个便宜的计算点，保证在几何对象内</p>
<p>坐标值通过coords、x、y和 z属性访问</p>
<p>object.interpolate(distance[, normalized=False])
返回一个沿线性几何对象的指定距离的点。线性特征（如 LineStrings 和 MultiLineStrings ）
ip = LineString([(0, 0), (0, 1), (1, 1)]).interpolate(1.5)
object.project(other[, normalized=False])
返回沿这个几何对象到离另一个对象最近的点的距离。如果(normalized arg)为True，返回归一化为对象长度的距离
LineString([(0, 0), (0, 1), (1, 1)]).project(ip)</p>
<p><a href="https://www.heywhale.com/mw/project/62754e8fd0bd1f00173f1cee">Shapely 用户手册</a>
object.has_z
如果该特征不仅有 x 和 y ，而且还有3D（或所谓的2.5D）几何形状的 z 坐标，则返回True。
object.is_ccw
如果坐标是按逆时针顺序排列的，则返回True（边界是一个有正号的区域）。这个方法只适用于 LinearRing 对象。
object.is_empty
如果该特征的 interior 和 boundary（以点集术语）与空集重合，则返回True。
object.is_ring
如果该特征是一个封闭的、简单的 LineString，返回True。一个封闭的特征的 boundary 与空集重合。
object.is_simple
如果该特征不与自身交叉，则返回True。简单性测试只对 LineStrings 和 LinearRings 有意义。
object.is_valid
如果一个特征在1的意义上是 "有效 "的，则返回True。有效性测试只对 Polygons 和 MultiPolygons 有意义。对于其他类型的几何体，总是返回 True。</p>
<p>object.eq(other)
如果两个对象是相同的几何类型，并且两个对象的坐标精确匹配，则返回 True。
object.eals(other)
如果对象的集合论边界、内部和外部与另一个对象的集合论边界、内部和外部相吻合，则返回True。
object.almost_equals(other[, decimal=6])
如果对象在所有点上都近似等于另一个对象，并达到指定的小数位精度，则返回True。
object.contains(other)
如果其他物体的任何点都不在物体的外部，并且其他物体的内部至少有一个点在物体的内部，则返回True。
object.within(other)
如果对象的边界和内部只与对方的内部相交（而不是其边界或外部），则返回True。
object.covers(other)
如果其他物体的每一个点都是物体内部或边界上的一个点，则返回True。这与object.contains(other)相似，只是这不需要其他的内部点位于对象的内部。
object.covered_by(other)
如果对象的每一个点都是其他对象的内部或边界上的一个点，则返回True。这等同于other.cover(object)。
object.crosses(other)
如果对象的内部与另一个对象的内部相交，但不包含它，并且相交的尺寸小于一个或另一个对象的尺寸，则返回True。
object.disjoint(other)
如果对象的边界和内部与另一个对象的边界和内部完全不相交，则返回True。
object.intersects(other)
如果对象的边界或内部以任何方式与其他对象相交，则返回True。
object.intersects(other)
如果对象的边界或内部以任何方式与其他对象相交，则返回True。
object.touches(other)
如果对象至少有一个共同点，并且其内部没有与对方的任何部分相交，则返回True。</p>
<p>object.relate(other)
返回一个对象的内部、边界、外部与另一个几何对象的关系的DE-9IM矩阵的字符串表示。
object.relate_pattern(other, pattern)
如果几何体之间关系的DE-9IM字符串代码满足模式，则返回True，否则返回False。</p>
<p>object.boundary
返回一个低维对象，代表该对象的集合理论边界。
object.centroid
返回对象的几何中心点（点）的表示。
object.difference(other)
返回构成此几何对象的、不构成另一对象的点的表示。
object.intersection(other)
返回此对象与其他几何对象的交集的表示。
object.symmetric_difference(other)
返回本对象中不在其他几何对象中的点的表示，以及其他对象中不在本几何对象中的点的表示。
object.union(other)
返回这个对象和另一个几何对象的点的联合的表示。</p>
<p>object.buffer(distance, resolution=16, cap_style=1, join_style=1, mitre_limit=5.0, single_sided=False)
返回该几何对象给定距离内的所有点的近似表示。
object.convex_hull
返回包含对象中所有点的最小的凸形 Polygon 的表示，除非对象中的点的数量少于3。对于两个点，凸面体塌陷为 LineString ；对于1个点，为 Point。
object.envelope
返回包含该对象的点或最小的矩形多边形（边与坐标轴平行）的表示。
object.minimum_rotated_rectangle
返回包含该对象的一般最小边界矩形。与包络线不同，这个矩形不受约束地与坐标轴平行。如果对象的凸壳是一个退化体（线或点），将返回这个退化体。
object.parallel_offset(distance, side, resolution=16, join_style=1, mitre_limit=5.0)
返回一个LineString或MultiLineString几何体在其右边或左边与对象的距离。此方法仅适用于 LinearRing 和 LineString 对象。
object.simplify(tolerance, preserve_topology=True)
返回几何对象的简化表示。
shapely.affinity.affine_transform(geom, matrix)
返回一个使用仿射变换矩阵的变换几何体。系数矩阵matrix以列表或元组的形式提供，对于二维或三维变换，分别有6或12项。
shapely.affinity.rotate(geom, angle, origin='center', use_radians=False)
返回一个在二维平面上旋转的几何体。旋转的角度可以用度数（默认）或者通过设置use_radians=True来指定弧度。
shapely.affinity.scale(geom, xfact=1.0, yfact=1.0, zfact=1.0, origin='center')
返回一个按比例排列的几何体，沿着每个维度都有相应的缩放系数。
shapely.affinity.skew(geom, xs=0.0, ys=0.0, origin='center', use_radians=False)
返回一个倾斜的几何体，沿着x和y维度的角度进行剪切。
shapely.affinity.translate(geom, xoff=0.0, yoff=0.0, zoff=0.0)
返回一个沿各维度偏移的平移的几何体。</p>
<h3 id="_49">文件处理</h3>
<h4 id="pandas">pandas（数据处理）</h4>
<h5 id="excel">Excel</h5>
<p>读取文件：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-105-1"><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-105-2"><a id="__codelineno-105-2" name="__codelineno-105-2" href="#__codelineno-105-2"></a><span class="c1"># 需要下载xlrd(.xls) 或 openpyxl(.xlsx)</span>
</span><span id="__span-105-3"><a id="__codelineno-105-3" name="__codelineno-105-3" href="#__codelineno-105-3"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;example.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</span><span id="__span-105-4"><a id="__codelineno-105-4" name="__codelineno-105-4" href="#__codelineno-105-4"></a><span class="c1"># 当只读取一个sheet时，返回的是DataFrame对象</span>
</span><span id="__span-105-5"><a id="__codelineno-105-5" name="__codelineno-105-5" href="#__codelineno-105-5"></a><span class="c1"># &#39;r&#39;是转义字符，避免路径中的&#39;\&#39;被转译，也可以不加&#39;r&#39;，但要变为&#39;/&#39;</span>
</span><span id="__span-105-6"><a id="__codelineno-105-6" name="__codelineno-105-6" href="#__codelineno-105-6"></a><span class="c1"># sheet_name 导入指定sheet的表格，默认读取第一个sheet</span>
</span><span id="__span-105-7"><a id="__codelineno-105-7" name="__codelineno-105-7" href="#__codelineno-105-7"></a>
</span><span id="__span-105-8"><a id="__codelineno-105-8" name="__codelineno-105-8" href="#__codelineno-105-8"></a><span class="c1"># index_col，header 指定行、列索引 行索引默认None，列索引默认0</span>
</span><span id="__span-105-9"><a id="__codelineno-105-9" name="__codelineno-105-9" href="#__codelineno-105-9"></a><span class="c1"># header可以设置为None(0，1，2作为索引名）或者具体的行(header=0)</span>
</span><span id="__span-105-10"><a id="__codelineno-105-10" name="__codelineno-105-10" href="#__codelineno-105-10"></a><span class="c1"># index_col可以设置为None(0，1，2作为索引名）或者具体的列(index_col=2，会将那一列的值取出作为列名)或者False(0，1，2作为索引名）</span>
</span><span id="__span-105-11"><a id="__codelineno-105-11" name="__codelineno-105-11" href="#__codelineno-105-11"></a>
</span><span id="__span-105-12"><a id="__codelineno-105-12" name="__codelineno-105-12" href="#__codelineno-105-12"></a><span class="c1"># usecols 指定需要导入的列。也支持usecols=[‘列名’]</span>
</span><span id="__span-105-13"><a id="__codelineno-105-13" name="__codelineno-105-13" href="#__codelineno-105-13"></a>
</span><span id="__span-105-14"><a id="__codelineno-105-14" name="__codelineno-105-14" href="#__codelineno-105-14"></a><span class="c1"># 获取全部数据：df.values，获取全部数据，返回类型为ndarray（二维）。</span>
</span><span id="__span-105-15"><a id="__codelineno-105-15" name="__codelineno-105-15" href="#__codelineno-105-15"></a>
</span><span id="__span-105-16"><a id="__codelineno-105-16" name="__codelineno-105-16" href="#__codelineno-105-16"></a>
</span><span id="__span-105-17"><a id="__codelineno-105-17" name="__codelineno-105-17" href="#__codelineno-105-17"></a><span class="c1"># 在DataFrame中，空值默认是NaN</span>
</span><span id="__span-105-18"><a id="__codelineno-105-18" name="__codelineno-105-18" href="#__codelineno-105-18"></a><span class="c1"># 1)读取 Excel 时禁用 NaN，空单元格变为空字符串 &quot;&quot;</span>
</span><span id="__span-105-19"><a id="__codelineno-105-19" name="__codelineno-105-19" href="#__codelineno-105-19"></a><span class="c1"># df = pd.read_excel(&quot;input.xlsx&quot;, keep_default_na=False)</span>
</span><span id="__span-105-20"><a id="__codelineno-105-20" name="__codelineno-105-20" href="#__codelineno-105-20"></a><span class="c1"># 2)替换所有 NaN 为 None（适合 Python 原生处理）</span>
</span><span id="__span-105-21"><a id="__codelineno-105-21" name="__codelineno-105-21" href="#__codelineno-105-21"></a><span class="c1"># df = df.where(pd.notnull(df), None)</span>
</span><span id="__span-105-22"><a id="__codelineno-105-22" name="__codelineno-105-22" href="#__codelineno-105-22"></a><span class="c1"># 3)或者替换为自定义值（如空字符串）</span>
</span><span id="__span-105-23"><a id="__codelineno-105-23" name="__codelineno-105-23" href="#__codelineno-105-23"></a><span class="c1"># df = df.fillna(&quot;&quot;)</span>
</span><span id="__span-105-24"><a id="__codelineno-105-24" name="__codelineno-105-24" href="#__codelineno-105-24"></a><span class="c1"># 4)逐行处理，将 NaN 替换为 None</span>
</span><span id="__span-105-25"><a id="__codelineno-105-25" name="__codelineno-105-25" href="#__codelineno-105-25"></a><span class="c1"># for row in df.itertuples(index=False):</span>
</span><span id="__span-105-26"><a id="__codelineno-105-26" name="__codelineno-105-26" href="#__codelineno-105-26"></a><span class="c1">#     cleaned_row = [None if pd.isna(x) else x for x in row]</span>
</span><span id="__span-105-27"><a id="__codelineno-105-27" name="__codelineno-105-27" href="#__codelineno-105-27"></a><span class="c1">#     data_list.append(cleaned_row)</span>
</span></code></pre></div>
<p>写入文件：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-106-1"><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-106-2"><a id="__codelineno-106-2" name="__codelineno-106-2" href="#__codelineno-106-2"></a>
</span><span id="__span-106-3"><a id="__codelineno-106-3" name="__codelineno-106-3" href="#__codelineno-106-3"></a><span class="c1"># 创建一个简单的DataFrame</span>
</span><span id="__span-106-4"><a id="__codelineno-106-4" name="__codelineno-106-4" href="#__codelineno-106-4"></a><span class="c1"># 可以是字典、二维数组、Series、DataFrame 或其他可转换为 DataFrame 的对象。</span>
</span><span id="__span-106-5"><a id="__codelineno-106-5" name="__codelineno-106-5" href="#__codelineno-106-5"></a><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-106-6"><a id="__codelineno-106-6" name="__codelineno-106-6" href="#__codelineno-106-6"></a><span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">],</span>
</span><span id="__span-106-7"><a id="__codelineno-106-7" name="__codelineno-106-7" href="#__codelineno-106-7"></a><span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span>
</span><span id="__span-106-8"><a id="__codelineno-106-8" name="__codelineno-106-8" href="#__codelineno-106-8"></a><span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;London&#39;</span><span class="p">,</span> <span class="s1">&#39;Paris&#39;</span><span class="p">]</span>
</span><span id="__span-106-9"><a id="__codelineno-106-9" name="__codelineno-106-9" href="#__codelineno-106-9"></a><span class="p">}</span>
</span><span id="__span-106-10"><a id="__codelineno-106-10" name="__codelineno-106-10" href="#__codelineno-106-10"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="__span-106-11"><a id="__codelineno-106-11" name="__codelineno-106-11" href="#__codelineno-106-11"></a>
</span><span id="__span-106-12"><a id="__codelineno-106-12" name="__codelineno-106-12" href="#__codelineno-106-12"></a><span class="c1"># 将DataFrame导出到Excel文件 </span>
</span><span id="__span-106-13"><a id="__codelineno-106-13" name="__codelineno-106-13" href="#__codelineno-106-13"></a><span class="c1"># index=False参数表示在导出的Excel文件中不包含DataFrame的索引列。</span>
</span><span id="__span-106-14"><a id="__codelineno-106-14" name="__codelineno-106-14" href="#__codelineno-106-14"></a><span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;output.xlsx&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></code></pre></div>
<p>对较长的文本内容美化：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-107-1"><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-107-2"><a id="__codelineno-107-2" name="__codelineno-107-2" href="#__codelineno-107-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl</span><span class="w"> </span><span class="kn">import</span> <span class="n">Workbook</span>
</span><span id="__span-107-3"><a id="__codelineno-107-3" name="__codelineno-107-3" href="#__codelineno-107-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_column_letter</span>
</span><span id="__span-107-4"><a id="__codelineno-107-4" name="__codelineno-107-4" href="#__codelineno-107-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl.styles</span><span class="w"> </span><span class="kn">import</span> <span class="n">Alignment</span>
</span><span id="__span-107-5"><a id="__codelineno-107-5" name="__codelineno-107-5" href="#__codelineno-107-5"></a>
</span><span id="__span-107-6"><a id="__codelineno-107-6" name="__codelineno-107-6" href="#__codelineno-107-6"></a><span class="c1"># 创建一个示例 DataFrame</span>
</span><span id="__span-107-7"><a id="__codelineno-107-7" name="__codelineno-107-7" href="#__codelineno-107-7"></a><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-107-8"><a id="__codelineno-107-8" name="__codelineno-107-8" href="#__codelineno-107-8"></a>    <span class="s2">&quot;列1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;短文本&quot;</span><span class="p">,</span> <span class="s2">&quot;较长的文本内容需要换行显示&quot;</span><span class="p">],</span>
</span><span id="__span-107-9"><a id="__codelineno-107-9" name="__codelineno-107-9" href="#__codelineno-107-9"></a>    <span class="s2">&quot;列2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Another short text&quot;</span><span class="p">,</span> <span class="s2">&quot;Another long text that needs wrapping&quot;</span><span class="p">]</span>
</span><span id="__span-107-10"><a id="__codelineno-107-10" name="__codelineno-107-10" href="#__codelineno-107-10"></a><span class="p">}</span>
</span><span id="__span-107-11"><a id="__codelineno-107-11" name="__codelineno-107-11" href="#__codelineno-107-11"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="__span-107-12"><a id="__codelineno-107-12" name="__codelineno-107-12" href="#__codelineno-107-12"></a>
</span><span id="__span-107-13"><a id="__codelineno-107-13" name="__codelineno-107-13" href="#__codelineno-107-13"></a><span class="c1"># 将 DataFrame 写入 Excel 文件</span>
</span><span id="__span-107-14"><a id="__codelineno-107-14" name="__codelineno-107-14" href="#__codelineno-107-14"></a><span class="n">excel_file</span> <span class="o">=</span> <span class="s2">&quot;output.xlsx&quot;</span>
</span><span id="__span-107-15"><a id="__codelineno-107-15" name="__codelineno-107-15" href="#__codelineno-107-15"></a><span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">excel_file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-107-16"><a id="__codelineno-107-16" name="__codelineno-107-16" href="#__codelineno-107-16"></a>
</span><span id="__span-107-17"><a id="__codelineno-107-17" name="__codelineno-107-17" href="#__codelineno-107-17"></a><span class="c1"># 使用 openpyxl 调整列宽和设置文本换行</span>
</span><span id="__span-107-18"><a id="__codelineno-107-18" name="__codelineno-107-18" href="#__codelineno-107-18"></a><span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_workbook</span>
</span><span id="__span-107-19"><a id="__codelineno-107-19" name="__codelineno-107-19" href="#__codelineno-107-19"></a>
</span><span id="__span-107-20"><a id="__codelineno-107-20" name="__codelineno-107-20" href="#__codelineno-107-20"></a><span class="c1"># 加载刚刚保存的 Excel 文件</span>
</span><span id="__span-107-21"><a id="__codelineno-107-21" name="__codelineno-107-21" href="#__codelineno-107-21"></a><span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="n">excel_file</span><span class="p">)</span>
</span><span id="__span-107-22"><a id="__codelineno-107-22" name="__codelineno-107-22" href="#__codelineno-107-22"></a><span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
</span><span id="__span-107-23"><a id="__codelineno-107-23" name="__codelineno-107-23" href="#__codelineno-107-23"></a>
</span><span id="__span-107-24"><a id="__codelineno-107-24" name="__codelineno-107-24" href="#__codelineno-107-24"></a><span class="c1"># 遍历所有列，设置列宽自适应</span>
</span><span id="__span-107-25"><a id="__codelineno-107-25" name="__codelineno-107-25" href="#__codelineno-107-25"></a><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="__span-107-26"><a id="__codelineno-107-26" name="__codelineno-107-26" href="#__codelineno-107-26"></a>    <span class="n">max_length</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-107-27"><a id="__codelineno-107-27" name="__codelineno-107-27" href="#__codelineno-107-27"></a>    <span class="n">col_letter</span> <span class="o">=</span> <span class="n">get_column_letter</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>  <span class="c1"># 获取列字母</span>
</span><span id="__span-107-28"><a id="__codelineno-107-28" name="__codelineno-107-28" href="#__codelineno-107-28"></a>    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
</span><span id="__span-107-29"><a id="__codelineno-107-29" name="__codelineno-107-29" href="#__codelineno-107-29"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-107-30"><a id="__codelineno-107-30" name="__codelineno-107-30" href="#__codelineno-107-30"></a>            <span class="k">if</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>  <span class="c1"># 计算单元格内容的长度</span>
</span><span id="__span-107-31"><a id="__codelineno-107-31" name="__codelineno-107-31" href="#__codelineno-107-31"></a>                <span class="n">max_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_length</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
</span><span id="__span-107-32"><a id="__codelineno-107-32" name="__codelineno-107-32" href="#__codelineno-107-32"></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="__span-107-33"><a id="__codelineno-107-33" name="__codelineno-107-33" href="#__codelineno-107-33"></a>            <span class="k">pass</span>
</span><span id="__span-107-34"><a id="__codelineno-107-34" name="__codelineno-107-34" href="#__codelineno-107-34"></a>    <span class="c1"># +2 添加一些额外空间显示，并且限制最大列宽为50防止过长</span>
</span><span id="__span-107-35"><a id="__codelineno-107-35" name="__codelineno-107-35" href="#__codelineno-107-35"></a>    <span class="n">adjusted_width</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_length</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</span><span id="__span-107-36"><a id="__codelineno-107-36" name="__codelineno-107-36" href="#__codelineno-107-36"></a>    <span class="n">ws</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="n">col_letter</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">adjusted_width</span>
</span><span id="__span-107-37"><a id="__codelineno-107-37" name="__codelineno-107-37" href="#__codelineno-107-37"></a>
</span><span id="__span-107-38"><a id="__codelineno-107-38" name="__codelineno-107-38" href="#__codelineno-107-38"></a><span class="c1"># 设置文本换行和对齐方式</span>
</span><span id="__span-107-39"><a id="__codelineno-107-39" name="__codelineno-107-39" href="#__codelineno-107-39"></a><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">():</span>
</span><span id="__span-107-40"><a id="__codelineno-107-40" name="__codelineno-107-40" href="#__codelineno-107-40"></a>    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
</span><span id="__span-107-41"><a id="__codelineno-107-41" name="__codelineno-107-41" href="#__codelineno-107-41"></a>        <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">wrap_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">horizontal</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</span><span id="__span-107-42"><a id="__codelineno-107-42" name="__codelineno-107-42" href="#__codelineno-107-42"></a>
</span><span id="__span-107-43"><a id="__codelineno-107-43" name="__codelineno-107-43" href="#__codelineno-107-43"></a><span class="c1"># 保存修改后的 Excel 文件</span>
</span><span id="__span-107-44"><a id="__codelineno-107-44" name="__codelineno-107-44" href="#__codelineno-107-44"></a><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">excel_file</span><span class="p">)</span>
</span></code></pre></div>
<p><code>openpyxl</code> 支持在Excel中插入图片，但图片会浮动在单元格上方，不会随单元格自动调整位置。
<code>xlsxwriter</code> 适用于创建新Excel文件，支持直接插入图片到指定位置。
<code>xlwings</code> 通过Excel应用程序接口操作，适合需要精确控制图片位置的场景。</p>
<p>添加超链接</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-108-1"><a id="__codelineno-108-1" name="__codelineno-108-1" href="#__codelineno-108-1"></a><span class="n">value_cell</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row_num</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">row_data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="__span-108-2"><a id="__codelineno-108-2" name="__codelineno-108-2" href="#__codelineno-108-2"></a><span class="n">value_cell</span><span class="o">.</span><span class="n">hyperlink</span> <span class="o">=</span> <span class="n">url</span> <span class="c1"># 添加超链接</span>
</span><span id="__span-108-3"><a id="__codelineno-108-3" name="__codelineno-108-3" href="#__codelineno-108-3"></a><span class="n">value_cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;0000FF&quot;</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="s2">&quot;single&quot;</span><span class="p">)</span>  <span class="c1"># 设置为蓝色并带下划线</span>
</span></code></pre></div>
<h4 id="pillow">pillow（图像处理）</h4>
<p>图像处理库
<code>pip install pillow</code></p>
<p>Image 是 Pillow 最常用的类</p>
<h5 id="_50">创建图像实例</h5>
<ol>
<li><strong>通过文件创建 Image 对象</strong></li>
</ol>
<div class="language-python highlight"><pre><span></span><code><span id="__span-109-1"><a id="__codelineno-109-1" name="__codelineno-109-1" href="#__codelineno-109-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
</span><span id="__span-109-2"><a id="__codelineno-109-2" name="__codelineno-109-2" href="#__codelineno-109-2"></a>
</span><span id="__span-109-3"><a id="__codelineno-109-3" name="__codelineno-109-3" href="#__codelineno-109-3"></a><span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;python-logo.png&#39;</span><span class="p">)</span>  <span class="c1"># 创建图像实例</span>
</span><span id="__span-109-4"><a id="__codelineno-109-4" name="__codelineno-109-4" href="#__codelineno-109-4"></a><span class="c1"># 查看图像实例的属性</span>
</span><span id="__span-109-5"><a id="__codelineno-109-5" name="__codelineno-109-5" href="#__codelineno-109-5"></a><span class="c1"># format 图像格式;size 图像的 (宽,高) 元组;mode 常见模式，默认 RGB 真彩图像</span>
</span><span id="__span-109-6"><a id="__codelineno-109-6" name="__codelineno-109-6" href="#__codelineno-109-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">format</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
</span><span id="__span-109-7"><a id="__codelineno-109-7" name="__codelineno-109-7" href="#__codelineno-109-7"></a>
</span><span id="__span-109-8"><a id="__codelineno-109-8" name="__codelineno-109-8" href="#__codelineno-109-8"></a><span class="n">image</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># 显示图像</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-110-1"><a id="__codelineno-110-1" name="__codelineno-110-1" href="#__codelineno-110-1"></a><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;python-logo.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">)</span> <span class="c1"># RGB、L灰度图</span>
</span><span id="__span-110-2"><a id="__codelineno-110-2" name="__codelineno-110-2" href="#__codelineno-110-2"></a><span class="n">rotated_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>  <span class="c1"># 旋转45度</span>
</span><span id="__span-110-3"><a id="__codelineno-110-3" name="__codelineno-110-3" href="#__codelineno-110-3"></a><span class="n">默认旋转中心是图像的中心</span><span class="err">，</span><span class="n">逆时针旋转</span><span class="err">。</span><span class="n">如果需要顺时针旋转</span><span class="err">，</span><span class="n">可以传递负角度</span><span class="err">。</span>
</span></code></pre></div>
<ol>
<li>从打开文件中读取
   可以从文件对象读取而不是文件名，但文件对象必须实现 read( ) ，seek( ) 和 tell( ) 方法，并且是以二进制模式打开。</li>
</ol>
<div class="language-python highlight"><pre><span></span><code><span id="__span-111-1"><a id="__codelineno-111-1" name="__codelineno-111-1" href="#__codelineno-111-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
</span><span id="__span-111-2"><a id="__codelineno-111-2" name="__codelineno-111-2" href="#__codelineno-111-2"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;hopper.ppm&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
</span><span id="__span-111-3"><a id="__codelineno-111-3" name="__codelineno-111-3" href="#__codelineno-111-3"></a>    <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span></code></pre></div>
<ol>
<li>从 string 二进制流中读取
   要从字符串数据中读取图像，需使用 io 类：</li>
</ol>
<div class="language-python highlight"><pre><span></span><code><span id="__span-112-1"><a id="__codelineno-112-1" name="__codelineno-112-1" href="#__codelineno-112-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io</span>
</span><span id="__span-112-2"><a id="__codelineno-112-2" name="__codelineno-112-2" href="#__codelineno-112-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
</span><span id="__span-112-3"><a id="__codelineno-112-3" name="__codelineno-112-3" href="#__codelineno-112-3"></a>
</span><span id="__span-112-4"><a id="__codelineno-112-4" name="__codelineno-112-4" href="#__codelineno-112-4"></a><span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">buffer</span><span class="p">))</span>
</span></code></pre></div>
<p>注意：在读取图像 header 之前将文件倒回（使用 seek(0) ）。</p>
<ol>
<li>从tar文件中读取</li>
</ol>
<div class="language-python highlight"><pre><span></span><code><span id="__span-113-1"><a id="__codelineno-113-1" name="__codelineno-113-1" href="#__codelineno-113-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">TarIO</span>
</span><span id="__span-113-2"><a id="__codelineno-113-2" name="__codelineno-113-2" href="#__codelineno-113-2"></a>
</span><span id="__span-113-3"><a id="__codelineno-113-3" name="__codelineno-113-3" href="#__codelineno-113-3"></a><span class="n">fp</span> <span class="o">=</span> <span class="n">TarIO</span><span class="o">.</span><span class="n">TarIO</span><span class="p">(</span><span class="s2">&quot;Imaging.tar&quot;</span><span class="p">,</span> <span class="s2">&quot;Imaging/test/lena.ppm&quot;</span><span class="p">)</span>
</span><span id="__span-113-4"><a id="__codelineno-113-4" name="__codelineno-113-4" href="#__codelineno-113-4"></a><span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span></code></pre></div>
<h5 id="_51">读写图像</h5>
<ol>
<li><strong>格式转换并保存图像</strong></li>
</ol>
<div class="language-python highlight"><pre><span></span><code><span id="__span-114-1"><a id="__codelineno-114-1" name="__codelineno-114-1" href="#__codelineno-114-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-114-2"><a id="__codelineno-114-2" name="__codelineno-114-2" href="#__codelineno-114-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
</span><span id="__span-114-3"><a id="__codelineno-114-3" name="__codelineno-114-3" href="#__codelineno-114-3"></a>
</span><span id="__span-114-4"><a id="__codelineno-114-4" name="__codelineno-114-4" href="#__codelineno-114-4"></a><span class="n">image_path</span><span class="o">=</span><span class="s1">&#39;python-logo.png&#39;</span> <span class="c1"># 图片位置</span>
</span><span id="__span-114-5"><a id="__codelineno-114-5" name="__codelineno-114-5" href="#__codelineno-114-5"></a><span class="n">f</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span> <span class="c1"># 获取文件名与后缀</span>
</span><span id="__span-114-6"><a id="__codelineno-114-6" name="__codelineno-114-6" href="#__codelineno-114-6"></a><span class="n">outfile</span> <span class="o">=</span> <span class="n">f</span> <span class="o">+</span> <span class="s2">&quot;.jpg&quot;</span>
</span><span id="__span-114-7"><a id="__codelineno-114-7" name="__codelineno-114-7" href="#__codelineno-114-7"></a><span class="k">if</span> <span class="n">image_path</span> <span class="o">!=</span> <span class="n">outfile</span><span class="p">:</span>
</span><span id="__span-114-8"><a id="__codelineno-114-8" name="__codelineno-114-8" href="#__codelineno-114-8"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-114-9"><a id="__codelineno-114-9" name="__codelineno-114-9" href="#__codelineno-114-9"></a>        <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span> <span class="c1"># 修改文件格式</span>
</span><span id="__span-114-10"><a id="__codelineno-114-10" name="__codelineno-114-10" href="#__codelineno-114-10"></a>    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
</span><span id="__span-114-11"><a id="__codelineno-114-11" name="__codelineno-114-11" href="#__codelineno-114-11"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cannot convert&quot;</span><span class="p">,</span> <span class="n">image_path</span><span class="p">)</span>
</span></code></pre></div>
<p>如果图片mode是RGBA那么会出现异常,因为 JPG 不支持透明度。要么丢弃Alpha , 要么保存为.png
save() 函数有两个参数，如果文件名没有指定图片格式，那么第二个参数是必须的，他指定图片的格式</p>
<ol>
<li>创建缩略图</li>
</ol>
<div class="language-python highlight"><pre><span></span><code><span id="__span-115-1"><a id="__codelineno-115-1" name="__codelineno-115-1" href="#__codelineno-115-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-115-2"><a id="__codelineno-115-2" name="__codelineno-115-2" href="#__codelineno-115-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
</span><span id="__span-115-3"><a id="__codelineno-115-3" name="__codelineno-115-3" href="#__codelineno-115-3"></a>
</span><span id="__span-115-4"><a id="__codelineno-115-4" name="__codelineno-115-4" href="#__codelineno-115-4"></a><span class="n">image_path</span> <span class="o">=</span> <span class="s1">&#39;python-logo.png&#39;</span>  <span class="c1"># 图片位置</span>
</span><span id="__span-115-5"><a id="__codelineno-115-5" name="__codelineno-115-5" href="#__codelineno-115-5"></a><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>  <span class="c1"># 文件大小</span>
</span><span id="__span-115-6"><a id="__codelineno-115-6" name="__codelineno-115-6" href="#__codelineno-115-6"></a><span class="n">f</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>  <span class="c1"># 获取文件名与后缀</span>
</span><span id="__span-115-7"><a id="__codelineno-115-7" name="__codelineno-115-7" href="#__codelineno-115-7"></a><span class="n">outfile</span> <span class="o">=</span> <span class="n">f</span> <span class="o">+</span> <span class="s2">&quot;.thumbnail&quot;</span>
</span><span id="__span-115-8"><a id="__codelineno-115-8" name="__codelineno-115-8" href="#__codelineno-115-8"></a><span class="k">if</span> <span class="n">image_path</span> <span class="o">!=</span> <span class="n">outfile</span><span class="p">:</span>
</span><span id="__span-115-9"><a id="__codelineno-115-9" name="__codelineno-115-9" href="#__codelineno-115-9"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-115-10"><a id="__codelineno-115-10" name="__codelineno-115-10" href="#__codelineno-115-10"></a>        <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
</span><span id="__span-115-11"><a id="__codelineno-115-11" name="__codelineno-115-11" href="#__codelineno-115-11"></a>        <span class="n">im</span><span class="o">.</span><span class="n">thumbnail</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>  <span class="c1"># 设置缩略图大小</span>
</span><span id="__span-115-12"><a id="__codelineno-115-12" name="__codelineno-115-12" href="#__codelineno-115-12"></a>        <span class="n">im</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s2">&quot;JPEG&quot;</span><span class="p">)</span>
</span><span id="__span-115-13"><a id="__codelineno-115-13" name="__codelineno-115-13" href="#__codelineno-115-13"></a>    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
</span><span id="__span-115-14"><a id="__codelineno-115-14" name="__codelineno-115-14" href="#__codelineno-115-14"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cannot convert&quot;</span><span class="p">,</span> <span class="n">image_path</span><span class="p">)</span>
</span></code></pre></div>
<h5 id="_52">剪贴，粘贴、合并图像</h5>
<p>1）<strong>从图像复制子矩形</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-116-1"><a id="__codelineno-116-1" name="__codelineno-116-1" href="#__codelineno-116-1"></a><span class="n">box</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
</span><span id="__span-116-2"><a id="__codelineno-116-2" name="__codelineno-116-2" href="#__codelineno-116-2"></a><span class="n">region</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
</span><span id="__span-116-3"><a id="__codelineno-116-3" name="__codelineno-116-3" href="#__codelineno-116-3"></a><span class="c1"># 图像基于左上角为（0,0）的坐标</span>
</span><span id="__span-116-4"><a id="__codelineno-116-4" name="__codelineno-116-4" href="#__codelineno-116-4"></a><span class="c1"># 定义box元组，box 坐标为 (左，上，右，下）。示例中为 300 * 300 像素。</span>
</span></code></pre></div>
<p>2）处理子矩形并将其粘贴回来</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-117-1"><a id="__codelineno-117-1" name="__codelineno-117-1" href="#__codelineno-117-1"></a><span class="n">region</span> <span class="o">=</span> <span class="n">region</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">ROTATE_180</span><span class="p">)</span> <span class="c1"># 颠倒180度</span>
</span><span id="__span-117-2"><a id="__codelineno-117-2" name="__codelineno-117-2" href="#__codelineno-117-2"></a><span class="n">box</span> <span class="o">=</span> <span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">700</span><span class="p">)</span>  <span class="c1"># 粘贴位置，像素必须吻合，300 * 300</span>
</span><span id="__span-117-3"><a id="__codelineno-117-3" name="__codelineno-117-3" href="#__codelineno-117-3"></a><span class="n">im</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">box</span><span class="p">)</span>
</span></code></pre></div>
<p>3）<strong>分离和合并通道</strong>
Pillow 允许处理图像的各个通道，例如RGB图像有R、G、B三个通道。 split 方法分离图像通道，如果图像为单通道则返回图像本身。merge 合并函数采用图像的 mode 和 通道元组为参数，将它们合并成新图像。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-118-1"><a id="__codelineno-118-1" name="__codelineno-118-1" href="#__codelineno-118-1"></a><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="__span-118-2"><a id="__codelineno-118-2" name="__codelineno-118-2" href="#__codelineno-118-2"></a><span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>
</span></code></pre></div>
<h5 id="_53">几何变换</h5>
<p>PIL.Image.Image 包含调整图像大小 resize() 和旋转 rotate() 的方法。前者采用元组给出新的大小，后者采用逆时针方向的角度。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-119-1"><a id="__codelineno-119-1" name="__codelineno-119-1" href="#__codelineno-119-1"></a><span class="c1"># 调整大小为(128, 128)</span>
</span><span id="__span-119-2"><a id="__codelineno-119-2" name="__codelineno-119-2" href="#__codelineno-119-2"></a><span class="n">out</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
</span><span id="__span-119-3"><a id="__codelineno-119-3" name="__codelineno-119-3" href="#__codelineno-119-3"></a><span class="c1"># 逆时针旋转 45度</span>
</span><span id="__span-119-4"><a id="__codelineno-119-4" name="__codelineno-119-4" href="#__codelineno-119-4"></a><span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>
</span><span id="__span-119-5"><a id="__codelineno-119-5" name="__codelineno-119-5" href="#__codelineno-119-5"></a><span class="c1"># 水平左右翻转 Image.FLIP_TOP_BOTTOM/Image.ROTATE_90/Image.ROTATE_180</span>
</span><span id="__span-119-6"><a id="__codelineno-119-6" name="__codelineno-119-6" href="#__codelineno-119-6"></a><span class="n">im</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">FLIP_LEFT_RIGHT</span><span class="p">)</span>
</span></code></pre></div>
<h5 id="_54">颜色变换</h5>
<div class="language-python highlight"><pre><span></span><code><span id="__span-120-1"><a id="__codelineno-120-1" name="__codelineno-120-1" href="#__codelineno-120-1"></a><span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;hopper.ppm&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">)</span> <span class="c1"># 转换为灰阶图像</span>
</span></code></pre></div>
<h5 id="_55">图像增强</h5>
<p>1）Filters 过滤器
ImageFilter 模块有很多预定义的增强过滤器</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-121-1"><a id="__codelineno-121-1" name="__codelineno-121-1" href="#__codelineno-121-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImageFilter</span>
</span><span id="__span-121-2"><a id="__codelineno-121-2" name="__codelineno-121-2" href="#__codelineno-121-2"></a><span class="n">out</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ImageFilter</span><span class="o">.</span><span class="n">DETAIL</span><span class="p">)</span>
</span></code></pre></div>
<p>2）像素点处理
point() 方法可用于转换图像的像素值（如对比度），在大多数情况下，可以将函数对象作为参数传递格此方法，它根据函数返回值对每个像素进行处理。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-122-1"><a id="__codelineno-122-1" name="__codelineno-122-1" href="#__codelineno-122-1"></a><span class="c1"># 每个像素点扩大1.2倍</span>
</span><span id="__span-122-2"><a id="__codelineno-122-2" name="__codelineno-122-2" href="#__codelineno-122-2"></a><span class="n">out</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>
</span></code></pre></div>
<p>3）处理单独通道</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-123-1"><a id="__codelineno-123-1" name="__codelineno-123-1" href="#__codelineno-123-1"></a><span class="c1"># 将通道分离</span>
</span><span id="__span-123-2"><a id="__codelineno-123-2" name="__codelineno-123-2" href="#__codelineno-123-2"></a><span class="n">source</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="__span-123-3"><a id="__codelineno-123-3" name="__codelineno-123-3" href="#__codelineno-123-3"></a><span class="n">R</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
</span><span id="__span-123-4"><a id="__codelineno-123-4" name="__codelineno-123-4" href="#__codelineno-123-4"></a>
</span><span id="__span-123-5"><a id="__codelineno-123-5" name="__codelineno-123-5" href="#__codelineno-123-5"></a><span class="c1"># 选择红色小于100的区域</span>
</span><span id="__span-123-6"><a id="__codelineno-123-6" name="__codelineno-123-6" href="#__codelineno-123-6"></a><span class="n">mask</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="n">R</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span> <span class="ow">and</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="__span-123-7"><a id="__codelineno-123-7" name="__codelineno-123-7" href="#__codelineno-123-7"></a><span class="c1"># 处理绿色</span>
</span><span id="__span-123-8"><a id="__codelineno-123-8" name="__codelineno-123-8" href="#__codelineno-123-8"></a><span class="n">out</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="n">G</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="mf">0.7</span><span class="p">)</span>
</span><span id="__span-123-9"><a id="__codelineno-123-9" name="__codelineno-123-9" href="#__codelineno-123-9"></a><span class="c1"># 粘贴已处理的通道，红色通道仅限于&lt;100</span>
</span><span id="__span-123-10"><a id="__codelineno-123-10" name="__codelineno-123-10" href="#__codelineno-123-10"></a><span class="n">source</span><span class="p">[</span><span class="n">G</span><span class="p">]</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
</span><span id="__span-123-11"><a id="__codelineno-123-11" name="__codelineno-123-11" href="#__codelineno-123-11"></a><span class="c1"># 合并图像</span>
</span><span id="__span-123-12"><a id="__codelineno-123-12" name="__codelineno-123-12" href="#__codelineno-123-12"></a><span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
</span></code></pre></div>
<p>4）高级增强
其他图像增强功能可以使用 ImageEnhance 模块中的类。从图像创建后，可以使用 ImageEnhance 快速调整图片的对比度、亮度、饱和度和清晰度。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-124-1"><a id="__codelineno-124-1" name="__codelineno-124-1" href="#__codelineno-124-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImageEnhance</span>
</span><span id="__span-124-2"><a id="__codelineno-124-2" name="__codelineno-124-2" href="#__codelineno-124-2"></a>
</span><span id="__span-124-3"><a id="__codelineno-124-3" name="__codelineno-124-3" href="#__codelineno-124-3"></a><span class="n">enh</span> <span class="o">=</span> <span class="n">ImageEnhance</span><span class="o">.</span><span class="n">Contrast</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>  <span class="c1"># 创建调整对比度对象</span>
</span><span id="__span-124-4"><a id="__codelineno-124-4" name="__codelineno-124-4" href="#__codelineno-124-4"></a><span class="c1"># 参数是一个浮点数。1.0是原始图像，更高的值增加对比度，更低的值降低。</span>
</span><span id="__span-124-5"><a id="__codelineno-124-5" name="__codelineno-124-5" href="#__codelineno-124-5"></a><span class="n">enh</span><span class="o">.</span><span class="n">enhance</span><span class="p">(</span><span class="mf">1.3</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># 增加30%对比度</span>
</span><span id="__span-124-6"><a id="__codelineno-124-6" name="__codelineno-124-6" href="#__codelineno-124-6"></a>
</span><span id="__span-124-7"><a id="__codelineno-124-7" name="__codelineno-124-7" href="#__codelineno-124-7"></a><span class="c1"># ImageEnhance.Contrast(im) 对比度  </span>
</span><span id="__span-124-8"><a id="__codelineno-124-8" name="__codelineno-124-8" href="#__codelineno-124-8"></a><span class="c1"># ImageEnhance.Color(im) 色彩饱和度  </span>
</span><span id="__span-124-9"><a id="__codelineno-124-9" name="__codelineno-124-9" href="#__codelineno-124-9"></a><span class="c1"># ImageEnhance.Brightness(im) 亮度  </span>
</span><span id="__span-124-10"><a id="__codelineno-124-10" name="__codelineno-124-10" href="#__codelineno-124-10"></a><span class="c1"># ImageEnhance.Sharpness(im) 清晰度</span>
</span></code></pre></div>
<h5 id="_56">动态图像</h5>
<p>Pillow 支持一些动态图像处理（如FLI/FLC，GIF等格式）。TIFF文件同样可以包含数帧图像。
打开动态图像时，PIL 会自动加载序列中的第一帧。你可以使用 seek 和 tell 方法在不同的帧之间移动。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-125-1"><a id="__codelineno-125-1" name="__codelineno-125-1" href="#__codelineno-125-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
</span><span id="__span-125-2"><a id="__codelineno-125-2" name="__codelineno-125-2" href="#__codelineno-125-2"></a>
</span><span id="__span-125-3"><a id="__codelineno-125-3" name="__codelineno-125-3" href="#__codelineno-125-3"></a><span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;animation.gif&quot;</span><span class="p">)</span>
</span><span id="__span-125-4"><a id="__codelineno-125-4" name="__codelineno-125-4" href="#__codelineno-125-4"></a><span class="n">im</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 跳到第二帧</span>
</span><span id="__span-125-5"><a id="__codelineno-125-5" name="__codelineno-125-5" href="#__codelineno-125-5"></a>
</span><span id="__span-125-6"><a id="__codelineno-125-6" name="__codelineno-125-6" href="#__codelineno-125-6"></a><span class="k">try</span><span class="p">:</span>
</span><span id="__span-125-7"><a id="__codelineno-125-7" name="__codelineno-125-7" href="#__codelineno-125-7"></a>    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-125-8"><a id="__codelineno-125-8" name="__codelineno-125-8" href="#__codelineno-125-8"></a>        <span class="n">im</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># tell() 获取当前帧的索引号</span>
</span><span id="__span-125-9"><a id="__codelineno-125-9" name="__codelineno-125-9" href="#__codelineno-125-9"></a><span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span> <span class="c1"># 当读取到最后一帧时，Pillow抛出EOFError异常。</span>
</span><span id="__span-125-10"><a id="__codelineno-125-10" name="__codelineno-125-10" href="#__codelineno-125-10"></a>    <span class="k">pass</span> <span class="c1"># 结束</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-126-1"><a id="__codelineno-126-1" name="__codelineno-126-1" href="#__codelineno-126-1"></a><span class="c1"># 保存动态图像</span>
</span><span id="__span-126-2"><a id="__codelineno-126-2" name="__codelineno-126-2" href="#__codelineno-126-2"></a><span class="n">im</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">append_images</span><span class="o">=</span><span class="p">[</span><span class="n">im1</span><span class="p">,</span> <span class="n">im2</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
</span></code></pre></div>
<h5 id="imagedraw">ImageDraw</h5>
<p>ImageDraw 用于在图像上直接绘制文本、形状等内容。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-127-1"><a id="__codelineno-127-1" name="__codelineno-127-1" href="#__codelineno-127-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageFont</span>
</span><span id="__span-127-2"><a id="__codelineno-127-2" name="__codelineno-127-2" href="#__codelineno-127-2"></a>
</span><span id="__span-127-3"><a id="__codelineno-127-3" name="__codelineno-127-3" href="#__codelineno-127-3"></a><span class="c1"># 打开图像</span>
</span><span id="__span-127-4"><a id="__codelineno-127-4" name="__codelineno-127-4" href="#__codelineno-127-4"></a><span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.jpg&quot;</span><span class="p">)</span>
</span><span id="__span-127-5"><a id="__codelineno-127-5" name="__codelineno-127-5" href="#__codelineno-127-5"></a>
</span><span id="__span-127-6"><a id="__codelineno-127-6" name="__codelineno-127-6" href="#__codelineno-127-6"></a><span class="c1"># 创建 ImageDraw 对象</span>
</span><span id="__span-127-7"><a id="__codelineno-127-7" name="__codelineno-127-7" href="#__codelineno-127-7"></a><span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
</span><span id="__span-127-8"><a id="__codelineno-127-8" name="__codelineno-127-8" href="#__codelineno-127-8"></a>
</span><span id="__span-127-9"><a id="__codelineno-127-9" name="__codelineno-127-9" href="#__codelineno-127-9"></a><span class="c1"># 设置字体并绘制文本</span>
</span><span id="__span-127-10"><a id="__codelineno-127-10" name="__codelineno-127-10" href="#__codelineno-127-10"></a><span class="k">try</span><span class="p">:</span>
</span><span id="__span-127-11"><a id="__codelineno-127-11" name="__codelineno-127-11" href="#__codelineno-127-11"></a>    <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>  <span class="c1"># 字体文件路径和字号</span>
</span><span id="__span-127-12"><a id="__codelineno-127-12" name="__codelineno-127-12" href="#__codelineno-127-12"></a><span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
</span><span id="__span-127-13"><a id="__codelineno-127-13" name="__codelineno-127-13" href="#__codelineno-127-13"></a>    <span class="c1"># 回退到默认字体，默认字体可以通过default_font.font_variant(size=20)调整字号</span>
</span><span id="__span-127-14"><a id="__codelineno-127-14" name="__codelineno-127-14" href="#__codelineno-127-14"></a>    <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">load_default</span><span class="p">()</span>
</span><span id="__span-127-15"><a id="__codelineno-127-15" name="__codelineno-127-15" href="#__codelineno-127-15"></a>
</span><span id="__span-127-16"><a id="__codelineno-127-16" name="__codelineno-127-16" href="#__codelineno-127-16"></a><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Hello, Pillow!&quot;</span>
</span><span id="__span-127-17"><a id="__codelineno-127-17" name="__codelineno-127-17" href="#__codelineno-127-17"></a><span class="c1"># 在 (10, 10) 处绘制文本，默认颜色为白色</span>
</span><span id="__span-127-18"><a id="__codelineno-127-18" name="__codelineno-127-18" href="#__codelineno-127-18"></a><span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">title</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">)</span>
</span><span id="__span-127-19"><a id="__codelineno-127-19" name="__codelineno-127-19" href="#__codelineno-127-19"></a>
</span><span id="__span-127-20"><a id="__codelineno-127-20" name="__codelineno-127-20" href="#__codelineno-127-20"></a><span class="c1"># 显示图像</span>
</span><span id="__span-127-21"><a id="__codelineno-127-21" name="__codelineno-127-21" href="#__codelineno-127-21"></a><span class="n">im</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<h5 id="psdraw">PSDraw</h5>
<p>PSDraw 用于生成 PostScript 文件。PostScript 是一种页面描述语言，常用于打印和出版领域。
不过一般直接使用ImageDraw</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-128-1"><a id="__codelineno-128-1" name="__codelineno-128-1" href="#__codelineno-128-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
</span><span id="__span-128-2"><a id="__codelineno-128-2" name="__codelineno-128-2" href="#__codelineno-128-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">PSDraw</span>
</span><span id="__span-128-3"><a id="__codelineno-128-3" name="__codelineno-128-3" href="#__codelineno-128-3"></a>
</span><span id="__span-128-4"><a id="__codelineno-128-4" name="__codelineno-128-4" href="#__codelineno-128-4"></a><span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.jpg&quot;</span><span class="p">)</span>
</span><span id="__span-128-5"><a id="__codelineno-128-5" name="__codelineno-128-5" href="#__codelineno-128-5"></a><span class="c1"># 定义要绘制的标题文本</span>
</span><span id="__span-128-6"><a id="__codelineno-128-6" name="__codelineno-128-6" href="#__codelineno-128-6"></a><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;hopper&quot;</span>
</span><span id="__span-128-7"><a id="__codelineno-128-7" name="__codelineno-128-7" href="#__codelineno-128-7"></a><span class="c1"># 定义了图像绘制的区域，单位为点（1 点 = 1/72 英寸）</span>
</span><span id="__span-128-8"><a id="__codelineno-128-8" name="__codelineno-128-8" href="#__codelineno-128-8"></a><span class="n">box</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="mi">72</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="mi">72</span><span class="p">,</span> <span class="mi">7</span><span class="o">*</span><span class="mi">72</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="mi">72</span><span class="p">)</span>
</span><span id="__span-128-9"><a id="__codelineno-128-9" name="__codelineno-128-9" href="#__codelineno-128-9"></a>
</span><span id="__span-128-10"><a id="__codelineno-128-10" name="__codelineno-128-10" href="#__codelineno-128-10"></a><span class="c1"># 创建一个 PostScript 绘图对象，默认输出到标准输出（`sys.stdout`）</span>
</span><span id="__span-128-11"><a id="__codelineno-128-11" name="__codelineno-128-11" href="#__codelineno-128-11"></a><span class="c1">## 可以改成 `PSDraw.PSDraw(f)` 输出到文件</span>
</span><span id="__span-128-12"><a id="__codelineno-128-12" name="__codelineno-128-12" href="#__codelineno-128-12"></a><span class="c1">## 或者在控制台输入 `python test.py &gt;  output.ps` 重定向输出到文件</span>
</span><span id="__span-128-13"><a id="__codelineno-128-13" name="__codelineno-128-13" href="#__codelineno-128-13"></a><span class="c1">## 再使用 PostScript 查看器（如 Ghostscript）打开生成的output.ps文件查看</span>
</span><span id="__span-128-14"><a id="__codelineno-128-14" name="__codelineno-128-14" href="#__codelineno-128-14"></a><span class="n">ps</span> <span class="o">=</span> <span class="n">PSDraw</span><span class="o">.</span><span class="n">PSDraw</span><span class="p">()</span>
</span><span id="__span-128-15"><a id="__codelineno-128-15" name="__codelineno-128-15" href="#__codelineno-128-15"></a>
</span><span id="__span-128-16"><a id="__codelineno-128-16" name="__codelineno-128-16" href="#__codelineno-128-16"></a><span class="c1"># 开始一个新的 PostScript 文档，并设置文档标题</span>
</span><span id="__span-128-17"><a id="__codelineno-128-17" name="__codelineno-128-17" href="#__codelineno-128-17"></a><span class="n">ps</span><span class="o">.</span><span class="n">begin_document</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</span><span id="__span-128-18"><a id="__codelineno-128-18" name="__codelineno-128-18" href="#__codelineno-128-18"></a>
</span><span id="__span-128-19"><a id="__codelineno-128-19" name="__codelineno-128-19" href="#__codelineno-128-19"></a><span class="c1"># 在指定的 box 区域内绘制图像，分辨率为 75 DPI</span>
</span><span id="__span-128-20"><a id="__codelineno-128-20" name="__codelineno-128-20" href="#__codelineno-128-20"></a><span class="n">ps</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
</span><span id="__span-128-21"><a id="__codelineno-128-21" name="__codelineno-128-21" href="#__codelineno-128-21"></a><span class="c1"># 在图像周围绘制一个矩形框</span>
</span><span id="__span-128-22"><a id="__codelineno-128-22" name="__codelineno-128-22" href="#__codelineno-128-22"></a><span class="n">ps</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
</span><span id="__span-128-23"><a id="__codelineno-128-23" name="__codelineno-128-23" href="#__codelineno-128-23"></a>
</span><span id="__span-128-24"><a id="__codelineno-128-24" name="__codelineno-128-24" href="#__codelineno-128-24"></a><span class="c1"># 设置字体为 HelveticaNarrow-Bold，字号为 36 点</span>
</span><span id="__span-128-25"><a id="__codelineno-128-25" name="__codelineno-128-25" href="#__codelineno-128-25"></a><span class="n">ps</span><span class="o">.</span><span class="n">setfont</span><span class="p">(</span><span class="s2">&quot;HelveticaNarrow-Bold&quot;</span><span class="p">,</span> <span class="mi">36</span><span class="p">)</span>
</span><span id="__span-128-26"><a id="__codelineno-128-26" name="__codelineno-128-26" href="#__codelineno-128-26"></a><span class="c1"># 在坐标 (3*72, 4*72) 处绘制标题文本</span>
</span><span id="__span-128-27"><a id="__codelineno-128-27" name="__codelineno-128-27" href="#__codelineno-128-27"></a><span class="n">ps</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mi">3</span><span class="o">*</span><span class="mi">72</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="mi">72</span><span class="p">),</span> <span class="n">title</span><span class="p">)</span>
</span></code></pre></div>
<h5 id="draft">配置加载器 draft</h5>
<p>某些解码器允许在从文件中读取图像时对其进行操作。这通常可用于创建缩略图时（当速度比质量更重要）加速解码并打印到单色激光打印机（仅需灰阶图像时）。</p>
<p>draft() 方法操作已打开但尚未加载的图像，使其尽可能匹配给定的模式和大小。它通过重新配置图像解码器来完成。仅适用于JPEG和MPO文件。使用 draft() 快速解码图像：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-129-1"><a id="__codelineno-129-1" name="__codelineno-129-1" href="#__codelineno-129-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
</span><span id="__span-129-2"><a id="__codelineno-129-2" name="__codelineno-129-2" href="#__codelineno-129-2"></a>
</span><span id="__span-129-3"><a id="__codelineno-129-3" name="__codelineno-129-3" href="#__codelineno-129-3"></a><span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;test.jpg&#39;</span><span class="p">)</span>
</span><span id="__span-129-4"><a id="__codelineno-129-4" name="__codelineno-129-4" href="#__codelineno-129-4"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;original =&quot;</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</span><span id="__span-129-5"><a id="__codelineno-129-5" name="__codelineno-129-5" href="#__codelineno-129-5"></a>
</span><span id="__span-129-6"><a id="__codelineno-129-6" name="__codelineno-129-6" href="#__codelineno-129-6"></a><span class="n">im</span><span class="o">.</span><span class="n">draft</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</span><span id="__span-129-7"><a id="__codelineno-129-7" name="__codelineno-129-7" href="#__codelineno-129-7"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;draft =&quot;</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="gui">图形界面GUI</h3>
<p>使用标准库 [[#tkinter]] ，可以绘制简单的GUI</p>
<p>小型项目和原型开发：wxPython；大型项目和商业应用：PyQt；跨平台和兼容性：PyGTK</p>
<h4 id="pyqt5qt">pyqt5（Qt）</h4>
<p>PyQt是一个功能强大的Python绑定库，可以与Qt图形库协同工作。Qt是一种跨平台的应用程序和界面框架，提供了丰富的图形控件、布局管理、事件处理和网络功能等。PyQt使用Qt的C++库将其封装成Python可用的模块，为Python开发者提供了创建功能丰富的GUI应用程序的能力。</p>
<p>PyQt5 不再提供常用Qt工具，比如<strong>图形界面开发工具Qt Designer</strong>、国际化翻译工具Liguist 如果开发中使用到这些，必须自行安装Qt工具(PyQt5-tools)。</p>
<p>下面给出了常用模块的列表 −</p>
<ul>
<li><strong>QtCore</strong> − 其他模块使用的核心非 GUI 类</li>
<li><strong>QtGui</strong> − 图形用户界面组件</li>
<li><strong>QtMultimedia</strong> − 低级多媒体编程类</li>
<li><strong>QtNetwork</strong> − 网络编程类</li>
<li><strong>QtOpenGL</strong> − OpenGL 支持类</li>
<li><strong>QtScript</strong> − 用于评估 Qt 脚本的类</li>
<li><strong>QtSql</strong> − 使用 SQL 进行数据库集成的类</li>
<li><strong>QtSvg</strong> − 显示 SVG 文件内容的类</li>
<li><strong>QtWebKit</strong> − 用于呈现和编辑 HTML 的类</li>
<li><strong>QtXml</strong> − 处理 XML 的类</li>
<li><strong>QtWidgets</strong> − 用于创建经典桌面风格 UI 的类</li>
<li><strong>QtDesigner</strong> − 用于扩展 Qt Designer 的类</li>
</ul>
<p>PyQt 兼容所有流行的操作系统，包括 Windows、Linux 和 Mac OS。</p>
<p><strong>Canvas 组件支持以下标准选项：</strong></p>
<p>arc − 创建一个扇形</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-130-1"><a id="__codelineno-130-1" name="__codelineno-130-1" href="#__codelineno-130-1"></a><span class="n">coord</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span><span class="mi">210</span>
</span><span id="__span-130-2"><a id="__codelineno-130-2" name="__codelineno-130-2" href="#__codelineno-130-2"></a><span class="n">arc</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">create_arc</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>image − 创建图像</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-131-1"><a id="__codelineno-131-1" name="__codelineno-131-1" href="#__codelineno-131-1"></a><span class="n">filename</span> <span class="o">=</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span><span class="s2">&quot;sunshine.gif&quot;</span><span class="p">)</span>
</span><span id="__span-131-2"><a id="__codelineno-131-2" name="__codelineno-131-2" href="#__codelineno-131-2"></a><span class="n">image</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">NE</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
</span></code></pre></div>
<p>line − 创建线条</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-132-1"><a id="__codelineno-132-1" name="__codelineno-132-1" href="#__codelineno-132-1"></a><span class="n">line</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">create_line</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span><span class="o">...</span><span class="p">,</span> <span class="n">xn</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span></code></pre></div>
<p>oval − 创建一个圆</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-133-1"><a id="__codelineno-133-1" name="__codelineno-133-1" href="#__codelineno-133-1"></a><span class="n">oval</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">create_oval</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span></code></pre></div>
<p>polygon − 创建一个至少有三个顶点的多边形</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-134-1"><a id="__codelineno-134-1" name="__codelineno-134-1" href="#__codelineno-134-1"></a><span class="n">oval</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">create_polygon</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span><span class="o">...</span><span class="n">xn</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="wxpythonwxwidgets">wxPython（wxWidgets）</h4>
<p>wxPython是一个开源的Python绑定库，能够让Python开发者使用wxWidgets框架创建GUI应用程序。wxWidgets是一个跨平台的C++应用程序框架，提供了大量的GUI控件和工具，可以在多个平台上构建本地界面。</p>
<h4 id="pygtkgtk">PyGTK（GTK+）</h4>
<p>PyGTK是一个用于Python的GTK+绑定库，允许Python开发者使用GTK+工具包创建GUI应用程序。GTK+是一个世界知名的开源GUI开发工具包，被广泛应用于Linux桌面环境和GNOME桌面环境。</p>
<h4 id="kivy">Kivy</h4>
<p>Kivy 是一个用于开发跨平台应用程序的 Python 框架
可以使用[[#Buildozer]]打包apk</p>
<p>Kivy 默认使用英文字体，因此需要手动指定支持中文的字体文件：
将字体文件（如 <a href="../msyh.ttf">msyh.ttf</a>）放入你的 Kivy 项目目录中</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-135-1"><a id="__codelineno-135-1" name="__codelineno-135-1" href="#__codelineno-135-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">kivy.app</span><span class="w"> </span><span class="kn">import</span> <span class="n">App</span>
</span><span id="__span-135-2"><a id="__codelineno-135-2" name="__codelineno-135-2" href="#__codelineno-135-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">kivy.uix.label</span><span class="w"> </span><span class="kn">import</span> <span class="n">Label</span>
</span><span id="__span-135-3"><a id="__codelineno-135-3" name="__codelineno-135-3" href="#__codelineno-135-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">kivy.core.text</span><span class="w"> </span><span class="kn">import</span> <span class="n">LabelBase</span>
</span><span id="__span-135-4"><a id="__codelineno-135-4" name="__codelineno-135-4" href="#__codelineno-135-4"></a>
</span><span id="__span-135-5"><a id="__codelineno-135-5" name="__codelineno-135-5" href="#__codelineno-135-5"></a><span class="c1"># 注册中文字体</span>
</span><span id="__span-135-6"><a id="__codelineno-135-6" name="__codelineno-135-6" href="#__codelineno-135-6"></a><span class="n">LabelBase</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ChineseFont&#39;</span><span class="p">,</span> <span class="n">fn_regular</span><span class="o">=</span><span class="s1">&#39;msyh.ttf&#39;</span><span class="p">)</span>
</span><span id="__span-135-7"><a id="__codelineno-135-7" name="__codelineno-135-7" href="#__codelineno-135-7"></a>
</span><span id="__span-135-8"><a id="__codelineno-135-8" name="__codelineno-135-8" href="#__codelineno-135-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
</span><span id="__span-135-9"><a id="__codelineno-135-9" name="__codelineno-135-9" href="#__codelineno-135-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-135-10"><a id="__codelineno-135-10" name="__codelineno-135-10" href="#__codelineno-135-10"></a>        <span class="c1"># 使用中文字体</span>
</span><span id="__span-135-11"><a id="__codelineno-135-11" name="__codelineno-135-11" href="#__codelineno-135-11"></a>        <span class="k">return</span> <span class="n">Label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;你好，Kivy！&quot;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;ChineseFont&#39;</span><span class="p">)</span>
</span><span id="__span-135-12"><a id="__codelineno-135-12" name="__codelineno-135-12" href="#__codelineno-135-12"></a>
</span><span id="__span-135-13"><a id="__codelineno-135-13" name="__codelineno-135-13" href="#__codelineno-135-13"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">show_popup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
</span><span id="__span-135-14"><a id="__codelineno-135-14" name="__codelineno-135-14" href="#__codelineno-135-14"></a>        <span class="c1"># 创建 Popup</span>
</span><span id="__span-135-15"><a id="__codelineno-135-15" name="__codelineno-135-15" href="#__codelineno-135-15"></a>        <span class="n">popup</span> <span class="o">=</span> <span class="n">Popup</span><span class="p">(</span>
</span><span id="__span-135-16"><a id="__codelineno-135-16" name="__codelineno-135-16" href="#__codelineno-135-16"></a>            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;你好，Kivy！&quot;</span><span class="p">,</span>  <span class="c1"># 设置标题</span>
</span><span id="__span-135-17"><a id="__codelineno-135-17" name="__codelineno-135-17" href="#__codelineno-135-17"></a>            <span class="n">title_font</span><span class="o">=</span><span class="s1">&#39;ChineseFont&#39;</span><span class="p">,</span>  <span class="c1"># 设置标题字体</span>
</span><span id="__span-135-18"><a id="__codelineno-135-18" name="__codelineno-135-18" href="#__codelineno-135-18"></a>            <span class="n">content</span><span class="o">=</span><span class="n">Label</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;这是一个弹窗。&quot;</span><span class="p">),</span>  <span class="c1"># 设置内容</span>
</span><span id="__span-135-19"><a id="__codelineno-135-19" name="__codelineno-135-19" href="#__codelineno-135-19"></a>            <span class="n">size_hint</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>  <span class="c1"># 设置大小</span>
</span><span id="__span-135-20"><a id="__codelineno-135-20" name="__codelineno-135-20" href="#__codelineno-135-20"></a>        <span class="p">)</span>
</span><span id="__span-135-21"><a id="__codelineno-135-21" name="__codelineno-135-21" href="#__codelineno-135-21"></a>        <span class="n">popup</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
</span><span id="__span-135-22"><a id="__codelineno-135-22" name="__codelineno-135-22" href="#__codelineno-135-22"></a>
</span><span id="__span-135-23"><a id="__codelineno-135-23" name="__codelineno-135-23" href="#__codelineno-135-23"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-135-24"><a id="__codelineno-135-24" name="__codelineno-135-24" href="#__codelineno-135-24"></a>    <span class="n">MyApp</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></code></pre></div>
<p><strong>BeeWare</strong>
<strong>Flet</strong></p>
<h3 id="_57">游戏开发</h3>
<p>Panda3D
  cocos2d</p>
<h4 id="pygame">Pygame</h4>
<p>Pygame是一个流行的Python库，用于开发视频游戏。它是免费的、开源的、跨平台的简单直接媒体库（SDL）的封装器。Pygame提供的SDL功能的抽象化使得使用Python开发多媒体应用程序变得非常容易。</p>
<p>每个游戏的核心都是一个循环，将其称为“游戏循环”。这个循环一直在不断运行，一遍又一遍地完成游戏工作所需的所有事情。每次循环显示一次游戏当前画面，称为帧。
FPS（Frames Per Second）代表每秒帧数，也叫帧率。这意味着游戏循环每秒应发生多少次。
Pygame游戏循环，主要是：处理外部输入；更新游戏对象位置或状态；渲染</p>
<p>pygame默认是采用的笛卡尔坐标系。左上角的顶点是(0,0)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-136-1"><a id="__codelineno-136-1" name="__codelineno-136-1" href="#__codelineno-136-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pygame</span>
</span><span id="__span-136-2"><a id="__codelineno-136-2" name="__codelineno-136-2" href="#__codelineno-136-2"></a>
</span><span id="__span-136-3"><a id="__codelineno-136-3" name="__codelineno-136-3" href="#__codelineno-136-3"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>  <span class="c1"># 初始化 pygame 模块</span>
</span><span id="__span-136-4"><a id="__codelineno-136-4" name="__codelineno-136-4" href="#__codelineno-136-4"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span> <span class="c1">#声音初始化</span>
</span><span id="__span-136-5"><a id="__codelineno-136-5" name="__codelineno-136-5" href="#__codelineno-136-5"></a>
</span><span id="__span-136-6"><a id="__codelineno-136-6" name="__codelineno-136-6" href="#__codelineno-136-6"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">360</span>  <span class="c1"># 游戏窗口的宽度</span>
</span><span id="__span-136-7"><a id="__codelineno-136-7" name="__codelineno-136-7" href="#__codelineno-136-7"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">480</span> <span class="c1"># 游戏窗口的高度</span>
</span><span id="__span-136-8"><a id="__codelineno-136-8" name="__codelineno-136-8" href="#__codelineno-136-8"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span> <span class="c1"># 帧率</span>
</span><span id="__span-136-9"><a id="__codelineno-136-9" name="__codelineno-136-9" href="#__codelineno-136-9"></a><span class="c1"># # 获取当前屏幕分辨率</span>
</span><span id="__span-136-10"><a id="__codelineno-136-10" name="__codelineno-136-10" href="#__codelineno-136-10"></a><span class="c1"># screen_info = pygame.display.Info()</span>
</span><span id="__span-136-11"><a id="__codelineno-136-11" name="__codelineno-136-11" href="#__codelineno-136-11"></a><span class="c1"># SCREEN_WIDTH = screen_info.current_w</span>
</span><span id="__span-136-12"><a id="__codelineno-136-12" name="__codelineno-136-12" href="#__codelineno-136-12"></a><span class="c1"># SCREEN_HEIGHT = screen_info.current_h</span>
</span><span id="__span-136-13"><a id="__codelineno-136-13" name="__codelineno-136-13" href="#__codelineno-136-13"></a>
</span><span id="__span-136-14"><a id="__codelineno-136-14" name="__codelineno-136-14" href="#__codelineno-136-14"></a><span class="c1"># pygame.Color(r, g, b, a=255)</span>
</span><span id="__span-136-15"><a id="__codelineno-136-15" name="__codelineno-136-15" href="#__codelineno-136-15"></a><span class="n">WHITE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="__span-136-16"><a id="__codelineno-136-16" name="__codelineno-136-16" href="#__codelineno-136-16"></a><span class="n">BLACK</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-136-17"><a id="__codelineno-136-17" name="__codelineno-136-17" href="#__codelineno-136-17"></a><span class="n">RED</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-136-18"><a id="__codelineno-136-18" name="__codelineno-136-18" href="#__codelineno-136-18"></a><span class="n">GREEN</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-136-19"><a id="__codelineno-136-19" name="__codelineno-136-19" href="#__codelineno-136-19"></a><span class="n">BLUE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="__span-136-20"><a id="__codelineno-136-20" name="__codelineno-136-20" href="#__codelineno-136-20"></a>
</span><span id="__span-136-21"><a id="__codelineno-136-21" name="__codelineno-136-21" href="#__codelineno-136-21"></a><span class="n">screen</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>  <span class="c1"># 初始化显示窗口并设置尺寸</span>
</span><span id="__span-136-22"><a id="__codelineno-136-22" name="__codelineno-136-22" href="#__codelineno-136-22"></a><span class="c1"># screen = pygame.display.set_mode((0, 0), pygame.FULLSCREEN) # 全屏显示</span>
</span><span id="__span-136-23"><a id="__codelineno-136-23" name="__codelineno-136-23" href="#__codelineno-136-23"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">)</span>  <span class="c1"># 设置游戏窗口标题栏文字</span>
</span><span id="__span-136-24"><a id="__codelineno-136-24" name="__codelineno-136-24" href="#__codelineno-136-24"></a><span class="c1"># icon = pygame.image.load(&quot;icon.png&quot;).convert_alpha()</span>
</span><span id="__span-136-25"><a id="__codelineno-136-25" name="__codelineno-136-25" href="#__codelineno-136-25"></a><span class="c1"># pygame.display.set_icon(icon) # 设置窗口的新图标</span>
</span><span id="__span-136-26"><a id="__codelineno-136-26" name="__codelineno-136-26" href="#__codelineno-136-26"></a><span class="c1"># background = pygame.image.load(&quot;background.jpg&quot;)</span>
</span><span id="__span-136-27"><a id="__codelineno-136-27" name="__codelineno-136-27" href="#__codelineno-136-27"></a><span class="c1"># screen.blit(background, (0, 0)) # 设置背景图片</span>
</span><span id="__span-136-28"><a id="__codelineno-136-28" name="__codelineno-136-28" href="#__codelineno-136-28"></a><span class="c1"># pygame.display.flip()</span>
</span><span id="__span-136-29"><a id="__codelineno-136-29" name="__codelineno-136-29" href="#__codelineno-136-29"></a>
</span><span id="__span-136-30"><a id="__codelineno-136-30" name="__codelineno-136-30" href="#__codelineno-136-30"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span> <span class="c1"># 创建一个clock时钟对象</span>
</span><span id="__span-136-31"><a id="__codelineno-136-31" name="__codelineno-136-31" href="#__codelineno-136-31"></a>
</span><span id="__span-136-32"><a id="__codelineno-136-32" name="__codelineno-136-32" href="#__codelineno-136-32"></a><span class="c1"># 游戏循环</span>
</span><span id="__span-136-33"><a id="__codelineno-136-33" name="__codelineno-136-33" href="#__codelineno-136-33"></a><span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-136-34"><a id="__codelineno-136-34" name="__codelineno-136-34" href="#__codelineno-136-34"></a><span class="k">while</span> <span class="n">running</span><span class="p">:</span>
</span><span id="__span-136-35"><a id="__codelineno-136-35" name="__codelineno-136-35" href="#__codelineno-136-35"></a>    <span class="c1"># 设置FPS为30</span>
</span><span id="__span-136-36"><a id="__codelineno-136-36" name="__codelineno-136-36" href="#__codelineno-136-36"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
</span><span id="__span-136-37"><a id="__codelineno-136-37" name="__codelineno-136-37" href="#__codelineno-136-37"></a>
</span><span id="__span-136-38"><a id="__codelineno-136-38" name="__codelineno-136-38" href="#__codelineno-136-38"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>  <span class="c1"># 从Pygame的事件队列中取出事件</span>
</span><span id="__span-136-39"><a id="__codelineno-136-39" name="__codelineno-136-39" href="#__codelineno-136-39"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>  <span class="c1"># 获得事件类型，并逐类响应</span>
</span><span id="__span-136-40"><a id="__codelineno-136-40" name="__codelineno-136-40" href="#__codelineno-136-40"></a>            <span class="c1"># 退出游戏，也可以使用sys.exit()强制退出程序</span>
</span><span id="__span-136-41"><a id="__codelineno-136-41" name="__codelineno-136-41" href="#__codelineno-136-41"></a>            <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span> 
</span><span id="__span-136-42"><a id="__codelineno-136-42" name="__codelineno-136-42" href="#__codelineno-136-42"></a>        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
</span><span id="__span-136-43"><a id="__codelineno-136-43" name="__codelineno-136-43" href="#__codelineno-136-43"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_ESCAPE</span><span class="p">:</span>  <span class="c1"># 按ESC退出</span>
</span><span id="__span-136-44"><a id="__codelineno-136-44" name="__codelineno-136-44" href="#__codelineno-136-44"></a>                <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-136-45"><a id="__codelineno-136-45" name="__codelineno-136-45" href="#__codelineno-136-45"></a>
</span><span id="__span-136-46"><a id="__codelineno-136-46" name="__codelineno-136-46" href="#__codelineno-136-46"></a>    <span class="n">screen</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">BLACK</span><span class="p">)</span> <span class="c1"># 填充背景色（可选）</span>
</span><span id="__span-136-47"><a id="__codelineno-136-47" name="__codelineno-136-47" href="#__codelineno-136-47"></a>    <span class="c1"># draw</span>
</span><span id="__span-136-48"><a id="__codelineno-136-48" name="__codelineno-136-48" href="#__codelineno-136-48"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># 可更新指定区域（默认更新所有修改过的区域）</span>
</span><span id="__span-136-49"><a id="__codelineno-136-49" name="__codelineno-136-49" href="#__codelineno-136-49"></a>    <span class="c1"># pygame.display.flip() # 强制更新整个屏幕（所有像素）</span>
</span><span id="__span-136-50"><a id="__codelineno-136-50" name="__codelineno-136-50" href="#__codelineno-136-50"></a>
</span><span id="__span-136-51"><a id="__codelineno-136-51" name="__codelineno-136-51" href="#__codelineno-136-51"></a><span class="c1"># 关闭 Pygame 库的函数。确保所有 Pygame 模块都被正确地取消初始化</span>
</span><span id="__span-136-52"><a id="__codelineno-136-52" name="__codelineno-136-52" href="#__codelineno-136-52"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-137-1"><a id="__codelineno-137-1" name="__codelineno-137-1" href="#__codelineno-137-1"></a><span class="c1"># 屏幕尺寸和模式</span>
</span><span id="__span-137-2"><a id="__codelineno-137-2" name="__codelineno-137-2" href="#__codelineno-137-2"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">vsync</span><span class="p">)</span>
</span><span id="__span-137-3"><a id="__codelineno-137-3" name="__codelineno-137-3" href="#__codelineno-137-3"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">Info</span><span class="p">()</span>
</span><span id="__span-137-4"><a id="__codelineno-137-4" name="__codelineno-137-4" href="#__codelineno-137-4"></a><span class="c1"># 窗口标题和图标</span>
</span><span id="__span-137-5"><a id="__codelineno-137-5" name="__codelineno-137-5" href="#__codelineno-137-5"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">()</span>
</span><span id="__span-137-6"><a id="__codelineno-137-6" name="__codelineno-137-6" href="#__codelineno-137-6"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_icon</span><span class="p">()</span>
</span><span id="__span-137-7"><a id="__codelineno-137-7" name="__codelineno-137-7" href="#__codelineno-137-7"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">get_caption</span><span class="p">()</span>
</span><span id="__span-137-8"><a id="__codelineno-137-8" name="__codelineno-137-8" href="#__codelineno-137-8"></a><span class="c1"># 图标的感知和刷新</span>
</span><span id="__span-137-9"><a id="__codelineno-137-9" name="__codelineno-137-9" href="#__codelineno-137-9"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">get_active</span><span class="p">()</span>
</span><span id="__span-137-10"><a id="__codelineno-137-10" name="__codelineno-137-10" href="#__codelineno-137-10"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
</span><span id="__span-137-11"><a id="__codelineno-137-11" name="__codelineno-137-11" href="#__codelineno-137-11"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="__span-137-12"><a id="__codelineno-137-12" name="__codelineno-137-12" href="#__codelineno-137-12"></a>
</span><span id="__span-137-13"><a id="__codelineno-137-13" name="__codelineno-137-13" href="#__codelineno-137-13"></a><span class="c1"># 加载图片</span>
</span><span id="__span-137-14"><a id="__codelineno-137-14" name="__codelineno-137-14" href="#__codelineno-137-14"></a><span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</span><span id="__span-137-15"><a id="__codelineno-137-15" name="__codelineno-137-15" href="#__codelineno-137-15"></a>
</span><span id="__span-137-16"><a id="__codelineno-137-16" name="__codelineno-137-16" href="#__codelineno-137-16"></a><span class="n">screen</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="c1"># 显示窗口背景填充为color颜色，采用RGB色彩体系</span>
</span><span id="__span-137-17"><a id="__codelineno-137-17" name="__codelineno-137-17" href="#__codelineno-137-17"></a><span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span> <span class="c1">#将一个图像绘制在另一个图像上，即将src绘制到dest位置上</span>
</span></code></pre></div>
<h6 id="_58">精灵</h6>
<p>2D游戏能屏幕上看到的所有对象都是精灵。在Pygame中，精灵是对象类型。</p>
<p>Pygame精灵都必须拥有两个属性： <code>image</code> （外观）和 <code>rect</code> （矩形坐标）</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-138-1"><a id="__codelineno-138-1" name="__codelineno-138-1" href="#__codelineno-138-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Player</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
</span><span id="__span-138-2"><a id="__codelineno-138-2" name="__codelineno-138-2" href="#__codelineno-138-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-138-3"><a id="__codelineno-138-3" name="__codelineno-138-3" href="#__codelineno-138-3"></a>        <span class="c1"># 调用父类的初始化方法</span>
</span><span id="__span-138-4"><a id="__codelineno-138-4" name="__codelineno-138-4" href="#__codelineno-138-4"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="__span-138-5"><a id="__codelineno-138-5" name="__codelineno-138-5" href="#__codelineno-138-5"></a>        <span class="c1"># 创建一个简单的50 x 50正方形并用颜色填充</span>
</span><span id="__span-138-6"><a id="__codelineno-138-6" name="__codelineno-138-6" href="#__codelineno-138-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
</span><span id="__span-138-7"><a id="__codelineno-138-7" name="__codelineno-138-7" href="#__codelineno-138-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">GREEN</span><span class="p">)</span>
</span><span id="__span-138-8"><a id="__codelineno-138-8" name="__codelineno-138-8" href="#__codelineno-138-8"></a>        <span class="c1"># 将精灵放在屏幕中心</span>
</span><span id="__span-138-9"><a id="__codelineno-138-9" name="__codelineno-138-9" href="#__codelineno-138-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span> <span class="c1"># 包围image的矩形</span>
</span><span id="__span-138-10"><a id="__codelineno-138-10" name="__codelineno-138-10" href="#__codelineno-138-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">HEIGHT</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-138-11"><a id="__codelineno-138-11" name="__codelineno-138-11" href="#__codelineno-138-11"></a>
</span><span id="__span-138-12"><a id="__codelineno-138-12" name="__codelineno-138-12" href="#__codelineno-138-12"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-138-13"><a id="__codelineno-138-13" name="__codelineno-138-13" href="#__codelineno-138-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="mi">5</span>
</span><span id="__span-138-14"><a id="__codelineno-138-14" name="__codelineno-138-14" href="#__codelineno-138-14"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
</span><span id="__span-138-15"><a id="__codelineno-138-15" name="__codelineno-138-15" href="#__codelineno-138-15"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="mi">0</span>
</span></code></pre></div>
<p>精灵组是精灵的集合，可以同时对所有精灵进行操作。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-139-1"><a id="__codelineno-139-1" name="__codelineno-139-1" href="#__codelineno-139-1"></a><span class="c1"># 创建精灵组</span>
</span><span id="__span-139-2"><a id="__codelineno-139-2" name="__codelineno-139-2" href="#__codelineno-139-2"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
</span><span id="__span-139-3"><a id="__codelineno-139-3" name="__codelineno-139-3" href="#__codelineno-139-3"></a><span class="c1"># 实例化</span>
</span><span id="__span-139-4"><a id="__codelineno-139-4" name="__codelineno-139-4" href="#__codelineno-139-4"></a><span class="n">player</span> <span class="o">=</span> <span class="n">Player</span><span class="p">()</span>
</span><span id="__span-139-5"><a id="__codelineno-139-5" name="__codelineno-139-5" href="#__codelineno-139-5"></a><span class="c1"># 把添加进精灵组</span>
</span><span id="__span-139-6"><a id="__codelineno-139-6" name="__codelineno-139-6" href="#__codelineno-139-6"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
</span><span id="__span-139-7"><a id="__codelineno-139-7" name="__codelineno-139-7" href="#__codelineno-139-7"></a>
</span><span id="__span-139-8"><a id="__codelineno-139-8" name="__codelineno-139-8" href="#__codelineno-139-8"></a><span class="k">while</span> <span class="n">running</span><span class="p">:</span>
</span><span id="__span-139-9"><a id="__codelineno-139-9" name="__codelineno-139-9" href="#__codelineno-139-9"></a>    <span class="k">pass</span>
</span><span id="__span-139-10"><a id="__codelineno-139-10" name="__codelineno-139-10" href="#__codelineno-139-10"></a>    <span class="c1"># 刷新精灵组</span>
</span><span id="__span-139-11"><a id="__codelineno-139-11" name="__codelineno-139-11" href="#__codelineno-139-11"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="__span-139-12"><a id="__codelineno-139-12" name="__codelineno-139-12" href="#__codelineno-139-12"></a>    <span class="c1"># 把精灵组绘制在屏幕上</span>
</span><span id="__span-139-13"><a id="__codelineno-139-13" name="__codelineno-139-13" href="#__codelineno-139-13"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">screen</span><span class="p">)</span>
</span><span id="__span-139-14"><a id="__codelineno-139-14" name="__codelineno-139-14" href="#__codelineno-139-14"></a>    <span class="k">pass</span>
</span></code></pre></div>
<p>设置图片为精灵的image
<em>一般把游戏资源保存在文件夹如img中</em></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-140-1"><a id="__codelineno-140-1" name="__codelineno-140-1" href="#__codelineno-140-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pygame</span>
</span><span id="__span-140-2"><a id="__codelineno-140-2" name="__codelineno-140-2" href="#__codelineno-140-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-140-3"><a id="__codelineno-140-3" name="__codelineno-140-3" href="#__codelineno-140-3"></a>
</span><span id="__span-140-4"><a id="__codelineno-140-4" name="__codelineno-140-4" href="#__codelineno-140-4"></a><span class="c1"># 获得当前代码文件所在的文件夹路径</span>
</span><span id="__span-140-5"><a id="__codelineno-140-5" name="__codelineno-140-5" href="#__codelineno-140-5"></a><span class="n">game_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
</span><span id="__span-140-6"><a id="__codelineno-140-6" name="__codelineno-140-6" href="#__codelineno-140-6"></a><span class="c1"># 获得img文件夹</span>
</span><span id="__span-140-7"><a id="__codelineno-140-7" name="__codelineno-140-7" href="#__codelineno-140-7"></a><span class="n">img_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">game_folder</span><span class="p">,</span> <span class="s1">&#39;img&#39;</span><span class="p">)</span>
</span><span id="__span-140-8"><a id="__codelineno-140-8" name="__codelineno-140-8" href="#__codelineno-140-8"></a><span class="c1"># 获得p1_jump.png图片</span>
</span><span id="__span-140-9"><a id="__codelineno-140-9" name="__codelineno-140-9" href="#__codelineno-140-9"></a><span class="n">player_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">img_folder</span><span class="p">,</span> <span class="s1">&#39;p1_jump.png&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
</span><span id="__span-140-10"><a id="__codelineno-140-10" name="__codelineno-140-10" href="#__codelineno-140-10"></a>
</span><span id="__span-140-11"><a id="__codelineno-140-11" name="__codelineno-140-11" href="#__codelineno-140-11"></a><span class="k">class</span><span class="w"> </span><span class="nc">Player</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
</span><span id="__span-140-12"><a id="__codelineno-140-12" name="__codelineno-140-12" href="#__codelineno-140-12"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-140-13"><a id="__codelineno-140-13" name="__codelineno-140-13" href="#__codelineno-140-13"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-140-14"><a id="__codelineno-140-14" name="__codelineno-140-14" href="#__codelineno-140-14"></a>        <span class="c1"># 设置图片为精灵的image</span>
</span><span id="__span-140-15"><a id="__codelineno-140-15" name="__codelineno-140-15" href="#__codelineno-140-15"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">player_img</span>
</span><span id="__span-140-16"><a id="__codelineno-140-16" name="__codelineno-140-16" href="#__codelineno-140-16"></a>        <span class="c1"># 设置角色的初始位置</span>
</span><span id="__span-140-17"><a id="__codelineno-140-17" name="__codelineno-140-17" href="#__codelineno-140-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="n">WIDTH</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="o">//</span><span class="mi">2</span><span class="p">))</span>
</span><span id="__span-140-18"><a id="__codelineno-140-18" name="__codelineno-140-18" href="#__codelineno-140-18"></a>
</span><span id="__span-140-19"><a id="__codelineno-140-19" name="__codelineno-140-19" href="#__codelineno-140-19"></a>    <span class="c1"># 精灵移动时同步移动图片image</span>
</span><span id="__span-140-20"><a id="__codelineno-140-20" name="__codelineno-140-20" href="#__codelineno-140-20"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">screen</span><span class="p">):</span>
</span><span id="__span-140-21"><a id="__codelineno-140-21" name="__codelineno-140-21" href="#__codelineno-140-21"></a>        <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>
</span><span id="__span-140-22"><a id="__codelineno-140-22" name="__codelineno-140-22" href="#__codelineno-140-22"></a>    <span class="c1"># 精灵旋转时同步旋转图片image</span>
</span><span id="__span-140-23"><a id="__codelineno-140-23" name="__codelineno-140-23" href="#__codelineno-140-23"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
</span><span id="__span-140-24"><a id="__codelineno-140-24" name="__codelineno-140-24" href="#__codelineno-140-24"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
</span><span id="__span-140-25"><a id="__codelineno-140-25" name="__codelineno-140-25" href="#__codelineno-140-25"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
</span></code></pre></div>
<p><code>ballrect.move(x,y)</code>矩形移动一个偏移量(x,y)，即在横轴方向移动x像素，纵轴方向移动y像素</p>
<p><strong>碰撞检测函数</strong> spritecollide(sprite, group, dokill, collided = None) -&gt; Sprite_list</p>
<h5 id="_59">事件</h5>
<p>事件本质上是一种封装后的数据类型（对象）
<code>pygame.event.EventType</code> 是Pygame的一个类，表示事件类型</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-141-1"><a id="__codelineno-141-1" name="__codelineno-141-1" href="#__codelineno-141-1"></a><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-141-2"><a id="__codelineno-141-2" name="__codelineno-141-2" href="#__codelineno-141-2"></a>   <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="__span-141-3"><a id="__codelineno-141-3" name="__codelineno-141-3" href="#__codelineno-141-3"></a>      <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
</span><span id="__span-141-4"><a id="__codelineno-141-4" name="__codelineno-141-4" href="#__codelineno-141-4"></a>         <span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</span><span id="__span-141-5"><a id="__codelineno-141-5" name="__codelineno-141-5" href="#__codelineno-141-5"></a>         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span><span id="__span-141-6"><a id="__codelineno-141-6" name="__codelineno-141-6" href="#__codelineno-141-6"></a>      <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
</span><span id="__span-141-7"><a id="__codelineno-141-7" name="__codelineno-141-7" href="#__codelineno-141-7"></a>         <span class="n">key</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-141-8"><a id="__codelineno-141-8" name="__codelineno-141-8" href="#__codelineno-141-8"></a>         <span class="nb">print</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;Key is pressed&quot;</span><span class="p">)</span>
</span><span id="__span-141-9"><a id="__codelineno-141-9" name="__codelineno-141-9" href="#__codelineno-141-9"></a>         <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_UP</span><span class="p">:</span>
</span><span id="__span-141-10"><a id="__codelineno-141-10" name="__codelineno-141-10" href="#__codelineno-141-10"></a>             <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;↑&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>pygame.QUIT 事件</strong>
用户点击“关闭”按钮的事件，但一般情况下，它并不会自动关闭，有时可能出现未响应的情况，除非我们关闭Python。</p>
<p><strong>键盘事件</strong>
pygame.KEYDOWN 按下键盘
pygame.KEYUP 释放键盘</p>
<p>event.key</p>
<table>
<thead>
<tr>
<th>按键</th>
<th>名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>↑</td>
<td>pygame.K_UP</td>
</tr>
<tr>
<td>↓</td>
<td>pygame.K_DOWN</td>
</tr>
<tr>
<td>←</td>
<td>pygame.K_LEFT</td>
</tr>
<tr>
<td>→</td>
<td>pygame.K_RIGHT</td>
</tr>
<tr>
<td>空格</td>
<td>pygame.K_SPACE</td>
</tr>
<tr>
<td>esc</td>
<td>pygame.K_ESCAPE</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>pygame.key.get_pressed()</th>
<th>获取所有键盘按钮的状态</th>
</tr>
</thead>
<tbody>
<tr>
<td>pygame.key.get_mods()</td>
<td>确定哪些修改键正在被按下</td>
</tr>
<tr>
<td>pygame.key.set_repeat()</td>
<td>控制被按下的键的重复方式</td>
</tr>
<tr>
<td>pygame.key.get_repeat()</td>
<td>查看持有的按键是如何重复的</td>
</tr>
<tr>
<td>pygame.key.name()</td>
<td>获取一个键的标识符的名称。</td>
</tr>
<tr>
<td>pygame.key.key_code()</td>
<td>从一个键的名称中获取键的标识符</td>
</tr>
<tr>
<td>pygame.key.start_text_input()</td>
<td>开始处理Unicode文本输入事件</td>
</tr>
<tr>
<td>pygame.key.stop_text_input()</td>
<td>停止处理Unicode文本输入事件</td>
</tr>
</tbody>
</table>
<div class="language-python highlight"><pre><span></span><code><span id="__span-142-1"><a id="__codelineno-142-1" name="__codelineno-142-1" href="#__codelineno-142-1"></a><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-142-2"><a id="__codelineno-142-2" name="__codelineno-142-2" href="#__codelineno-142-2"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="__span-142-3"><a id="__codelineno-142-3" name="__codelineno-142-3" href="#__codelineno-142-3"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
</span><span id="__span-142-4"><a id="__codelineno-142-4" name="__codelineno-142-4" href="#__codelineno-142-4"></a>            <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-142-5"><a id="__codelineno-142-5" name="__codelineno-142-5" href="#__codelineno-142-5"></a>        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
</span><span id="__span-142-6"><a id="__codelineno-142-6" name="__codelineno-142-6" href="#__codelineno-142-6"></a>            <span class="c1"># 检测按下事件，实现点击跳跃</span>
</span><span id="__span-142-7"><a id="__codelineno-142-7" name="__codelineno-142-7" href="#__codelineno-142-7"></a>             <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_SPACE</span><span class="p">:</span>
</span><span id="__span-142-8"><a id="__codelineno-142-8" name="__codelineno-142-8" href="#__codelineno-142-8"></a>                <span class="n">player</span><span class="o">.</span><span class="n">jump</span><span class="p">()</span>
</span><span id="__span-142-9"><a id="__codelineno-142-9" name="__codelineno-142-9" href="#__codelineno-142-9"></a>
</span><span id="__span-142-10"><a id="__codelineno-142-10" name="__codelineno-142-10" href="#__codelineno-142-10"></a>    <span class="c1"># 实时检测键盘状态，实现长按移动</span>
</span><span id="__span-142-11"><a id="__codelineno-142-11" name="__codelineno-142-11" href="#__codelineno-142-11"></a>    <span class="n">keys</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_pressed</span><span class="p">()</span>
</span><span id="__span-142-12"><a id="__codelineno-142-12" name="__codelineno-142-12" href="#__codelineno-142-12"></a>    <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_a</span><span class="p">]:</span>
</span><span id="__span-142-13"><a id="__codelineno-142-13" name="__codelineno-142-13" href="#__codelineno-142-13"></a>        <span class="n">player</span><span class="o">.</span><span class="n">moveLeft</span><span class="p">()</span>
</span><span id="__span-142-14"><a id="__codelineno-142-14" name="__codelineno-142-14" href="#__codelineno-142-14"></a>    <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_d</span><span class="p">]:</span>
</span><span id="__span-142-15"><a id="__codelineno-142-15" name="__codelineno-142-15" href="#__codelineno-142-15"></a>        <span class="n">player</span><span class="o">.</span><span class="n">moveRight</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-143-1"><a id="__codelineno-143-1" name="__codelineno-143-1" href="#__codelineno-143-1"></a><span class="c1"># 强制捕获键盘事件:</span>
</span><span id="__span-143-2"><a id="__codelineno-143-2" name="__codelineno-143-2" href="#__codelineno-143-2"></a><span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">set_grab</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># 强制捕获所有输入事件</span>
</span><span id="__span-143-3"><a id="__codelineno-143-3" name="__codelineno-143-3" href="#__codelineno-143-3"></a><span class="n">pygame</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">set_repeat</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>  <span class="c1"># 启用按键重复（100ms 延迟，50ms 间隔）</span>
</span><span id="__span-143-4"><a id="__codelineno-143-4" name="__codelineno-143-4" href="#__codelineno-143-4"></a>
</span><span id="__span-143-5"><a id="__codelineno-143-5" name="__codelineno-143-5" href="#__codelineno-143-5"></a><span class="c1"># 某些输入法（如中文输入法）可能会拦截键盘事件</span>
</span></code></pre></div>
<p><strong>鼠标事件</strong>
MOUSEBUTTONDOWN 按下鼠标
MOUSEBUTTONUP 释放鼠标
MOUSEMOTION 划过窗口</p>
<p>要精确到是左击还是右击，需要用到pygame.mouse.get_pressed()函数，它返回的是一个列表。其中第一项（索引[0]）是代表左键是否按下，第三项（索引[2]）是代表右键是否按下，它们的值都是布尔运算值
获取鼠标位置，要用event.pos方法，得到的是一个表示坐标的元组</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-144-1"><a id="__codelineno-144-1" name="__codelineno-144-1" href="#__codelineno-144-1"></a><span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">MOUSEMOTION</span><span class="p">:</span>
</span><span id="__span-144-2"><a id="__codelineno-144-2" name="__codelineno-144-2" href="#__codelineno-144-2"></a>   <span class="n">pos</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">pos</span> <span class="c1"># 或者pos=pygame.mouse.get_pos()</span>
</span><span id="__span-144-3"><a id="__codelineno-144-3" name="__codelineno-144-3" href="#__codelineno-144-3"></a>   <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;x = </span><span class="si">{}</span><span class="s2">, y = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span></code></pre></div>
<table>
<thead>
<tr>
<th>pygame.key.get_pressed</th>
<th>获取鼠标按键的状态</th>
</tr>
</thead>
<tbody>
<tr>
<td>pygame.mouse.get_pos()</td>
<td>获取鼠标光标的位置</td>
</tr>
<tr>
<td>pygame.mouse.get_rel()</td>
<td>获取鼠标的移动量</td>
</tr>
<tr>
<td>pygame.mouse.set_pos()</td>
<td>设置鼠标光标的位置</td>
</tr>
<tr>
<td>pygame.mouse.set_visible()</td>
<td>隐藏或显示鼠标光标</td>
</tr>
<tr>
<td>pygame.mouse.get_visible()</td>
<td>获取鼠标光标的当前可见状态。</td>
</tr>
<tr>
<td>pygame.mouse.get_focused()</td>
<td>检查显示器是否正在接收鼠标输入</td>
</tr>
<tr>
<td>pygame.mouse.set_cursor()</td>
<td>设置鼠标光标的图像</td>
</tr>
<tr>
<td>pygame.mouse.set_system_cursor()</td>
<td>将鼠标光标设置为一个系统变体</td>
</tr>
</tbody>
</table>
<p>Pygame定义了以下系统光标：</p>
<table>
<thead>
<tr>
<th>pygame.SYSTEM_CURSOR_ARROW</th>
<th>箭头</th>
</tr>
</thead>
<tbody>
<tr>
<td>pygame.SYSTEM_CURSOR_IBEAM</td>
<td>i-beam</td>
</tr>
<tr>
<td>pygame.SYSTEM_CURSOR_WAIT</td>
<td>wait</td>
</tr>
<tr>
<td>pygame.SYSTEM_CURSOR_CROSSHAIR</td>
<td>十字线</td>
</tr>
<tr>
<td>pygame.SYSTEM_CURSOR_SIZENWSE</td>
<td>指向西北和东南的双箭头</td>
</tr>
<tr>
<td>pygame.SYSTEM_CURSOR_SIZENESW</td>
<td>指向东北方和西南方的双箭头</td>
</tr>
<tr>
<td>pygame.SYSTEM_CURSOR_SIZEWE</td>
<td>指向西方和东方的双箭头</td>
</tr>
<tr>
<td>pygame.SYSTEM_CURSOR_SIZENS</td>
<td>指向南北的双箭头</td>
</tr>
<tr>
<td>pygame.SYSTEM_CURSOR_SIZEALL</td>
<td>四个箭头</td>
</tr>
<tr>
<td>pygame.SYSTEM_CURSOR_NO</td>
<td>划线的圆圈或十字骨</td>
</tr>
<tr>
<td>pygame.SYSTEM_CURSOR_HAND</td>
<td>手</td>
</tr>
</tbody>
</table>
<div class="language-python highlight"><pre><span></span><code><span id="__span-145-1"><a id="__codelineno-145-1" name="__codelineno-145-1" href="#__codelineno-145-1"></a><span class="c1"># 设置游戏窗口的光标为十字线</span>
</span><span id="__span-145-2"><a id="__codelineno-145-2" name="__codelineno-145-2" href="#__codelineno-145-2"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">set_cursor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">SYSTEM_CURSOR_CROSSHAIR</span><span class="p">)</span>
</span></code></pre></div>
<h5 id="_60">其他</h5>
<p>绘制图形：
任何一个图形绘制后，会返回一个矩形Rect类表示该形状
pygame.Rect  表达一个矩形区域的类，用于存储坐标和长度信息Pygame利用Rect类来操作图形/图像等元素 四个参数 left，top，width，height</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-146-1"><a id="__codelineno-146-1" name="__codelineno-146-1" href="#__codelineno-146-1"></a><span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">screen</span><span class="p">,</span> <span class="n">red</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-146-2"><a id="__codelineno-146-2" name="__codelineno-146-2" href="#__codelineno-146-2"></a><span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">polygon</span><span class="p">(</span><span class="n">screen</span><span class="p">,</span> <span class="n">blue</span><span class="p">,</span> <span class="p">((</span><span class="mi">25</span><span class="p">,</span><span class="mi">75</span><span class="p">),(</span><span class="mi">76</span><span class="p">,</span><span class="mi">125</span><span class="p">),(</span><span class="mi">275</span><span class="p">,</span><span class="mi">200</span><span class="p">),(</span><span class="mi">350</span><span class="p">,</span><span class="mi">25</span><span class="p">),(</span><span class="mi">60</span><span class="p">,</span><span class="mi">280</span><span class="p">)),</span> <span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-146-3"><a id="__codelineno-146-3" name="__codelineno-146-3" href="#__codelineno-146-3"></a><span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">screen</span><span class="p">,</span> <span class="n">white</span><span class="p">,</span> <span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">),</span> <span class="mi">60</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-146-4"><a id="__codelineno-146-4" name="__codelineno-146-4" href="#__codelineno-146-4"></a><span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">ellipse</span><span class="p">(</span><span class="n">screen</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
</span><span id="__span-146-5"><a id="__codelineno-146-5" name="__codelineno-146-5" href="#__codelineno-146-5"></a><span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">screen</span><span class="p">,</span> <span class="n">red</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-146-6"><a id="__codelineno-146-6" name="__codelineno-146-6" href="#__codelineno-146-6"></a><span class="c1"># arc/lines/aaline/aalines</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-147-1"><a id="__codelineno-147-1" name="__codelineno-147-1" href="#__codelineno-147-1"></a><span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;pygame.png&#39;</span><span class="p">)</span>
</span><span id="__span-147-2"><a id="__codelineno-147-2" name="__codelineno-147-2" href="#__codelineno-147-2"></a><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-147-3"><a id="__codelineno-147-3" name="__codelineno-147-3" href="#__codelineno-147-3"></a>    <span class="k">pass</span>
</span><span id="__span-147-4"><a id="__codelineno-147-4" name="__codelineno-147-4" href="#__codelineno-147-4"></a>    <span class="n">rect</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
</span><span id="__span-147-5"><a id="__codelineno-147-5" name="__codelineno-147-5" href="#__codelineno-147-5"></a>    <span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">150</span>
</span><span id="__span-147-6"><a id="__codelineno-147-6" name="__codelineno-147-6" href="#__codelineno-147-6"></a>    <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
</span></code></pre></div>
<p><code>pygame.image.save(screen, "circles.png")</code> 可以将Surface对象的内容保存到一个图像文件中</p>
<p>显示文本：</p>
<p>当前机器中安装的字体列表可以通过 <code>fonts = pygame.font.get_fonts()</code> 获得</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-148-1"><a id="__codelineno-148-1" name="__codelineno-148-1" href="#__codelineno-148-1"></a><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="n">none</span><span class="p">,</span> <span class="mi">36</span><span class="p">)</span> <span class="c1"># none指默认字体，可以指定主体如&quot;Arial&quot;</span>
</span><span id="__span-148-2"><a id="__codelineno-148-2" name="__codelineno-148-2" href="#__codelineno-148-2"></a><span class="n">font1</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="s1">&#39;chalkduster.ttf&#39;</span><span class="p">,</span> <span class="mi">72</span><span class="p">)</span> <span class="c1"># 字体文件也可以</span>
</span><span id="__span-148-3"><a id="__codelineno-148-3" name="__codelineno-148-3" href="#__codelineno-148-3"></a><span class="n">txtsurf</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;Hello World&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">BLUE</span><span class="p">)</span>
</span><span id="__span-148-4"><a id="__codelineno-148-4" name="__codelineno-148-4" href="#__codelineno-148-4"></a><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-148-5"><a id="__codelineno-148-5" name="__codelineno-148-5" href="#__codelineno-148-5"></a>    <span class="k">pass</span>
</span><span id="__span-148-6"><a id="__codelineno-148-6" name="__codelineno-148-6" href="#__codelineno-148-6"></a>    <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">txtsurf</span><span class="p">,(</span><span class="n">WIDTH</span> <span class="o">-</span> <span class="n">txtsurf</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="n">txtsurf</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">//</span> <span class="mi">2</span><span class="p">))</span>
</span></code></pre></div>
<table>
<thead>
<tr>
<th>bold()</th>
<th>获取或设置字体是否应该以黑体呈现。</th>
</tr>
</thead>
<tbody>
<tr>
<td>italic()</td>
<td>获取或设置字体是否应该以斜体形式呈现。</td>
</tr>
<tr>
<td>underline()</td>
<td>获取或设置字体是否应以下划线呈现。</td>
</tr>
<tr>
<td>render()</td>
<td>在一个新的Surface上绘制文本</td>
</tr>
<tr>
<td>size()</td>
<td>计算渲染文字所需的尺寸</td>
</tr>
<tr>
<td>set_underline()</td>
<td>控制是否用下划线来渲染文本</td>
</tr>
<tr>
<td>get_underline()</td>
<td>检查文本是否带下划线。</td>
</tr>
<tr>
<td>set_bold()</td>
<td>启用加粗文本的假渲染</td>
</tr>
<tr>
<td>get_bold()</td>
<td>检查文本是否会被渲染成粗体</td>
</tr>
<tr>
<td>set_italic()</td>
<td>启用斜体文字的假渲染</td>
</tr>
<tr>
<td>metrics()</td>
<td>获取每个字符的度量值</td>
</tr>
<tr>
<td>get_italic()</td>
<td>检查文本是否会被渲染成斜体</td>
</tr>
<tr>
<td>get_linesize()</td>
<td>获取字体文本的行间距</td>
</tr>
<tr>
<td>get_height()</td>
<td>获取字体的高度</td>
</tr>
<tr>
<td>get_ascent()</td>
<td>获取字体的上升高度</td>
</tr>
<tr>
<td>get_descent()</td>
<td>获取字体的下降值</td>
</tr>
</tbody>
</table>
<p>Rect</p>
<table>
<thead>
<tr>
<th>copy()</th>
<th>返回一个新的矩形，其位置和大小与原矩形相同。</th>
</tr>
</thead>
<tbody>
<tr>
<td>move()</td>
<td>返回一个按给定偏移量移动的新矩形。x和y参数可以是任何整数，正数或负数。</td>
</tr>
<tr>
<td>move_ip()</td>
<td>与Rect.move()方法相同，但在原地操作。</td>
</tr>
<tr>
<td>inflate(x,y)</td>
<td>返回一个新的矩形，其大小由给定的偏移量改变。负值会缩小矩形。</td>
</tr>
<tr>
<td>inflate_ip(x, y)</td>
<td>和Rect.inflate()方法一样，但在原地操作。</td>
</tr>
<tr>
<td>clamp(Rect)</td>
<td>返回一个新的矩形，该矩形被移动到完全在参数Rect的内部。</td>
</tr>
<tr>
<td>clip(Rect)</td>
<td>返回一个新的矩形，该矩形被裁剪成完全在参数 Rect 内。</td>
</tr>
<tr>
<td>union(Rect)</td>
<td>返回一个新的矩形，该矩形完全覆盖两个提供的矩形的面积。</td>
</tr>
<tr>
<td>union_ip(Rect)</td>
<td>与 Rect.union() 方法相同，但在原地操作。</td>
</tr>
<tr>
<td>contains(Rect)</td>
<td>当参数完全在Rect里面时返回true。</td>
</tr>
<tr>
<td>collidepoint((x,y))</td>
<td>如果给定的点在矩形内，返回真。</td>
</tr>
<tr>
<td>colliderect(Rect)</td>
<td>如果两个矩形的任何部分重叠，返回真。</td>
</tr>
</tbody>
</table>
<p>ransform</p>
<table>
<thead>
<tr>
<th>flip()</th>
<th>垂直和水平方向的翻转</th>
</tr>
</thead>
<tbody>
<tr>
<td>scale()</td>
<td>调整大小到新的分辨率</td>
</tr>
<tr>
<td>rotate()</td>
<td>旋转一个图像</td>
</tr>
<tr>
<td>rotozoom()</td>
<td>缩放和旋转的过滤</td>
</tr>
<tr>
<td>scale2x()</td>
<td>专门的图像倍增器</td>
</tr>
<tr>
<td>smoothscale()</td>
<td>将一个曲面平滑地扩展到一个任意的尺寸</td>
</tr>
<tr>
<td>get_smoothscale_backend()</td>
<td>返回正在使用的smoothscale过滤器的版本 – ‘GENERIC’, ‘MMX’, or ‘SSE’ 。</td>
</tr>
<tr>
<td>set_smoothscale_backend()</td>
<td>设置平滑尺度过滤器的版本为 – ‘GENERIC’, ‘MMX’, 或 ‘SSE’之一。</td>
</tr>
<tr>
<td>chop()</td>
<td>获取一个去除内部区域的图像的副本</td>
</tr>
<tr>
<td>laplacian()</td>
<td>查找曲面中的边缘</td>
</tr>
<tr>
<td>average_surfaces()</td>
<td>从许多表面中找出平均的表面。</td>
</tr>
<tr>
<td>Average_color()</td>
<td>找出一个曲面的平均颜色</td>
</tr>
<tr>
<td>threshold()</td>
<td>找出一个曲面中哪些像素在 “search_color “或 “search_surf “的阈值范围内，以及有多少像素在阈值范围内。</td>
</tr>
</tbody>
</table>
<p>声音对象
混合器通道</p>
<h5 id="pygame_1">Pygame小游戏</h5>
<h6 id="_61">人物移动射击</h6>
<div class="language-python highlight"><pre><span></span><code><span id="__span-149-1"><a id="__codelineno-149-1" name="__codelineno-149-1" href="#__codelineno-149-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pygame</span>
</span><span id="__span-149-2"><a id="__codelineno-149-2" name="__codelineno-149-2" href="#__codelineno-149-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
</span><span id="__span-149-3"><a id="__codelineno-149-3" name="__codelineno-149-3" href="#__codelineno-149-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</span><span id="__span-149-4"><a id="__codelineno-149-4" name="__codelineno-149-4" href="#__codelineno-149-4"></a>
</span><span id="__span-149-5"><a id="__codelineno-149-5" name="__codelineno-149-5" href="#__codelineno-149-5"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span><span id="__span-149-6"><a id="__codelineno-149-6" name="__codelineno-149-6" href="#__codelineno-149-6"></a><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">=</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">360</span>
</span><span id="__span-149-7"><a id="__codelineno-149-7" name="__codelineno-149-7" href="#__codelineno-149-7"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
</span><span id="__span-149-8"><a id="__codelineno-149-8" name="__codelineno-149-8" href="#__codelineno-149-8"></a><span class="c1"># 获取当前屏幕分辨率</span>
</span><span id="__span-149-9"><a id="__codelineno-149-9" name="__codelineno-149-9" href="#__codelineno-149-9"></a><span class="n">screen_info</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">Info</span><span class="p">()</span>
</span><span id="__span-149-10"><a id="__codelineno-149-10" name="__codelineno-149-10" href="#__codelineno-149-10"></a><span class="n">SCREEN_WIDTH</span> <span class="o">=</span> <span class="n">screen_info</span><span class="o">.</span><span class="n">current_w</span>
</span><span id="__span-149-11"><a id="__codelineno-149-11" name="__codelineno-149-11" href="#__codelineno-149-11"></a><span class="n">SCREEN_HEIGHT</span> <span class="o">=</span> <span class="n">screen_info</span><span class="o">.</span><span class="n">current_h</span>
</span><span id="__span-149-12"><a id="__codelineno-149-12" name="__codelineno-149-12" href="#__codelineno-149-12"></a>
</span><span id="__span-149-13"><a id="__codelineno-149-13" name="__codelineno-149-13" href="#__codelineno-149-13"></a><span class="c1"># 颜色定义</span>
</span><span id="__span-149-14"><a id="__codelineno-149-14" name="__codelineno-149-14" href="#__codelineno-149-14"></a><span class="n">WHITE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="__span-149-15"><a id="__codelineno-149-15" name="__codelineno-149-15" href="#__codelineno-149-15"></a><span class="n">BLACK</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-149-16"><a id="__codelineno-149-16" name="__codelineno-149-16" href="#__codelineno-149-16"></a><span class="n">RED</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-149-17"><a id="__codelineno-149-17" name="__codelineno-149-17" href="#__codelineno-149-17"></a><span class="n">GREEN</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-149-18"><a id="__codelineno-149-18" name="__codelineno-149-18" href="#__codelineno-149-18"></a><span class="n">BLUE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="__span-149-19"><a id="__codelineno-149-19" name="__codelineno-149-19" href="#__codelineno-149-19"></a><span class="n">YELLOW</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-149-20"><a id="__codelineno-149-20" name="__codelineno-149-20" href="#__codelineno-149-20"></a><span class="n">CYAN</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span>
</span><span id="__span-149-21"><a id="__codelineno-149-21" name="__codelineno-149-21" href="#__codelineno-149-21"></a><span class="n">GRAY</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
</span><span id="__span-149-22"><a id="__codelineno-149-22" name="__codelineno-149-22" href="#__codelineno-149-22"></a>
</span><span id="__span-149-23"><a id="__codelineno-149-23" name="__codelineno-149-23" href="#__codelineno-149-23"></a><span class="n">screen</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span><span class="p">))</span>
</span><span id="__span-149-24"><a id="__codelineno-149-24" name="__codelineno-149-24" href="#__codelineno-149-24"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;Player Movement Demo&quot;</span><span class="p">)</span>
</span><span id="__span-149-25"><a id="__codelineno-149-25" name="__codelineno-149-25" href="#__codelineno-149-25"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
</span><span id="__span-149-26"><a id="__codelineno-149-26" name="__codelineno-149-26" href="#__codelineno-149-26"></a>
</span><span id="__span-149-27"><a id="__codelineno-149-27" name="__codelineno-149-27" href="#__codelineno-149-27"></a><span class="c1"># 加载字体</span>
</span><span id="__span-149-28"><a id="__codelineno-149-28" name="__codelineno-149-28" href="#__codelineno-149-28"></a><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">36</span><span class="p">)</span>
</span><span id="__span-149-29"><a id="__codelineno-149-29" name="__codelineno-149-29" href="#__codelineno-149-29"></a>
</span><span id="__span-149-30"><a id="__codelineno-149-30" name="__codelineno-149-30" href="#__codelineno-149-30"></a><span class="k">class</span><span class="w"> </span><span class="nc">Platform</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
</span><span id="__span-149-31"><a id="__codelineno-149-31" name="__codelineno-149-31" href="#__codelineno-149-31"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-149-32"><a id="__codelineno-149-32" name="__codelineno-149-32" href="#__codelineno-149-32"></a><span class="sd">    平台</span>
</span><span id="__span-149-33"><a id="__codelineno-149-33" name="__codelineno-149-33" href="#__codelineno-149-33"></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="__span-149-34"><a id="__codelineno-149-34" name="__codelineno-149-34" href="#__codelineno-149-34"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
</span><span id="__span-149-35"><a id="__codelineno-149-35" name="__codelineno-149-35" href="#__codelineno-149-35"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="__span-149-36"><a id="__codelineno-149-36" name="__codelineno-149-36" href="#__codelineno-149-36"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
</span><span id="__span-149-37"><a id="__codelineno-149-37" name="__codelineno-149-37" href="#__codelineno-149-37"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">GRAY</span><span class="p">)</span>
</span><span id="__span-149-38"><a id="__codelineno-149-38" name="__codelineno-149-38" href="#__codelineno-149-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
</span><span id="__span-149-39"><a id="__codelineno-149-39" name="__codelineno-149-39" href="#__codelineno-149-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="__span-149-40"><a id="__codelineno-149-40" name="__codelineno-149-40" href="#__codelineno-149-40"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="__span-149-41"><a id="__codelineno-149-41" name="__codelineno-149-41" href="#__codelineno-149-41"></a>
</span><span id="__span-149-42"><a id="__codelineno-149-42" name="__codelineno-149-42" href="#__codelineno-149-42"></a><span class="k">class</span><span class="w"> </span><span class="nc">Player</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
</span><span id="__span-149-43"><a id="__codelineno-149-43" name="__codelineno-149-43" href="#__codelineno-149-43"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-149-44"><a id="__codelineno-149-44" name="__codelineno-149-44" href="#__codelineno-149-44"></a><span class="sd">    玩家</span>
</span><span id="__span-149-45"><a id="__codelineno-149-45" name="__codelineno-149-45" href="#__codelineno-149-45"></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="__span-149-46"><a id="__codelineno-149-46" name="__codelineno-149-46" href="#__codelineno-149-46"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-149-47"><a id="__codelineno-149-47" name="__codelineno-149-47" href="#__codelineno-149-47"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="__span-149-48"><a id="__codelineno-149-48" name="__codelineno-149-48" href="#__codelineno-149-48"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
</span><span id="__span-149-49"><a id="__codelineno-149-49" name="__codelineno-149-49" href="#__codelineno-149-49"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">GREEN</span><span class="p">)</span>
</span><span id="__span-149-50"><a id="__codelineno-149-50" name="__codelineno-149-50" href="#__codelineno-149-50"></a>        <span class="c1"># 设置角色的初始位置</span>
</span><span id="__span-149-51"><a id="__codelineno-149-51" name="__codelineno-149-51" href="#__codelineno-149-51"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="n">SCREEN_WIDTH</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span><span class="o">//</span><span class="mi">2</span><span class="p">))</span>
</span><span id="__span-149-52"><a id="__codelineno-149-52" name="__codelineno-149-52" href="#__codelineno-149-52"></a>        <span class="c1"># 设置角色的初始速度和加速度</span>
</span><span id="__span-149-53"><a id="__codelineno-149-53" name="__codelineno-149-53" href="#__codelineno-149-53"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">=</span> <span class="mi">0</span>                 <span class="c1"># 水平速度</span>
</span><span id="__span-149-54"><a id="__codelineno-149-54" name="__codelineno-149-54" href="#__codelineno-149-54"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">acceleration_x</span> <span class="o">=</span> <span class="mf">0.5</span>           <span class="c1"># 水平加速度</span>
</span><span id="__span-149-55"><a id="__codelineno-149-55" name="__codelineno-149-55" href="#__codelineno-149-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frictionAacceleration_x</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># 水平摩擦力加速度</span>
</span><span id="__span-149-56"><a id="__codelineno-149-56" name="__codelineno-149-56" href="#__codelineno-149-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_velocity</span> <span class="o">=</span> <span class="mi">5</span>               <span class="c1"># 最大速度</span>
</span><span id="__span-149-57"><a id="__codelineno-149-57" name="__codelineno-149-57" href="#__codelineno-149-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">=</span> <span class="mi">0</span>                 <span class="c1"># 垂直速度</span>
</span><span id="__span-149-58"><a id="__codelineno-149-58" name="__codelineno-149-58" href="#__codelineno-149-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">acceleration_y</span> <span class="o">=</span> <span class="mi">1</span>             <span class="c1"># 重力加速度</span>
</span><span id="__span-149-59"><a id="__codelineno-149-59" name="__codelineno-149-59" href="#__codelineno-149-59"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">jump_velocity</span> <span class="o">=</span> <span class="o">-</span><span class="mi">15</span>  <span class="c1"># 跳跃速度</span>
</span><span id="__span-149-60"><a id="__codelineno-149-60" name="__codelineno-149-60" href="#__codelineno-149-60"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_ground</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># 是否在地面上</span>
</span><span id="__span-149-61"><a id="__codelineno-149-61" name="__codelineno-149-61" href="#__codelineno-149-61"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_jump_count</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 最大跳跃次数</span>
</span><span id="__span-149-62"><a id="__codelineno-149-62" name="__codelineno-149-62" href="#__codelineno-149-62"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">jump_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_jump_count</span> <span class="c1"># 剩余跳跃次数</span>
</span><span id="__span-149-63"><a id="__codelineno-149-63" name="__codelineno-149-63" href="#__codelineno-149-63"></a>
</span><span id="__span-149-64"><a id="__codelineno-149-64" name="__codelineno-149-64" href="#__codelineno-149-64"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">jump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-149-65"><a id="__codelineno-149-65" name="__codelineno-149-65" href="#__codelineno-149-65"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">jump_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 如果还有跳跃次数</span>
</span><span id="__span-149-66"><a id="__codelineno-149-66" name="__codelineno-149-66" href="#__codelineno-149-66"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jump_velocity</span>
</span><span id="__span-149-67"><a id="__codelineno-149-67" name="__codelineno-149-67" href="#__codelineno-149-67"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">jump_count</span> <span class="o">-=</span> <span class="mi">1</span>  <span class="c1"># 减少跳跃次数</span>
</span><span id="__span-149-68"><a id="__codelineno-149-68" name="__codelineno-149-68" href="#__codelineno-149-68"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">on_ground</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># 标记为不在平台上</span>
</span><span id="__span-149-69"><a id="__codelineno-149-69" name="__codelineno-149-69" href="#__codelineno-149-69"></a>
</span><span id="__span-149-70"><a id="__codelineno-149-70" name="__codelineno-149-70" href="#__codelineno-149-70"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">moveLeft</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-149-71"><a id="__codelineno-149-71" name="__codelineno-149-71" href="#__codelineno-149-71"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">max_velocity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">acceleration_x</span><span class="p">)</span>
</span><span id="__span-149-72"><a id="__codelineno-149-72" name="__codelineno-149-72" href="#__codelineno-149-72"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span>
</span><span id="__span-149-73"><a id="__codelineno-149-73" name="__codelineno-149-73" href="#__codelineno-149-73"></a>
</span><span id="__span-149-74"><a id="__codelineno-149-74" name="__codelineno-149-74" href="#__codelineno-149-74"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">moveRight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-149-75"><a id="__codelineno-149-75" name="__codelineno-149-75" href="#__codelineno-149-75"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_velocity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">acceleration_x</span><span class="p">)</span>
</span><span id="__span-149-76"><a id="__codelineno-149-76" name="__codelineno-149-76" href="#__codelineno-149-76"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span>
</span><span id="__span-149-77"><a id="__codelineno-149-77" name="__codelineno-149-77" href="#__codelineno-149-77"></a>
</span><span id="__span-149-78"><a id="__codelineno-149-78" name="__codelineno-149-78" href="#__codelineno-149-78"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-149-79"><a id="__codelineno-149-79" name="__codelineno-149-79" href="#__codelineno-149-79"></a>        <span class="c1"># 更新角色的位置和速度</span>
</span><span id="__span-149-80"><a id="__codelineno-149-80" name="__codelineno-149-80" href="#__codelineno-149-80"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">acceleration_y</span>
</span><span id="__span-149-81"><a id="__codelineno-149-81" name="__codelineno-149-81" href="#__codelineno-149-81"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span>
</span><span id="__span-149-82"><a id="__codelineno-149-82" name="__codelineno-149-82" href="#__codelineno-149-82"></a>        <span class="c1"># 控制角色不超出屏幕边缘</span>
</span><span id="__span-149-83"><a id="__codelineno-149-83" name="__codelineno-149-83" href="#__codelineno-149-83"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">:</span>
</span><span id="__span-149-84"><a id="__codelineno-149-84" name="__codelineno-149-84" href="#__codelineno-149-84"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span>
</span><span id="__span-149-85"><a id="__codelineno-149-85" name="__codelineno-149-85" href="#__codelineno-149-85"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocity</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-149-86"><a id="__codelineno-149-86" name="__codelineno-149-86" href="#__codelineno-149-86"></a>        <span class="c1"># 模拟摩擦力（逐渐减速）</span>
</span><span id="__span-149-87"><a id="__codelineno-149-87" name="__codelineno-149-87" href="#__codelineno-149-87"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-149-88"><a id="__codelineno-149-88" name="__codelineno-149-88" href="#__codelineno-149-88"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">frictionAacceleration_x</span><span class="p">)</span>
</span><span id="__span-149-89"><a id="__codelineno-149-89" name="__codelineno-149-89" href="#__codelineno-149-89"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-149-90"><a id="__codelineno-149-90" name="__codelineno-149-90" href="#__codelineno-149-90"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">frictionAacceleration_x</span><span class="p">)</span>
</span><span id="__span-149-91"><a id="__codelineno-149-91" name="__codelineno-149-91" href="#__codelineno-149-91"></a>
</span><span id="__span-149-92"><a id="__codelineno-149-92" name="__codelineno-149-92" href="#__codelineno-149-92"></a>        <span class="c1"># 边界检测（水平方向）</span>
</span><span id="__span-149-93"><a id="__codelineno-149-93" name="__codelineno-149-93" href="#__codelineno-149-93"></a>        <span class="c1"># 如果角色超出左边界</span>
</span><span id="__span-149-94"><a id="__codelineno-149-94" name="__codelineno-149-94" href="#__codelineno-149-94"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-149-95"><a id="__codelineno-149-95" name="__codelineno-149-95" href="#__codelineno-149-95"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 限制位置</span>
</span><span id="__span-149-96"><a id="__codelineno-149-96" name="__codelineno-149-96" href="#__codelineno-149-96"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span>  <span class="c1"># 反转速度</span>
</span><span id="__span-149-97"><a id="__codelineno-149-97" name="__codelineno-149-97" href="#__codelineno-149-97"></a>        <span class="c1"># 如果角色超出右边界</span>
</span><span id="__span-149-98"><a id="__codelineno-149-98" name="__codelineno-149-98" href="#__codelineno-149-98"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">SCREEN_WIDTH</span><span class="p">:</span>
</span><span id="__span-149-99"><a id="__codelineno-149-99" name="__codelineno-149-99" href="#__codelineno-149-99"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">SCREEN_WIDTH</span>  <span class="c1"># 限制位置</span>
</span><span id="__span-149-100"><a id="__codelineno-149-100" name="__codelineno-149-100" href="#__codelineno-149-100"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span>  <span class="c1"># 反转速度</span>
</span><span id="__span-149-101"><a id="__codelineno-149-101" name="__codelineno-149-101" href="#__codelineno-149-101"></a>
</span><span id="__span-149-102"><a id="__codelineno-149-102" name="__codelineno-149-102" href="#__codelineno-149-102"></a>        <span class="c1"># 碰撞检测（与平台）</span>
</span><span id="__span-149-103"><a id="__codelineno-149-103" name="__codelineno-149-103" href="#__codelineno-149-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_ground</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-149-104"><a id="__codelineno-149-104" name="__codelineno-149-104" href="#__codelineno-149-104"></a>        <span class="k">for</span> <span class="n">platform</span> <span class="ow">in</span> <span class="n">platforms</span><span class="p">:</span>
</span><span id="__span-149-105"><a id="__codelineno-149-105" name="__codelineno-149-105" href="#__codelineno-149-105"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">colliderect</span><span class="p">(</span><span class="n">platform</span><span class="o">.</span><span class="n">rect</span><span class="p">):</span>
</span><span id="__span-149-106"><a id="__codelineno-149-106" name="__codelineno-149-106" href="#__codelineno-149-106"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 下落时碰到平台</span>
</span><span id="__span-149-107"><a id="__codelineno-149-107" name="__codelineno-149-107" href="#__codelineno-149-107"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span>
</span><span id="__span-149-108"><a id="__codelineno-149-108" name="__codelineno-149-108" href="#__codelineno-149-108"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-149-109"><a id="__codelineno-149-109" name="__codelineno-149-109" href="#__codelineno-149-109"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">on_ground</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-149-110"><a id="__codelineno-149-110" name="__codelineno-149-110" href="#__codelineno-149-110"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">jump_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_jump_count</span>
</span><span id="__span-149-111"><a id="__codelineno-149-111" name="__codelineno-149-111" href="#__codelineno-149-111"></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 上升时碰到平台</span>
</span><span id="__span-149-112"><a id="__codelineno-149-112" name="__codelineno-149-112" href="#__codelineno-149-112"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span>
</span><span id="__span-149-113"><a id="__codelineno-149-113" name="__codelineno-149-113" href="#__codelineno-149-113"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-149-114"><a id="__codelineno-149-114" name="__codelineno-149-114" href="#__codelineno-149-114"></a>
</span><span id="__span-149-115"><a id="__codelineno-149-115" name="__codelineno-149-115" href="#__codelineno-149-115"></a><span class="k">class</span><span class="w"> </span><span class="nc">Bullet</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
</span><span id="__span-149-116"><a id="__codelineno-149-116" name="__codelineno-149-116" href="#__codelineno-149-116"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-149-117"><a id="__codelineno-149-117" name="__codelineno-149-117" href="#__codelineno-149-117"></a><span class="sd">    子弹</span>
</span><span id="__span-149-118"><a id="__codelineno-149-118" name="__codelineno-149-118" href="#__codelineno-149-118"></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="__span-149-119"><a id="__codelineno-149-119" name="__codelineno-149-119" href="#__codelineno-149-119"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_x</span><span class="p">,</span> <span class="n">start_y</span><span class="p">,</span> <span class="n">target_x</span><span class="p">,</span> <span class="n">target_y</span><span class="p">,</span> <span class="n">colour</span><span class="p">,</span> <span class="n">damage</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">velocity</span><span class="p">):</span>
</span><span id="__span-149-120"><a id="__codelineno-149-120" name="__codelineno-149-120" href="#__codelineno-149-120"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="__span-149-121"><a id="__codelineno-149-121" name="__codelineno-149-121" href="#__codelineno-149-121"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">damage</span> <span class="o">=</span> <span class="n">damage</span>
</span><span id="__span-149-122"><a id="__codelineno-149-122" name="__codelineno-149-122" href="#__codelineno-149-122"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>  <span class="c1"># 子弹半径</span>
</span><span id="__span-149-123"><a id="__codelineno-149-123" name="__codelineno-149-123" href="#__codelineno-149-123"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gravity</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># 重力加速度</span>
</span><span id="__span-149-124"><a id="__codelineno-149-124" name="__codelineno-149-124" href="#__codelineno-149-124"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">velocity</span> <span class="o">=</span> <span class="n">velocity</span>
</span><span id="__span-149-125"><a id="__codelineno-149-125" name="__codelineno-149-125" href="#__codelineno-149-125"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">*</span> <span class="mi">2</span><span class="p">),</span> <span class="n">pygame</span><span class="o">.</span><span class="n">SRCALPHA</span><span class="p">)</span>
</span><span id="__span-149-126"><a id="__codelineno-149-126" name="__codelineno-149-126" href="#__codelineno-149-126"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">colour</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
</span><span id="__span-149-127"><a id="__codelineno-149-127" name="__codelineno-149-127" href="#__codelineno-149-127"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="n">start_x</span><span class="p">,</span> <span class="n">start_y</span><span class="p">))</span>
</span><span id="__span-149-128"><a id="__codelineno-149-128" name="__codelineno-149-128" href="#__codelineno-149-128"></a>
</span><span id="__span-149-129"><a id="__codelineno-149-129" name="__codelineno-149-129" href="#__codelineno-149-129"></a>        <span class="c1"># 计算子弹飞行方向</span>
</span><span id="__span-149-130"><a id="__codelineno-149-130" name="__codelineno-149-130" href="#__codelineno-149-130"></a>        <span class="n">dx</span> <span class="o">=</span> <span class="n">target_x</span> <span class="o">-</span> <span class="n">start_x</span>
</span><span id="__span-149-131"><a id="__codelineno-149-131" name="__codelineno-149-131" href="#__codelineno-149-131"></a>        <span class="n">dy</span> <span class="o">=</span> <span class="n">target_y</span> <span class="o">-</span> <span class="n">start_y</span>
</span><span id="__span-149-132"><a id="__codelineno-149-132" name="__codelineno-149-132" href="#__codelineno-149-132"></a>        <span class="n">distance</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>  <span class="c1"># 计算两点间距离</span>
</span><span id="__span-149-133"><a id="__codelineno-149-133" name="__codelineno-149-133" href="#__codelineno-149-133"></a>        <span class="k">if</span> <span class="n">distance</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-149-134"><a id="__codelineno-149-134" name="__codelineno-149-134" href="#__codelineno-149-134"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-149-135"><a id="__codelineno-149-135" name="__codelineno-149-135" href="#__codelineno-149-135"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-149-136"><a id="__codelineno-149-136" name="__codelineno-149-136" href="#__codelineno-149-136"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-149-137"><a id="__codelineno-149-137" name="__codelineno-149-137" href="#__codelineno-149-137"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">distance</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity</span>  <span class="c1"># 速度向量</span>
</span><span id="__span-149-138"><a id="__codelineno-149-138" name="__codelineno-149-138" href="#__codelineno-149-138"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">distance</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity</span>
</span><span id="__span-149-139"><a id="__codelineno-149-139" name="__codelineno-149-139" href="#__codelineno-149-139"></a>
</span><span id="__span-149-140"><a id="__codelineno-149-140" name="__codelineno-149-140" href="#__codelineno-149-140"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-149-141"><a id="__codelineno-149-141" name="__codelineno-149-141" href="#__codelineno-149-141"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span>
</span><span id="__span-149-142"><a id="__codelineno-149-142" name="__codelineno-149-142" href="#__codelineno-149-142"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span>
</span><span id="__span-149-143"><a id="__codelineno-149-143" name="__codelineno-149-143" href="#__codelineno-149-143"></a>        <span class="c1"># 应用重力</span>
</span><span id="__span-149-144"><a id="__codelineno-149-144" name="__codelineno-149-144" href="#__codelineno-149-144"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gravity</span>
</span><span id="__span-149-145"><a id="__codelineno-149-145" name="__codelineno-149-145" href="#__codelineno-149-145"></a>        <span class="c1"># 如果子弹飞出屏幕，移除它</span>
</span><span id="__span-149-146"><a id="__codelineno-149-146" name="__codelineno-149-146" href="#__codelineno-149-146"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">SCREEN_WIDTH</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">SCREEN_HEIGHT</span><span class="p">:</span>
</span><span id="__span-149-147"><a id="__codelineno-149-147" name="__codelineno-149-147" href="#__codelineno-149-147"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
</span><span id="__span-149-148"><a id="__codelineno-149-148" name="__codelineno-149-148" href="#__codelineno-149-148"></a>
</span><span id="__span-149-149"><a id="__codelineno-149-149" name="__codelineno-149-149" href="#__codelineno-149-149"></a><span class="k">class</span><span class="w"> </span><span class="nc">Enemy</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
</span><span id="__span-149-150"><a id="__codelineno-149-150" name="__codelineno-149-150" href="#__codelineno-149-150"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-149-151"><a id="__codelineno-149-151" name="__codelineno-149-151" href="#__codelineno-149-151"></a><span class="sd">    敌人</span>
</span><span id="__span-149-152"><a id="__codelineno-149-152" name="__codelineno-149-152" href="#__codelineno-149-152"></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="__span-149-153"><a id="__codelineno-149-153" name="__codelineno-149-153" href="#__codelineno-149-153"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">health</span><span class="p">):</span>
</span><span id="__span-149-154"><a id="__codelineno-149-154" name="__codelineno-149-154" href="#__codelineno-149-154"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-149-155"><a id="__codelineno-149-155" name="__codelineno-149-155" href="#__codelineno-149-155"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">))</span>
</span><span id="__span-149-156"><a id="__codelineno-149-156" name="__codelineno-149-156" href="#__codelineno-149-156"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">YELLOW</span><span class="p">)</span>
</span><span id="__span-149-157"><a id="__codelineno-149-157" name="__codelineno-149-157" href="#__codelineno-149-157"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
</span><span id="__span-149-158"><a id="__codelineno-149-158" name="__codelineno-149-158" href="#__codelineno-149-158"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SCREEN_WIDTH</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
</span><span id="__span-149-159"><a id="__codelineno-149-159" name="__codelineno-149-159" href="#__codelineno-149-159"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</span><span id="__span-149-160"><a id="__codelineno-149-160" name="__codelineno-149-160" href="#__codelineno-149-160"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">health</span> <span class="o">=</span> <span class="n">health</span>  <span class="c1"># 敌人生命值</span>
</span><span id="__span-149-161"><a id="__codelineno-149-161" name="__codelineno-149-161" href="#__codelineno-149-161"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># 随机水平速度</span>
</span><span id="__span-149-162"><a id="__codelineno-149-162" name="__codelineno-149-162" href="#__codelineno-149-162"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># 随机垂直速度</span>
</span><span id="__span-149-163"><a id="__codelineno-149-163" name="__codelineno-149-163" href="#__codelineno-149-163"></a>
</span><span id="__span-149-164"><a id="__codelineno-149-164" name="__codelineno-149-164" href="#__codelineno-149-164"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-149-165"><a id="__codelineno-149-165" name="__codelineno-149-165" href="#__codelineno-149-165"></a>        <span class="c1"># 随机移动</span>
</span><span id="__span-149-166"><a id="__codelineno-149-166" name="__codelineno-149-166" href="#__codelineno-149-166"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span>
</span><span id="__span-149-167"><a id="__codelineno-149-167" name="__codelineno-149-167" href="#__codelineno-149-167"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span>
</span><span id="__span-149-168"><a id="__codelineno-149-168" name="__codelineno-149-168" href="#__codelineno-149-168"></a>
</span><span id="__span-149-169"><a id="__codelineno-149-169" name="__codelineno-149-169" href="#__codelineno-149-169"></a>        <span class="c1"># 边界检测</span>
</span><span id="__span-149-170"><a id="__codelineno-149-170" name="__codelineno-149-170" href="#__codelineno-149-170"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">SCREEN_WIDTH</span><span class="p">:</span>
</span><span id="__span-149-171"><a id="__codelineno-149-171" name="__codelineno-149-171" href="#__codelineno-149-171"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">velocity_x</span>  <span class="c1"># 反转水平方向</span>
</span><span id="__span-149-172"><a id="__codelineno-149-172" name="__codelineno-149-172" href="#__codelineno-149-172"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&gt;</span> <span class="n">SCREEN_HEIGHT</span><span class="p">:</span>
</span><span id="__span-149-173"><a id="__codelineno-149-173" name="__codelineno-149-173" href="#__codelineno-149-173"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span>  <span class="c1"># 反转垂直方向</span>
</span><span id="__span-149-174"><a id="__codelineno-149-174" name="__codelineno-149-174" href="#__codelineno-149-174"></a>
</span><span id="__span-149-175"><a id="__codelineno-149-175" name="__codelineno-149-175" href="#__codelineno-149-175"></a>        <span class="c1"># 碰撞检测（与平台）</span>
</span><span id="__span-149-176"><a id="__codelineno-149-176" name="__codelineno-149-176" href="#__codelineno-149-176"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_ground</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-149-177"><a id="__codelineno-149-177" name="__codelineno-149-177" href="#__codelineno-149-177"></a>        <span class="k">for</span> <span class="n">platform</span> <span class="ow">in</span> <span class="n">platforms</span><span class="p">:</span>
</span><span id="__span-149-178"><a id="__codelineno-149-178" name="__codelineno-149-178" href="#__codelineno-149-178"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">colliderect</span><span class="p">(</span><span class="n">platform</span><span class="o">.</span><span class="n">rect</span><span class="p">):</span>
</span><span id="__span-149-179"><a id="__codelineno-149-179" name="__codelineno-149-179" href="#__codelineno-149-179"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 下落时碰到平台</span>
</span><span id="__span-149-180"><a id="__codelineno-149-180" name="__codelineno-149-180" href="#__codelineno-149-180"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span>
</span><span id="__span-149-181"><a id="__codelineno-149-181" name="__codelineno-149-181" href="#__codelineno-149-181"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-149-182"><a id="__codelineno-149-182" name="__codelineno-149-182" href="#__codelineno-149-182"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">on_ground</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-149-183"><a id="__codelineno-149-183" name="__codelineno-149-183" href="#__codelineno-149-183"></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 上升时碰到平台</span>
</span><span id="__span-149-184"><a id="__codelineno-149-184" name="__codelineno-149-184" href="#__codelineno-149-184"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span>
</span><span id="__span-149-185"><a id="__codelineno-149-185" name="__codelineno-149-185" href="#__codelineno-149-185"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-149-186"><a id="__codelineno-149-186" name="__codelineno-149-186" href="#__codelineno-149-186"></a>
</span><span id="__span-149-187"><a id="__codelineno-149-187" name="__codelineno-149-187" href="#__codelineno-149-187"></a><span class="n">player</span> <span class="o">=</span> <span class="n">Player</span><span class="p">()</span>
</span><span id="__span-149-188"><a id="__codelineno-149-188" name="__codelineno-149-188" href="#__codelineno-149-188"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
</span><span id="__span-149-189"><a id="__codelineno-149-189" name="__codelineno-149-189" href="#__codelineno-149-189"></a><span class="n">bullets</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>  <span class="c1"># 子弹组</span>
</span><span id="__span-149-190"><a id="__codelineno-149-190" name="__codelineno-149-190" href="#__codelineno-149-190"></a><span class="n">enemies</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>  <span class="c1"># 敌人组</span>
</span><span id="__span-149-191"><a id="__codelineno-149-191" name="__codelineno-149-191" href="#__codelineno-149-191"></a><span class="n">platforms</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>  <span class="c1"># 平台组</span>
</span><span id="__span-149-192"><a id="__codelineno-149-192" name="__codelineno-149-192" href="#__codelineno-149-192"></a><span class="n">max_bullets</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># 最大子弹数量</span>
</span><span id="__span-149-193"><a id="__codelineno-149-193" name="__codelineno-149-193" href="#__codelineno-149-193"></a><span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 初始得分</span>
</span><span id="__span-149-194"><a id="__codelineno-149-194" name="__codelineno-149-194" href="#__codelineno-149-194"></a>
</span><span id="__span-149-195"><a id="__codelineno-149-195" name="__codelineno-149-195" href="#__codelineno-149-195"></a><span class="c1"># 创建平台</span>
</span><span id="__span-149-196"><a id="__codelineno-149-196" name="__codelineno-149-196" href="#__codelineno-149-196"></a><span class="n">platforms</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Platform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">-</span> <span class="mi">40</span><span class="p">,</span> <span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="mi">40</span><span class="p">))</span>  <span class="c1"># 底部平台</span>
</span><span id="__span-149-197"><a id="__codelineno-149-197" name="__codelineno-149-197" href="#__codelineno-149-197"></a><span class="n">platforms</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Platform</span><span class="p">(</span><span class="n">SCREEN_WIDTH</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">-</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>  <span class="c1"># 中间平台</span>
</span><span id="__span-149-198"><a id="__codelineno-149-198" name="__codelineno-149-198" href="#__codelineno-149-198"></a><span class="n">platforms</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Platform</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">-</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>  <span class="c1"># 顶部平台</span>
</span><span id="__span-149-199"><a id="__codelineno-149-199" name="__codelineno-149-199" href="#__codelineno-149-199"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">platforms</span><span class="p">)</span>
</span><span id="__span-149-200"><a id="__codelineno-149-200" name="__codelineno-149-200" href="#__codelineno-149-200"></a>
</span><span id="__span-149-201"><a id="__codelineno-149-201" name="__codelineno-149-201" href="#__codelineno-149-201"></a><span class="c1"># 敌人生成计时器</span>
</span><span id="__span-149-202"><a id="__codelineno-149-202" name="__codelineno-149-202" href="#__codelineno-149-202"></a><span class="n">max_enemies</span> <span class="o">=</span> <span class="mi">6</span>
</span><span id="__span-149-203"><a id="__codelineno-149-203" name="__codelineno-149-203" href="#__codelineno-149-203"></a><span class="n">enemy_spawn_time</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-149-204"><a id="__codelineno-149-204" name="__codelineno-149-204" href="#__codelineno-149-204"></a><span class="n">enemy_spawn_interval</span> <span class="o">=</span> <span class="mi">2000</span>  <span class="c1"># 每 2 秒生成一个敌人（单位：毫秒）</span>
</span><span id="__span-149-205"><a id="__codelineno-149-205" name="__codelineno-149-205" href="#__codelineno-149-205"></a>
</span><span id="__span-149-206"><a id="__codelineno-149-206" name="__codelineno-149-206" href="#__codelineno-149-206"></a><span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-149-207"><a id="__codelineno-149-207" name="__codelineno-149-207" href="#__codelineno-149-207"></a><span class="k">while</span> <span class="n">running</span><span class="p">:</span>
</span><span id="__span-149-208"><a id="__codelineno-149-208" name="__codelineno-149-208" href="#__codelineno-149-208"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
</span><span id="__span-149-209"><a id="__codelineno-149-209" name="__codelineno-149-209" href="#__codelineno-149-209"></a>
</span><span id="__span-149-210"><a id="__codelineno-149-210" name="__codelineno-149-210" href="#__codelineno-149-210"></a>    <span class="c1"># 处理事件</span>
</span><span id="__span-149-211"><a id="__codelineno-149-211" name="__codelineno-149-211" href="#__codelineno-149-211"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="__span-149-212"><a id="__codelineno-149-212" name="__codelineno-149-212" href="#__codelineno-149-212"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
</span><span id="__span-149-213"><a id="__codelineno-149-213" name="__codelineno-149-213" href="#__codelineno-149-213"></a>            <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-149-214"><a id="__codelineno-149-214" name="__codelineno-149-214" href="#__codelineno-149-214"></a>        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
</span><span id="__span-149-215"><a id="__codelineno-149-215" name="__codelineno-149-215" href="#__codelineno-149-215"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_SPACE</span> <span class="ow">or</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_w</span> <span class="ow">or</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_UP</span><span class="p">:</span>
</span><span id="__span-149-216"><a id="__codelineno-149-216" name="__codelineno-149-216" href="#__codelineno-149-216"></a>                <span class="n">player</span><span class="o">.</span><span class="n">jump</span><span class="p">()</span>
</span><span id="__span-149-217"><a id="__codelineno-149-217" name="__codelineno-149-217" href="#__codelineno-149-217"></a>            <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_ESCAPE</span><span class="p">:</span>  <span class="c1"># 按下 ESC 键</span>
</span><span id="__span-149-218"><a id="__codelineno-149-218" name="__codelineno-149-218" href="#__codelineno-149-218"></a>                <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-149-219"><a id="__codelineno-149-219" name="__codelineno-149-219" href="#__codelineno-149-219"></a>        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">MOUSEBUTTONDOWN</span><span class="p">:</span>  <span class="c1"># 鼠标点击事件</span>
</span><span id="__span-149-220"><a id="__codelineno-149-220" name="__codelineno-149-220" href="#__codelineno-149-220"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># 左键点击</span>
</span><span id="__span-149-221"><a id="__codelineno-149-221" name="__codelineno-149-221" href="#__codelineno-149-221"></a>                <span class="c1"># 获取鼠标点击位置</span>
</span><span id="__span-149-222"><a id="__codelineno-149-222" name="__codelineno-149-222" href="#__codelineno-149-222"></a>                <span class="n">mouse_x</span><span class="p">,</span> <span class="n">mouse_y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">pos</span>
</span><span id="__span-149-223"><a id="__codelineno-149-223" name="__codelineno-149-223" href="#__codelineno-149-223"></a>                <span class="c1"># 检查子弹数量</span>
</span><span id="__span-149-224"><a id="__codelineno-149-224" name="__codelineno-149-224" href="#__codelineno-149-224"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bullets</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_bullets</span><span class="p">:</span>
</span><span id="__span-149-225"><a id="__codelineno-149-225" name="__codelineno-149-225" href="#__codelineno-149-225"></a>                    <span class="c1"># 发射子弹</span>
</span><span id="__span-149-226"><a id="__codelineno-149-226" name="__codelineno-149-226" href="#__codelineno-149-226"></a>                    <span class="n">bullet</span> <span class="o">=</span> <span class="n">Bullet</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span><span class="p">,</span> <span class="n">player</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centery</span><span class="p">,</span> <span class="n">mouse_x</span><span class="p">,</span> <span class="n">mouse_y</span><span class="p">,</span> <span class="n">RED</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</span><span id="__span-149-227"><a id="__codelineno-149-227" name="__codelineno-149-227" href="#__codelineno-149-227"></a>                    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">bullet</span><span class="p">)</span>
</span><span id="__span-149-228"><a id="__codelineno-149-228" name="__codelineno-149-228" href="#__codelineno-149-228"></a>                    <span class="n">bullets</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">bullet</span><span class="p">)</span>
</span><span id="__span-149-229"><a id="__codelineno-149-229" name="__codelineno-149-229" href="#__codelineno-149-229"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># 右键点击</span>
</span><span id="__span-149-230"><a id="__codelineno-149-230" name="__codelineno-149-230" href="#__codelineno-149-230"></a>                <span class="c1"># 获取鼠标点击位置</span>
</span><span id="__span-149-231"><a id="__codelineno-149-231" name="__codelineno-149-231" href="#__codelineno-149-231"></a>                <span class="n">mouse_x</span><span class="p">,</span> <span class="n">mouse_y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">pos</span>
</span><span id="__span-149-232"><a id="__codelineno-149-232" name="__codelineno-149-232" href="#__codelineno-149-232"></a>                <span class="c1"># 检查子弹数量</span>
</span><span id="__span-149-233"><a id="__codelineno-149-233" name="__codelineno-149-233" href="#__codelineno-149-233"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bullets</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_bullets</span><span class="p">:</span>
</span><span id="__span-149-234"><a id="__codelineno-149-234" name="__codelineno-149-234" href="#__codelineno-149-234"></a>                    <span class="c1"># 发射子弹</span>
</span><span id="__span-149-235"><a id="__codelineno-149-235" name="__codelineno-149-235" href="#__codelineno-149-235"></a>                    <span class="n">bullet</span> <span class="o">=</span> <span class="n">Bullet</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span><span class="p">,</span> <span class="n">player</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centery</span><span class="p">,</span> <span class="n">mouse_x</span><span class="p">,</span> <span class="n">mouse_y</span><span class="p">,</span> <span class="n">BLUE</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="__span-149-236"><a id="__codelineno-149-236" name="__codelineno-149-236" href="#__codelineno-149-236"></a>                    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">bullet</span><span class="p">)</span>
</span><span id="__span-149-237"><a id="__codelineno-149-237" name="__codelineno-149-237" href="#__codelineno-149-237"></a>                    <span class="n">bullets</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">bullet</span><span class="p">)</span>
</span><span id="__span-149-238"><a id="__codelineno-149-238" name="__codelineno-149-238" href="#__codelineno-149-238"></a>
</span><span id="__span-149-239"><a id="__codelineno-149-239" name="__codelineno-149-239" href="#__codelineno-149-239"></a>    <span class="c1"># 实时检测键盘状态</span>
</span><span id="__span-149-240"><a id="__codelineno-149-240" name="__codelineno-149-240" href="#__codelineno-149-240"></a>    <span class="n">keys</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_pressed</span><span class="p">()</span>
</span><span id="__span-149-241"><a id="__codelineno-149-241" name="__codelineno-149-241" href="#__codelineno-149-241"></a>    <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_a</span><span class="p">]</span> <span class="ow">or</span> <span class="n">keys</span><span class="p">[</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">]:</span>
</span><span id="__span-149-242"><a id="__codelineno-149-242" name="__codelineno-149-242" href="#__codelineno-149-242"></a>        <span class="n">player</span><span class="o">.</span><span class="n">moveLeft</span><span class="p">()</span>
</span><span id="__span-149-243"><a id="__codelineno-149-243" name="__codelineno-149-243" href="#__codelineno-149-243"></a>    <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_d</span><span class="p">]</span> <span class="ow">or</span> <span class="n">keys</span><span class="p">[</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">]:</span>
</span><span id="__span-149-244"><a id="__codelineno-149-244" name="__codelineno-149-244" href="#__codelineno-149-244"></a>        <span class="n">player</span><span class="o">.</span><span class="n">moveRight</span><span class="p">()</span>
</span><span id="__span-149-245"><a id="__codelineno-149-245" name="__codelineno-149-245" href="#__codelineno-149-245"></a>
</span><span id="__span-149-246"><a id="__codelineno-149-246" name="__codelineno-149-246" href="#__codelineno-149-246"></a>    <span class="c1"># 更新精灵逻辑</span>
</span><span id="__span-149-247"><a id="__codelineno-149-247" name="__codelineno-149-247" href="#__codelineno-149-247"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="__span-149-248"><a id="__codelineno-149-248" name="__codelineno-149-248" href="#__codelineno-149-248"></a>
</span><span id="__span-149-249"><a id="__codelineno-149-249" name="__codelineno-149-249" href="#__codelineno-149-249"></a>    <span class="c1"># 检测子弹与敌人的碰撞</span>
</span><span id="__span-149-250"><a id="__codelineno-149-250" name="__codelineno-149-250" href="#__codelineno-149-250"></a>    <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">groupcollide</span><span class="p">(</span><span class="n">bullets</span><span class="p">,</span> <span class="n">enemies</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="__span-149-251"><a id="__codelineno-149-251" name="__codelineno-149-251" href="#__codelineno-149-251"></a>    <span class="k">for</span> <span class="n">bullet</span><span class="p">,</span> <span class="n">enemy_list</span> <span class="ow">in</span> <span class="n">hits</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-149-252"><a id="__codelineno-149-252" name="__codelineno-149-252" href="#__codelineno-149-252"></a>        <span class="k">for</span> <span class="n">enemy</span> <span class="ow">in</span> <span class="n">enemy_list</span><span class="p">:</span>
</span><span id="__span-149-253"><a id="__codelineno-149-253" name="__codelineno-149-253" href="#__codelineno-149-253"></a>            <span class="n">enemy</span><span class="o">.</span><span class="n">health</span> <span class="o">-=</span> <span class="n">bullet</span><span class="o">.</span><span class="n">damage</span>  <span class="c1"># 减少敌人生命值</span>
</span><span id="__span-149-254"><a id="__codelineno-149-254" name="__codelineno-149-254" href="#__codelineno-149-254"></a>            <span class="k">if</span> <span class="n">enemy</span><span class="o">.</span><span class="n">health</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 如果敌人生命值为 0</span>
</span><span id="__span-149-255"><a id="__codelineno-149-255" name="__codelineno-149-255" href="#__codelineno-149-255"></a>                <span class="n">enemy</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>  <span class="c1"># 移除敌人</span>
</span><span id="__span-149-256"><a id="__codelineno-149-256" name="__codelineno-149-256" href="#__codelineno-149-256"></a>                <span class="n">score</span> <span class="o">+=</span> <span class="mi">10</span>  <span class="c1"># 增加得分</span>
</span><span id="__span-149-257"><a id="__codelineno-149-257" name="__codelineno-149-257" href="#__codelineno-149-257"></a>
</span><span id="__span-149-258"><a id="__codelineno-149-258" name="__codelineno-149-258" href="#__codelineno-149-258"></a>    <span class="c1"># 随时间生成敌人</span>
</span><span id="__span-149-259"><a id="__codelineno-149-259" name="__codelineno-149-259" href="#__codelineno-149-259"></a>    <span class="n">current_time</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
</span><span id="__span-149-260"><a id="__codelineno-149-260" name="__codelineno-149-260" href="#__codelineno-149-260"></a>    <span class="k">if</span> <span class="n">current_time</span> <span class="o">-</span> <span class="n">enemy_spawn_time</span> <span class="o">&gt;</span> <span class="n">enemy_spawn_interval</span><span class="p">:</span>
</span><span id="__span-149-261"><a id="__codelineno-149-261" name="__codelineno-149-261" href="#__codelineno-149-261"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">enemies</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_enemies</span><span class="p">:</span>
</span><span id="__span-149-262"><a id="__codelineno-149-262" name="__codelineno-149-262" href="#__codelineno-149-262"></a>            <span class="n">enemy</span> <span class="o">=</span> <span class="n">Enemy</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="__span-149-263"><a id="__codelineno-149-263" name="__codelineno-149-263" href="#__codelineno-149-263"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">enemy</span><span class="p">)</span>
</span><span id="__span-149-264"><a id="__codelineno-149-264" name="__codelineno-149-264" href="#__codelineno-149-264"></a>            <span class="n">enemies</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">enemy</span><span class="p">)</span>
</span><span id="__span-149-265"><a id="__codelineno-149-265" name="__codelineno-149-265" href="#__codelineno-149-265"></a>        <span class="n">enemy_spawn_time</span> <span class="o">=</span> <span class="n">current_time</span>  <span class="c1"># 重置计时器</span>
</span><span id="__span-149-266"><a id="__codelineno-149-266" name="__codelineno-149-266" href="#__codelineno-149-266"></a>
</span><span id="__span-149-267"><a id="__codelineno-149-267" name="__codelineno-149-267" href="#__codelineno-149-267"></a>    <span class="c1"># 清屏 + 绘制</span>
</span><span id="__span-149-268"><a id="__codelineno-149-268" name="__codelineno-149-268" href="#__codelineno-149-268"></a>    <span class="n">screen</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">WHITE</span><span class="p">)</span>
</span><span id="__span-149-269"><a id="__codelineno-149-269" name="__codelineno-149-269" href="#__codelineno-149-269"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">screen</span><span class="p">)</span>
</span><span id="__span-149-270"><a id="__codelineno-149-270" name="__codelineno-149-270" href="#__codelineno-149-270"></a>    <span class="c1"># 绘制得分</span>
</span><span id="__span-149-271"><a id="__codelineno-149-271" name="__codelineno-149-271" href="#__codelineno-149-271"></a>    <span class="n">score_text</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score: </span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">BLACK</span><span class="p">)</span>
</span><span id="__span-149-272"><a id="__codelineno-149-272" name="__codelineno-149-272" href="#__codelineno-149-272"></a>    <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">score_text</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="__span-149-273"><a id="__codelineno-149-273" name="__codelineno-149-273" href="#__codelineno-149-273"></a>
</span><span id="__span-149-274"><a id="__codelineno-149-274" name="__codelineno-149-274" href="#__codelineno-149-274"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
</span><span id="__span-149-275"><a id="__codelineno-149-275" name="__codelineno-149-275" href="#__codelineno-149-275"></a>
</span><span id="__span-149-276"><a id="__codelineno-149-276" name="__codelineno-149-276" href="#__codelineno-149-276"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</span></code></pre></div>
<h6 id="flappy-bird">Flappy Bird</h6>
<div class="language-python highlight"><pre><span></span><code><span id="__span-150-1"><a id="__codelineno-150-1" name="__codelineno-150-1" href="#__codelineno-150-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pygame</span>
</span><span id="__span-150-2"><a id="__codelineno-150-2" name="__codelineno-150-2" href="#__codelineno-150-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</span><span id="__span-150-3"><a id="__codelineno-150-3" name="__codelineno-150-3" href="#__codelineno-150-3"></a>
</span><span id="__span-150-4"><a id="__codelineno-150-4" name="__codelineno-150-4" href="#__codelineno-150-4"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span><span id="__span-150-5"><a id="__codelineno-150-5" name="__codelineno-150-5" href="#__codelineno-150-5"></a><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">=</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">512</span>
</span><span id="__span-150-6"><a id="__codelineno-150-6" name="__codelineno-150-6" href="#__codelineno-150-6"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">60</span>
</span><span id="__span-150-7"><a id="__codelineno-150-7" name="__codelineno-150-7" href="#__codelineno-150-7"></a><span class="c1"># screen_info = pygame.display.Info()</span>
</span><span id="__span-150-8"><a id="__codelineno-150-8" name="__codelineno-150-8" href="#__codelineno-150-8"></a><span class="c1"># SCREEN_WIDTH = screen_info.current_w</span>
</span><span id="__span-150-9"><a id="__codelineno-150-9" name="__codelineno-150-9" href="#__codelineno-150-9"></a><span class="c1"># SCREEN_HEIGHT = screen_info.current_h</span>
</span><span id="__span-150-10"><a id="__codelineno-150-10" name="__codelineno-150-10" href="#__codelineno-150-10"></a>
</span><span id="__span-150-11"><a id="__codelineno-150-11" name="__codelineno-150-11" href="#__codelineno-150-11"></a><span class="c1"># 颜色定义</span>
</span><span id="__span-150-12"><a id="__codelineno-150-12" name="__codelineno-150-12" href="#__codelineno-150-12"></a><span class="n">WHITE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="__span-150-13"><a id="__codelineno-150-13" name="__codelineno-150-13" href="#__codelineno-150-13"></a><span class="n">BLACK</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-150-14"><a id="__codelineno-150-14" name="__codelineno-150-14" href="#__codelineno-150-14"></a><span class="n">YELLOW</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-150-15"><a id="__codelineno-150-15" name="__codelineno-150-15" href="#__codelineno-150-15"></a><span class="n">GREEN</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-150-16"><a id="__codelineno-150-16" name="__codelineno-150-16" href="#__codelineno-150-16"></a><span class="n">BLUE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="__span-150-17"><a id="__codelineno-150-17" name="__codelineno-150-17" href="#__codelineno-150-17"></a><span class="n">EARTH_TONE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">199</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
</span><span id="__span-150-18"><a id="__codelineno-150-18" name="__codelineno-150-18" href="#__codelineno-150-18"></a>
</span><span id="__span-150-19"><a id="__codelineno-150-19" name="__codelineno-150-19" href="#__codelineno-150-19"></a><span class="n">screen</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span><span class="p">))</span>
</span><span id="__span-150-20"><a id="__codelineno-150-20" name="__codelineno-150-20" href="#__codelineno-150-20"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;Flappy Bird&quot;</span><span class="p">)</span>
</span><span id="__span-150-21"><a id="__codelineno-150-21" name="__codelineno-150-21" href="#__codelineno-150-21"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
</span><span id="__span-150-22"><a id="__codelineno-150-22" name="__codelineno-150-22" href="#__codelineno-150-22"></a>
</span><span id="__span-150-23"><a id="__codelineno-150-23" name="__codelineno-150-23" href="#__codelineno-150-23"></a><span class="c1"># 加载字体</span>
</span><span id="__span-150-24"><a id="__codelineno-150-24" name="__codelineno-150-24" href="#__codelineno-150-24"></a><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">36</span><span class="p">)</span>
</span><span id="__span-150-25"><a id="__codelineno-150-25" name="__codelineno-150-25" href="#__codelineno-150-25"></a>
</span><span id="__span-150-26"><a id="__codelineno-150-26" name="__codelineno-150-26" href="#__codelineno-150-26"></a><span class="c1"># 加载图片（使用纯色方块代替图片）</span>
</span><span id="__span-150-27"><a id="__codelineno-150-27" name="__codelineno-150-27" href="#__codelineno-150-27"></a><span class="n">bird_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="mi">34</span><span class="p">,</span> <span class="mi">24</span><span class="p">))</span>
</span><span id="__span-150-28"><a id="__codelineno-150-28" name="__codelineno-150-28" href="#__codelineno-150-28"></a><span class="n">bird_img</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">YELLOW</span><span class="p">)</span>
</span><span id="__span-150-29"><a id="__codelineno-150-29" name="__codelineno-150-29" href="#__codelineno-150-29"></a><span class="n">pipe_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="mi">52</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
</span><span id="__span-150-30"><a id="__codelineno-150-30" name="__codelineno-150-30" href="#__codelineno-150-30"></a><span class="n">pipe_img</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">GREEN</span><span class="p">)</span>
</span><span id="__span-150-31"><a id="__codelineno-150-31" name="__codelineno-150-31" href="#__codelineno-150-31"></a><span class="n">background_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span><span class="p">))</span>
</span><span id="__span-150-32"><a id="__codelineno-150-32" name="__codelineno-150-32" href="#__codelineno-150-32"></a><span class="n">background_img</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">BLUE</span><span class="p">)</span>
</span><span id="__span-150-33"><a id="__codelineno-150-33" name="__codelineno-150-33" href="#__codelineno-150-33"></a><span class="n">ground_h</span> <span class="o">=</span> <span class="mi">50</span>
</span><span id="__span-150-34"><a id="__codelineno-150-34" name="__codelineno-150-34" href="#__codelineno-150-34"></a><span class="n">ground_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">ground_h</span><span class="p">))</span>
</span><span id="__span-150-35"><a id="__codelineno-150-35" name="__codelineno-150-35" href="#__codelineno-150-35"></a><span class="n">ground_img</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">EARTH_TONE</span><span class="p">)</span>
</span><span id="__span-150-36"><a id="__codelineno-150-36" name="__codelineno-150-36" href="#__codelineno-150-36"></a>
</span><span id="__span-150-37"><a id="__codelineno-150-37" name="__codelineno-150-37" href="#__codelineno-150-37"></a><span class="k">class</span><span class="w"> </span><span class="nc">Bird</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
</span><span id="__span-150-38"><a id="__codelineno-150-38" name="__codelineno-150-38" href="#__codelineno-150-38"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-150-39"><a id="__codelineno-150-39" name="__codelineno-150-39" href="#__codelineno-150-39"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="__span-150-40"><a id="__codelineno-150-40" name="__codelineno-150-40" href="#__codelineno-150-40"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">bird_img</span>
</span><span id="__span-150-41"><a id="__codelineno-150-41" name="__codelineno-150-41" href="#__codelineno-150-41"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
</span><span id="__span-150-42"><a id="__codelineno-150-42" name="__codelineno-150-42" href="#__codelineno-150-42"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="n">SCREEN_WIDTH</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># 小鸟初始位置在屏幕中间</span>
</span><span id="__span-150-43"><a id="__codelineno-150-43" name="__codelineno-150-43" href="#__codelineno-150-43"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speed_y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-150-44"><a id="__codelineno-150-44" name="__codelineno-150-44" href="#__codelineno-150-44"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gravity</span> <span class="o">=</span> <span class="mf">0.5</span>
</span><span id="__span-150-45"><a id="__codelineno-150-45" name="__codelineno-150-45" href="#__codelineno-150-45"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">flap_power</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span>  <span class="c1"># 小鸟上升的力量</span>
</span><span id="__span-150-46"><a id="__codelineno-150-46" name="__codelineno-150-46" href="#__codelineno-150-46"></a>
</span><span id="__span-150-47"><a id="__codelineno-150-47" name="__codelineno-150-47" href="#__codelineno-150-47"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-150-48"><a id="__codelineno-150-48" name="__codelineno-150-48" href="#__codelineno-150-48"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speed_y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gravity</span>
</span><span id="__span-150-49"><a id="__codelineno-150-49" name="__codelineno-150-49" href="#__codelineno-150-49"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed_y</span>
</span><span id="__span-150-50"><a id="__codelineno-150-50" name="__codelineno-150-50" href="#__codelineno-150-50"></a>
</span><span id="__span-150-51"><a id="__codelineno-150-51" name="__codelineno-150-51" href="#__codelineno-150-51"></a>        <span class="c1"># 限制小鸟移动范围</span>
</span><span id="__span-150-52"><a id="__codelineno-150-52" name="__codelineno-150-52" href="#__codelineno-150-52"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-150-53"><a id="__codelineno-150-53" name="__codelineno-150-53" href="#__codelineno-150-53"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-150-54"><a id="__codelineno-150-54" name="__codelineno-150-54" href="#__codelineno-150-54"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&gt;</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">-</span> <span class="n">ground_h</span><span class="p">:</span>  <span class="c1"># 地面高度</span>
</span><span id="__span-150-55"><a id="__codelineno-150-55" name="__codelineno-150-55" href="#__codelineno-150-55"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">-</span> <span class="n">ground_h</span>
</span><span id="__span-150-56"><a id="__codelineno-150-56" name="__codelineno-150-56" href="#__codelineno-150-56"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speed_y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-150-57"><a id="__codelineno-150-57" name="__codelineno-150-57" href="#__codelineno-150-57"></a>
</span><span id="__span-150-58"><a id="__codelineno-150-58" name="__codelineno-150-58" href="#__codelineno-150-58"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">flap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-150-59"><a id="__codelineno-150-59" name="__codelineno-150-59" href="#__codelineno-150-59"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speed_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flap_power</span>  <span class="c1"># 向上飞</span>
</span><span id="__span-150-60"><a id="__codelineno-150-60" name="__codelineno-150-60" href="#__codelineno-150-60"></a>
</span><span id="__span-150-61"><a id="__codelineno-150-61" name="__codelineno-150-61" href="#__codelineno-150-61"></a><span class="k">class</span><span class="w"> </span><span class="nc">Pipe</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
</span><span id="__span-150-62"><a id="__codelineno-150-62" name="__codelineno-150-62" href="#__codelineno-150-62"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-150-63"><a id="__codelineno-150-63" name="__codelineno-150-63" href="#__codelineno-150-63"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="__span-150-64"><a id="__codelineno-150-64" name="__codelineno-150-64" href="#__codelineno-150-64"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pipe_img</span>
</span><span id="__span-150-65"><a id="__codelineno-150-65" name="__codelineno-150-65" href="#__codelineno-150-65"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
</span><span id="__span-150-66"><a id="__codelineno-150-66" name="__codelineno-150-66" href="#__codelineno-150-66"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">SCREEN_WIDTH</span>
</span><span id="__span-150-67"><a id="__codelineno-150-67" name="__codelineno-150-67" href="#__codelineno-150-67"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">passed</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># 标记小鸟是否已通过该管道</span>
</span><span id="__span-150-68"><a id="__codelineno-150-68" name="__codelineno-150-68" href="#__codelineno-150-68"></a>
</span><span id="__span-150-69"><a id="__codelineno-150-69" name="__codelineno-150-69" href="#__codelineno-150-69"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-150-70"><a id="__codelineno-150-70" name="__codelineno-150-70" href="#__codelineno-150-70"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">-=</span> <span class="mi">3</span>  <span class="c1"># 管道向左移动</span>
</span><span id="__span-150-71"><a id="__codelineno-150-71" name="__codelineno-150-71" href="#__codelineno-150-71"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 管道移出屏幕后移除</span>
</span><span id="__span-150-72"><a id="__codelineno-150-72" name="__codelineno-150-72" href="#__codelineno-150-72"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
</span><span id="__span-150-73"><a id="__codelineno-150-73" name="__codelineno-150-73" href="#__codelineno-150-73"></a>
</span><span id="__span-150-74"><a id="__codelineno-150-74" name="__codelineno-150-74" href="#__codelineno-150-74"></a><span class="c1"># 创建精灵组</span>
</span><span id="__span-150-75"><a id="__codelineno-150-75" name="__codelineno-150-75" href="#__codelineno-150-75"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
</span><span id="__span-150-76"><a id="__codelineno-150-76" name="__codelineno-150-76" href="#__codelineno-150-76"></a><span class="n">pipes</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
</span><span id="__span-150-77"><a id="__codelineno-150-77" name="__codelineno-150-77" href="#__codelineno-150-77"></a>
</span><span id="__span-150-78"><a id="__codelineno-150-78" name="__codelineno-150-78" href="#__codelineno-150-78"></a><span class="c1"># 创建小鸟</span>
</span><span id="__span-150-79"><a id="__codelineno-150-79" name="__codelineno-150-79" href="#__codelineno-150-79"></a><span class="n">bird</span> <span class="o">=</span> <span class="n">Bird</span><span class="p">()</span>
</span><span id="__span-150-80"><a id="__codelineno-150-80" name="__codelineno-150-80" href="#__codelineno-150-80"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">bird</span><span class="p">)</span>
</span><span id="__span-150-81"><a id="__codelineno-150-81" name="__codelineno-150-81" href="#__codelineno-150-81"></a>
</span><span id="__span-150-82"><a id="__codelineno-150-82" name="__codelineno-150-82" href="#__codelineno-150-82"></a><span class="c1"># 游戏变量</span>
</span><span id="__span-150-83"><a id="__codelineno-150-83" name="__codelineno-150-83" href="#__codelineno-150-83"></a><span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-150-84"><a id="__codelineno-150-84" name="__codelineno-150-84" href="#__codelineno-150-84"></a><span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-150-85"><a id="__codelineno-150-85" name="__codelineno-150-85" href="#__codelineno-150-85"></a><span class="n">game_over</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-150-86"><a id="__codelineno-150-86" name="__codelineno-150-86" href="#__codelineno-150-86"></a>
</span><span id="__span-150-87"><a id="__codelineno-150-87" name="__codelineno-150-87" href="#__codelineno-150-87"></a><span class="c1"># 管道生成计时器</span>
</span><span id="__span-150-88"><a id="__codelineno-150-88" name="__codelineno-150-88" href="#__codelineno-150-88"></a><span class="n">pipe_spawn_time</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-150-89"><a id="__codelineno-150-89" name="__codelineno-150-89" href="#__codelineno-150-89"></a><span class="n">pipe_spawn_interval</span> <span class="o">=</span> <span class="mi">5000</span>  <span class="c1"># 每 5 秒生成一对管道（单位：毫秒）</span>
</span><span id="__span-150-90"><a id="__codelineno-150-90" name="__codelineno-150-90" href="#__codelineno-150-90"></a>
</span><span id="__span-150-91"><a id="__codelineno-150-91" name="__codelineno-150-91" href="#__codelineno-150-91"></a><span class="k">while</span> <span class="n">running</span><span class="p">:</span>
</span><span id="__span-150-92"><a id="__codelineno-150-92" name="__codelineno-150-92" href="#__codelineno-150-92"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
</span><span id="__span-150-93"><a id="__codelineno-150-93" name="__codelineno-150-93" href="#__codelineno-150-93"></a>
</span><span id="__span-150-94"><a id="__codelineno-150-94" name="__codelineno-150-94" href="#__codelineno-150-94"></a>    <span class="c1"># 处理事件</span>
</span><span id="__span-150-95"><a id="__codelineno-150-95" name="__codelineno-150-95" href="#__codelineno-150-95"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="__span-150-96"><a id="__codelineno-150-96" name="__codelineno-150-96" href="#__codelineno-150-96"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
</span><span id="__span-150-97"><a id="__codelineno-150-97" name="__codelineno-150-97" href="#__codelineno-150-97"></a>            <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-150-98"><a id="__codelineno-150-98" name="__codelineno-150-98" href="#__codelineno-150-98"></a>        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
</span><span id="__span-150-99"><a id="__codelineno-150-99" name="__codelineno-150-99" href="#__codelineno-150-99"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_SPACE</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">game_over</span><span class="p">:</span>  <span class="c1"># 按下空格键</span>
</span><span id="__span-150-100"><a id="__codelineno-150-100" name="__codelineno-150-100" href="#__codelineno-150-100"></a>                <span class="n">bird</span><span class="o">.</span><span class="n">flap</span><span class="p">()</span>
</span><span id="__span-150-101"><a id="__codelineno-150-101" name="__codelineno-150-101" href="#__codelineno-150-101"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_r</span> <span class="ow">and</span> <span class="n">game_over</span><span class="p">:</span>  <span class="c1"># 按下 R 键重新开始</span>
</span><span id="__span-150-102"><a id="__codelineno-150-102" name="__codelineno-150-102" href="#__codelineno-150-102"></a>                <span class="c1"># 重置游戏</span>
</span><span id="__span-150-103"><a id="__codelineno-150-103" name="__codelineno-150-103" href="#__codelineno-150-103"></a>                <span class="n">all_sprites</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span>
</span><span id="__span-150-104"><a id="__codelineno-150-104" name="__codelineno-150-104" href="#__codelineno-150-104"></a>                <span class="n">pipes</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span>
</span><span id="__span-150-105"><a id="__codelineno-150-105" name="__codelineno-150-105" href="#__codelineno-150-105"></a>                <span class="n">bird</span> <span class="o">=</span> <span class="n">Bird</span><span class="p">()</span>
</span><span id="__span-150-106"><a id="__codelineno-150-106" name="__codelineno-150-106" href="#__codelineno-150-106"></a>                <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">bird</span><span class="p">)</span>
</span><span id="__span-150-107"><a id="__codelineno-150-107" name="__codelineno-150-107" href="#__codelineno-150-107"></a>                <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-150-108"><a id="__codelineno-150-108" name="__codelineno-150-108" href="#__codelineno-150-108"></a>                <span class="n">game_over</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-150-109"><a id="__codelineno-150-109" name="__codelineno-150-109" href="#__codelineno-150-109"></a>
</span><span id="__span-150-110"><a id="__codelineno-150-110" name="__codelineno-150-110" href="#__codelineno-150-110"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">game_over</span><span class="p">:</span>
</span><span id="__span-150-111"><a id="__codelineno-150-111" name="__codelineno-150-111" href="#__codelineno-150-111"></a>        <span class="c1"># 更新精灵逻辑</span>
</span><span id="__span-150-112"><a id="__codelineno-150-112" name="__codelineno-150-112" href="#__codelineno-150-112"></a>        <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="__span-150-113"><a id="__codelineno-150-113" name="__codelineno-150-113" href="#__codelineno-150-113"></a>
</span><span id="__span-150-114"><a id="__codelineno-150-114" name="__codelineno-150-114" href="#__codelineno-150-114"></a>        <span class="c1"># 生成管道</span>
</span><span id="__span-150-115"><a id="__codelineno-150-115" name="__codelineno-150-115" href="#__codelineno-150-115"></a>        <span class="n">current_time</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
</span><span id="__span-150-116"><a id="__codelineno-150-116" name="__codelineno-150-116" href="#__codelineno-150-116"></a>        <span class="k">if</span> <span class="n">current_time</span> <span class="o">-</span> <span class="n">pipe_spawn_time</span> <span class="o">&gt;</span> <span class="n">pipe_spawn_interval</span><span class="p">:</span>
</span><span id="__span-150-117"><a id="__codelineno-150-117" name="__codelineno-150-117" href="#__codelineno-150-117"></a>            <span class="n">gap_y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">SCREEN_HEIGHT</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">//</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># 随机生成空隙位置</span>
</span><span id="__span-150-118"><a id="__codelineno-150-118" name="__codelineno-150-118" href="#__codelineno-150-118"></a>            <span class="n">pipe_top</span> <span class="o">=</span> <span class="n">Pipe</span><span class="p">()</span>  <span class="c1"># 上管道</span>
</span><span id="__span-150-119"><a id="__codelineno-150-119" name="__codelineno-150-119" href="#__codelineno-150-119"></a>            <span class="n">pipe_bottom</span> <span class="o">=</span> <span class="n">Pipe</span><span class="p">()</span>  <span class="c1"># 下管道</span>
</span><span id="__span-150-120"><a id="__codelineno-150-120" name="__codelineno-150-120" href="#__codelineno-150-120"></a>            <span class="n">gap</span> <span class="o">=</span> <span class="mi">60</span>
</span><span id="__span-150-121"><a id="__codelineno-150-121" name="__codelineno-150-121" href="#__codelineno-150-121"></a>            <span class="n">pipe_top</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">gap_y</span> <span class="o">-</span> <span class="n">gap</span>  <span class="c1"># 上管道底部位置</span>
</span><span id="__span-150-122"><a id="__codelineno-150-122" name="__codelineno-150-122" href="#__codelineno-150-122"></a>            <span class="n">pipe_bottom</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">gap_y</span> <span class="o">+</span> <span class="n">gap</span>  <span class="c1"># 下管道顶部位置</span>
</span><span id="__span-150-123"><a id="__codelineno-150-123" name="__codelineno-150-123" href="#__codelineno-150-123"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pipe_top</span><span class="p">)</span>
</span><span id="__span-150-124"><a id="__codelineno-150-124" name="__codelineno-150-124" href="#__codelineno-150-124"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pipe_bottom</span><span class="p">)</span>
</span><span id="__span-150-125"><a id="__codelineno-150-125" name="__codelineno-150-125" href="#__codelineno-150-125"></a>            <span class="n">pipes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pipe_top</span><span class="p">)</span>
</span><span id="__span-150-126"><a id="__codelineno-150-126" name="__codelineno-150-126" href="#__codelineno-150-126"></a>            <span class="n">pipes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pipe_bottom</span><span class="p">)</span>
</span><span id="__span-150-127"><a id="__codelineno-150-127" name="__codelineno-150-127" href="#__codelineno-150-127"></a>            <span class="n">pipe_spawn_time</span> <span class="o">=</span> <span class="n">current_time</span>
</span><span id="__span-150-128"><a id="__codelineno-150-128" name="__codelineno-150-128" href="#__codelineno-150-128"></a>
</span><span id="__span-150-129"><a id="__codelineno-150-129" name="__codelineno-150-129" href="#__codelineno-150-129"></a>        <span class="c1"># 检测小鸟与管道的碰撞</span>
</span><span id="__span-150-130"><a id="__codelineno-150-130" name="__codelineno-150-130" href="#__codelineno-150-130"></a>        <span class="k">if</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="n">bird</span><span class="p">,</span> <span class="n">pipes</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="__span-150-131"><a id="__codelineno-150-131" name="__codelineno-150-131" href="#__codelineno-150-131"></a>            <span class="n">game_over</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-150-132"><a id="__codelineno-150-132" name="__codelineno-150-132" href="#__codelineno-150-132"></a>
</span><span id="__span-150-133"><a id="__codelineno-150-133" name="__codelineno-150-133" href="#__codelineno-150-133"></a>        <span class="c1"># 检测小鸟掉出屏幕</span>
</span><span id="__span-150-134"><a id="__codelineno-150-134" name="__codelineno-150-134" href="#__codelineno-150-134"></a>        <span class="k">if</span> <span class="n">bird</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&gt;=</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">-</span> <span class="n">ground_h</span><span class="p">:</span>  <span class="c1"># 地面高度</span>
</span><span id="__span-150-135"><a id="__codelineno-150-135" name="__codelineno-150-135" href="#__codelineno-150-135"></a>            <span class="n">game_over</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-150-136"><a id="__codelineno-150-136" name="__codelineno-150-136" href="#__codelineno-150-136"></a>
</span><span id="__span-150-137"><a id="__codelineno-150-137" name="__codelineno-150-137" href="#__codelineno-150-137"></a>        <span class="c1"># 检测得分（小鸟通过管道）</span>
</span><span id="__span-150-138"><a id="__codelineno-150-138" name="__codelineno-150-138" href="#__codelineno-150-138"></a>        <span class="k">for</span> <span class="n">pipe</span> <span class="ow">in</span> <span class="n">pipes</span><span class="p">:</span>
</span><span id="__span-150-139"><a id="__codelineno-150-139" name="__codelineno-150-139" href="#__codelineno-150-139"></a>            <span class="k">if</span> <span class="n">pipe</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="n">bird</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pipe</span><span class="o">.</span><span class="n">passed</span><span class="p">:</span>
</span><span id="__span-150-140"><a id="__codelineno-150-140" name="__codelineno-150-140" href="#__codelineno-150-140"></a>                <span class="n">pipe</span><span class="o">.</span><span class="n">passed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-150-141"><a id="__codelineno-150-141" name="__codelineno-150-141" href="#__codelineno-150-141"></a>                <span class="n">score</span> <span class="o">+=</span> <span class="mf">0.5</span>  <span class="c1"># 每对管道得 1 分</span>
</span><span id="__span-150-142"><a id="__codelineno-150-142" name="__codelineno-150-142" href="#__codelineno-150-142"></a>
</span><span id="__span-150-143"><a id="__codelineno-150-143" name="__codelineno-150-143" href="#__codelineno-150-143"></a>    <span class="c1"># 清屏 + 绘制</span>
</span><span id="__span-150-144"><a id="__codelineno-150-144" name="__codelineno-150-144" href="#__codelineno-150-144"></a>    <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">background_img</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># 绘制背景</span>
</span><span id="__span-150-145"><a id="__codelineno-150-145" name="__codelineno-150-145" href="#__codelineno-150-145"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">screen</span><span class="p">)</span>
</span><span id="__span-150-146"><a id="__codelineno-150-146" name="__codelineno-150-146" href="#__codelineno-150-146"></a>    <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">ground_img</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">-</span> <span class="n">ground_h</span><span class="p">))</span>  <span class="c1"># 绘制地面</span>
</span><span id="__span-150-147"><a id="__codelineno-150-147" name="__codelineno-150-147" href="#__codelineno-150-147"></a>
</span><span id="__span-150-148"><a id="__codelineno-150-148" name="__codelineno-150-148" href="#__codelineno-150-148"></a>    <span class="c1"># 绘制得分</span>
</span><span id="__span-150-149"><a id="__codelineno-150-149" name="__codelineno-150-149" href="#__codelineno-150-149"></a>    <span class="n">score_text</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">WHITE</span><span class="p">)</span>
</span><span id="__span-150-150"><a id="__codelineno-150-150" name="__codelineno-150-150" href="#__codelineno-150-150"></a>    <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">score_text</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="__span-150-151"><a id="__codelineno-150-151" name="__codelineno-150-151" href="#__codelineno-150-151"></a>
</span><span id="__span-150-152"><a id="__codelineno-150-152" name="__codelineno-150-152" href="#__codelineno-150-152"></a>    <span class="c1"># 游戏结束画面</span>
</span><span id="__span-150-153"><a id="__codelineno-150-153" name="__codelineno-150-153" href="#__codelineno-150-153"></a>    <span class="k">if</span> <span class="n">game_over</span><span class="p">:</span>
</span><span id="__span-150-154"><a id="__codelineno-150-154" name="__codelineno-150-154" href="#__codelineno-150-154"></a>        <span class="n">game_over_text</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;Game Over&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">WHITE</span><span class="p">)</span>
</span><span id="__span-150-155"><a id="__codelineno-150-155" name="__codelineno-150-155" href="#__codelineno-150-155"></a>        <span class="n">restart_text</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;Press R to Restart&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">WHITE</span><span class="p">)</span>
</span><span id="__span-150-156"><a id="__codelineno-150-156" name="__codelineno-150-156" href="#__codelineno-150-156"></a>        <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">game_over_text</span><span class="p">,</span> <span class="p">(</span><span class="n">SCREEN_WIDTH</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">80</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">50</span><span class="p">))</span>
</span><span id="__span-150-157"><a id="__codelineno-150-157" name="__codelineno-150-157" href="#__codelineno-150-157"></a>        <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">restart_text</span><span class="p">,</span> <span class="p">(</span><span class="n">SCREEN_WIDTH</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">100</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">//</span> <span class="mi">2</span><span class="p">))</span>
</span><span id="__span-150-158"><a id="__codelineno-150-158" name="__codelineno-150-158" href="#__codelineno-150-158"></a>
</span><span id="__span-150-159"><a id="__codelineno-150-159" name="__codelineno-150-159" href="#__codelineno-150-159"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
</span><span id="__span-150-160"><a id="__codelineno-150-160" name="__codelineno-150-160" href="#__codelineno-150-160"></a>
</span><span id="__span-150-161"><a id="__codelineno-150-161" name="__codelineno-150-161" href="#__codelineno-150-161"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</span></code></pre></div>
<h6 id="_62">双人乒乓</h6>
<div class="language-python highlight"><pre><span></span><code><span id="__span-151-1"><a id="__codelineno-151-1" name="__codelineno-151-1" href="#__codelineno-151-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pygame</span>
</span><span id="__span-151-2"><a id="__codelineno-151-2" name="__codelineno-151-2" href="#__codelineno-151-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</span><span id="__span-151-3"><a id="__codelineno-151-3" name="__codelineno-151-3" href="#__codelineno-151-3"></a>
</span><span id="__span-151-4"><a id="__codelineno-151-4" name="__codelineno-151-4" href="#__codelineno-151-4"></a><span class="c1"># 初始化pygame</span>
</span><span id="__span-151-5"><a id="__codelineno-151-5" name="__codelineno-151-5" href="#__codelineno-151-5"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span><span id="__span-151-6"><a id="__codelineno-151-6" name="__codelineno-151-6" href="#__codelineno-151-6"></a>
</span><span id="__span-151-7"><a id="__codelineno-151-7" name="__codelineno-151-7" href="#__codelineno-151-7"></a><span class="c1"># 设置窗口大小</span>
</span><span id="__span-151-8"><a id="__codelineno-151-8" name="__codelineno-151-8" href="#__codelineno-151-8"></a><span class="n">SCREEN_WIDTH</span> <span class="o">=</span> <span class="mi">800</span>
</span><span id="__span-151-9"><a id="__codelineno-151-9" name="__codelineno-151-9" href="#__codelineno-151-9"></a><span class="n">SCREEN_HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
</span><span id="__span-151-10"><a id="__codelineno-151-10" name="__codelineno-151-10" href="#__codelineno-151-10"></a><span class="n">screen</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span><span class="p">))</span>
</span><span id="__span-151-11"><a id="__codelineno-151-11" name="__codelineno-151-11" href="#__codelineno-151-11"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;Ping Pong - 2 Player&quot;</span><span class="p">)</span>
</span><span id="__span-151-12"><a id="__codelineno-151-12" name="__codelineno-151-12" href="#__codelineno-151-12"></a>
</span><span id="__span-151-13"><a id="__codelineno-151-13" name="__codelineno-151-13" href="#__codelineno-151-13"></a><span class="c1"># 定义颜色</span>
</span><span id="__span-151-14"><a id="__codelineno-151-14" name="__codelineno-151-14" href="#__codelineno-151-14"></a><span class="n">WHITE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="__span-151-15"><a id="__codelineno-151-15" name="__codelineno-151-15" href="#__codelineno-151-15"></a><span class="n">BLACK</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-151-16"><a id="__codelineno-151-16" name="__codelineno-151-16" href="#__codelineno-151-16"></a><span class="n">RED</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-151-17"><a id="__codelineno-151-17" name="__codelineno-151-17" href="#__codelineno-151-17"></a>
</span><span id="__span-151-18"><a id="__codelineno-151-18" name="__codelineno-151-18" href="#__codelineno-151-18"></a><span class="c1"># 加载字体</span>
</span><span id="__span-151-19"><a id="__codelineno-151-19" name="__codelineno-151-19" href="#__codelineno-151-19"></a><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">36</span><span class="p">)</span>
</span><span id="__span-151-20"><a id="__codelineno-151-20" name="__codelineno-151-20" href="#__codelineno-151-20"></a>
</span><span id="__span-151-21"><a id="__codelineno-151-21" name="__codelineno-151-21" href="#__codelineno-151-21"></a><span class="k">class</span><span class="w"> </span><span class="nc">Ball</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
</span><span id="__span-151-22"><a id="__codelineno-151-22" name="__codelineno-151-22" href="#__codelineno-151-22"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-151-23"><a id="__codelineno-151-23" name="__codelineno-151-23" href="#__codelineno-151-23"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="__span-151-24"><a id="__codelineno-151-24" name="__codelineno-151-24" href="#__codelineno-151-24"></a>        <span class="c1"># 定义小球属性</span>
</span><span id="__span-151-25"><a id="__codelineno-151-25" name="__codelineno-151-25" href="#__codelineno-151-25"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ball_radius</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="__span-151-26"><a id="__codelineno-151-26" name="__codelineno-151-26" href="#__codelineno-151-26"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ball_radius</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ball_radius</span> <span class="o">*</span> <span class="mi">2</span><span class="p">),</span> <span class="n">pygame</span><span class="o">.</span><span class="n">SRCALPHA</span><span class="p">)</span>
</span><span id="__span-151-27"><a id="__codelineno-151-27" name="__codelineno-151-27" href="#__codelineno-151-27"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">RED</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ball_radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ball_radius</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ball_radius</span><span class="p">)</span>
</span><span id="__span-151-28"><a id="__codelineno-151-28" name="__codelineno-151-28" href="#__codelineno-151-28"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
</span><span id="__span-151-29"><a id="__codelineno-151-29" name="__codelineno-151-29" href="#__codelineno-151-29"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># 初始化小球位置和速度</span>
</span><span id="__span-151-30"><a id="__codelineno-151-30" name="__codelineno-151-30" href="#__codelineno-151-30"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ball_dx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># 随机水平速度</span>
</span><span id="__span-151-31"><a id="__codelineno-151-31" name="__codelineno-151-31" href="#__codelineno-151-31"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ball_dy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># 随机垂直速度</span>
</span><span id="__span-151-32"><a id="__codelineno-151-32" name="__codelineno-151-32" href="#__codelineno-151-32"></a>
</span><span id="__span-151-33"><a id="__codelineno-151-33" name="__codelineno-151-33" href="#__codelineno-151-33"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-151-34"><a id="__codelineno-151-34" name="__codelineno-151-34" href="#__codelineno-151-34"></a>        <span class="c1"># 重置小球位置和速度</span>
</span><span id="__span-151-35"><a id="__codelineno-151-35" name="__codelineno-151-35" href="#__codelineno-151-35"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="n">SCREEN_WIDTH</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-151-36"><a id="__codelineno-151-36" name="__codelineno-151-36" href="#__codelineno-151-36"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ball_dx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="__span-151-37"><a id="__codelineno-151-37" name="__codelineno-151-37" href="#__codelineno-151-37"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ball_dy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="__span-151-38"><a id="__codelineno-151-38" name="__codelineno-151-38" href="#__codelineno-151-38"></a>
</span><span id="__span-151-39"><a id="__codelineno-151-39" name="__codelineno-151-39" href="#__codelineno-151-39"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-151-40"><a id="__codelineno-151-40" name="__codelineno-151-40" href="#__codelineno-151-40"></a>        <span class="c1"># 移动小球</span>
</span><span id="__span-151-41"><a id="__codelineno-151-41" name="__codelineno-151-41" href="#__codelineno-151-41"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ball_dx</span>
</span><span id="__span-151-42"><a id="__codelineno-151-42" name="__codelineno-151-42" href="#__codelineno-151-42"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ball_dy</span>
</span><span id="__span-151-43"><a id="__codelineno-151-43" name="__codelineno-151-43" href="#__codelineno-151-43"></a>
</span><span id="__span-151-44"><a id="__codelineno-151-44" name="__codelineno-151-44" href="#__codelineno-151-44"></a>        <span class="c1"># 小球碰撞检测（与屏幕上下边界）</span>
</span><span id="__span-151-45"><a id="__codelineno-151-45" name="__codelineno-151-45" href="#__codelineno-151-45"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&gt;=</span> <span class="n">SCREEN_HEIGHT</span><span class="p">:</span>
</span><span id="__span-151-46"><a id="__codelineno-151-46" name="__codelineno-151-46" href="#__codelineno-151-46"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ball_dy</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ball_dy</span>
</span><span id="__span-151-47"><a id="__codelineno-151-47" name="__codelineno-151-47" href="#__codelineno-151-47"></a>
</span><span id="__span-151-48"><a id="__codelineno-151-48" name="__codelineno-151-48" href="#__codelineno-151-48"></a><span class="k">class</span><span class="w"> </span><span class="nc">Paddle</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
</span><span id="__span-151-49"><a id="__codelineno-151-49" name="__codelineno-151-49" href="#__codelineno-151-49"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">up_key</span><span class="p">,</span> <span class="n">down_key</span><span class="p">):</span>
</span><span id="__span-151-50"><a id="__codelineno-151-50" name="__codelineno-151-50" href="#__codelineno-151-50"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="__span-151-51"><a id="__codelineno-151-51" name="__codelineno-151-51" href="#__codelineno-151-51"></a>        <span class="c1"># 定义挡板属性</span>
</span><span id="__span-151-52"><a id="__codelineno-151-52" name="__codelineno-151-52" href="#__codelineno-151-52"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">paddle_width</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="__span-151-53"><a id="__codelineno-151-53" name="__codelineno-151-53" href="#__codelineno-151-53"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">paddle_height</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="__span-151-54"><a id="__codelineno-151-54" name="__codelineno-151-54" href="#__codelineno-151-54"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">paddle_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">paddle_height</span><span class="p">))</span>
</span><span id="__span-151-55"><a id="__codelineno-151-55" name="__codelineno-151-55" href="#__codelineno-151-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">WHITE</span><span class="p">)</span>
</span><span id="__span-151-56"><a id="__codelineno-151-56" name="__codelineno-151-56" href="#__codelineno-151-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
</span><span id="__span-151-57"><a id="__codelineno-151-57" name="__codelineno-151-57" href="#__codelineno-151-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="__span-151-58"><a id="__codelineno-151-58" name="__codelineno-151-58" href="#__codelineno-151-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">paddle_speed</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-151-59"><a id="__codelineno-151-59" name="__codelineno-151-59" href="#__codelineno-151-59"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">up_key</span> <span class="o">=</span> <span class="n">up_key</span>
</span><span id="__span-151-60"><a id="__codelineno-151-60" name="__codelineno-151-60" href="#__codelineno-151-60"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">down_key</span> <span class="o">=</span> <span class="n">down_key</span>
</span><span id="__span-151-61"><a id="__codelineno-151-61" name="__codelineno-151-61" href="#__codelineno-151-61"></a>
</span><span id="__span-151-62"><a id="__codelineno-151-62" name="__codelineno-151-62" href="#__codelineno-151-62"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-151-63"><a id="__codelineno-151-63" name="__codelineno-151-63" href="#__codelineno-151-63"></a>        <span class="c1"># 处理挡板移动</span>
</span><span id="__span-151-64"><a id="__codelineno-151-64" name="__codelineno-151-64" href="#__codelineno-151-64"></a>        <span class="n">keys</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_pressed</span><span class="p">()</span>
</span><span id="__span-151-65"><a id="__codelineno-151-65" name="__codelineno-151-65" href="#__codelineno-151-65"></a>        <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">up_key</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-151-66"><a id="__codelineno-151-66" name="__codelineno-151-66" href="#__codelineno-151-66"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paddle_speed</span>
</span><span id="__span-151-67"><a id="__codelineno-151-67" name="__codelineno-151-67" href="#__codelineno-151-67"></a>        <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">down_key</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&lt;</span> <span class="n">SCREEN_HEIGHT</span><span class="p">:</span>
</span><span id="__span-151-68"><a id="__codelineno-151-68" name="__codelineno-151-68" href="#__codelineno-151-68"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paddle_speed</span>
</span><span id="__span-151-69"><a id="__codelineno-151-69" name="__codelineno-151-69" href="#__codelineno-151-69"></a>
</span><span id="__span-151-70"><a id="__codelineno-151-70" name="__codelineno-151-70" href="#__codelineno-151-70"></a><span class="k">def</span><span class="w"> </span><span class="nf">circle_rect_collision</span><span class="p">(</span><span class="n">circle</span><span class="p">,</span> <span class="n">rect</span><span class="p">):</span>
</span><span id="__span-151-71"><a id="__codelineno-151-71" name="__codelineno-151-71" href="#__codelineno-151-71"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-151-72"><a id="__codelineno-151-72" name="__codelineno-151-72" href="#__codelineno-151-72"></a><span class="sd">    检测圆形与矩形的碰撞</span>
</span><span id="__span-151-73"><a id="__codelineno-151-73" name="__codelineno-151-73" href="#__codelineno-151-73"></a><span class="sd">    :param circle: 圆形对象（需包含 rect 和 radius 属性）</span>
</span><span id="__span-151-74"><a id="__codelineno-151-74" name="__codelineno-151-74" href="#__codelineno-151-74"></a><span class="sd">    :param rect: 矩形对象（需包含 rect 属性）</span>
</span><span id="__span-151-75"><a id="__codelineno-151-75" name="__codelineno-151-75" href="#__codelineno-151-75"></a><span class="sd">    :return: 是否碰撞</span>
</span><span id="__span-151-76"><a id="__codelineno-151-76" name="__codelineno-151-76" href="#__codelineno-151-76"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-151-77"><a id="__codelineno-151-77" name="__codelineno-151-77" href="#__codelineno-151-77"></a>    <span class="c1"># 找到矩形上距离圆心最近的点</span>
</span><span id="__span-151-78"><a id="__codelineno-151-78" name="__codelineno-151-78" href="#__codelineno-151-78"></a>    <span class="n">closest_x</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">circle</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span><span class="p">,</span> <span class="n">rect</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span><span class="p">))</span>
</span><span id="__span-151-79"><a id="__codelineno-151-79" name="__codelineno-151-79" href="#__codelineno-151-79"></a>    <span class="n">closest_y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">circle</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centery</span><span class="p">,</span> <span class="n">rect</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span><span class="p">))</span>
</span><span id="__span-151-80"><a id="__codelineno-151-80" name="__codelineno-151-80" href="#__codelineno-151-80"></a>
</span><span id="__span-151-81"><a id="__codelineno-151-81" name="__codelineno-151-81" href="#__codelineno-151-81"></a>    <span class="c1"># 计算圆心与最近点的距离</span>
</span><span id="__span-151-82"><a id="__codelineno-151-82" name="__codelineno-151-82" href="#__codelineno-151-82"></a>    <span class="n">distance_x</span> <span class="o">=</span> <span class="n">circle</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">-</span> <span class="n">closest_x</span>
</span><span id="__span-151-83"><a id="__codelineno-151-83" name="__codelineno-151-83" href="#__codelineno-151-83"></a>    <span class="n">distance_y</span> <span class="o">=</span> <span class="n">circle</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centery</span> <span class="o">-</span> <span class="n">closest_y</span>
</span><span id="__span-151-84"><a id="__codelineno-151-84" name="__codelineno-151-84" href="#__codelineno-151-84"></a>    <span class="n">distance_squared</span> <span class="o">=</span> <span class="n">distance_x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">distance_y</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="__span-151-85"><a id="__codelineno-151-85" name="__codelineno-151-85" href="#__codelineno-151-85"></a>
</span><span id="__span-151-86"><a id="__codelineno-151-86" name="__codelineno-151-86" href="#__codelineno-151-86"></a>    <span class="c1"># 判断是否碰撞</span>
</span><span id="__span-151-87"><a id="__codelineno-151-87" name="__codelineno-151-87" href="#__codelineno-151-87"></a>    <span class="k">return</span> <span class="n">distance_squared</span> <span class="o">&lt;</span> <span class="n">circle</span><span class="o">.</span><span class="n">ball_radius</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="__span-151-88"><a id="__codelineno-151-88" name="__codelineno-151-88" href="#__codelineno-151-88"></a>
</span><span id="__span-151-89"><a id="__codelineno-151-89" name="__codelineno-151-89" href="#__codelineno-151-89"></a><span class="c1"># 创建精灵组</span>
</span><span id="__span-151-90"><a id="__codelineno-151-90" name="__codelineno-151-90" href="#__codelineno-151-90"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
</span><span id="__span-151-91"><a id="__codelineno-151-91" name="__codelineno-151-91" href="#__codelineno-151-91"></a><span class="n">paddles</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
</span><span id="__span-151-92"><a id="__codelineno-151-92" name="__codelineno-151-92" href="#__codelineno-151-92"></a>
</span><span id="__span-151-93"><a id="__codelineno-151-93" name="__codelineno-151-93" href="#__codelineno-151-93"></a><span class="c1"># 创建小球和挡板</span>
</span><span id="__span-151-94"><a id="__codelineno-151-94" name="__codelineno-151-94" href="#__codelineno-151-94"></a><span class="n">ball</span> <span class="o">=</span> <span class="n">Ball</span><span class="p">()</span>
</span><span id="__span-151-95"><a id="__codelineno-151-95" name="__codelineno-151-95" href="#__codelineno-151-95"></a><span class="n">paddle_left</span> <span class="o">=</span> <span class="n">Paddle</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_w</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_s</span><span class="p">)</span>  <span class="c1"># 左侧挡板，W/S 控制</span>
</span><span id="__span-151-96"><a id="__codelineno-151-96" name="__codelineno-151-96" href="#__codelineno-151-96"></a><span class="n">paddle_right</span> <span class="o">=</span> <span class="n">Paddle</span><span class="p">(</span><span class="n">SCREEN_WIDTH</span> <span class="o">-</span> <span class="mi">30</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_UP</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_DOWN</span><span class="p">)</span>  <span class="c1"># 右侧挡板，上下箭头控制</span>
</span><span id="__span-151-97"><a id="__codelineno-151-97" name="__codelineno-151-97" href="#__codelineno-151-97"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ball</span><span class="p">)</span>
</span><span id="__span-151-98"><a id="__codelineno-151-98" name="__codelineno-151-98" href="#__codelineno-151-98"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">paddle_left</span><span class="p">)</span>
</span><span id="__span-151-99"><a id="__codelineno-151-99" name="__codelineno-151-99" href="#__codelineno-151-99"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">paddle_right</span><span class="p">)</span>
</span><span id="__span-151-100"><a id="__codelineno-151-100" name="__codelineno-151-100" href="#__codelineno-151-100"></a><span class="n">paddles</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">paddle_left</span><span class="p">)</span>
</span><span id="__span-151-101"><a id="__codelineno-151-101" name="__codelineno-151-101" href="#__codelineno-151-101"></a><span class="n">paddles</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">paddle_right</span><span class="p">)</span>
</span><span id="__span-151-102"><a id="__codelineno-151-102" name="__codelineno-151-102" href="#__codelineno-151-102"></a>
</span><span id="__span-151-103"><a id="__codelineno-151-103" name="__codelineno-151-103" href="#__codelineno-151-103"></a><span class="c1"># 得分变量</span>
</span><span id="__span-151-104"><a id="__codelineno-151-104" name="__codelineno-151-104" href="#__codelineno-151-104"></a><span class="n">score_left</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-151-105"><a id="__codelineno-151-105" name="__codelineno-151-105" href="#__codelineno-151-105"></a><span class="n">score_right</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-151-106"><a id="__codelineno-151-106" name="__codelineno-151-106" href="#__codelineno-151-106"></a>
</span><span id="__span-151-107"><a id="__codelineno-151-107" name="__codelineno-151-107" href="#__codelineno-151-107"></a><span class="c1"># 游戏主循环</span>
</span><span id="__span-151-108"><a id="__codelineno-151-108" name="__codelineno-151-108" href="#__codelineno-151-108"></a><span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-151-109"><a id="__codelineno-151-109" name="__codelineno-151-109" href="#__codelineno-151-109"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
</span><span id="__span-151-110"><a id="__codelineno-151-110" name="__codelineno-151-110" href="#__codelineno-151-110"></a><span class="k">while</span> <span class="n">running</span><span class="p">:</span>
</span><span id="__span-151-111"><a id="__codelineno-151-111" name="__codelineno-151-111" href="#__codelineno-151-111"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</span><span id="__span-151-112"><a id="__codelineno-151-112" name="__codelineno-151-112" href="#__codelineno-151-112"></a>    <span class="n">screen</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">BLACK</span><span class="p">)</span>
</span><span id="__span-151-113"><a id="__codelineno-151-113" name="__codelineno-151-113" href="#__codelineno-151-113"></a>
</span><span id="__span-151-114"><a id="__codelineno-151-114" name="__codelineno-151-114" href="#__codelineno-151-114"></a>    <span class="c1"># 处理事件</span>
</span><span id="__span-151-115"><a id="__codelineno-151-115" name="__codelineno-151-115" href="#__codelineno-151-115"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="__span-151-116"><a id="__codelineno-151-116" name="__codelineno-151-116" href="#__codelineno-151-116"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
</span><span id="__span-151-117"><a id="__codelineno-151-117" name="__codelineno-151-117" href="#__codelineno-151-117"></a>            <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-151-118"><a id="__codelineno-151-118" name="__codelineno-151-118" href="#__codelineno-151-118"></a>
</span><span id="__span-151-119"><a id="__codelineno-151-119" name="__codelineno-151-119" href="#__codelineno-151-119"></a>    <span class="c1"># 更新精灵逻辑</span>
</span><span id="__span-151-120"><a id="__codelineno-151-120" name="__codelineno-151-120" href="#__codelineno-151-120"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</span><span id="__span-151-121"><a id="__codelineno-151-121" name="__codelineno-151-121" href="#__codelineno-151-121"></a>
</span><span id="__span-151-122"><a id="__codelineno-151-122" name="__codelineno-151-122" href="#__codelineno-151-122"></a>    <span class="c1"># 检测小球与挡板的碰撞</span>
</span><span id="__span-151-123"><a id="__codelineno-151-123" name="__codelineno-151-123" href="#__codelineno-151-123"></a>    <span class="k">for</span> <span class="n">paddle</span> <span class="ow">in</span> <span class="n">paddles</span><span class="p">:</span>
</span><span id="__span-151-124"><a id="__codelineno-151-124" name="__codelineno-151-124" href="#__codelineno-151-124"></a>        <span class="k">if</span> <span class="n">circle_rect_collision</span><span class="p">(</span><span class="n">ball</span><span class="p">,</span> <span class="n">paddle</span><span class="p">):</span>
</span><span id="__span-151-125"><a id="__codelineno-151-125" name="__codelineno-151-125" href="#__codelineno-151-125"></a>            <span class="n">ball</span><span class="o">.</span><span class="n">ball_dx</span> <span class="o">=</span> <span class="o">-</span><span class="n">ball</span><span class="o">.</span><span class="n">ball_dx</span>  <span class="c1"># 小球反弹</span>
</span><span id="__span-151-126"><a id="__codelineno-151-126" name="__codelineno-151-126" href="#__codelineno-151-126"></a>
</span><span id="__span-151-127"><a id="__codelineno-151-127" name="__codelineno-151-127" href="#__codelineno-151-127"></a>    <span class="c1"># 检测小球掉出屏幕</span>
</span><span id="__span-151-128"><a id="__codelineno-151-128" name="__codelineno-151-128" href="#__codelineno-151-128"></a>    <span class="k">if</span> <span class="n">ball</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 小球掉出左侧</span>
</span><span id="__span-151-129"><a id="__codelineno-151-129" name="__codelineno-151-129" href="#__codelineno-151-129"></a>        <span class="n">score_right</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># 右侧得分</span>
</span><span id="__span-151-130"><a id="__codelineno-151-130" name="__codelineno-151-130" href="#__codelineno-151-130"></a>        <span class="n">ball</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># 重置小球</span>
</span><span id="__span-151-131"><a id="__codelineno-151-131" name="__codelineno-151-131" href="#__codelineno-151-131"></a>    <span class="k">elif</span> <span class="n">ball</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;=</span> <span class="n">SCREEN_WIDTH</span><span class="p">:</span>  <span class="c1"># 小球掉出右侧</span>
</span><span id="__span-151-132"><a id="__codelineno-151-132" name="__codelineno-151-132" href="#__codelineno-151-132"></a>        <span class="n">score_left</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># 左侧得分</span>
</span><span id="__span-151-133"><a id="__codelineno-151-133" name="__codelineno-151-133" href="#__codelineno-151-133"></a>        <span class="n">ball</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># 重置小球</span>
</span><span id="__span-151-134"><a id="__codelineno-151-134" name="__codelineno-151-134" href="#__codelineno-151-134"></a>
</span><span id="__span-151-135"><a id="__codelineno-151-135" name="__codelineno-151-135" href="#__codelineno-151-135"></a>    <span class="c1"># 绘制精灵</span>
</span><span id="__span-151-136"><a id="__codelineno-151-136" name="__codelineno-151-136" href="#__codelineno-151-136"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">screen</span><span class="p">)</span>
</span><span id="__span-151-137"><a id="__codelineno-151-137" name="__codelineno-151-137" href="#__codelineno-151-137"></a>
</span><span id="__span-151-138"><a id="__codelineno-151-138" name="__codelineno-151-138" href="#__codelineno-151-138"></a>    <span class="c1"># 绘制得分</span>
</span><span id="__span-151-139"><a id="__codelineno-151-139" name="__codelineno-151-139" href="#__codelineno-151-139"></a>    <span class="n">score_text</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">score_left</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">score_right</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">WHITE</span><span class="p">)</span>
</span><span id="__span-151-140"><a id="__codelineno-151-140" name="__codelineno-151-140" href="#__codelineno-151-140"></a>    <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">score_text</span><span class="p">,</span> <span class="p">(</span><span class="n">SCREEN_WIDTH</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="__span-151-141"><a id="__codelineno-151-141" name="__codelineno-151-141" href="#__codelineno-151-141"></a>
</span><span id="__span-151-142"><a id="__codelineno-151-142" name="__codelineno-151-142" href="#__codelineno-151-142"></a>    <span class="c1"># 更新屏幕</span>
</span><span id="__span-151-143"><a id="__codelineno-151-143" name="__codelineno-151-143" href="#__codelineno-151-143"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
</span><span id="__span-151-144"><a id="__codelineno-151-144" name="__codelineno-151-144" href="#__codelineno-151-144"></a>
</span><span id="__span-151-145"><a id="__codelineno-151-145" name="__codelineno-151-145" href="#__codelineno-151-145"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</span></code></pre></div>
<h3 id="manim">manim（动画）</h3>
<p>3Blue1Brown的动画制作引擎<a href="https://docs.manim.community/en/stable/">Manim Community</a></p>
<ol>
<li><a href="https://github.com/leekunhwee/manim">manim</a>：命令行输入 <code>python -m pip install manim</code></li>
<li><a href="https://miktex.org/download">miktex</a>：详见latex安装</li>
<li><a href="https://www.gyan.dev/ffmpeg/builds/">ffmpeg</a>：下载解压后将../bin/目录添加进用户环境变量（此为音视频流处理软件)</li>
</ol>
<p><code>manim ./1.py -p</code> 渲染文件中的场景 -p指渲染后预览；路径后加场景的类名可以精确匹配渲染的场景；-qk,-qp,-qh默认,-qm,-ql 4k（3840x2160 60FPS）、2k（2560x1440 60FPS）、高（1920x1080 60FPS）、中（1280x720 30FPS）、低（854x480 15FPS）画质；-s 输出视频的最后一帧；--format gif 输出gif格式的动画</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-152-1"><a id="__codelineno-152-1" name="__codelineno-152-1" href="#__codelineno-152-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">manim</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-152-2"><a id="__codelineno-152-2" name="__codelineno-152-2" href="#__codelineno-152-2"></a>
</span><span id="__span-152-3"><a id="__codelineno-152-3" name="__codelineno-152-3" href="#__codelineno-152-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">ManimCELogo</span><span class="p">(</span><span class="n">Scene</span><span class="p">):</span>
</span><span id="__span-152-4"><a id="__codelineno-152-4" name="__codelineno-152-4" href="#__codelineno-152-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-152-5"><a id="__codelineno-152-5" name="__codelineno-152-5" href="#__codelineno-152-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">background_color</span> <span class="o">=</span> <span class="s2">&quot;#ece6e2&quot;</span>
</span><span id="__span-152-6"><a id="__codelineno-152-6" name="__codelineno-152-6" href="#__codelineno-152-6"></a>        <span class="n">logo_green</span> <span class="o">=</span> <span class="s2">&quot;#87c2a5&quot;</span>
</span><span id="__span-152-7"><a id="__codelineno-152-7" name="__codelineno-152-7" href="#__codelineno-152-7"></a>        <span class="n">logo_blue</span> <span class="o">=</span> <span class="s2">&quot;#525893&quot;</span>
</span><span id="__span-152-8"><a id="__codelineno-152-8" name="__codelineno-152-8" href="#__codelineno-152-8"></a>        <span class="n">logo_red</span> <span class="o">=</span> <span class="s2">&quot;#e07a5f&quot;</span>
</span><span id="__span-152-9"><a id="__codelineno-152-9" name="__codelineno-152-9" href="#__codelineno-152-9"></a>        <span class="n">logo_black</span> <span class="o">=</span> <span class="s2">&quot;#343434&quot;</span>
</span><span id="__span-152-10"><a id="__codelineno-152-10" name="__codelineno-152-10" href="#__codelineno-152-10"></a>        <span class="n">ds_m</span> <span class="o">=</span> <span class="n">MathTex</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\mathbb</span><span class="si">{M}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="n">logo_black</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</span><span id="__span-152-11"><a id="__codelineno-152-11" name="__codelineno-152-11" href="#__codelineno-152-11"></a>        <span class="n">ds_m</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mf">2.25</span> <span class="o">*</span> <span class="n">LEFT</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">UP</span><span class="p">)</span>
</span><span id="__span-152-12"><a id="__codelineno-152-12" name="__codelineno-152-12" href="#__codelineno-152-12"></a>        <span class="n">circle</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">logo_green</span><span class="p">,</span> <span class="n">fill_opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">LEFT</span><span class="p">)</span>
</span><span id="__span-152-13"><a id="__codelineno-152-13" name="__codelineno-152-13" href="#__codelineno-152-13"></a>        <span class="n">square</span> <span class="o">=</span> <span class="n">Square</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">logo_blue</span><span class="p">,</span> <span class="n">fill_opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">UP</span><span class="p">)</span>
</span><span id="__span-152-14"><a id="__codelineno-152-14" name="__codelineno-152-14" href="#__codelineno-152-14"></a>        <span class="n">triangle</span> <span class="o">=</span> <span class="n">Triangle</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">logo_red</span><span class="p">,</span> <span class="n">fill_opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">RIGHT</span><span class="p">)</span>
</span><span id="__span-152-15"><a id="__codelineno-152-15" name="__codelineno-152-15" href="#__codelineno-152-15"></a>        <span class="n">logo</span> <span class="o">=</span> <span class="n">VGroup</span><span class="p">(</span><span class="n">triangle</span><span class="p">,</span> <span class="n">square</span><span class="p">,</span> <span class="n">circle</span><span class="p">,</span> <span class="n">ds_m</span><span class="p">)</span>  <span class="c1"># order matters</span>
</span><span id="__span-152-16"><a id="__codelineno-152-16" name="__codelineno-152-16" href="#__codelineno-152-16"></a>        <span class="n">logo</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="n">ORIGIN</span><span class="p">)</span>
</span><span id="__span-152-17"><a id="__codelineno-152-17" name="__codelineno-152-17" href="#__codelineno-152-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">logo</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-153-1"><a id="__codelineno-153-1" name="__codelineno-153-1" href="#__codelineno-153-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">manim</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-153-2"><a id="__codelineno-153-2" name="__codelineno-153-2" href="#__codelineno-153-2"></a>
</span><span id="__span-153-3"><a id="__codelineno-153-3" name="__codelineno-153-3" href="#__codelineno-153-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Example</span><span class="p">(</span><span class="n">Scene</span><span class="p">):</span>
</span><span id="__span-153-4"><a id="__codelineno-153-4" name="__codelineno-153-4" href="#__codelineno-153-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-153-5"><a id="__codelineno-153-5" name="__codelineno-153-5" href="#__codelineno-153-5"></a>        <span class="c1"># 创建坐标系</span>
</span><span id="__span-153-6"><a id="__codelineno-153-6" name="__codelineno-153-6" href="#__codelineno-153-6"></a>        <span class="n">axe</span> <span class="o">=</span> <span class="n">Axes</span><span class="p">(</span>
</span><span id="__span-153-7"><a id="__codelineno-153-7" name="__codelineno-153-7" href="#__codelineno-153-7"></a>            <span class="n">x_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># x轴范围从-1到3，步长为1</span>
</span><span id="__span-153-8"><a id="__codelineno-153-8" name="__codelineno-153-8" href="#__codelineno-153-8"></a>            <span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>  <span class="c1"># y轴范围从-1到9，步长为2</span>
</span><span id="__span-153-9"><a id="__codelineno-153-9" name="__codelineno-153-9" href="#__codelineno-153-9"></a>            <span class="n">axis_config</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-153-10"><a id="__codelineno-153-10" name="__codelineno-153-10" href="#__codelineno-153-10"></a>                <span class="c1"># 加长特定数字的刻度线</span>
</span><span id="__span-153-11"><a id="__codelineno-153-11" name="__codelineno-153-11" href="#__codelineno-153-11"></a>                <span class="s2">&quot;numbers_with_elongated_ticks&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
</span><span id="__span-153-12"><a id="__codelineno-153-12" name="__codelineno-153-12" href="#__codelineno-153-12"></a>                <span class="s2">&quot;font_size&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
</span><span id="__span-153-13"><a id="__codelineno-153-13" name="__codelineno-153-13" href="#__codelineno-153-13"></a>                <span class="c1"># 坐标轴显示标签，也可以通过axe = Axes().add_coordinates()实现</span>
</span><span id="__span-153-14"><a id="__codelineno-153-14" name="__codelineno-153-14" href="#__codelineno-153-14"></a>                <span class="s2">&quot;include_numbers&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-153-15"><a id="__codelineno-153-15" name="__codelineno-153-15" href="#__codelineno-153-15"></a>            <span class="p">},</span>
</span><span id="__span-153-16"><a id="__codelineno-153-16" name="__codelineno-153-16" href="#__codelineno-153-16"></a>            <span class="n">x_axis_config</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-153-17"><a id="__codelineno-153-17" name="__codelineno-153-17" href="#__codelineno-153-17"></a>                <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">RED</span><span class="p">,</span>  <span class="c1"># x轴颜色为红色</span>
</span><span id="__span-153-18"><a id="__codelineno-153-18" name="__codelineno-153-18" href="#__codelineno-153-18"></a>                <span class="s2">&quot;stroke_width&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>  <span class="c1"># x轴线条宽度</span>
</span><span id="__span-153-19"><a id="__codelineno-153-19" name="__codelineno-153-19" href="#__codelineno-153-19"></a>                <span class="s2">&quot;include_tip&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># 显示箭头</span>
</span><span id="__span-153-20"><a id="__codelineno-153-20" name="__codelineno-153-20" href="#__codelineno-153-20"></a>                <span class="s2">&quot;tip_shape&quot;</span><span class="p">:</span> <span class="n">ArrowSquareTip</span><span class="p">,</span> <span class="c1"># 箭头形状</span>
</span><span id="__span-153-21"><a id="__codelineno-153-21" name="__codelineno-153-21" href="#__codelineno-153-21"></a>                <span class="s2">&quot;tip_length&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>  <span class="c1"># 箭头长度</span>
</span><span id="__span-153-22"><a id="__codelineno-153-22" name="__codelineno-153-22" href="#__codelineno-153-22"></a>            <span class="p">},</span>
</span><span id="__span-153-23"><a id="__codelineno-153-23" name="__codelineno-153-23" href="#__codelineno-153-23"></a>            <span class="n">y_axis_config</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-153-24"><a id="__codelineno-153-24" name="__codelineno-153-24" href="#__codelineno-153-24"></a>                <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">BLUE</span><span class="p">,</span>  <span class="c1"># y轴颜色为蓝色</span>
</span><span id="__span-153-25"><a id="__codelineno-153-25" name="__codelineno-153-25" href="#__codelineno-153-25"></a>                <span class="s2">&quot;stroke_width&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="c1"># y轴线条宽度</span>
</span><span id="__span-153-26"><a id="__codelineno-153-26" name="__codelineno-153-26" href="#__codelineno-153-26"></a>                <span class="s2">&quot;include_tip&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># 显示箭头</span>
</span><span id="__span-153-27"><a id="__codelineno-153-27" name="__codelineno-153-27" href="#__codelineno-153-27"></a>                <span class="s2">&quot;tip_shape&quot;</span><span class="p">:</span> <span class="n">StealthTip</span><span class="p">,</span>  <span class="c1"># 箭头形状</span>
</span><span id="__span-153-28"><a id="__codelineno-153-28" name="__codelineno-153-28" href="#__codelineno-153-28"></a>            <span class="p">},</span>
</span><span id="__span-153-29"><a id="__codelineno-153-29" name="__codelineno-153-29" href="#__codelineno-153-29"></a>        <span class="p">)</span>
</span><span id="__span-153-30"><a id="__codelineno-153-30" name="__codelineno-153-30" href="#__codelineno-153-30"></a>
</span><span id="__span-153-31"><a id="__codelineno-153-31" name="__codelineno-153-31" href="#__codelineno-153-31"></a>        <span class="c1"># 添加坐标轴标签</span>
</span><span id="__span-153-32"><a id="__codelineno-153-32" name="__codelineno-153-32" href="#__codelineno-153-32"></a>        <span class="n">labels</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">get_axis_labels</span><span class="p">(</span>
</span><span id="__span-153-33"><a id="__codelineno-153-33" name="__codelineno-153-33" href="#__codelineno-153-33"></a>            <span class="n">Tex</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.7</span><span class="p">),</span> <span class="n">Text</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.45</span><span class="p">)</span>
</span><span id="__span-153-34"><a id="__codelineno-153-34" name="__codelineno-153-34" href="#__codelineno-153-34"></a>        <span class="p">)</span>
</span><span id="__span-153-35"><a id="__codelineno-153-35" name="__codelineno-153-35" href="#__codelineno-153-35"></a>
</span><span id="__span-153-36"><a id="__codelineno-153-36" name="__codelineno-153-36" href="#__codelineno-153-36"></a>        <span class="c1"># 绘制函数图像 y = x^2</span>
</span><span id="__span-153-37"><a id="__codelineno-153-37" name="__codelineno-153-37" href="#__codelineno-153-37"></a>        <span class="n">graph</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">],</span> <span class="n">use_smoothing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-153-38"><a id="__codelineno-153-38" name="__codelineno-153-38" href="#__codelineno-153-38"></a>        <span class="c1"># 为函数图像添加标签</span>
</span><span id="__span-153-39"><a id="__codelineno-153-39" name="__codelineno-153-39" href="#__codelineno-153-39"></a>        <span class="n">graph_label</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">get_graph_label</span><span class="p">(</span>
</span><span id="__span-153-40"><a id="__codelineno-153-40" name="__codelineno-153-40" href="#__codelineno-153-40"></a>            <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span>  <span class="c1"># 指定函数图像</span>
</span><span id="__span-153-41"><a id="__codelineno-153-41" name="__codelineno-153-41" href="#__codelineno-153-41"></a>            <span class="n">label</span><span class="o">=</span><span class="n">Tex</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x^2$&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.7</span><span class="p">),</span>  <span class="c1"># 标签内容</span>
</span><span id="__span-153-42"><a id="__codelineno-153-42" name="__codelineno-153-42" href="#__codelineno-153-42"></a>            <span class="n">direction</span><span class="o">=</span><span class="n">RIGHT</span>  <span class="c1"># 标签位置（相对于函数图像）UP、DOWN、LEFT</span>
</span><span id="__span-153-43"><a id="__codelineno-153-43" name="__codelineno-153-43" href="#__codelineno-153-43"></a>        <span class="p">)</span>
</span><span id="__span-153-44"><a id="__codelineno-153-44" name="__codelineno-153-44" href="#__codelineno-153-44"></a>        <span class="c1"># # 手动设置标签</span>
</span><span id="__span-153-45"><a id="__codelineno-153-45" name="__codelineno-153-45" href="#__codelineno-153-45"></a>        <span class="c1"># graph_label = Tex(r&quot;$x^2$&quot;).scale(0.7)</span>
</span><span id="__span-153-46"><a id="__codelineno-153-46" name="__codelineno-153-46" href="#__codelineno-153-46"></a>        <span class="c1"># graph_label.move_to(axe.c2p(2.5, 7.2))</span>
</span><span id="__span-153-47"><a id="__codelineno-153-47" name="__codelineno-153-47" href="#__codelineno-153-47"></a>        <span class="c1"># # graph_label.next_to(graph, RIGHT, buff=0.2)</span>
</span><span id="__span-153-48"><a id="__codelineno-153-48" name="__codelineno-153-48" href="#__codelineno-153-48"></a>
</span><span id="__span-153-49"><a id="__codelineno-153-49" name="__codelineno-153-49" href="#__codelineno-153-49"></a>        <span class="c1"># 在函数图像上创建一个黄色的点，x=2</span>
</span><span id="__span-153-50"><a id="__codelineno-153-50" name="__codelineno-153-50" href="#__codelineno-153-50"></a>        <span class="n">dot</span> <span class="o">=</span> <span class="n">Dot</span><span class="p">(</span>
</span><span id="__span-153-51"><a id="__codelineno-153-51" name="__codelineno-153-51" href="#__codelineno-153-51"></a>            <span class="n">point</span><span class="o">=</span><span class="n">axe</span><span class="o">.</span><span class="n">i2gp</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">),</span>
</span><span id="__span-153-52"><a id="__codelineno-153-52" name="__codelineno-153-52" href="#__codelineno-153-52"></a>            <span class="n">color</span><span class="o">=</span><span class="n">YELLOW</span>
</span><span id="__span-153-53"><a id="__codelineno-153-53" name="__codelineno-153-53" href="#__codelineno-153-53"></a>        <span class="p">)</span>
</span><span id="__span-153-54"><a id="__codelineno-153-54" name="__codelineno-153-54" href="#__codelineno-153-54"></a>
</span><span id="__span-153-55"><a id="__codelineno-153-55" name="__codelineno-153-55" href="#__codelineno-153-55"></a>        <span class="c1"># 在坐标系中创建一个绿色的点，坐标为 (2, 2)</span>
</span><span id="__span-153-56"><a id="__codelineno-153-56" name="__codelineno-153-56" href="#__codelineno-153-56"></a>        <span class="n">dot_axes</span> <span class="o">=</span> <span class="n">Dot</span><span class="p">(</span><span class="n">axe</span><span class="o">.</span><span class="n">coords_to_point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">GREEN</span><span class="p">)</span>
</span><span id="__span-153-57"><a id="__codelineno-153-57" name="__codelineno-153-57" href="#__codelineno-153-57"></a>
</span><span id="__span-153-58"><a id="__codelineno-153-58" name="__codelineno-153-58" href="#__codelineno-153-58"></a>        <span class="c1"># 从坐标系的原点到点 (2, 2^2) 绘制两条线</span>
</span><span id="__span-153-59"><a id="__codelineno-153-59" name="__codelineno-153-59" href="#__codelineno-153-59"></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">get_lines_to_point</span><span class="p">(</span><span class="n">axe</span><span class="o">.</span><span class="n">i2gp</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">))</span>
</span><span id="__span-153-60"><a id="__codelineno-153-60" name="__codelineno-153-60" href="#__codelineno-153-60"></a>        <span class="c1"># lines = axe.get_lines_to_point(axe.c2p(2,4)) # coords_to_point</span>
</span><span id="__span-153-61"><a id="__codelineno-153-61" name="__codelineno-153-61" href="#__codelineno-153-61"></a>
</span><span id="__span-153-62"><a id="__codelineno-153-62" name="__codelineno-153-62" href="#__codelineno-153-62"></a>        <span class="c1"># 将所有对象组合成一个组</span>
</span><span id="__span-153-63"><a id="__codelineno-153-63" name="__codelineno-153-63" href="#__codelineno-153-63"></a>        <span class="n">example_group</span> <span class="o">=</span> <span class="n">VGroup</span><span class="p">(</span><span class="n">axe</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">graph_label</span><span class="p">,</span> <span class="n">dot</span><span class="p">,</span> <span class="n">dot_axes</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>
</span><span id="__span-153-64"><a id="__codelineno-153-64" name="__codelineno-153-64" href="#__codelineno-153-64"></a>
</span><span id="__span-153-65"><a id="__codelineno-153-65" name="__codelineno-153-65" href="#__codelineno-153-65"></a>        <span class="c1"># 将组添加到场景中</span>
</span><span id="__span-153-66"><a id="__codelineno-153-66" name="__codelineno-153-66" href="#__codelineno-153-66"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">example_group</span><span class="p">)</span>
</span><span id="__span-153-67"><a id="__codelineno-153-67" name="__codelineno-153-67" href="#__codelineno-153-67"></a>
</span><span id="__span-153-68"><a id="__codelineno-153-68" name="__codelineno-153-68" href="#__codelineno-153-68"></a><span class="c1"># 箭头形状:</span>
</span><span id="__span-153-69"><a id="__codelineno-153-69" name="__codelineno-153-69" href="#__codelineno-153-69"></a><span class="c1"># ArrowTriangleTip三角形箭头(默认);ArrowTriangleFilledTip填充的三角形箭头;ArrowSquareTip方形箭头;ArrowSquareFilledTip填充的方形箭头;ArrowCircleTip圆形箭头;ArrowCircleFilledTip填充的圆形箭头;StealthTip\stealth 箭头;StealthTipFilled填充的 StealthTip 箭头;自定义箭头形状，可以通过继承 ArrowTip 类来实现</span>
</span><span id="__span-153-70"><a id="__codelineno-153-70" name="__codelineno-153-70" href="#__codelineno-153-70"></a>
</span><span id="__span-153-71"><a id="__codelineno-153-71" name="__codelineno-153-71" href="#__codelineno-153-71"></a><span class="c1"># from manim import RegularPolygon</span>
</span><span id="__span-153-72"><a id="__codelineno-153-72" name="__codelineno-153-72" href="#__codelineno-153-72"></a><span class="c1"># class CustomArrowTip(ArrowTip, RegularPolygon):</span>
</span><span id="__span-153-73"><a id="__codelineno-153-73" name="__codelineno-153-73" href="#__codelineno-153-73"></a><span class="c1">#      def __init__(self, length=0.35, **kwargs):</span>
</span><span id="__span-153-74"><a id="__codelineno-153-74" name="__codelineno-153-74" href="#__codelineno-153-74"></a><span class="c1">#          RegularPolygon.__init__(self, n=5, **kwargs)</span>
</span><span id="__span-153-75"><a id="__codelineno-153-75" name="__codelineno-153-75" href="#__codelineno-153-75"></a><span class="c1">#          self.width = length</span>
</span><span id="__span-153-76"><a id="__codelineno-153-76" name="__codelineno-153-76" href="#__codelineno-153-76"></a><span class="c1">#          self.stretch_to_fit_height(length)</span>
</span><span id="__span-153-77"><a id="__codelineno-153-77" name="__codelineno-153-77" href="#__codelineno-153-77"></a>
</span><span id="__span-153-78"><a id="__codelineno-153-78" name="__codelineno-153-78" href="#__codelineno-153-78"></a><span class="c1"># from manim import Polygon</span>
</span><span id="__span-153-79"><a id="__codelineno-153-79" name="__codelineno-153-79" href="#__codelineno-153-79"></a><span class="c1"># class CustomArrowTip(ArrowTip, Polygon):</span>
</span><span id="__span-153-80"><a id="__codelineno-153-80" name="__codelineno-153-80" href="#__codelineno-153-80"></a><span class="c1">#      def __init__(self, length=0.35, **kwargs):</span>
</span><span id="__span-153-81"><a id="__codelineno-153-81" name="__codelineno-153-81" href="#__codelineno-153-81"></a><span class="c1">#         points = [</span>
</span><span id="__span-153-82"><a id="__codelineno-153-82" name="__codelineno-153-82" href="#__codelineno-153-82"></a><span class="c1">#             (1.0000, 0.0000, 0.0),</span>
</span><span id="__span-153-83"><a id="__codelineno-153-83" name="__codelineno-153-83" href="#__codelineno-153-83"></a><span class="c1">#             (0.3090, 0.2245, 0.0),</span>
</span><span id="__span-153-84"><a id="__codelineno-153-84" name="__codelineno-153-84" href="#__codelineno-153-84"></a><span class="c1">#             (0.3090, 0.9511, 0.0),</span>
</span><span id="__span-153-85"><a id="__codelineno-153-85" name="__codelineno-153-85" href="#__codelineno-153-85"></a><span class="c1">#             (-0.1180, 0.3633, 0.0),</span>
</span><span id="__span-153-86"><a id="__codelineno-153-86" name="__codelineno-153-86" href="#__codelineno-153-86"></a><span class="c1">#             (-0.8090, 0.5878, 0.0),</span>
</span><span id="__span-153-87"><a id="__codelineno-153-87" name="__codelineno-153-87" href="#__codelineno-153-87"></a><span class="c1">#             (-0.3819, 0.0000, 0.0),  </span>
</span><span id="__span-153-88"><a id="__codelineno-153-88" name="__codelineno-153-88" href="#__codelineno-153-88"></a><span class="c1">#             (-0.8090, -0.5878, 0.0),</span>
</span><span id="__span-153-89"><a id="__codelineno-153-89" name="__codelineno-153-89" href="#__codelineno-153-89"></a><span class="c1">#             (-0.1180, -0.3633, 0.0)</span>
</span><span id="__span-153-90"><a id="__codelineno-153-90" name="__codelineno-153-90" href="#__codelineno-153-90"></a><span class="c1">#             (0.3090, -0.9511, 0.0),</span>
</span><span id="__span-153-91"><a id="__codelineno-153-91" name="__codelineno-153-91" href="#__codelineno-153-91"></a><span class="c1">#             (0.3090, -0.2245, 0.0) </span>
</span><span id="__span-153-92"><a id="__codelineno-153-92" name="__codelineno-153-92" href="#__codelineno-153-92"></a><span class="c1">#         ]</span>
</span><span id="__span-153-93"><a id="__codelineno-153-93" name="__codelineno-153-93" href="#__codelineno-153-93"></a><span class="c1">#         Polygon.__init__(self, *points, **kwargs)</span>
</span><span id="__span-153-94"><a id="__codelineno-153-94" name="__codelineno-153-94" href="#__codelineno-153-94"></a><span class="c1">#         self.scale(length / max(self.get_width(), self.get_height())) </span>
</span></code></pre></div>
<p><strong>scene</strong>（提供播放的场景）的方法：self.
add/remove 从scene中添加或移除若干个mobject
play 播放若干个animation动画
wait 让画面等待一段时间s，默认等待1s
camera 相机
camera.background_color = BLUE 设置摄像机的背景颜色，参数可为：预设颜色如RED、RGB颜色如[0.1, 0.2, 0.5]、十六进制颜色如'#FF5733'、浮点颜色如Color(0.2, 0.4, 0.7)
camera.frame_width/camera.frame_height 相机的视野范围</p>
<p><strong>mobject</strong>（场景中的各种物体）：物体的绝对坐标即中心的坐标，默认为(0,0,0)
图形：
Dot([x,y,z]) 点
Line([0,0,0],[1,1,0]) 线
Arrow 箭头
DashedLine 虚线
Circle(color=RED fill_color/stroke_color,fill_opacity=1,radius=1) 圆
Ellipse(height=4,width=4/5) 椭圆
Arc(angle=PI / 6, start_angle=PI * 1.5, radius=2) 30度圆弧，半径2，从270度开始绘制
Triangle 等边三角形
Square(side_length=1) 正方形
Rectangle(color=RED,height=4,width=4/5,fill_opacity=0.5) 矩形
RoundedRectangle(corner_radius=0.2, width=1.5, height=1) 圆角矩形
Polygon 依次连接传入的坐标点列表，绘制任意多边形
RegularPolygon(n=6)  # 正六边形
图形的样式属性：
stroke_width：图形边框的粗细
color：图形的颜色
fill_color：图形的填充色
fill_opacity：填充色的透明度
文本和公式：
Text("hello world") 一般用于单行的文本
Paragraph("hello","world") 一般用于多行的文本
MarkupText("<code>&lt;u&gt;</code>下划线<code>&lt;/u&gt;</code>")  一般用于富文本显示，类似HTML
Tex(r"<span class="arithmatex"><span class="MathJax_Preview">a^2 + b^2 = c^2</span><script type="math/tex">a^2 + b^2 = c^2</script></span>") 基于Tex主要是用来显示数学公式。Tex默认只支持显示英文
BulletedList 会将传入的多个字符串以列表的方式排列起来
Title 自动显示在顶部
文本属性和方法：
Text("hello world", color=RED) 颜色
Text("hello world").set_color_by_gradient((RED, GREEN)) 渐变色
Text("databook.top", t2c={"data": BLUE, "book": RED, "top": GREEN})可以用 t2c属性来设置特定字符的颜色（t2f：按字符设置字体t2s：按字符设置斜体t2w：按字符设置粗体）。对于 Tex对象来说，虽然没有 t2c属性，也可以通过 set_color_by_tex方法来设置特定字符的颜色
Text("数学", font="STXingkai") font属性设置字体
Text("manim", font_size=20) 通过 font_size属性设置字号
Text("BOLD font weight", weight=BOLD) 粗体
Text("ITALIC font", slant=ITALIC) 斜体
图片：
ImageMobject("images/test.png") 插入图片可以是 jpg/png/gif ，但 gif只会显示第一帧，height/width方法获取图片长宽。invert=True 表示反色
VGroup() 将某些物体视为一个整体
坐标轴：
NumberLine 数轴是最基本的一维坐标系
NumberPlane 实数平面
ComplexPlane 复平面
PolarPlane 极坐标系
Axes() 二维笛卡尔坐标轴，通过height和width两个参数可以控制坐标轴的长和宽，x_range和y_range来指定坐标轴每个维度的范围，x_axis_config。默认生成的坐标轴是没有刻度的，长度和宽度为各自屏幕的长度宽度减2。Axes的get_graph方法绘制function图像如function=lambda x : np.sin(x)，axe.i2gp(x=1,graph=sin_graph)方法得到图像点的绝对坐标
ThreeDAxes() 三维空间的笛卡尔坐标轴</p>
<p>move_to([1,0,0]) 绝对坐标、另一个物体，默认为中心，可选参数aligned_edge=RIGHT/LEFT/UP/DOWN/OUT/IN物体的右/左/上/下/外/内边界（可以复合，如UR指右上）
set_x,set_y,set_z 分别设置x,y,z坐标，可选参数direction
set_opacity 设置物体透明度
center() 移动到场景中心
to_edge(RIGHT,buff=0) 移动到场景的边界，参数为RIGHT/LEFT/UP/DOWN，可选参数buff表示与边界的间隙默认为0.5
to_corner(UR,buff=0) 移动到场景的角落，参数为UL/UR/DL/DR，可选参数buff
shift() 相对于自身移动一个单位，参数为RIGHT/LEFT/UP/DOWN
next_to() 相邻于另一个物体，可选参数direction、buff
align_to(s,UP) 在direction侧对齐于另一个物体
match_x,match_y,match_z 物体的坐标于另一个物体相匹配
除坐标属性外还有match_color/match_width/match_height
get_center/get_x/get_y/get_z 获取物体中心点坐标
get_left/get_right/get_top/get_bottom 获取物体边界中心点坐标
get_corner() 获取物体角落坐标，参数为UL/UR/DL/DR
rotate(45 * DEGREES) 逆时针旋转物体 run_time=2
copy() 得到物体的副本
animate.to_edge(RIGHT,buff=1) 将移动的方法变成动画从而传入play中播放</p>
<p><strong>animation</strong>（作用于物体上的动画）：
Create 创建图形，绘制时图形逐步显示
Write 用在文字的创建上，绘制文字时逐个显示文字
FadeIn/FadeOut 淡入、淡出
Uncreate一般用在擦除图形
Unwrite一般用在擦除文字
ReplacementTransform 从原图形/文字直接变换成新的图形/文字
TransformFromCopy 保留原图形/文字的变换</p>
<p>MoveAlongPath 可以让元素沿着任意的函数轨迹来运动
TracedPath可以设置保留运动轨迹的效果
通过 LaggedStart控制组合的多个动画之间的启动时间间隔
通过 Succession控制多个动画顺序执行，它能够保证上一个执行成功后才执行下一个</p>
<h3 id="chardet">chardet（编码检测）</h3>
<p>chardet 是一个 Python 库，用于检测文本数据的字符编码。它可以自动识别文本的字符编码，在处理各种不同编码的文本数据时避免出现乱码或其他问题。chardet 的工作原理是分析文本数据中的字符分布和统计信息，然后根据这些信息来猜测文本的编码方式。</p>
<p>pip install chardet</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-154-1"><a id="__codelineno-154-1" name="__codelineno-154-1" href="#__codelineno-154-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">chardet</span>
</span><span id="__span-154-2"><a id="__codelineno-154-2" name="__codelineno-154-2" href="#__codelineno-154-2"></a>
</span><span id="__span-154-3"><a id="__codelineno-154-3" name="__codelineno-154-3" href="#__codelineno-154-3"></a><span class="n">text</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;This is a sample text.&#39;</span>
</span><span id="__span-154-4"><a id="__codelineno-154-4" name="__codelineno-154-4" href="#__codelineno-154-4"></a><span class="n">result</span> <span class="o">=</span> <span class="n">chardet</span><span class="o">.</span><span class="n">detect</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span><span id="__span-154-5"><a id="__codelineno-154-5" name="__codelineno-154-5" href="#__codelineno-154-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="c1"># {&#39;encoding&#39;: &#39;ascii&#39;, &#39;confidence&#39;: 1.0, &#39;language&#39;: &#39;&#39;}</span>
</span></code></pre></div>
<h3 id="web">web开发</h3>
<p><strong>Diango
  Pyramid
  flask</strong></p>
<h4 id="sqlalchemy">SQLAlchemy</h4>
<p>sqlalchemy是一个python语言实现的的针对关系型数据库的orm库。可用于连接大多数常见的数据库，比如Postges、MySQL、SQLite、Oracle等</p>
<p>SQLAlchemy提供了两种主要的使用模式</p>
<ol>
<li>SQL表达式语言（SQLAlchemy Core）</li>
<li>ORM</li>
</ol>
<h4 id="fastapi">FastAPI</h4>
<p>FastAPI 是一个用于构建 API 的现代、快速（高性能）的 web 框架，专为在 Python 中构建 RESTful API 而设计。</p>
<h4 id="mkdocsmarkdown">Mkdocs（markdown静态网站）</h4>
<p>MkDocs是一个快速、简单、华丽的静态网站生成器，适用于构建项目文档。文档源文件以Markdown编写，并使用一个YAML文件来进行配置。</p>
<p>安装：==<code>pip install mkdocs</code>==
 使用 <code>mkdocs --version</code> 检查是否安装成功</p>
<p><strong>初始化项目</strong>：==<code>mkdocs new &lt;项目名&gt;</code>==
生成一个&lt;项目名&gt;文件夹，里面有 <code>mkdocs.yml</code>配置文件，以及一个名为 <code>docs</code>的文件夹，它将包含你的文档文件。现在 <code>docs</code>文件夹只包含一个名为 <code>index.md</code>的文档页面。
直接在当前目录下运行 <code>mkdocs new .</code> 命令将已有的文件夹初始化为 MkDocs 项目而不创建新文件夹
<code>index.md</code> 文件不需要显式添加到 <code>nav</code> 配置中，因为它会自动作为主页加载。</p>
<p>MkDocs附带一个内置的开发服务器，可以让你在处理文档时预览文档。
确保 <code>mkdocs.yml</code>配置文件位于同一目录中
运行==<code>mkdocs serve</code>==命令启动服务器，在浏览器中打开 <code>http://127.0.0.1:8000/</code>，你将看到显示的默认主页</p>
<p><code>site_url</code> 是 MkDocs 配置文件 (<code>mkdocs.yml</code>) 中的一个可选字段，用于指定网站的根 URL。它的主要作用是为生成的站点提供一个绝对路径的基础 URL
use_directory_urls: true默认为true，访问 URL 时不需要显式地添加 <code>.html</code> 后缀
如<code>http://127.0.0.1:8000/notes/python</code> 会自动映射到 <code>python.html</code></p>
<p><strong>主题</strong>：
配置文件 <code>mkdocs.yml</code>
<code>site_name: &lt;站点名称&gt;</code>
添加 <code>nav</code>设置来管理每个页面导航的顺序、标题和嵌套情况
添加 <code>theme</code>设置（MkDocs的默认主题为mkdocs，还内置readthedocs主题）
可以在MkDocs<a href="https://github.com/mkdocs/mkdocs/wiki/MkDocs-Themes">community wiki</a>中找到第三方主题列表</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-155-1"><a id="__codelineno-155-1" name="__codelineno-155-1" href="#__codelineno-155-1"></a>site_name: MkLorum
</span><span id="__span-155-2"><a id="__codelineno-155-2" name="__codelineno-155-2" href="#__codelineno-155-2"></a>nav:
</span><span id="__span-155-3"><a id="__codelineno-155-3" name="__codelineno-155-3" href="#__codelineno-155-3"></a>- User Guide:
</span><span id="__span-155-4"><a id="__codelineno-155-4" name="__codelineno-155-4" href="#__codelineno-155-4"></a>    - Writing your docs: write/writing-your-docs.md
</span><span id="__span-155-5"><a id="__codelineno-155-5" name="__codelineno-155-5" href="#__codelineno-155-5"></a>    - Styling your docs: styling-your-docs.md
</span><span id="__span-155-6"><a id="__codelineno-155-6" name="__codelineno-155-6" href="#__codelineno-155-6"></a>- About:
</span><span id="__span-155-7"><a id="__codelineno-155-7" name="__codelineno-155-7" href="#__codelineno-155-7"></a>    - License: license.md
</span><span id="__span-155-8"><a id="__codelineno-155-8" name="__codelineno-155-8" href="#__codelineno-155-8"></a>    - Release Notes: release-notes.md
</span><span id="__span-155-9"><a id="__codelineno-155-9" name="__codelineno-155-9" href="#__codelineno-155-9"></a>theme: readthedocs
</span></code></pre></div>
<p>也可以自定义主题，自定义主题至少包含一个 <code>main.html</code>文件</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-156-1"><a id="__codelineno-156-1" name="__codelineno-156-1" href="#__codelineno-156-1"></a>theme:
</span><span id="__span-156-2"><a id="__codelineno-156-2" name="__codelineno-156-2" href="#__codelineno-156-2"></a>    name: null
</span><span id="__span-156-3"><a id="__codelineno-156-3" name="__codelineno-156-3" href="#__codelineno-156-3"></a>    custom_dir: &#39;custom_theme/&#39;
</span></code></pre></div>
<p>默认情况下，MkDocs使用MkDocs favicon图标。 要使用不同的图标，请在docs_dir中创建一个img子目录，并将自定义的favicon.ico文件复制到该目录。 MkDocs将自动检测并使用该文件作为你的favicon图标。</p>
<p><strong>自定义</strong>：
可以添加css和JavaScript文件到 <code>docs</code>目录进一步调整样式
在 <code>docs</code>目录下添加文件：</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-157-1"><a id="__codelineno-157-1" name="__codelineno-157-1" href="#__codelineno-157-1"></a>.
</span><span id="__span-157-2"><a id="__codelineno-157-2" name="__codelineno-157-2" href="#__codelineno-157-2"></a>├─ docs/
</span><span id="__span-157-3"><a id="__codelineno-157-3" name="__codelineno-157-3" href="#__codelineno-157-3"></a>│  ├─ stylesheets/
</span><span id="__span-157-4"><a id="__codelineno-157-4" name="__codelineno-157-4" href="#__codelineno-157-4"></a>│  │  └─ extra.css
</span><span id="__span-157-5"><a id="__codelineno-157-5" name="__codelineno-157-5" href="#__codelineno-157-5"></a>│  └─ javascripts/
</span><span id="__span-157-6"><a id="__codelineno-157-6" name="__codelineno-157-6" href="#__codelineno-157-6"></a>│     └─ extra.js
</span><span id="__span-157-7"><a id="__codelineno-157-7" name="__codelineno-157-7" href="#__codelineno-157-7"></a>└─ mkdocs.yml
</span></code></pre></div>
<p>然后在 <code>mkdocs.yml</code>中添加以下内容：</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-158-1"><a id="__codelineno-158-1" name="__codelineno-158-1" href="#__codelineno-158-1"></a>extra_css:
</span><span id="__span-158-2"><a id="__codelineno-158-2" name="__codelineno-158-2" href="#__codelineno-158-2"></a>  - stylesheets/extra.css
</span><span id="__span-158-3"><a id="__codelineno-158-3" name="__codelineno-158-3" href="#__codelineno-158-3"></a>
</span><span id="__span-158-4"><a id="__codelineno-158-4" name="__codelineno-158-4" href="#__codelineno-158-4"></a>extra_javascript:
</span><span id="__span-158-5"><a id="__codelineno-158-5" name="__codelineno-158-5" href="#__codelineno-158-5"></a>  - javascripts/extra.js
</span></code></pre></div>
<p><strong>插件</strong>：
在使用插件之前，必须将其安装在系统上。 如果您使用的是MkDocs附带的插件，则在安装MkDocs时会安装它。 但是，要安装第三方插件，您需要确定相应的软件包名称并使用 <code>pip</code>进行安装</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-159-1"><a id="__codelineno-159-1" name="__codelineno-159-1" href="#__codelineno-159-1"></a>pip<span class="w"> </span>install<span class="w"> </span>mkdocs-foo-plugin
</span></code></pre></div>
<p>使用插件：<a href="https://wdk-docs.github.io/mkdocs-docs/plugins/">第三方插件</a>
plugins配置选项应包含构建站点时要使用的插件列表。 每个“插件”必须是分配给插件的字符串名称（请参阅给定插件的文档以确定其“名称”）。 此处列出的插件必须已经安装。</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-160-1"><a id="__codelineno-160-1" name="__codelineno-160-1" href="#__codelineno-160-1"></a>plugins: - search
</span></code></pre></div>
<p>某些插件可能提供自己的配置选项。 如果要设置任何配置选项，则可以嵌套给定插件支持的任何选项的键/值映射</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-161-1"><a id="__codelineno-161-1" name="__codelineno-161-1" href="#__codelineno-161-1"></a>plugins:
</span><span id="__span-161-2"><a id="__codelineno-161-2" name="__codelineno-161-2" href="#__codelineno-161-2"></a>    - search:
</span><span id="__span-161-3"><a id="__codelineno-161-3" name="__codelineno-161-3" href="#__codelineno-161-3"></a>        lang: en
</span><span id="__span-161-4"><a id="__codelineno-161-4" name="__codelineno-161-4" href="#__codelineno-161-4"></a>        foo: bar
</span></code></pre></div>
<p>开发插件：
插件必须用Python编写
插件需要打包为Python库（分布在PyPI上，与MkDocs分开），每个插件必须通过setuptools entry_point注册为插件。</p>
<p>==数学公式支持==：</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-162-1"><a id="__codelineno-162-1" name="__codelineno-162-1" href="#__codelineno-162-1"></a>markdown_extensions:
</span><span id="__span-162-2"><a id="__codelineno-162-2" name="__codelineno-162-2" href="#__codelineno-162-2"></a>  - pymdownx.arithmatex
</span><span id="__span-162-3"><a id="__codelineno-162-3" name="__codelineno-162-3" href="#__codelineno-162-3"></a>
</span><span id="__span-162-4"><a id="__codelineno-162-4" name="__codelineno-162-4" href="#__codelineno-162-4"></a>extra_javascript:
</span><span id="__span-162-5"><a id="__codelineno-162-5" name="__codelineno-162-5" href="#__codelineno-162-5"></a>  - https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-163-1"><a id="__codelineno-163-1" name="__codelineno-163-1" href="#__codelineno-163-1"></a>markdown_extensions:
</span><span id="__span-163-2"><a id="__codelineno-163-2" name="__codelineno-163-2" href="#__codelineno-163-2"></a>  - pymdownx.arithmatex:  # 启用数学公式扩展
</span><span id="__span-163-3"><a id="__codelineno-163-3" name="__codelineno-163-3" href="#__codelineno-163-3"></a>      generic: true  # 使用通用数学公式渲染器
</span><span id="__span-163-4"><a id="__codelineno-163-4" name="__codelineno-163-4" href="#__codelineno-163-4"></a>
</span><span id="__span-163-5"><a id="__codelineno-163-5" name="__codelineno-163-5" href="#__codelineno-163-5"></a>extra_css:
</span><span id="__span-163-6"><a id="__codelineno-163-6" name="__codelineno-163-6" href="#__codelineno-163-6"></a>- themes/css/custom.css
</span><span id="__span-163-7"><a id="__codelineno-163-7" name="__codelineno-163-7" href="#__codelineno-163-7"></a>- themes/css/simpleLightbox.min.css
</span><span id="__span-163-8"><a id="__codelineno-163-8" name="__codelineno-163-8" href="#__codelineno-163-8"></a>- themes/css/pied_piper.css
</span><span id="__span-163-9"><a id="__codelineno-163-9" name="__codelineno-163-9" href="#__codelineno-163-9"></a>- https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css
</span><span id="__span-163-10"><a id="__codelineno-163-10" name="__codelineno-163-10" href="#__codelineno-163-10"></a>
</span><span id="__span-163-11"><a id="__codelineno-163-11" name="__codelineno-163-11" href="#__codelineno-163-11"></a>extra_javascript:
</span><span id="__span-163-12"><a id="__codelineno-163-12" name="__codelineno-163-12" href="#__codelineno-163-12"></a>- themes/js/custom.js
</span><span id="__span-163-13"><a id="__codelineno-163-13" name="__codelineno-163-13" href="#__codelineno-163-13"></a>- themes/js/simpleLightbox.min.js
</span><span id="__span-163-14"><a id="__codelineno-163-14" name="__codelineno-163-14" href="#__codelineno-163-14"></a>- themes/js/optionalConfig.js
</span><span id="__span-163-15"><a id="__codelineno-163-15" name="__codelineno-163-15" href="#__codelineno-163-15"></a>- themes/js/mermaidloader.js
</span><span id="__span-163-16"><a id="__codelineno-163-16" name="__codelineno-163-16" href="#__codelineno-163-16"></a>- themes/js/umlconvert.js
</span><span id="__span-163-17"><a id="__codelineno-163-17" name="__codelineno-163-17" href="#__codelineno-163-17"></a>- themes/js/mathjax.js
</span><span id="__span-163-18"><a id="__codelineno-163-18" name="__codelineno-163-18" href="#__codelineno-163-18"></a>- themes/js/katex.js
</span><span id="__span-163-19"><a id="__codelineno-163-19" name="__codelineno-163-19" href="#__codelineno-163-19"></a>- https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js
</span><span id="__span-163-20"><a id="__codelineno-163-20" name="__codelineno-163-20" href="#__codelineno-163-20"></a>- https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.17.1/flowchart.min.js
</span><span id="__span-163-21"><a id="__codelineno-163-21" name="__codelineno-163-21" href="#__codelineno-163-21"></a>- https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.min.js
</span><span id="__span-163-22"><a id="__codelineno-163-22" name="__codelineno-163-22" href="#__codelineno-163-22"></a>- https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.13.6/underscore-min.js
</span><span id="__span-163-23"><a id="__codelineno-163-23" name="__codelineno-163-23" href="#__codelineno-163-23"></a>- https://cdn.jsdelivr.net/npm/@mermaid-js/mermaid-mindmap@9.3.0/dist/diagram-definition.0faef4c2.min.js
</span><span id="__span-163-24"><a id="__codelineno-163-24" name="__codelineno-163-24" href="#__codelineno-163-24"></a>- https://cdn.jsdelivr.net/npm/markdown-it-plantuml@1.4.1/index.min.js
</span><span id="__span-163-25"><a id="__codelineno-163-25" name="__codelineno-163-25" href="#__codelineno-163-25"></a>- https://cdnjs.cloudflare.com/ajax/libs/webfont/1.6.28/webfontloader.js
</span><span id="__span-163-26"><a id="__codelineno-163-26" name="__codelineno-163-26" href="#__codelineno-163-26"></a>- https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js
</span><span id="__span-163-27"><a id="__codelineno-163-27" name="__codelineno-163-27" href="#__codelineno-163-27"></a>- https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-chtml.js
</span><span id="__span-163-28"><a id="__codelineno-163-28" name="__codelineno-163-28" href="#__codelineno-163-28"></a>- https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-chtml-full.js
</span><span id="__span-163-29"><a id="__codelineno-163-29" name="__codelineno-163-29" href="#__codelineno-163-29"></a>- https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-svg-full.js
</span><span id="__span-163-30"><a id="__codelineno-163-30" name="__codelineno-163-30" href="#__codelineno-163-30"></a>- https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js
</span><span id="__span-163-31"><a id="__codelineno-163-31" name="__codelineno-163-31" href="#__codelineno-163-31"></a>- https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js
</span></code></pre></div>
<p><strong>生成网站</strong>：==<code>mkdocs build --clean</code>== --clean参数用于删除陈旧的文件</p>
<p>如果已经在GitHub上托管代码，那么使用GitHub Pages来发布网站再方便不过了。
使用GitHub Actions可以自动部署网站。在库的根目录下新建一个GitHub Actions workflow，比如：.github/workflows/ci.yml，并粘贴入以下内容：</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-164-1"><a id="__codelineno-164-1" name="__codelineno-164-1" href="#__codelineno-164-1"></a>name: ci
</span><span id="__span-164-2"><a id="__codelineno-164-2" name="__codelineno-164-2" href="#__codelineno-164-2"></a>on:
</span><span id="__span-164-3"><a id="__codelineno-164-3" name="__codelineno-164-3" href="#__codelineno-164-3"></a>  push:
</span><span id="__span-164-4"><a id="__codelineno-164-4" name="__codelineno-164-4" href="#__codelineno-164-4"></a>    branches:
</span><span id="__span-164-5"><a id="__codelineno-164-5" name="__codelineno-164-5" href="#__codelineno-164-5"></a>      - master
</span><span id="__span-164-6"><a id="__codelineno-164-6" name="__codelineno-164-6" href="#__codelineno-164-6"></a>      - main
</span><span id="__span-164-7"><a id="__codelineno-164-7" name="__codelineno-164-7" href="#__codelineno-164-7"></a>jobs:
</span><span id="__span-164-8"><a id="__codelineno-164-8" name="__codelineno-164-8" href="#__codelineno-164-8"></a>  deploy:
</span><span id="__span-164-9"><a id="__codelineno-164-9" name="__codelineno-164-9" href="#__codelineno-164-9"></a>    runs-on: ubuntu-latest
</span><span id="__span-164-10"><a id="__codelineno-164-10" name="__codelineno-164-10" href="#__codelineno-164-10"></a>    steps:
</span><span id="__span-164-11"><a id="__codelineno-164-11" name="__codelineno-164-11" href="#__codelineno-164-11"></a>      - uses: actions/checkout@v2
</span><span id="__span-164-12"><a id="__codelineno-164-12" name="__codelineno-164-12" href="#__codelineno-164-12"></a>      - uses: actions/setup-python@v2
</span><span id="__span-164-13"><a id="__codelineno-164-13" name="__codelineno-164-13" href="#__codelineno-164-13"></a>        with:
</span><span id="__span-164-14"><a id="__codelineno-164-14" name="__codelineno-164-14" href="#__codelineno-164-14"></a>          python-version: 3.x
</span><span id="__span-164-15"><a id="__codelineno-164-15" name="__codelineno-164-15" href="#__codelineno-164-15"></a>      - run: pip install mkdocs-material
</span><span id="__span-164-16"><a id="__codelineno-164-16" name="__codelineno-164-16" href="#__codelineno-164-16"></a>      - run: mkdocs gh-deploy --force
</span></code></pre></div>
<p>此时，当一个新的提交推送到 <code>master</code>或 <code>main</code>时，我们的静态网站的内容将自动生成并完成部署。网站将在不久后部署到 <code>&lt;username&gt;.github.io/&lt;repository&gt;</code></p>
<p>如果几分钟后 GitHub Page 没有出现，请转到你的存储库的设置并确保你的 Pages 的发布源分支设置为gh-pages。</p>
<p>当你部署到 GitHub Pages 时，如果你的仓库不是一个用户或组织的主页仓库（例如 <code>username.github.io</code>），那么生成的网站会被托管在一个子路径下，例如 <code>https://username.github.io/repository-name/</code>。这需要在 mkdocs.yml中正确配置 <code>site_url</code> 和 <code>use_directory_urls</code>。</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-165-1"><a id="__codelineno-165-1" name="__codelineno-165-1" href="#__codelineno-165-1"></a>site_url: https://username.github.io/repository-name/
</span><span id="__span-165-2"><a id="__codelineno-165-2" name="__codelineno-165-2" href="#__codelineno-165-2"></a>use_directory_urls: false
</span></code></pre></div>
<p>如果是倾向于手动部署网站，请在包含 <code>mkdocs.yml</code>文件的目录中运行以下命令：
<code>mkdocs gh-deploy --force</code></p>
<hr />
<p><a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a>是MkDocs的一个使用人数众多主题
可以使用 <code>pip install mkdocs-material</code> 来完成安装</p>
<p><a href="https://mkdoc-material.llango.com/">Material for MkDocs - Material for MkDocs 中文文档</a></p>
<p>添加内容到 <code>mkdocs.yml</code>以配置</p>
<p>最小配置：</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-166-1"><a id="__codelineno-166-1" name="__codelineno-166-1" href="#__codelineno-166-1"></a>theme:
</span><span id="__span-166-2"><a id="__codelineno-166-2" name="__codelineno-166-2" href="#__codelineno-166-2"></a>  name: material
</span></code></pre></div>
<p>高级设置：</p>
<ul>
<li>修改颜色</li>
<li>修改字体</li>
<li>修改语言</li>
<li>修改logo图片和icon图标</li>
<li>设置导航</li>
<li>设置站内搜索</li>
<li>设置访问统计</li>
<li>设置versioning</li>
<li>设置头部(header)</li>
<li>设置底部(footer)</li>
<li>添加Github库(repository)</li>
<li>添加评论系统</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-167-1"><a id="__codelineno-167-1" name="__codelineno-167-1" href="#__codelineno-167-1"></a>theme:
</span><span id="__span-167-2"><a id="__codelineno-167-2" name="__codelineno-167-2" href="#__codelineno-167-2"></a>  name: material  # 使用 Material 主题
</span><span id="__span-167-3"><a id="__codelineno-167-3" name="__codelineno-167-3" href="#__codelineno-167-3"></a>  language: zh  # 设置站点语言为中文
</span><span id="__span-167-4"><a id="__codelineno-167-4" name="__codelineno-167-4" href="#__codelineno-167-4"></a>  favicon: assets/favicon.png  # 设置网站标签页图标
</span><span id="__span-167-5"><a id="__codelineno-167-5" name="__codelineno-167-5" href="#__codelineno-167-5"></a>  icon:
</span><span id="__span-167-6"><a id="__codelineno-167-6" name="__codelineno-167-6" href="#__codelineno-167-6"></a>    logo: logo  # 设置站点 logo 图标
</span><span id="__span-167-7"><a id="__codelineno-167-7" name="__codelineno-167-7" href="#__codelineno-167-7"></a>  font:
</span><span id="__span-167-8"><a id="__codelineno-167-8" name="__codelineno-167-8" href="#__codelineno-167-8"></a>    text: Roboto  # 正文字体
</span><span id="__span-167-9"><a id="__codelineno-167-9" name="__codelineno-167-9" href="#__codelineno-167-9"></a>    code: Roboto Mono  # 代码字体
</span><span id="__span-167-10"><a id="__codelineno-167-10" name="__codelineno-167-10" href="#__codelineno-167-10"></a>
</span><span id="__span-167-11"><a id="__codelineno-167-11" name="__codelineno-167-11" href="#__codelineno-167-11"></a>  features:
</span><span id="__span-167-12"><a id="__codelineno-167-12" name="__codelineno-167-12" href="#__codelineno-167-12"></a>    # - navigation.instant  # 启用即时导航功能
</span><span id="__span-167-13"><a id="__codelineno-167-13" name="__codelineno-167-13" href="#__codelineno-167-13"></a>    - navigation.sections  # 启用导航部分功能
</span><span id="__span-167-14"><a id="__codelineno-167-14" name="__codelineno-167-14" href="#__codelineno-167-14"></a>    - navigation.tabs  # 启用导航标签功能
</span><span id="__span-167-15"><a id="__codelineno-167-15" name="__codelineno-167-15" href="#__codelineno-167-15"></a>    - content.code.copy  # 启用代码块复制功能
</span><span id="__span-167-16"><a id="__codelineno-167-16" name="__codelineno-167-16" href="#__codelineno-167-16"></a>    - navigation.tracking  # 启用导航跟踪功能
</span><span id="__span-167-17"><a id="__codelineno-167-17" name="__codelineno-167-17" href="#__codelineno-167-17"></a>
</span><span id="__span-167-18"><a id="__codelineno-167-18" name="__codelineno-167-18" href="#__codelineno-167-18"></a>  palette:
</span><span id="__span-167-19"><a id="__codelineno-167-19" name="__codelineno-167-19" href="#__codelineno-167-19"></a>    - media: &quot;(prefers-color-scheme: light)&quot;
</span><span id="__span-167-20"><a id="__codelineno-167-20" name="__codelineno-167-20" href="#__codelineno-167-20"></a>      scheme: default
</span><span id="__span-167-21"><a id="__codelineno-167-21" name="__codelineno-167-21" href="#__codelineno-167-21"></a>      primary: white  # 浅色模式主色调
</span><span id="__span-167-22"><a id="__codelineno-167-22" name="__codelineno-167-22" href="#__codelineno-167-22"></a>      accent: purple  # 浅色模式强调色
</span><span id="__span-167-23"><a id="__codelineno-167-23" name="__codelineno-167-23" href="#__codelineno-167-23"></a>      toggle:
</span><span id="__span-167-24"><a id="__codelineno-167-24" name="__codelineno-167-24" href="#__codelineno-167-24"></a>        icon: material/weather-sunny # 设置浅色模式下的切换按钮图标
</span><span id="__span-167-25"><a id="__codelineno-167-25" name="__codelineno-167-25" href="#__codelineno-167-25"></a>        name: 切换到深色模式  # 设置浅色模式下的切换按钮名称
</span><span id="__span-167-26"><a id="__codelineno-167-26" name="__codelineno-167-26" href="#__codelineno-167-26"></a>
</span><span id="__span-167-27"><a id="__codelineno-167-27" name="__codelineno-167-27" href="#__codelineno-167-27"></a>    - media: &quot;(prefers-color-scheme: dark)&quot;
</span><span id="__span-167-28"><a id="__codelineno-167-28" name="__codelineno-167-28" href="#__codelineno-167-28"></a>      scheme: slate
</span><span id="__span-167-29"><a id="__codelineno-167-29" name="__codelineno-167-29" href="#__codelineno-167-29"></a>      primary: black  # 深色模式主色调
</span><span id="__span-167-30"><a id="__codelineno-167-30" name="__codelineno-167-30" href="#__codelineno-167-30"></a>      accent: pink  # 深色模式强调色
</span><span id="__span-167-31"><a id="__codelineno-167-31" name="__codelineno-167-31" href="#__codelineno-167-31"></a>      toggle:
</span><span id="__span-167-32"><a id="__codelineno-167-32" name="__codelineno-167-32" href="#__codelineno-167-32"></a>        icon: material/weather-night  # 设置深色模式下的切换按钮图标
</span><span id="__span-167-33"><a id="__codelineno-167-33" name="__codelineno-167-33" href="#__codelineno-167-33"></a>        name: 切换到浅色模式  # 设置深色模式下的切换按钮名称
</span><span id="__span-167-34"><a id="__codelineno-167-34" name="__codelineno-167-34" href="#__codelineno-167-34"></a>
</span><span id="__span-167-35"><a id="__codelineno-167-35" name="__codelineno-167-35" href="#__codelineno-167-35"></a>  static_templates:
</span><span id="__span-167-36"><a id="__codelineno-167-36" name="__codelineno-167-36" href="#__codelineno-167-36"></a>    - 404.html  # 自定义 404 页面
</span><span id="__span-167-37"><a id="__codelineno-167-37" name="__codelineno-167-37" href="#__codelineno-167-37"></a>
</span><span id="__span-167-38"><a id="__codelineno-167-38" name="__codelineno-167-38" href="#__codelineno-167-38"></a>  include_search_page: false  # 不包含 MkDocs 的搜索页面
</span><span id="__span-167-39"><a id="__codelineno-167-39" name="__codelineno-167-39" href="#__codelineno-167-39"></a>  search_index_only: true  # 仅包含搜索索引
</span></code></pre></div>
<hr />
<p>MkDocs Minify是Mkdocs的HTML、js、css最小化插件，可以节约空间
HTML压缩通过<strong>htmlmin2</strong>实现，JS压缩通过<strong>jsmin</strong>实现，CSS压缩通过<strong>csscompressor</strong>实现。
（<code>htmlmin -csHk &lt;input.html&gt; [output.html]</code>）</p>
<p><code>pip install mkdocs-minify-plugin</code></p>
<p>在 <code>plugins</code>配置项中加入 <code>minify</code></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-168-1"><a id="__codelineno-168-1" name="__codelineno-168-1" href="#__codelineno-168-1"></a>plugins:
</span><span id="__span-168-2"><a id="__codelineno-168-2" name="__codelineno-168-2" href="#__codelineno-168-2"></a>  - search
</span><span id="__span-168-3"><a id="__codelineno-168-3" name="__codelineno-168-3" href="#__codelineno-168-3"></a>  - minify:
</span><span id="__span-168-4"><a id="__codelineno-168-4" name="__codelineno-168-4" href="#__codelineno-168-4"></a>      minify_html: true
</span><span id="__span-168-5"><a id="__codelineno-168-5" name="__codelineno-168-5" href="#__codelineno-168-5"></a>      minify_js: true
</span><span id="__span-168-6"><a id="__codelineno-168-6" name="__codelineno-168-6" href="#__codelineno-168-6"></a>      minify_css: true
</span></code></pre></div>
<h4 id="djangoweb">Django（Web 框架）</h4>
<p>Django 是一个由 Python 编写的一个开放源代码的 Web 应用框架。
Django 本身基于 MVC ，即 Model（模型）+ View（视图）+ Controller（控制器）设计模式
Django 提供了一个强大的 ORM（对象关系映射），允许开发者通过 Python 代码来定义和操作数据库模型，而无需直接使用 SQL。这使得数据库操作更加抽象和易于管理。</p>
<p><a href="https://docs.djangoproject.com/zh-hans">Django</a></p>
<p>windows <code>pip install Django</code>
linux <code>sudo pip3 install Django</code></p>
<p><strong>初始化项目</strong>：<code>django-admin startproject &lt;项目名&gt;</code>
(或 <code>python -m django startproject &lt;项目名&gt;</code>)
在项目文件夹下<strong>启动开发服务器</strong>（进入项目文件夹<code>cd &lt;项目名&gt;</code>）：<code>python manage.py runserver 0.0.0.0:8000</code></p>
<blockquote>
<p>0.0.0.0 表示开放外界访问，8000指端口。</p>
</blockquote>
<p>需要先编辑 <code>settings.py</code>中的ALLOWED_HOSTS添加 服务器ip /127.0.0.1开放访问</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-169-1"><a id="__codelineno-169-1" name="__codelineno-169-1" href="#__codelineno-169-1"></a><span class="n">ALLOWED_HOSTS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="s1">&#39;example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;123.45.67.89&#39;</span><span class="p">,]</span>
</span><span id="__span-169-2"><a id="__codelineno-169-2" name="__codelineno-169-2" href="#__codelineno-169-2"></a><span class="n">ALLOWED_HOSTS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">]</span> <span class="c1"># 允许所有 IP 地址访问（在开发环境中）</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-170-1"><a id="__codelineno-170-1" name="__codelineno-170-1" href="#__codelineno-170-1"></a>项目名/      # 项目根目录                                       .
</span><span id="__span-170-2"><a id="__codelineno-170-2" name="__codelineno-170-2" href="#__codelineno-170-2"></a>├─ 项目名  # 主应用开发目录
</span><span id="__span-170-3"><a id="__codelineno-170-3" name="__codelineno-170-3" href="#__codelineno-170-3"></a>│   ├─ __init__.py   # 包的初始化文件
</span><span id="__span-170-4"><a id="__codelineno-170-4" name="__codelineno-170-4" href="#__codelineno-170-4"></a>│   ├─ asgi.py       # 异步编程模式的web对象
</span><span id="__span-170-5"><a id="__codelineno-170-5" name="__codelineno-170-5" href="#__codelineno-170-5"></a>│   ├─ settings.py   # 开发配置文件，包括数据库账号密码等配置
</span><span id="__span-170-6"><a id="__codelineno-170-6" name="__codelineno-170-6" href="#__codelineno-170-6"></a>│   ├─ urls.py       # 总路由文件，用于绑定url映射
</span><span id="__span-170-7"><a id="__codelineno-170-7" name="__codelineno-170-7" href="#__codelineno-170-7"></a>│   └─ wsgi.py       # wsgi服务器的入口文件，manage.py runserver调用的就是wsgi
</span><span id="__span-170-8"><a id="__codelineno-170-8" name="__codelineno-170-8" href="#__codelineno-170-8"></a>└─ manage.py         # 项目的入口程序，提供一系列脚手架
</span></code></pre></div>
<p>启动wsgi服务后还会多一个db.sqlite3数据库文件[[#SQLite3（数据库）]]</p>
<h5 id="_63">核心组件的使用</h5>
<p>一个 Django 项目由多个应用（App）组成,
（按功能模块合理规划 App；对于简单的静态页面（如关于页、主页），可直接在项目层处理无需创建 App ）
<strong>创建应用</strong> <code>python manage.py startapp &lt;app名&gt;</code></p>
<blockquote>
<p>注册应用：在 <code>settings.py</code> 中的INSTALLED_APPS添加应用</p>
</blockquote>
<div class="language-text highlight"><pre><span></span><code><span id="__span-171-1"><a id="__codelineno-171-1" name="__codelineno-171-1" href="#__codelineno-171-1"></a>app名/
</span><span id="__span-171-2"><a id="__codelineno-171-2" name="__codelineno-171-2" href="#__codelineno-171-2"></a>├─ migrations
</span><span id="__span-171-3"><a id="__codelineno-171-3" name="__codelineno-171-3" href="#__codelineno-171-3"></a>│      └─ __init__.py
</span><span id="__span-171-4"><a id="__codelineno-171-4" name="__codelineno-171-4" href="#__codelineno-171-4"></a>├─ __init__.py
</span><span id="__span-171-5"><a id="__codelineno-171-5" name="__codelineno-171-5" href="#__codelineno-171-5"></a>├─ admin.py
</span><span id="__span-171-6"><a id="__codelineno-171-6" name="__codelineno-171-6" href="#__codelineno-171-6"></a>├─ apps.py
</span><span id="__span-171-7"><a id="__codelineno-171-7" name="__codelineno-171-7" href="#__codelineno-171-7"></a>├─ models.py
</span><span id="__span-171-8"><a id="__codelineno-171-8" name="__codelineno-171-8" href="#__codelineno-171-8"></a>├─ tests.py
</span><span id="__span-171-9"><a id="__codelineno-171-9" name="__codelineno-171-9" href="#__codelineno-171-9"></a>└─ views.py   # 接收http的request对象
</span></code></pre></div>
<p><em>以下以项目 <code>myproject</code>，应用 <code>blog</code>为例</em>：</p>
<p><strong>数据库</strong>：
在 <code>models.py</code> 中设计数据库表</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-172-1"><a id="__codelineno-172-1" name="__codelineno-172-1" href="#__codelineno-172-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
</span><span id="__span-172-2"><a id="__codelineno-172-2" name="__codelineno-172-2" href="#__codelineno-172-2"></a>
</span><span id="__span-172-3"><a id="__codelineno-172-3" name="__codelineno-172-3" href="#__codelineno-172-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Post</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span><span id="__span-172-4"><a id="__codelineno-172-4" name="__codelineno-172-4" href="#__codelineno-172-4"></a>    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</span><span id="__span-172-5"><a id="__codelineno-172-5" name="__codelineno-172-5" href="#__codelineno-172-5"></a>    <span class="n">content</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;暂未填写&#39;</span><span class="p">)</span>
</span><span id="__span-172-6"><a id="__codelineno-172-6" name="__codelineno-172-6" href="#__codelineno-172-6"></a>    <span class="n">file</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FileField</span><span class="p">(</span><span class="n">upload_to</span><span class="o">=</span><span class="s1">&#39;uploads/%Y/%m/</span><span class="si">%d</span><span class="s1">/&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-172-7"><a id="__codelineno-172-7" name="__codelineno-172-7" href="#__codelineno-172-7"></a>    <span class="n">created_at</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-172-8"><a id="__codelineno-172-8" name="__codelineno-172-8" href="#__codelineno-172-8"></a>
</span><span id="__span-172-9"><a id="__codelineno-172-9" name="__codelineno-172-9" href="#__codelineno-172-9"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-172-10"><a id="__codelineno-172-10" name="__codelineno-172-10" href="#__codelineno-172-10"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
</span></code></pre></div>
<p>CharField：用于存储字符串。
IntegerField：用于存储整数。不过很多时候不如使用CharField
DateField：用于存储日期。
ForeignKey：用于定义多对一关系。related_name 是 Django 的 ForeignKey 字段的一个可选参数，用于定义反向关系的名称。它允许你通过关联模型访问主模型的所有相关对象。
related_name='files' 的作用是允许你通过 Post 模型访问所有关联的 PostFile 对象。例如：
<div class="language-python highlight"><pre><span></span><code><span id="__span-173-1"><a id="__codelineno-173-1" name="__codelineno-173-1" href="#__codelineno-173-1"></a><span class="c1"># 获取一个 Post 对象</span>
</span><span id="__span-173-2"><a id="__codelineno-173-2" name="__codelineno-173-2" href="#__codelineno-173-2"></a><span class="n">post</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-173-3"><a id="__codelineno-173-3" name="__codelineno-173-3" href="#__codelineno-173-3"></a>
</span><span id="__span-173-4"><a id="__codelineno-173-4" name="__codelineno-173-4" href="#__codelineno-173-4"></a><span class="c1"># 通过 related_name 获取所有关联的 PostFile 对象</span>
</span><span id="__span-173-5"><a id="__codelineno-173-5" name="__codelineno-173-5" href="#__codelineno-173-5"></a><span class="n">files</span> <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span></code></pre></div>
JSONField
TextField
boll
img
FileField：有一个file.url可以得到相对路径，使用 request.build_absolute_uri(file.url) 将相对路径转换为完整的 URL
可以使用 <code>JSONField</code> 或 <code>ManyToManyField</code> 来存储多个文件路径</p>
<ul>
<li>null=True：允许数据库字段存储 <code>NULL</code> 值。</li>
<li>blank=True：允许 Django 表单验证时字段可以为空。</li>
</ul>
<p>某些字段（如 CharField 或 IntegerField）可能需要显式设置默认值default
或者在前端表单中提供默认值 value=""</p>
<p>~~如DateTimeField需要一个 <code>datetime</code> 对象作为默认值~~
~~<code>from datetime import datetime</code>~~
~~<code>default=datetime(2025, 1, 1, 0, 0)</code>~~
~~如果您希望默认值始终是当前时间，可以使用 <code>default=datetime.now()</code>~~
~~(datetime.date()返回具有同样 year, month 和 day 值的 date 对象)~~</p>
<p>~~对于 IntegerField~~
~~直接提供一个整数作为默认值 <code>default=0</code>~~</p>
<p>在视图设置：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-174-1"><a id="__codelineno-174-1" name="__codelineno-174-1" href="#__codelineno-174-1"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-174-2"><a id="__codelineno-174-2" name="__codelineno-174-2" href="#__codelineno-174-2"></a>            <span class="c1"># 验证并格式化日期 %Y-%m-%dT%H:%M</span>
</span><span id="__span-174-3"><a id="__codelineno-174-3" name="__codelineno-174-3" href="#__codelineno-174-3"></a>            <span class="c1"># 将字符串转换为 datetime 对象。</span>
</span><span id="__span-174-4"><a id="__codelineno-174-4" name="__codelineno-174-4" href="#__codelineno-174-4"></a>            <span class="k">if</span> <span class="n">date</span><span class="p">:</span>
</span><span id="__span-174-5"><a id="__codelineno-174-5" name="__codelineno-174-5" href="#__codelineno-174-5"></a>                <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-174-6"><a id="__codelineno-174-6" name="__codelineno-174-6" href="#__codelineno-174-6"></a>            <span class="c1"># datetime 对象的.date() 方法，提取日期部分返回datetime.date 对象</span>
</span><span id="__span-174-7"><a id="__codelineno-174-7" name="__codelineno-174-7" href="#__codelineno-174-7"></a>
</span><span id="__span-174-8"><a id="__codelineno-174-8" name="__codelineno-174-8" href="#__codelineno-174-8"></a>            <span class="c1"># 将字符串转换为数字</span>
</span><span id="__span-174-9"><a id="__codelineno-174-9" name="__codelineno-174-9" href="#__codelineno-174-9"></a>            <span class="n">integer</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">integer</span><span class="p">)</span>
</span><span id="__span-174-10"><a id="__codelineno-174-10" name="__codelineno-174-10" href="#__codelineno-174-10"></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
</span><span id="__span-174-11"><a id="__codelineno-174-11" name="__codelineno-174-11" href="#__codelineno-174-11"></a>            <span class="n">date</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 如果格式不正确，设置为 None</span>
</span><span id="__span-174-12"><a id="__codelineno-174-12" name="__codelineno-174-12" href="#__codelineno-174-12"></a>            <span class="n">integer</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>
<p>如果数据很多，可以使用字典data传输数据，并且
<div class="language-python highlight"><pre><span></span><code><span id="__span-175-1"><a id="__codelineno-175-1" name="__codelineno-175-1" href="#__codelineno-175-1"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
</span><span id="__span-175-2"><a id="__codelineno-175-2" name="__codelineno-175-2" href="#__codelineno-175-2"></a>        <span class="n">date</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-175-3"><a id="__codelineno-175-3" name="__codelineno-175-3" href="#__codelineno-175-3"></a>            <span class="s1">&#39;title&#39;</span> <span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">),</span>
</span><span id="__span-175-4"><a id="__codelineno-175-4" name="__codelineno-175-4" href="#__codelineno-175-4"></a>            <span class="s1">&#39;content&#39;</span> <span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">),</span>
</span><span id="__span-175-5"><a id="__codelineno-175-5" name="__codelineno-175-5" href="#__codelineno-175-5"></a>        <span class="p">}</span>
</span><span id="__span-175-6"><a id="__codelineno-175-6" name="__codelineno-175-6" href="#__codelineno-175-6"></a>        <span class="c1"># 批量设置空字符串为None</span>
</span><span id="__span-175-7"><a id="__codelineno-175-7" name="__codelineno-175-7" href="#__codelineno-175-7"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-175-8"><a id="__codelineno-175-8" name="__codelineno-175-8" href="#__codelineno-175-8"></a>            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="__span-175-9"><a id="__codelineno-175-9" name="__codelineno-175-9" href="#__codelineno-175-9"></a>                <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-175-10"><a id="__codelineno-175-10" name="__codelineno-175-10" href="#__codelineno-175-10"></a>
</span><span id="__span-175-11"><a id="__codelineno-175-11" name="__codelineno-175-11" href="#__codelineno-175-11"></a>        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-175-12"><a id="__codelineno-175-12" name="__codelineno-175-12" href="#__codelineno-175-12"></a>            <span class="s1">&#39;file&#39;</span> <span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">FILES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">),</span>
</span><span id="__span-175-13"><a id="__codelineno-175-13" name="__codelineno-175-13" href="#__codelineno-175-13"></a>        <span class="p">}</span>
</span><span id="__span-175-14"><a id="__codelineno-175-14" name="__codelineno-175-14" href="#__codelineno-175-14"></a>
</span><span id="__span-175-15"><a id="__codelineno-175-15" name="__codelineno-175-15" href="#__codelineno-175-15"></a>        <span class="n">post</span> <span class="o">=</span> <span class="n">Post</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">files</span><span class="p">)</span>
</span></code></pre></div></p>
<p>如果需要修改数据，可以：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-176-1"><a id="__codelineno-176-1" name="__codelineno-176-1" href="#__codelineno-176-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">post_edit</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
</span><span id="__span-176-2"><a id="__codelineno-176-2" name="__codelineno-176-2" href="#__codelineno-176-2"></a>    <span class="n">post</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Post</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span>
</span><span id="__span-176-3"><a id="__codelineno-176-3" name="__codelineno-176-3" href="#__codelineno-176-3"></a>        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
</span><span id="__span-176-4"><a id="__codelineno-176-4" name="__codelineno-176-4" href="#__codelineno-176-4"></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-176-5"><a id="__codelineno-176-5" name="__codelineno-176-5" href="#__codelineno-176-5"></a>                <span class="c1"># 如果某个字段未提交，设置默认值</span>
</span><span id="__span-176-6"><a id="__codelineno-176-6" name="__codelineno-176-6" href="#__codelineno-176-6"></a>                <span class="s1">&#39;title&#39;</span> <span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="n">post</span><span class="o">.</span><span class="n">title</span><span class="p">),</span>
</span><span id="__span-176-7"><a id="__codelineno-176-7" name="__codelineno-176-7" href="#__codelineno-176-7"></a>            <span class="p">}</span>
</span><span id="__span-176-8"><a id="__codelineno-176-8" name="__codelineno-176-8" href="#__codelineno-176-8"></a>            <span class="n">files</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-176-9"><a id="__codelineno-176-9" name="__codelineno-176-9" href="#__codelineno-176-9"></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">{</span><span class="o">**</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">files</span><span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-176-10"><a id="__codelineno-176-10" name="__codelineno-176-10" href="#__codelineno-176-10"></a>                <span class="nb">setattr</span><span class="p">(</span><span class="n">post</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="__span-176-11"><a id="__codelineno-176-11" name="__codelineno-176-11" href="#__codelineno-176-11"></a>            <span class="n">post</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="__span-176-12"><a id="__codelineno-176-12" name="__codelineno-176-12" href="#__codelineno-176-12"></a>
</span><span id="__span-176-13"><a id="__codelineno-176-13" name="__codelineno-176-13" href="#__codelineno-176-13"></a><span class="c1"># urls.py</span>
</span><span id="__span-176-14"><a id="__codelineno-176-14" name="__codelineno-176-14" href="#__codelineno-176-14"></a><span class="n">path</span><span class="p">(</span><span class="s1">&#39;&lt;int:pk&gt;/edit/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">post_edit</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;post_edit&#39;</span><span class="p">),</span>
</span></code></pre></div>
<div class="language-html highlight"><pre><span></span><code><span id="__span-177-1"><a id="__codelineno-177-1" name="__codelineno-177-1" href="#__codelineno-177-1"></a><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;FactoryRepClosing&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ post.factory_rep_closing }}&quot;</span><span class="p">&gt;</span>
</span><span id="__span-177-2"><a id="__codelineno-177-2" name="__codelineno-177-2" href="#__codelineno-177-2"></a><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;datetime-local&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;Auditfinishtime&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ post.audit_finish_time|date:&#39;Y-m-d\\TH:i&#39; }}&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
</span><span id="__span-177-3"><a id="__codelineno-177-3" name="__codelineno-177-3" href="#__codelineno-177-3"></a>
</span><span id="__span-177-4"><a id="__codelineno-177-4" name="__codelineno-177-4" href="#__codelineno-177-4"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;radio-group&quot;</span><span class="p">&gt;</span>
</span><span id="__span-177-5"><a id="__codelineno-177-5" name="__codelineno-177-5" href="#__codelineno-177-5"></a>    <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;radio&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;a1&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;A&quot;</span> <span class="err">{%</span> <span class="na">if</span> <span class="na">post</span><span class="err">.</span><span class="na">pre_production_a1 </span><span class="o">=</span><span class="s">=</span> <span class="err">&#39;</span><span class="na">A</span><span class="err">&#39;</span> <span class="err">%}</span><span class="na">checked</span><span class="err">{%</span> <span class="na">endif</span> <span class="err">%}</span><span class="p">&gt;</span>A<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span><span id="__span-177-6"><a id="__codelineno-177-6" name="__codelineno-177-6" href="#__codelineno-177-6"></a>    <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;radio&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;a1&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;B&quot;</span> <span class="err">{%</span> <span class="na">if</span> <span class="na">post</span><span class="err">.</span><span class="na">pre_production_a1 </span><span class="o">=</span><span class="s">=</span> <span class="err">&#39;</span><span class="na">B</span><span class="err">&#39;</span> <span class="err">%}</span><span class="na">checked</span><span class="err">{%</span> <span class="na">endif</span> <span class="err">%}</span><span class="p">&gt;</span>B<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span><span id="__span-177-7"><a id="__codelineno-177-7" name="__codelineno-177-7" href="#__codelineno-177-7"></a>    <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;radio&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;a1&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;C&quot;</span> <span class="err">{%</span> <span class="na">if</span> <span class="na">post</span><span class="err">.</span><span class="na">pre_production_a1 </span><span class="o">=</span><span class="s">=</span> <span class="err">&#39;</span><span class="na">C</span><span class="err">&#39;</span> <span class="err">%}</span><span class="na">checked</span><span class="err">{%</span> <span class="na">endif</span> <span class="err">%}</span><span class="p">&gt;</span>C<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span><span id="__span-177-8"><a id="__codelineno-177-8" name="__codelineno-177-8" href="#__codelineno-177-8"></a>    <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;radio&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;a1&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;D&quot;</span> <span class="err">{%</span> <span class="na">if</span> <span class="na">post</span><span class="err">.</span><span class="na">pre_production_a1 </span><span class="o">=</span><span class="s">=</span> <span class="err">&#39;</span><span class="na">D</span><span class="err">&#39;</span> <span class="err">%}</span><span class="na">checked</span><span class="err">{%</span> <span class="na">endif</span> <span class="err">%}</span><span class="p">&gt;</span>D<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span><span id="__span-177-9"><a id="__codelineno-177-9" name="__codelineno-177-9" href="#__codelineno-177-9"></a>    <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;radio&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;a1&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;NA&quot;</span> <span class="err">{%</span> <span class="na">if</span> <span class="na">post</span><span class="err">.</span><span class="na">pre_production_a1 </span><span class="o">=</span><span class="s">=</span> <span class="err">&#39;</span><span class="na">NA</span><span class="err">&#39;</span> <span class="err">%}</span><span class="na">checked</span><span class="err">{%</span> <span class="na">endif</span> <span class="err">%}</span><span class="p">&gt;</span>NA<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span><span id="__span-177-10"><a id="__codelineno-177-10" name="__codelineno-177-10" href="#__codelineno-177-10"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-177-11"><a id="__codelineno-177-11" name="__codelineno-177-11" href="#__codelineno-177-11"></a>
</span><span id="__span-177-12"><a id="__codelineno-177-12" name="__codelineno-177-12" href="#__codelineno-177-12"></a>{% if post.a1_text %}
</span><span id="__span-177-13"><a id="__codelineno-177-13" name="__codelineno-177-13" href="#__codelineno-177-13"></a><span class="p">&lt;</span><span class="nt">textarea</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;a1_text&quot;</span> <span class="na">rows</span><span class="o">=</span><span class="s">&quot;2&quot;</span><span class="p">&gt;</span>{{ post.a1_text }}<span class="p">&lt;/</span><span class="nt">textarea</span><span class="p">&gt;</span>
</span><span id="__span-177-14"><a id="__codelineno-177-14" name="__codelineno-177-14" href="#__codelineno-177-14"></a>{% else %}
</span><span id="__span-177-15"><a id="__codelineno-177-15" name="__codelineno-177-15" href="#__codelineno-177-15"></a><span class="p">&lt;</span><span class="nt">textarea</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;a1_text&quot;</span> <span class="na">rows</span><span class="o">=</span><span class="s">&quot;2&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">textarea</span><span class="p">&gt;</span>
</span><span id="__span-177-16"><a id="__codelineno-177-16" name="__codelineno-177-16" href="#__codelineno-177-16"></a>{% endif %}
</span></code></pre></div>
<p>复制一条数据</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-178-1"><a id="__codelineno-178-1" name="__codelineno-178-1" href="#__codelineno-178-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">qsa_copy</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
</span><span id="__span-178-2"><a id="__codelineno-178-2" name="__codelineno-178-2" href="#__codelineno-178-2"></a>    <span class="c1"># 获取原始对象</span>
</span><span id="__span-178-3"><a id="__codelineno-178-3" name="__codelineno-178-3" href="#__codelineno-178-3"></a>    <span class="n">original_post</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Post</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span>
</span><span id="__span-178-4"><a id="__codelineno-178-4" name="__codelineno-178-4" href="#__codelineno-178-4"></a>    <span class="c1"># 将对象转换为字典</span>
</span><span id="__span-178-5"><a id="__codelineno-178-5" name="__codelineno-178-5" href="#__codelineno-178-5"></a>    <span class="n">post_data</span> <span class="o">=</span> <span class="n">model_to_dict</span><span class="p">(</span><span class="n">original_post</span><span class="p">)</span>
</span><span id="__span-178-6"><a id="__codelineno-178-6" name="__codelineno-178-6" href="#__codelineno-178-6"></a>    <span class="c1"># 移除主键字段以避免冲突</span>
</span><span id="__span-178-7"><a id="__codelineno-178-7" name="__codelineno-178-7" href="#__codelineno-178-7"></a>    <span class="n">post_data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-178-8"><a id="__codelineno-178-8" name="__codelineno-178-8" href="#__codelineno-178-8"></a>    <span class="c1"># 创建新对象</span>
</span><span id="__span-178-9"><a id="__codelineno-178-9" name="__codelineno-178-9" href="#__codelineno-178-9"></a>    <span class="n">new_post</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="o">**</span><span class="n">post_data</span><span class="p">)</span>
</span><span id="__span-178-10"><a id="__codelineno-178-10" name="__codelineno-178-10" href="#__codelineno-178-10"></a>    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;qsa_edit&#39;</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">new_post</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-179-1"><a id="__codelineno-179-1" name="__codelineno-179-1" href="#__codelineno-179-1"></a>python<span class="w"> </span>manage.py<span class="w"> </span>makemigrations<span class="w">  </span><span class="c1"># 生成迁移文件</span>
</span><span id="__span-179-2"><a id="__codelineno-179-2" name="__codelineno-179-2" href="#__codelineno-179-2"></a>python<span class="w"> </span>manage.py<span class="w"> </span>migrate<span class="w">         </span><span class="c1"># 应用迁移到数据库</span>
</span></code></pre></div>
<p>如果迁移出问题，可以尝试删除migrations文件夹下除__init__.py的其他文件如0001_initial.py，再重新迁移。仍然不行可以尝试删除数据库文件再迁移</p>
<p>关于文件的说明和优化方案：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-180-1"><a id="__codelineno-180-1" name="__codelineno-180-1" href="#__codelineno-180-1"></a><span class="c1"># 按照年月日创建文件夹：upload_to=&#39;uploads/%Y/%m/%d/&#39;</span>
</span><span id="__span-180-2"><a id="__codelineno-180-2" name="__codelineno-180-2" href="#__codelineno-180-2"></a>
</span><span id="__span-180-3"><a id="__codelineno-180-3" name="__codelineno-180-3" href="#__codelineno-180-3"></a><span class="c1"># 按用户ID分目录：upload_to=user_upload_path</span>
</span><span id="__span-180-4"><a id="__codelineno-180-4" name="__codelineno-180-4" href="#__codelineno-180-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">user_upload_path</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="__span-180-5"><a id="__codelineno-180-5" name="__codelineno-180-5" href="#__codelineno-180-5"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;uploads/user_</span><span class="si">{</span><span class="n">instance</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="__span-180-6"><a id="__codelineno-180-6" name="__codelineno-180-6" href="#__codelineno-180-6"></a>
</span><span id="__span-180-7"><a id="__codelineno-180-7" name="__codelineno-180-7" href="#__codelineno-180-7"></a><span class="c1"># 哈希文件名： upload_to=hash_filename</span>
</span><span id="__span-180-8"><a id="__codelineno-180-8" name="__codelineno-180-8" href="#__codelineno-180-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
</span><span id="__span-180-9"><a id="__codelineno-180-9" name="__codelineno-180-9" href="#__codelineno-180-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">hash_filename</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="__span-180-10"><a id="__codelineno-180-10" name="__codelineno-180-10" href="#__codelineno-180-10"></a>    <span class="n">ext</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-180-11"><a id="__codelineno-180-11" name="__codelineno-180-11" href="#__codelineno-180-11"></a>    <span class="n">hash_name</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()[:</span><span class="mi">8</span><span class="p">]</span>
</span><span id="__span-180-12"><a id="__codelineno-180-12" name="__codelineno-180-12" href="#__codelineno-180-12"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;files/</span><span class="si">{</span><span class="n">hash_name</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="__span-180-13"><a id="__codelineno-180-13" name="__codelineno-180-13" href="#__codelineno-180-13"></a>
</span><span id="__span-180-14"><a id="__codelineno-180-14" name="__codelineno-180-14" href="#__codelineno-180-14"></a><span class="c1"># 按年+哈希：uploads/2024/abc123de.jpg</span>
</span><span id="__span-180-15"><a id="__codelineno-180-15" name="__codelineno-180-15" href="#__codelineno-180-15"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">timezone</span>
</span><span id="__span-180-16"><a id="__codelineno-180-16" name="__codelineno-180-16" href="#__codelineno-180-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">smart_upload_path</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span> 
</span><span id="__span-180-17"><a id="__codelineno-180-17" name="__codelineno-180-17" href="#__codelineno-180-17"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;uploads/</span><span class="si">{</span><span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()[:</span><span class="mi">6</span><span class="p">]</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
</span></code></pre></div>
<p>默认使用db.sqlite3数据库文件作为数据库
在settings.py 文件中找到 DATABASES 配置项可以修改</p>
<p>如果需要使用mysql 数据库：
安装 mysql
创建 MySQL 数据库 <code>create database 数据库名称 default charset=utf8;</code>( ORM 无法操作到数据库级别，只能操作到数据表)
修改DATABASES为</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-181-1"><a id="__codelineno-181-1" name="__codelineno-181-1" href="#__codelineno-181-1"></a><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span> 
</span><span id="__span-181-2"><a id="__codelineno-181-2" name="__codelineno-181-2" href="#__codelineno-181-2"></a>    <span class="s1">&#39;default&#39;</span><span class="p">:</span> 
</span><span id="__span-181-3"><a id="__codelineno-181-3" name="__codelineno-181-3" href="#__codelineno-181-3"></a>    <span class="p">{</span> 
</span><span id="__span-181-4"><a id="__codelineno-181-4" name="__codelineno-181-4" href="#__codelineno-181-4"></a>        <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;django.db.backends.mysql&#39;</span><span class="p">,</span>    <span class="c1"># 数据库引擎</span>
</span><span id="__span-181-5"><a id="__codelineno-181-5" name="__codelineno-181-5" href="#__codelineno-181-5"></a>        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="c1"># 数据库名称</span>
</span><span id="__span-181-6"><a id="__codelineno-181-6" name="__codelineno-181-6" href="#__codelineno-181-6"></a>        <span class="s1">&#39;HOST&#39;</span><span class="p">:</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="c1"># 数据库地址，本机 ip 地址 127.0.0.1 </span>
</span><span id="__span-181-7"><a id="__codelineno-181-7" name="__codelineno-181-7" href="#__codelineno-181-7"></a>        <span class="s1">&#39;PORT&#39;</span><span class="p">:</span> <span class="mi">3306</span><span class="p">,</span> <span class="c1"># 端口 </span>
</span><span id="__span-181-8"><a id="__codelineno-181-8" name="__codelineno-181-8" href="#__codelineno-181-8"></a>        <span class="s1">&#39;USER&#39;</span><span class="p">:</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>  <span class="c1"># 数据库用户名</span>
</span><span id="__span-181-9"><a id="__codelineno-181-9" name="__codelineno-181-9" href="#__codelineno-181-9"></a>        <span class="s1">&#39;PASSWORD&#39;</span><span class="p">:</span> <span class="s1">&#39;123456&#39;</span><span class="p">,</span> <span class="c1"># 数据库密码</span>
</span><span id="__span-181-10"><a id="__codelineno-181-10" name="__codelineno-181-10" href="#__codelineno-181-10"></a>    <span class="p">}</span>  
</span><span id="__span-181-11"><a id="__codelineno-181-11" name="__codelineno-181-11" href="#__codelineno-181-11"></a><span class="p">}</span>
</span></code></pre></div>
<p>安装mysqlclient驱动 <code>pip install mysqlclient</code>即可
如果安装pymysql驱动 <code>pip install pymysql</code>，需要告诉 Django 使用 pymysql 模块连接 mysql 数据库：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-182-1"><a id="__codelineno-182-1" name="__codelineno-182-1" href="#__codelineno-182-1"></a><span class="c1"># 在与 settings.py 同级目录下的 __init__.py 中引入模块和进行配置  </span>
</span><span id="__span-182-2"><a id="__codelineno-182-2" name="__codelineno-182-2" href="#__codelineno-182-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pymysql</span>  
</span><span id="__span-182-3"><a id="__codelineno-182-3" name="__codelineno-182-3" href="#__codelineno-182-3"></a><span class="n">pymysql</span><span class="o">.</span><span class="n">install_as_MySQLdb</span><span class="p">()</span>
</span></code></pre></div>
<p><strong>配置视图（View）</strong>
在 <code>views.py</code> 中处理业务逻辑</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-183-1"><a id="__codelineno-183-1" name="__codelineno-183-1" href="#__codelineno-183-1"></a><span class="c1"># from django.http import HttpResponse</span>
</span><span id="__span-183-2"><a id="__codelineno-183-2" name="__codelineno-183-2" href="#__codelineno-183-2"></a><span class="c1"># def index(request):</span>
</span><span id="__span-183-3"><a id="__codelineno-183-3" name="__codelineno-183-3" href="#__codelineno-183-3"></a><span class="c1">#     return HttpResponse(&quot;Hello, world.&quot;)</span>
</span><span id="__span-183-4"><a id="__codelineno-183-4" name="__codelineno-183-4" href="#__codelineno-183-4"></a>
</span><span id="__span-183-5"><a id="__codelineno-183-5" name="__codelineno-183-5" href="#__codelineno-183-5"></a><span class="c1"># from django.shortcuts import render</span>
</span><span id="__span-183-6"><a id="__codelineno-183-6" name="__codelineno-183-6" href="#__codelineno-183-6"></a><span class="c1"># def index(request):</span>
</span><span id="__span-183-7"><a id="__codelineno-183-7" name="__codelineno-183-7" href="#__codelineno-183-7"></a><span class="c1">#     return render(request, &#39;index.html&#39;)</span>
</span><span id="__span-183-8"><a id="__codelineno-183-8" name="__codelineno-183-8" href="#__codelineno-183-8"></a>
</span><span id="__span-183-9"><a id="__codelineno-183-9" name="__codelineno-183-9" href="#__codelineno-183-9"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span>
</span><span id="__span-183-10"><a id="__codelineno-183-10" name="__codelineno-183-10" href="#__codelineno-183-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Post</span>
</span><span id="__span-183-11"><a id="__codelineno-183-11" name="__codelineno-183-11" href="#__codelineno-183-11"></a>
</span><span id="__span-183-12"><a id="__codelineno-183-12" name="__codelineno-183-12" href="#__codelineno-183-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">post_list</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span id="__span-183-13"><a id="__codelineno-183-13" name="__codelineno-183-13" href="#__codelineno-183-13"></a>    <span class="n">posts</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="__span-183-14"><a id="__codelineno-183-14" name="__codelineno-183-14" href="#__codelineno-183-14"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;blog/post_list.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;posts&#39;</span><span class="p">:</span> <span class="n">posts</span><span class="p">})</span>
</span></code></pre></div>
<p>HttpResponse
render渲染
redirect后端重定向</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>字段属性</td>
<td>模型中定义的字段（如 CharField, ForeignKey 等）。</td>
</tr>
<tr>
<td>Meta 类</td>
<td>定义模型的元数据（如数据库表名、排序规则等）。</td>
</tr>
<tr>
<td>objects</td>
<td>默认的模型管理器（用于数据库查询，如 Post.objects.all()）。</td>
</tr>
<tr>
<td>pk</td>
<td>主键的快捷访问方式（如 post.pk 对应 post.id）。</td>
</tr>
<tr>
<td>_meta</td>
<td>提供模型的元信息（如字段列表、关联关系等）。</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>实例方法</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>save(**kwargs)</td>
<td>保存对象到数据库（新建或更新）。</td>
</tr>
<tr>
<td>delete(**kwargs)</td>
<td>从数据库删除对象。</td>
</tr>
<tr>
<td>refresh_from_db(fields=None)</td>
<td>从数据库重新加载对象的最新数据。</td>
</tr>
<tr>
<td>clean()</td>
<td>自定义数据验证逻辑（需手动调用或通过 full_clean() 触发）。</td>
</tr>
<tr>
<td>full_clean()</td>
<td>执行完整验证（字段验证、clean() 方法、唯一性检查）。</td>
</tr>
<tr>
<td>get_FOO_display()</td>
<td>获取 choices 字段的可读值（FOO 为字段名，如 get_status_display()）。</td>
</tr>
<tr>
<td>get_absolute_url()</td>
<td>定义对象的详情页 URL（常用于模板或重定向）。</td>
</tr>
<tr>
<td><code>__str__()</code></td>
<td>定义对象的字符串表示（用于控制台、Admin 界面等）。</td>
</tr>
</tbody>
</table>
<p>post.save()
post.delete()</p>
<table>
<thead>
<tr>
<th>类方法</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>objects.all()</td>
<td>返回所有对象的 QuerySet。</td>
</tr>
<tr>
<td>objects.filter(**kwargs)</td>
<td>返回符合条件的 QuerySet（如 Post.objects.filter(author=user)。</td>
</tr>
<tr>
<td>objects.get(**kwargs)</td>
<td>返回单个对象（找不到或找到多个时抛异常）。</td>
</tr>
<tr>
<td>objects.create(**kwargs)</td>
<td>创建并保存新对象（等价于 Model().save()）。</td>
</tr>
<tr>
<td>objects.update(**kwargs)</td>
<td>批量更新符合条件的对象。</td>
</tr>
<tr>
<td>objects.order_by(*fields)</td>
<td>对查询结果排序（如 Post.objects.order_by('-created_at')。</td>
</tr>
</tbody>
</table>
<p><code>post =Post.objects.all()</code>返回数据库中所有 <code>Post</code> 对象
<code>post =get_object_or_404(Post, pk=pk)</code>返回主键（<code>pk</code>）匹配的唯一一个对象,若对象不存在则返回 404 页面
<code>post =Post.objects.filter(id__in=post_ids)</code>返回 <code>id</code> 在 <code>post_ids</code> 列表中的所有对象</p>
<p>html <code>action="{% url 'submit_form' %}"</code>：指定表单提交到Django的 <code>submit_form</code>路由，不指定默认提交当前路由</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-184-1"><a id="__codelineno-184-1" name="__codelineno-184-1" href="#__codelineno-184-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">form_submit</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span id="__span-184-2"><a id="__codelineno-184-2" name="__codelineno-184-2" href="#__codelineno-184-2"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
</span><span id="__span-184-3"><a id="__codelineno-184-3" name="__codelineno-184-3" href="#__codelineno-184-3"></a>        <span class="c1"># 处理数据...</span>
</span><span id="__span-184-4"><a id="__codelineno-184-4" name="__codelineno-184-4" href="#__codelineno-184-4"></a>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">)</span>  <span class="c1"># 使用URL命名</span>
</span><span id="__span-184-5"><a id="__codelineno-184-5" name="__codelineno-184-5" href="#__codelineno-184-5"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;form.html&#39;</span><span class="p">)</span>
</span><span id="__span-184-6"><a id="__codelineno-184-6" name="__codelineno-184-6" href="#__codelineno-184-6"></a>
</span><span id="__span-184-7"><a id="__codelineno-184-7" name="__codelineno-184-7" href="#__codelineno-184-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">success_page</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span id="__span-184-8"><a id="__codelineno-184-8" name="__codelineno-184-8" href="#__codelineno-184-8"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;success.html&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p>获取单个值：request.POST.get('键')
获取多选框/多选列表的值（返回列表）：request.POST.getlist('键')</p>
<p>网页动态化（<strong>模板</strong>）：
需要向Django说明模板文件的路径
一般可以创建一个文件夹存放templates模板，然后修改settings.py中的 TEMPLATES 中的 DIRS 为 <code>[os.path.join(BASE_DIR, 'templates')]</code>
(BASE_DIR是项目根目录，也可以使用相对路径直接 <code>['templates']</code>)</p>
<p>在view.py中：返回一个字典 <code>{'HTML变量名':views变量名}</code></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-185-1"><a id="__codelineno-185-1" name="__codelineno-185-1" href="#__codelineno-185-1"></a>    <span class="n">views_name</span> <span class="o">=</span> <span class="s1">&#39;Django&#39;</span>
</span><span id="__span-185-2"><a id="__codelineno-185-2" name="__codelineno-185-2" href="#__codelineno-185-2"></a>    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-185-3"><a id="__codelineno-185-3" name="__codelineno-185-3" href="#__codelineno-185-3"></a>        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">views_name</span><span class="p">,</span>
</span><span id="__span-185-4"><a id="__codelineno-185-4" name="__codelineno-185-4" href="#__codelineno-185-4"></a>        <span class="s1">&#39;views_list&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</span><span id="__span-185-5"><a id="__codelineno-185-5" name="__codelineno-185-5" href="#__codelineno-185-5"></a>    <span class="p">}</span>
</span><span id="__span-185-6"><a id="__codelineno-185-6" name="__codelineno-185-6" href="#__codelineno-185-6"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;index.html&#39;</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</span></code></pre></div>
<p>HTML：<code>{{ 变量名 }}</code></p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-186-1"><a id="__codelineno-186-1" name="__codelineno-186-1" href="#__codelineno-186-1"></a><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ name }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>如果 <code>views_name</code>是列表，可以用 <code>.</code>  索引下标取出对应的元素，如 <code>views_name.0</code>
如果 <code>views_name</code>是列表，可以用 <code>.</code>  键标取出对应的元素，如 <code>views_name.name</code></p>
<p>在 Django 模板中直接访问以下划线开头的属性（如 <code>post._meta.fields</code>）会触发 <code>TemplateSyntaxError</code>，因为 Django 模板系统出于安全考虑禁止访问这类内部属性。
可以在views中获取模型字段信息，再传递给模板。</p>
<p>==模板过滤器==可以在变量被显示前修改它：<code>{{ 变量名 | 过滤器:可选参数 }}</code>，过滤器可以套接</p>
<ul>
<li><code>add</code>：将一个值加到变量上。<code>{{ forloop.counter|add:10 }}</code></li>
<li><code>default</code>：如果变量为空或不存在，则返回默认值。<code>{{ variable|default:"默认值" }}</code></li>
<li><code>length</code>：返回变量的长度。
  <code>{{ my_list|length }}</code></li>
<li><code>lower</code>：将字符串转换为小写。</li>
</ul>
<p><code>{{ "HELLO"|lower }}</code>
- <code>upper</code>：将字符串转换为大写。</p>
<p><code>{{ "hello"|upper }}</code>
- <code>truncatechars</code>：截断字符串到指定字符数，并添加省略号。</p>
<p>{{ "This is a long text"|truncatechars:10 }}
- <code>title</code>：将字符串转换为标题格式（每个单词首字母大写）。</p>
<p>{{ "hello world"|title }}
- <code>date</code>：格式化日期。</p>
<p>{{ my_date|date:"Y-m-d" }}
- <code>time</code>：格式化时间。</p>
<p>{{ my_time|time:"H:i:s" }}
- <code>timesince</code>：返回从某个时间到现在的时间间隔。</p>
<p>{{ my_date|timesince }}
- <code>first</code>：返回列表的第一个元素。</p>
<p>{{ my_list|first }}
- <code>last</code>：返回列表的最后一个元素。</p>
<p>{{ my_list|last }}
- <code>slice</code>：对列表进行切片。</p>
<p>{{ my_list|slice:":3" }}
- <code>dictsort</code>：根据字典的某个键对列表排序。</p>
<p>{{ my_dict_list|dictsort:"key_name" }}
- <code>yesno</code>：根据布尔值返回自定义的文本。</p>
<p>{{ is_active|yesno:"是,否,未知" }}
- <code>default_if_none</code>：如果变量为 <code>None</code>，返回默认值。</p>
<p>{{ variable|default_if_none:"无数据" }}
- <code>escape</code>：对字符串进行 HTML 转义。</p>
<p><code>{{ "&lt;script&gt;"|escape }}</code>
- <code>safe</code>：标记字符串为安全的 HTML，不会被转义。</p>
<p><code>{{ "&lt;b&gt;bold&lt;/b&gt;"|safe }}</code>
- <code>linebreaks</code>：将换行符转换为 <code>&lt;br&gt;</code> 标签。</p>
<p>{{ "Line1\nLine2"|linebreaks }}
- <code>floatformat</code>：格式化浮点数。</p>
<p>{{ 3.14159|floatformat:2 }}
- <code>addslashes</code>：为字符串添加反斜杠。</p>
<p>{{ "O'Reilly"|addslashes }}
- <code>filesizeformat</code>：格式化文件大小。</p>
<p>{{ file.size|filesizeformat }}
- <code>urlencode</code>：对字符串进行 URL 编码。</p>
<p>{{ "Hello World"|urlencode }}</p>
<p><strong>自定义过滤器</strong></p>
<p>如果内置过滤器无法满足需求，可以创建自定义过滤器。示例：</p>
<p>在 templatetags 文件夹中创建自定义过滤器</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-187-1"><a id="__codelineno-187-1" name="__codelineno-187-1" href="#__codelineno-187-1"></a><span class="c1"># 在 templatetags 文件夹中创建自定义过滤器</span>
</span><span id="__span-187-2"><a id="__codelineno-187-2" name="__codelineno-187-2" href="#__codelineno-187-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django</span><span class="w"> </span><span class="kn">import</span> <span class="n">template</span>
</span><span id="__span-187-3"><a id="__codelineno-187-3" name="__codelineno-187-3" href="#__codelineno-187-3"></a>
</span><span id="__span-187-4"><a id="__codelineno-187-4" name="__codelineno-187-4" href="#__codelineno-187-4"></a><span class="n">register</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">Library</span><span class="p">()</span>
</span><span id="__span-187-5"><a id="__codelineno-187-5" name="__codelineno-187-5" href="#__codelineno-187-5"></a>
</span><span id="__span-187-6"><a id="__codelineno-187-6" name="__codelineno-187-6" href="#__codelineno-187-6"></a><span class="nd">@register</span><span class="o">.</span><span class="n">filter</span>
</span><span id="__span-187-7"><a id="__codelineno-187-7" name="__codelineno-187-7" href="#__codelineno-187-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">multiply</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
</span><span id="__span-187-8"><a id="__codelineno-187-8" name="__codelineno-187-8" href="#__codelineno-187-8"></a>    <span class="k">return</span> <span class="n">value</span> <span class="o">*</span> <span class="n">arg</span>
</span><span id="__span-187-9"><a id="__codelineno-187-9" name="__codelineno-187-9" href="#__codelineno-187-9"></a>
</span><span id="__span-187-10"><a id="__codelineno-187-10" name="__codelineno-187-10" href="#__codelineno-187-10"></a><span class="c1"># 在模板中使用：{{ 5|multiply:3 }}</span>
</span></code></pre></div>
<p>注释标签：{# 这是一个注释 #}
==if/else 标签==
支持嵌套，接受 and 、 or 、 not 关键字</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-188-1"><a id="__codelineno-188-1" name="__codelineno-188-1" href="#__codelineno-188-1"></a>{% if condition1 %}
</span><span id="__span-188-2"><a id="__codelineno-188-2" name="__codelineno-188-2" href="#__codelineno-188-2"></a>   ... display 1
</span><span id="__span-188-3"><a id="__codelineno-188-3" name="__codelineno-188-3" href="#__codelineno-188-3"></a>{% elif condition2 %}
</span><span id="__span-188-4"><a id="__codelineno-188-4" name="__codelineno-188-4" href="#__codelineno-188-4"></a>   ... display 2
</span><span id="__span-188-5"><a id="__codelineno-188-5" name="__codelineno-188-5" href="#__codelineno-188-5"></a>{% else %}
</span><span id="__span-188-6"><a id="__codelineno-188-6" name="__codelineno-188-6" href="#__codelineno-188-6"></a>   ... display 3
</span><span id="__span-188-7"><a id="__codelineno-188-7" name="__codelineno-188-7" href="#__codelineno-188-7"></a>{% endif %}
</span></code></pre></div>
<p>==for 标签==
{% for %} 允许我们在一个序列上迭代。给标签增加一个 reversed 使得该列表被反向迭代</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-189-1"><a id="__codelineno-189-1" name="__codelineno-189-1" href="#__codelineno-189-1"></a>{% for athlete in athlete_list %}
</span><span id="__span-189-2"><a id="__codelineno-189-2" name="__codelineno-189-2" href="#__codelineno-189-2"></a>{# % for athlete in athlete_list reversed % #}
</span><span id="__span-189-3"><a id="__codelineno-189-3" name="__codelineno-189-3" href="#__codelineno-189-3"></a>    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>{{ athlete.name }}<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span><span id="__span-189-4"><a id="__codelineno-189-4" name="__codelineno-189-4" href="#__codelineno-189-4"></a>{% endfor %}
</span></code></pre></div>
<p>遍历字典可以 <code>{% for i,j in views_dict.items %}</code> 得到键和值
在 {% for %} 标签里可以通过 {{forloop}} 变量获取循环序号
可选的 {% empty %} 从句：在循环为空的时候执行</p>
<p><code>{{ forloop.counter }}</code> 输出当前循环迭代的计数器值，从 1 开始计数。</p>
<p>==include 标签==
{% include %} 标签允许在模板中包含其它的模板的内容。
<code>{% include "nav.html" %}</code></p>
<p>csrf_token 用于form表单中，作用是跨站请求伪造保护。
如果不用 <code>{% csrf_token %}</code> 标签，在用 form 表单时，要再次跳转页面会报 403 权限错误。</p>
<p>在模板文件的顶部添加 <code>{% load static %}</code>，如果有继承在 <code>{% extends 'base.html' %}</code>之后添加
然后通过静态文件夹在Django模板中引用CSS样式/js
<code>&lt;link rel="stylesheet" href="{% static 'css/styles.css' %}"&gt;</code></p>
<p>可以自定义标签和过滤器</p>
<p>==模板继承==
模板可以用继承的方式来实现复用，减少冗余内容。
网页的头部和尾部内容一般都是一致的，我们就可以通过模板继承来实现复用。
父模板用于放置可重复利用的内容，子模板继承父模板的内容，并放置自己的内容。
通常 <code>{% extends "base.html" %}</code>统一网页结构</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-190-1"><a id="__codelineno-190-1" name="__codelineno-190-1" href="#__codelineno-190-1"></a>{% block 名称 %} 
</span><span id="__span-190-2"><a id="__codelineno-190-2" name="__codelineno-190-2" href="#__codelineno-190-2"></a>预留给子模板的区域，可以设置设置默认内容
</span><span id="__span-190-3"><a id="__codelineno-190-3" name="__codelineno-190-3" href="#__codelineno-190-3"></a>{% endblock 名称 %}
</span></code></pre></div>
<div class="language-html highlight"><pre><span></span><code><span id="__span-191-1"><a id="__codelineno-191-1" name="__codelineno-191-1" href="#__codelineno-191-1"></a>{% extends &quot;父模板路径&quot;%}
</span><span id="__span-191-2"><a id="__codelineno-191-2" name="__codelineno-191-2" href="#__codelineno-191-2"></a>
</span><span id="__span-191-3"><a id="__codelineno-191-3" name="__codelineno-191-3" href="#__codelineno-191-3"></a>{% block 名称 %}
</span><span id="__span-191-4"><a id="__codelineno-191-4" name="__codelineno-191-4" href="#__codelineno-191-4"></a>内容 
</span><span id="__span-191-5"><a id="__codelineno-191-5" name="__codelineno-191-5" href="#__codelineno-191-5"></a>{% endblock 名称 %}
</span></code></pre></div>
<div class="language-html highlight"><pre><span></span><code><span id="__span-192-1"><a id="__codelineno-192-1" name="__codelineno-192-1" href="#__codelineno-192-1"></a><span class="cm">&lt;!-- blog/post_list.html --&gt;</span>
</span><span id="__span-192-2"><a id="__codelineno-192-2" name="__codelineno-192-2" href="#__codelineno-192-2"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span id="__span-192-3"><a id="__codelineno-192-3" name="__codelineno-192-3" href="#__codelineno-192-3"></a><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span><span id="__span-192-4"><a id="__codelineno-192-4" name="__codelineno-192-4" href="#__codelineno-192-4"></a><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span><span id="__span-192-5"><a id="__codelineno-192-5" name="__codelineno-192-5" href="#__codelineno-192-5"></a>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>帖子列表<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span><span id="__span-192-6"><a id="__codelineno-192-6" name="__codelineno-192-6" href="#__codelineno-192-6"></a><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span><span id="__span-192-7"><a id="__codelineno-192-7" name="__codelineno-192-7" href="#__codelineno-192-7"></a><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span><span id="__span-192-8"><a id="__codelineno-192-8" name="__codelineno-192-8" href="#__codelineno-192-8"></a>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>所有帖子<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span><span id="__span-192-9"><a id="__codelineno-192-9" name="__codelineno-192-9" href="#__codelineno-192-9"></a>
</span><span id="__span-192-10"><a id="__codelineno-192-10" name="__codelineno-192-10" href="#__codelineno-192-10"></a>    {% for post in posts %}
</span><span id="__span-192-11"><a id="__codelineno-192-11" name="__codelineno-192-11" href="#__codelineno-192-11"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;border: 1px solid #ccc; padding: 10px; margin-bottom: 20px;&quot;</span><span class="p">&gt;</span>
</span><span id="__span-192-12"><a id="__codelineno-192-12" name="__codelineno-192-12" href="#__codelineno-192-12"></a>            <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>{{ post.title }}<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
</span><span id="__span-192-13"><a id="__codelineno-192-13" name="__codelineno-192-13" href="#__codelineno-192-13"></a>            <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ post.content }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span><span id="__span-192-14"><a id="__codelineno-192-14" name="__codelineno-192-14" href="#__codelineno-192-14"></a>            <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>创建时间：{{ post.created_at }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span><span id="__span-192-15"><a id="__codelineno-192-15" name="__codelineno-192-15" href="#__codelineno-192-15"></a>
</span><span id="__span-192-16"><a id="__codelineno-192-16" name="__codelineno-192-16" href="#__codelineno-192-16"></a>            {% if post.file %}
</span><span id="__span-192-17"><a id="__codelineno-192-17" name="__codelineno-192-17" href="#__codelineno-192-17"></a>                <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>附件：
</span><span id="__span-192-18"><a id="__codelineno-192-18" name="__codelineno-192-18" href="#__codelineno-192-18"></a>                    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ post.file.url }}&quot;</span> <span class="na">target</span><span class="o">=</span><span class="s">&quot;_blank&quot;</span><span class="p">&gt;</span>
</span><span id="__span-192-19"><a id="__codelineno-192-19" name="__codelineno-192-19" href="#__codelineno-192-19"></a>                        {{ post.file.name|cut:&quot;uploads/&quot; }}
</span><span id="__span-192-20"><a id="__codelineno-192-20" name="__codelineno-192-20" href="#__codelineno-192-20"></a>                    <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span><span id="__span-192-21"><a id="__codelineno-192-21" name="__codelineno-192-21" href="#__codelineno-192-21"></a>                <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span><span id="__span-192-22"><a id="__codelineno-192-22" name="__codelineno-192-22" href="#__codelineno-192-22"></a>            {% endif %}
</span><span id="__span-192-23"><a id="__codelineno-192-23" name="__codelineno-192-23" href="#__codelineno-192-23"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-192-24"><a id="__codelineno-192-24" name="__codelineno-192-24" href="#__codelineno-192-24"></a>    {% endfor %}
</span><span id="__span-192-25"><a id="__codelineno-192-25" name="__codelineno-192-25" href="#__codelineno-192-25"></a>
</span><span id="__span-192-26"><a id="__codelineno-192-26" name="__codelineno-192-26" href="#__codelineno-192-26"></a>    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;create_post&#39; %}&quot;</span><span class="p">&gt;</span>新建帖子<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span><span id="__span-192-27"><a id="__codelineno-192-27" name="__codelineno-192-27" href="#__codelineno-192-27"></a><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span><span id="__span-192-28"><a id="__codelineno-192-28" name="__codelineno-192-28" href="#__codelineno-192-28"></a><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></code></pre></div>
<p><strong>配置路由（URL）</strong>
项目路由（<code>myproject/urls.py</code>）：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-193-1"><a id="__codelineno-193-1" name="__codelineno-193-1" href="#__codelineno-193-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib</span><span class="w"> </span><span class="kn">import</span> <span class="n">admin</span>
</span><span id="__span-193-2"><a id="__codelineno-193-2" name="__codelineno-193-2" href="#__codelineno-193-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">path</span>
</span><span id="__span-193-3"><a id="__codelineno-193-3" name="__codelineno-193-3" href="#__codelineno-193-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">myapp</span><span class="w"> </span><span class="kn">import</span> <span class="n">views</span>
</span><span id="__span-193-4"><a id="__codelineno-193-4" name="__codelineno-193-4" href="#__codelineno-193-4"></a>
</span><span id="__span-193-5"><a id="__codelineno-193-5" name="__codelineno-193-5" href="#__codelineno-193-5"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-193-6"><a id="__codelineno-193-6" name="__codelineno-193-6" href="#__codelineno-193-6"></a>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
</span><span id="__span-193-7"><a id="__codelineno-193-7" name="__codelineno-193-7" href="#__codelineno-193-7"></a>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;blog/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">post_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;post_list&#39;</span><span class="p">),</span>
</span><span id="__span-193-8"><a id="__codelineno-193-8" name="__codelineno-193-8" href="#__codelineno-193-8"></a><span class="p">]</span>
</span></code></pre></div>
<p>name用于url  ''</p>
<p>配置路由还可以使用应用路由的方式：
在app目录下新建 <code>urls.py</code></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-194-1"><a id="__codelineno-194-1" name="__codelineno-194-1" href="#__codelineno-194-1"></a><span class="c1"># blog/urls.py</span>
</span><span id="__span-194-2"><a id="__codelineno-194-2" name="__codelineno-194-2" href="#__codelineno-194-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span>
</span><span id="__span-194-3"><a id="__codelineno-194-3" name="__codelineno-194-3" href="#__codelineno-194-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">views</span>
</span><span id="__span-194-4"><a id="__codelineno-194-4" name="__codelineno-194-4" href="#__codelineno-194-4"></a>
</span><span id="__span-194-5"><a id="__codelineno-194-5" name="__codelineno-194-5" href="#__codelineno-194-5"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-194-6"><a id="__codelineno-194-6" name="__codelineno-194-6" href="#__codelineno-194-6"></a>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">post_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;post_list&#39;</span><span class="p">),</span>
</span><span id="__span-194-7"><a id="__codelineno-194-7" name="__codelineno-194-7" href="#__codelineno-194-7"></a><span class="p">]</span>
</span><span id="__span-194-8"><a id="__codelineno-194-8" name="__codelineno-194-8" href="#__codelineno-194-8"></a>
</span><span id="__span-194-9"><a id="__codelineno-194-9" name="__codelineno-194-9" href="#__codelineno-194-9"></a><span class="c1"># myproject/urls.py</span>
</span><span id="__span-194-10"><a id="__codelineno-194-10" name="__codelineno-194-10" href="#__codelineno-194-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">path</span>
</span><span id="__span-194-11"><a id="__codelineno-194-11" name="__codelineno-194-11" href="#__codelineno-194-11"></a>
</span><span id="__span-194-12"><a id="__codelineno-194-12" name="__codelineno-194-12" href="#__codelineno-194-12"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-194-13"><a id="__codelineno-194-13" name="__codelineno-194-13" href="#__codelineno-194-13"></a>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;blog/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;blog.urls&#39;</span><span class="p">)),</span>
</span><span id="__span-194-14"><a id="__codelineno-194-14" name="__codelineno-194-14" href="#__codelineno-194-14"></a><span class="p">]</span>
</span></code></pre></div>
<p><strong>Admin 管理工具</strong>Django 提供了基于 web 的管理工具。
可以通过命令 <code>python manage.py createsuperuser</code> 创建超级用户(需要先应用迁移到数据库)
在浏览器中访问 <code>http://127.0.0.1:8000/admin</code>，输入用户名密码登录(lain       lain123456)</p>
<p>修改settings文件，可改为中文</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-195-1"><a id="__codelineno-195-1" name="__codelineno-195-1" href="#__codelineno-195-1"></a><span class="n">LANGUAGE_CODE</span> <span class="o">=</span> <span class="s1">&#39;zh-Hans&#39;</span>
</span><span id="__span-195-2"><a id="__codelineno-195-2" name="__codelineno-195-2" href="#__codelineno-195-2"></a>
</span><span id="__span-195-3"><a id="__codelineno-195-3" name="__codelineno-195-3" href="#__codelineno-195-3"></a><span class="n">TIME_ZONE</span> <span class="o">=</span> <span class="s1">&#39;Asia/Shanghai&#39;</span>
</span></code></pre></div>
<p>注册模型到 Admin（<code>blog/admin.py</code>）</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-196-1"><a id="__codelineno-196-1" name="__codelineno-196-1" href="#__codelineno-196-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib</span><span class="w"> </span><span class="kn">import</span> <span class="n">admin</span>
</span><span id="__span-196-2"><a id="__codelineno-196-2" name="__codelineno-196-2" href="#__codelineno-196-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Post</span>
</span><span id="__span-196-3"><a id="__codelineno-196-3" name="__codelineno-196-3" href="#__codelineno-196-3"></a>
</span><span id="__span-196-4"><a id="__codelineno-196-4" name="__codelineno-196-4" href="#__codelineno-196-4"></a><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Post</span><span class="p">)</span>
</span></code></pre></div>
<h5 id="_64">常用功能</h5>
<p><strong>静态文件处理</strong>
配置静态文件（settings.py）：
一般静态文件存放在统一的文件夹下，命名为'/static/'、'/files/'等</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-197-1"><a id="__codelineno-197-1" name="__codelineno-197-1" href="#__codelineno-197-1"></a><span class="n">STATIC_URL</span> <span class="o">=</span> <span class="s1">&#39;/static/&#39;</span>
</span><span id="__span-197-2"><a id="__codelineno-197-2" name="__codelineno-197-2" href="#__codelineno-197-2"></a><span class="n">STATICFILES_DIRS</span> <span class="o">=</span> <span class="p">[</span><span class="n">BASE_DIR</span> <span class="o">/</span> <span class="s1">&#39;static&#39;</span><span class="p">]</span>
</span></code></pre></div>
<ol>
<li>
<p><strong><code>STATIC_URL = '/files/'</code></strong></p>
</li>
<li>
<p>定义了静态文件的 URL 前缀。当你在模板中引用静态文件时，Django 会使用这个 URL 前缀。例如，如果你有一个静态文件 <code>logo.png</code>，它的 URL 将是 <code>http://&lt;your-domain&gt;/files/logo.png</code>。</p>
</li>
<li>这是静态文件在浏览器中访问的路径。</li>
<li>
<p><strong><code>STATICFILES_DIRS = [BASE_DIR / 'files']</code></strong></p>
</li>
<li>
<p>指定了静态文件的目录路径。Django 会在这个目录中查找静态文件。</p>
</li>
</ol>
<p>也可以使用路由实现：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-198-1"><a id="__codelineno-198-1" name="__codelineno-198-1" href="#__codelineno-198-1"></a><span class="c1"># 开发环境下提供静态文件服务</span>
</span><span id="__span-198-2"><a id="__codelineno-198-2" name="__codelineno-198-2" href="#__codelineno-198-2"></a><span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
</span><span id="__span-198-3"><a id="__codelineno-198-3" name="__codelineno-198-3" href="#__codelineno-198-3"></a>    <span class="n">urlpatterns</span> <span class="o">+=</span> <span class="n">static</span><span class="p">(</span><span class="s1">&#39;/files/&#39;</span><span class="p">,</span> <span class="n">document_root</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">BASE_DIR</span> <span class="o">/</span> <span class="s1">&#39;files&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p><code>https://ip:端口/static/文件</code> 即可访问静态文件</p>
<p>STATIC_ROOT 是 collectstatic 命令收集所有静态文件的目标目录。
通常，这个目录不应该与 STATICFILES_DIRS 中的目录重叠。</p>
<p>生产环境需运行 python manage.py collectstatic 收集静态文件。</p>
<p><strong>表单处理</strong>
==使用Django 表单类==，在 forms.py 中定义表单：
表单可以自定义(forms.Form)，也可以由模型Models创建(forms.ModelForm)
forms.py的好处: 所有的表单在一个文件里，非常便于后期维护，比如增添或修订字段。</p>
<p>使用<code>ModelForm</code>可以自动帮助我们处理表单字段的显示和保存。在提交失败后，<code>ModelForm</code>会自动将字段值回填到表单中。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-199-1"><a id="__codelineno-199-1" name="__codelineno-199-1" href="#__codelineno-199-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django</span><span class="w"> </span><span class="kn">import</span> <span class="n">forms</span>
</span><span id="__span-199-2"><a id="__codelineno-199-2" name="__codelineno-199-2" href="#__codelineno-199-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Post</span>
</span><span id="__span-199-3"><a id="__codelineno-199-3" name="__codelineno-199-3" href="#__codelineno-199-3"></a>
</span><span id="__span-199-4"><a id="__codelineno-199-4" name="__codelineno-199-4" href="#__codelineno-199-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">PostForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
</span><span id="__span-199-5"><a id="__codelineno-199-5" name="__codelineno-199-5" href="#__codelineno-199-5"></a>    <span class="c1"># 可以通过声明方式指定字段，就像在常规 `Form` 中一样</span>
</span><span id="__span-199-6"><a id="__codelineno-199-6" name="__codelineno-199-6" href="#__codelineno-199-6"></a>    <span class="c1"># your_name = forms.CharField(label=&quot;Your name&quot;, max_length=100)</span>
</span><span id="__span-199-7"><a id="__codelineno-199-7" name="__codelineno-199-7" href="#__codelineno-199-7"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
</span><span id="__span-199-8"><a id="__codelineno-199-8" name="__codelineno-199-8" href="#__codelineno-199-8"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">Post</span>   <span class="c1"># 指定关联的模型</span>
</span><span id="__span-199-9"><a id="__codelineno-199-9" name="__codelineno-199-9" href="#__codelineno-199-9"></a>        <span class="n">exclude</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
</span><span id="__span-199-10"><a id="__codelineno-199-10" name="__codelineno-199-10" href="#__codelineno-199-10"></a>        <span class="c1"># fields = [&#39;title&#39;, &#39;content&#39;, &#39;file&#39;]   # 指定表单包含的字段</span>
</span><span id="__span-199-11"><a id="__codelineno-199-11" name="__codelineno-199-11" href="#__codelineno-199-11"></a>        <span class="c1"># 或者排除某些字段：exclude = [&#39;pub_date&#39;] （谨慎使用，避免安全风险）</span>
</span><span id="__span-199-12"><a id="__codelineno-199-12" name="__codelineno-199-12" href="#__codelineno-199-12"></a>        <span class="c1"># 自定义字段的标签</span>
</span><span id="__span-199-13"><a id="__codelineno-199-13" name="__codelineno-199-13" href="#__codelineno-199-13"></a>        <span class="c1"># labels = {</span>
</span><span id="__span-199-14"><a id="__codelineno-199-14" name="__codelineno-199-14" href="#__codelineno-199-14"></a>        <span class="c1">#     &#39;title&#39;: &#39;文章标题&#39;, # 将标题字段的标签改为 &quot;文章标题&quot;</span>
</span><span id="__span-199-15"><a id="__codelineno-199-15" name="__codelineno-199-15" href="#__codelineno-199-15"></a>        <span class="c1">#     &#39;content&#39;: &#39;内容&#39;,</span>
</span><span id="__span-199-16"><a id="__codelineno-199-16" name="__codelineno-199-16" href="#__codelineno-199-16"></a>        <span class="c1"># }</span>
</span><span id="__span-199-17"><a id="__codelineno-199-17" name="__codelineno-199-17" href="#__codelineno-199-17"></a>        <span class="c1"># 自定义字段的输入控件</span>
</span><span id="__span-199-18"><a id="__codelineno-199-18" name="__codelineno-199-18" href="#__codelineno-199-18"></a>        <span class="c1"># widgets = {</span>
</span><span id="__span-199-19"><a id="__codelineno-199-19" name="__codelineno-199-19" href="#__codelineno-199-19"></a>        <span class="c1">#     &#39;content&#39;: forms.Textarea(attrs={&#39;rows&#39;: 4}),</span>
</span><span id="__span-199-20"><a id="__codelineno-199-20" name="__codelineno-199-20" href="#__codelineno-199-20"></a>        <span class="c1"># }</span>
</span><span id="__span-199-21"><a id="__codelineno-199-21" name="__codelineno-199-21" href="#__codelineno-199-21"></a>
</span><span id="__span-199-22"><a id="__codelineno-199-22" name="__codelineno-199-22" href="#__codelineno-199-22"></a><span class="c1"># class NameForm(forms.Form):</span>
</span><span id="__span-199-23"><a id="__codelineno-199-23" name="__codelineno-199-23" href="#__codelineno-199-23"></a><span class="c1">#    your_name = forms.CharField(label=&quot;Your name&quot;, max_length=100)</span>
</span></code></pre></div>
<p>Form 类的常用属性</p>
<ol>
<li><strong><code>fields</code></strong><br />
    包含表单中所有字段的字典，键是字段名称，值是字段对象。</li>
<li><strong><code>errors</code></strong><br />
    一个字典，包含表单验证失败的错误信息，键是字段名称，值是错误信息列表。</li>
<li><strong><code>is_valid()</code></strong><br />
    方法，用于验证表单数据是否合法，返回布尔值。</li>
<li><strong><code>cleaned_data</code></strong><br />
    在表单验证成功后，包含清理后的数据的字典。</li>
<li><strong><code>as_p()</code> / <code>as_table()</code> / <code>as_ul()</code></strong><br />
    用于将表单渲染为 HTML 的方法，分别以 <code>&lt;p&gt;</code>、<code>&lt;table&gt;</code> 或 <code>&lt;ul&gt;</code> 格式输出。</li>
<li><strong><code>non_field_errors()</code></strong><br />
    返回与表单整体相关的错误，而不是特定字段的错误。</li>
</ol>
<p>字段的常用属性</p>
<ol>
<li><strong><code>label</code></strong><br />
    字段的标签，用于在表单中显示。</li>
<li><strong><code>required</code></strong><br />
    是否为必填字段，默认为 <code>True</code>。</li>
<li><strong><code>initial</code></strong><br />
    字段的初始值。</li>
<li><strong><code>help_text</code></strong><br />
    字段的帮助文本，用于提示用户。</li>
<li><strong><code>widget</code></strong><br />
    用于指定字段的渲染小部件（如 <code>TextInput</code>、<code>Textarea</code> 等）。</li>
<li><strong><code>error_messages</code></strong><br />
    自定义字段验证失败时的错误信息。</li>
<li><strong><code>validators</code></strong><br />
    字段的额外验证器列表。</li>
<li><strong><code>max_length</code> / <code>min_length</code></strong><br />
    对字符串字段的最大长度和最小长度限制。</li>
<li><strong><code>choices</code></strong><br />
    用于下拉选择字段，定义可选值的列表或元组。</li>
<li><strong><code>disabled</code></strong><br />
    如果设置为 <code>True</code>，字段将被禁用，用户无法修改其值。</li>
</ol>
<p><strong><code>labels</code></strong> 可以修改字段的标签。
如果希望全局修改字段的默认标签（在所有表单中生效），可以直接在模型中设置 <code>verbose_name</code></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-200-1"><a id="__codelineno-200-1" name="__codelineno-200-1" href="#__codelineno-200-1"></a><span class="c1"># models.py</span>
</span><span id="__span-200-2"><a id="__codelineno-200-2" name="__codelineno-200-2" href="#__codelineno-200-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
</span><span id="__span-200-3"><a id="__codelineno-200-3" name="__codelineno-200-3" href="#__codelineno-200-3"></a>
</span><span id="__span-200-4"><a id="__codelineno-200-4" name="__codelineno-200-4" href="#__codelineno-200-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">Article</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span><span id="__span-200-5"><a id="__codelineno-200-5" name="__codelineno-200-5" href="#__codelineno-200-5"></a>    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;文章标题&#39;</span><span class="p">)</span>  <span class="c1"># 默认标签为 &quot;文章标题&quot;</span>
</span><span id="__span-200-6"><a id="__codelineno-200-6" name="__codelineno-200-6" href="#__codelineno-200-6"></a>    <span class="n">content</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;正文内容&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p><strong><code>widget</code></strong> 来修改默认的输入控件</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-201-1"><a id="__codelineno-201-1" name="__codelineno-201-1" href="#__codelineno-201-1"></a><span class="c1"># 单选</span>
</span><span id="__span-201-2"><a id="__codelineno-201-2" name="__codelineno-201-2" href="#__codelineno-201-2"></a><span class="n">forms</span><span class="o">.</span><span class="n">RadioSelect</span><span class="p">()</span>
</span><span id="__span-201-3"><a id="__codelineno-201-3" name="__codelineno-201-3" href="#__codelineno-201-3"></a><span class="c1"># 多选</span>
</span><span id="__span-201-4"><a id="__codelineno-201-4" name="__codelineno-201-4" href="#__codelineno-201-4"></a><span class="n">forms</span><span class="o">.</span><span class="n">CheckboxSelectMultiple</span><span class="p">()</span>
</span><span id="__span-201-5"><a id="__codelineno-201-5" name="__codelineno-201-5" href="#__codelineno-201-5"></a><span class="c1"># 自定义输入控件属性（如添加 CSS 类）</span>
</span><span id="__span-201-6"><a id="__codelineno-201-6" name="__codelineno-201-6" href="#__codelineno-201-6"></a><span class="n">forms</span><span class="o">.</span><span class="n">RadioSelect</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;custom-radio&#39;</span><span class="p">}),</span>
</span></code></pre></div>
<p>也可以直接修改model</p>
<table>
<thead>
<tr>
<th>模型字段</th>
<th>默认控件</th>
<th>如何修改表单字段/控件</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>models.CharField</code></td>
<td><code>TextInput</code></td>
<td>使用 <code>widget=forms.Textarea</code> 改为文本框，或添加属性：<code>attrs={'class': 'custom-class'}</code></td>
</tr>
<tr>
<td><code>models.TextField</code></td>
<td><code>Textarea</code></td>
<td>修改行数：<code>widget=forms.Textarea(attrs={'rows': 5})</code></td>
</tr>
<tr>
<td><code>models.BooleanField</code></td>
<td><code>CheckboxInput</code></td>
<td>改为单选框：自定义为 <code>ChoiceField</code>，并设置 <code>widget=forms.RadioSelect(choices=[(True, '是'), (False, '否')])</code></td>
</tr>
<tr>
<td><code>models.IntegerField</code></td>
<td><code>NumberInput</code></td>
<td>限制范围：<code>forms.IntegerField(min_value=0, max_value=100)</code></td>
</tr>
<tr>
<td><code>models.EmailField</code></td>
<td><code>EmailInput</code></td>
<td>添加验证正则：<code>widget=forms.EmailInput(attrs={'pattern': '.*@example\.com'})</code></td>
</tr>
<tr>
<td><code>models.DateField</code></td>
<td><code>DateInput</code></td>
<td>使用日期选择器：<code>widget=forms.DateInput(attrs={'type': 'date'})</code></td>
</tr>
<tr>
<td><code>models.DateTimeField</code></td>
<td><code>DateTimeInput</code></td>
<td>使用 <code>SplitDateTimeWidget</code>：<code>widget=forms.SplitDateTimeWidget</code></td>
</tr>
<tr>
<td><code>models.ForeignKey</code></td>
<td><code>Select</code></td>
<td>改为单选框：<code>widget=forms.RadioSelect</code>，或限制选项：<code>queryset=Model.objects.filter(...)</code></td>
</tr>
<tr>
<td><code>models.ManyToManyField</code></td>
<td><code>SelectMultiple</code></td>
<td>改为多选框列表：<code>widget=forms.CheckboxSelectMultiple</code></td>
</tr>
<tr>
<td><code>models.FileField</code></td>
<td><code>ClearableFileInput</code></td>
<td>限制文件类型：<code>widget=forms.ClearableFileInput(attrs={'accept': 'image/*', 'multiple': True})</code></td>
</tr>
<tr>
<td><code>models.ImageField</code></td>
<td><code>ClearableFileInput</code></td>
<td>同 <code>FileField</code>，需配合 Pillow 库使用。</td>
</tr>
<tr>
<td>含有 <code>choices</code> 选项字段</td>
<td><code>Select</code></td>
<td>改为单选框：<code>widget=forms.RadioSelect</code>，或下拉框：<code>widget=forms.Select(attrs={...})</code></td>
</tr>
</tbody>
</table>
<p>使用forms.RadioSelect将Select转换为<code>RadioSelect</code> 控件时，可能会多出一个空选项：
1）如果模型字段设置了 <code>blank=True</code> 或 <code>null=True</code>，Django 会自动在表单中生成一个空选项（<code>-----</code>）
2）表单字段显式设置 <code>required=False</code>，也会生成空选项。
3）如果字段是外键（<code>ForeignKey</code>），默认会添加空选项 <code>-----</code>（可通过 <code>empty_label=None</code> 关闭）
可以在模型中禁止空值（<code>blank=False,  default='A'</code>），或在表单中设置 <code>required=True</code>；如果是外键字段，设置 <code>empty_label=None</code>。还可以在表单的 <code>__init__</code> 方法中强制移除空选项</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-202-1"><a id="__codelineno-202-1" name="__codelineno-202-1" href="#__codelineno-202-1"></a>        <span class="n">widgets</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-202-2"><a id="__codelineno-202-2" name="__codelineno-202-2" href="#__codelineno-202-2"></a>            <span class="c1"># 横向单选框：添加 CSS 类</span>
</span><span id="__span-202-3"><a id="__codelineno-202-3" name="__codelineno-202-3" href="#__codelineno-202-3"></a>            <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">forms</span><span class="o">.</span><span class="n">RadioSelect</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-202-4"><a id="__codelineno-202-4" name="__codelineno-202-4" href="#__codelineno-202-4"></a>                <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;radio-horizontal&#39;</span><span class="p">,</span>  <span class="c1"># 横向布局的 CSS 类</span>
</span><span id="__span-202-5"><a id="__codelineno-202-5" name="__codelineno-202-5" href="#__codelineno-202-5"></a>            <span class="p">}),</span>
</span><span id="__span-202-6"><a id="__codelineno-202-6" name="__codelineno-202-6" href="#__codelineno-202-6"></a>            <span class="c1"># 固定行数的文本框</span>
</span><span id="__span-202-7"><a id="__codelineno-202-7" name="__codelineno-202-7" href="#__codelineno-202-7"></a>            <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">forms</span><span class="o">.</span><span class="n">Textarea</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-202-8"><a id="__codelineno-202-8" name="__codelineno-202-8" href="#__codelineno-202-8"></a>                <span class="s1">&#39;rows&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>                   <span class="c1"># 指定行数</span>
</span><span id="__span-202-9"><a id="__codelineno-202-9" name="__codelineno-202-9" href="#__codelineno-202-9"></a>                <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;fixed-textarea&#39;</span><span class="p">,</span>    <span class="c1"># 限制高度的 CSS 类</span>
</span><span id="__span-202-10"><a id="__codelineno-202-10" name="__codelineno-202-10" href="#__codelineno-202-10"></a>            <span class="p">}),</span>
</span><span id="__span-202-11"><a id="__codelineno-202-11" name="__codelineno-202-11" href="#__codelineno-202-11"></a>        <span class="p">}</span>
</span><span id="__span-202-12"><a id="__codelineno-202-12" name="__codelineno-202-12" href="#__codelineno-202-12"></a>
</span><span id="__span-202-13"><a id="__codelineno-202-13" name="__codelineno-202-13" href="#__codelineno-202-13"></a>
</span><span id="__span-202-14"><a id="__codelineno-202-14" name="__codelineno-202-14" href="#__codelineno-202-14"></a><span class="c1"># forms.py</span>
</span><span id="__span-202-15"><a id="__codelineno-202-15" name="__codelineno-202-15" href="#__codelineno-202-15"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django</span><span class="w"> </span><span class="kn">import</span> <span class="n">forms</span>
</span><span id="__span-202-16"><a id="__codelineno-202-16" name="__codelineno-202-16" href="#__codelineno-202-16"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Article</span>
</span><span id="__span-202-17"><a id="__codelineno-202-17" name="__codelineno-202-17" href="#__codelineno-202-17"></a>
</span><span id="__span-202-18"><a id="__codelineno-202-18" name="__codelineno-202-18" href="#__codelineno-202-18"></a><span class="k">class</span><span class="w"> </span><span class="nc">ArticleForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
</span><span id="__span-202-19"><a id="__codelineno-202-19" name="__codelineno-202-19" href="#__codelineno-202-19"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
</span><span id="__span-202-20"><a id="__codelineno-202-20" name="__codelineno-202-20" href="#__codelineno-202-20"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">Article</span>
</span><span id="__span-202-21"><a id="__codelineno-202-21" name="__codelineno-202-21" href="#__codelineno-202-21"></a>        <span class="n">fields</span> <span class="o">=</span> <span class="s1">&#39;__all__&#39;</span>  <span class="c1"># 包含所有字段</span>
</span><span id="__span-202-22"><a id="__codelineno-202-22" name="__codelineno-202-22" href="#__codelineno-202-22"></a>
</span><span id="__span-202-23"><a id="__codelineno-202-23" name="__codelineno-202-23" href="#__codelineno-202-23"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="__span-202-24"><a id="__codelineno-202-24" name="__codelineno-202-24" href="#__codelineno-202-24"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-202-25"><a id="__codelineno-202-25" name="__codelineno-202-25" href="#__codelineno-202-25"></a>        <span class="c1"># 遍历所有字段</span>
</span><span id="__span-202-26"><a id="__codelineno-202-26" name="__codelineno-202-26" href="#__codelineno-202-26"></a>        <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>            
</span><span id="__span-202-27"><a id="__codelineno-202-27" name="__codelineno-202-27" href="#__codelineno-202-27"></a>            <span class="c1"># 针对 TextField，设置为固定行数的文本框</span>
</span><span id="__span-202-28"><a id="__codelineno-202-28" name="__codelineno-202-28" href="#__codelineno-202-28"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">widget</span><span class="p">,</span> <span class="n">forms</span><span class="o">.</span><span class="n">Textarea</span><span class="p">):</span>
</span><span id="__span-202-29"><a id="__codelineno-202-29" name="__codelineno-202-29" href="#__codelineno-202-29"></a>                <span class="n">field</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
</span><span id="__span-202-30"><a id="__codelineno-202-30" name="__codelineno-202-30" href="#__codelineno-202-30"></a>                    <span class="s1">&#39;rows&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="__span-202-31"><a id="__codelineno-202-31" name="__codelineno-202-31" href="#__codelineno-202-31"></a>                    <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;fixed-textarea&#39;</span>
</span><span id="__span-202-32"><a id="__codelineno-202-32" name="__codelineno-202-32" href="#__codelineno-202-32"></a>                <span class="p">})</span>
</span><span id="__span-202-33"><a id="__codelineno-202-33" name="__codelineno-202-33" href="#__codelineno-202-33"></a>
</span><span id="__span-202-34"><a id="__codelineno-202-34" name="__codelineno-202-34" href="#__codelineno-202-34"></a>
</span><span id="__span-202-35"><a id="__codelineno-202-35" name="__codelineno-202-35" href="#__codelineno-202-35"></a><span class="c1"># 直接设置widget有问题，可以在dynamic_fields.py循环生成widgets</span>
</span><span id="__span-202-36"><a id="__codelineno-202-36" name="__codelineno-202-36" href="#__codelineno-202-36"></a>
</span><span id="__span-202-37"><a id="__codelineno-202-37" name="__codelineno-202-37" href="#__codelineno-202-37"></a><span class="c1">#     str1 = &#39;&#39;&#39;</span>
</span><span id="__span-202-38"><a id="__codelineno-202-38" name="__codelineno-202-38" href="#__codelineno-202-38"></a><span class="c1"># widgets = {</span>
</span><span id="__span-202-39"><a id="__codelineno-202-39" name="__codelineno-202-39" href="#__codelineno-202-39"></a><span class="c1"># &#39;&#39;&#39;   </span>
</span><span id="__span-202-40"><a id="__codelineno-202-40" name="__codelineno-202-40" href="#__codelineno-202-40"></a><span class="c1">#     for field in dynamic_fields:</span>
</span><span id="__span-202-41"><a id="__codelineno-202-41" name="__codelineno-202-41" href="#__codelineno-202-41"></a><span class="c1">#         choices = field.get(&#39;choices&#39;)</span>
</span><span id="__span-202-42"><a id="__codelineno-202-42" name="__codelineno-202-42" href="#__codelineno-202-42"></a><span class="c1">#         name = field.get(&#39;name&#39;)</span>
</span><span id="__span-202-43"><a id="__codelineno-202-43" name="__codelineno-202-43" href="#__codelineno-202-43"></a><span class="c1">#         if choices:</span>
</span><span id="__span-202-44"><a id="__codelineno-202-44" name="__codelineno-202-44" href="#__codelineno-202-44"></a><span class="c1">#             str1 += f&quot;    \&quot;{name}\&quot;: forms.RadioSelect(attrs={{\&quot;class\&quot;: \&quot;radio-horizontal\&quot;}}),\n&quot;</span>
</span><span id="__span-202-45"><a id="__codelineno-202-45" name="__codelineno-202-45" href="#__codelineno-202-45"></a><span class="c1">#     str1 += &#39;}&#39;</span>
</span><span id="__span-202-46"><a id="__codelineno-202-46" name="__codelineno-202-46" href="#__codelineno-202-46"></a><span class="c1">#     print(str1)</span>
</span></code></pre></div>
<div class="language-css highlight"><pre><span></span><code><span id="__span-203-1"><a id="__codelineno-203-1" name="__codelineno-203-1" href="#__codelineno-203-1"></a><span class="c">/* 横向单选框 */</span>
</span><span id="__span-203-2"><a id="__codelineno-203-2" name="__codelineno-203-2" href="#__codelineno-203-2"></a><span class="p">.</span><span class="nc">radio-horizontal</span><span class="w"> </span><span class="nt">div</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-203-3"><a id="__codelineno-203-3" name="__codelineno-203-3" href="#__codelineno-203-3"></a><span class="w">  </span><span class="k">list-style</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span><span class="w">      </span><span class="c">/* 移除默认列表符号 */</span>
</span><span id="__span-203-4"><a id="__codelineno-203-4" name="__codelineno-203-4" href="#__codelineno-203-4"></a><span class="w">  </span><span class="k">padding-left</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">       </span><span class="c">/* 移除左内边距 */</span>
</span><span id="__span-203-5"><a id="__codelineno-203-5" name="__codelineno-203-5" href="#__codelineno-203-5"></a><span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span><span class="w">         </span><span class="c">/* 横向排列 */</span>
</span><span id="__span-203-6"><a id="__codelineno-203-6" name="__codelineno-203-6" href="#__codelineno-203-6"></a><span class="w">  </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span><span class="w">             </span><span class="c">/* 选项间距 */</span>
</span><span id="__span-203-7"><a id="__codelineno-203-7" name="__codelineno-203-7" href="#__codelineno-203-7"></a><span class="w">  </span><span class="k">flex-wrap</span><span class="p">:</span><span class="w"> </span><span class="kc">wrap</span><span class="p">;</span><span class="w">       </span><span class="c">/* 允许换行 */</span>
</span><span id="__span-203-8"><a id="__codelineno-203-8" name="__codelineno-203-8" href="#__codelineno-203-8"></a><span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">inline-block</span><span class="p">;</span><span class="w"> </span><span class="c">/* 横向排列选项 */</span>
</span><span id="__span-203-9"><a id="__codelineno-203-9" name="__codelineno-203-9" href="#__codelineno-203-9"></a><span class="p">}</span>
</span><span id="__span-203-10"><a id="__codelineno-203-10" name="__codelineno-203-10" href="#__codelineno-203-10"></a><span class="c">/* 固定高度的文本框 */</span>
</span><span id="__span-203-11"><a id="__codelineno-203-11" name="__codelineno-203-11" href="#__codelineno-203-11"></a><span class="p">.</span><span class="nc">fixed-textarea</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-203-12"><a id="__codelineno-203-12" name="__codelineno-203-12" href="#__codelineno-203-12"></a><span class="w">  </span><span class="k">max-height</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="kt">px</span><span class="p">;</span><span class="w">     </span><span class="c">/* 最大高度 */</span>
</span><span id="__span-203-13"><a id="__codelineno-203-13" name="__codelineno-203-13" href="#__codelineno-203-13"></a><span class="w">  </span><span class="k">overflow-y</span><span class="p">:</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span><span class="w">      </span><span class="c">/* 内容溢出时显示滚动条 */</span>
</span><span id="__span-203-14"><a id="__codelineno-203-14" name="__codelineno-203-14" href="#__codelineno-203-14"></a><span class="w">  </span><span class="k">resize</span><span class="p">:</span><span class="w"> </span><span class="kc">vertical</span><span class="p">;</span><span class="w">      </span><span class="c">/* 允许垂直调整大小 */</span>
</span><span id="__span-203-15"><a id="__codelineno-203-15" name="__codelineno-203-15" href="#__codelineno-203-15"></a><span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span><span class="w">           </span><span class="c">/* 填充父容器宽度 */</span>
</span><span id="__span-203-16"><a id="__codelineno-203-16" name="__codelineno-203-16" href="#__codelineno-203-16"></a><span class="w">  </span><span class="k">box-sizing</span><span class="p">:</span><span class="w"> </span><span class="kc">border-box</span><span class="p">;</span><span class="c">/* 避免溢出 */</span>
</span><span id="__span-203-17"><a id="__codelineno-203-17" name="__codelineno-203-17" href="#__codelineno-203-17"></a><span class="p">}</span>
</span></code></pre></div>
<p>如果您想进一步自定义字段，可以指定内部 <code>Meta</code> 类的 <code>labels</code>、<code>help_texts</code> 和 <code>error_messages</code> 属性</p>
<p>在视图中添加函数处理表单提交：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-204-1"><a id="__codelineno-204-1" name="__codelineno-204-1" href="#__codelineno-204-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">redirect</span>
</span><span id="__span-204-2"><a id="__codelineno-204-2" name="__codelineno-204-2" href="#__codelineno-204-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.forms</span><span class="w"> </span><span class="kn">import</span> <span class="n">PostForm</span>
</span><span id="__span-204-3"><a id="__codelineno-204-3" name="__codelineno-204-3" href="#__codelineno-204-3"></a>
</span><span id="__span-204-4"><a id="__codelineno-204-4" name="__codelineno-204-4" href="#__codelineno-204-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_post</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span id="__span-204-5"><a id="__codelineno-204-5" name="__codelineno-204-5" href="#__codelineno-204-5"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
</span><span id="__span-204-6"><a id="__codelineno-204-6" name="__codelineno-204-6" href="#__codelineno-204-6"></a>        <span class="n">form</span> <span class="o">=</span> <span class="n">PostForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">FILES</span><span class="p">)</span>
</span><span id="__span-204-7"><a id="__codelineno-204-7" name="__codelineno-204-7" href="#__codelineno-204-7"></a>        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
</span><span id="__span-204-8"><a id="__codelineno-204-8" name="__codelineno-204-8" href="#__codelineno-204-8"></a>            <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="__span-204-9"><a id="__codelineno-204-9" name="__codelineno-204-9" href="#__codelineno-204-9"></a>            <span class="c1"># # 暂存表单数据但不提交到数据库</span>
</span><span id="__span-204-10"><a id="__codelineno-204-10" name="__codelineno-204-10" href="#__codelineno-204-10"></a>            <span class="c1"># post = form.save(commit=False)</span>
</span><span id="__span-204-11"><a id="__codelineno-204-11" name="__codelineno-204-11" href="#__codelineno-204-11"></a>            <span class="c1"># # 添加表单中没有的字段</span>
</span><span id="__span-204-12"><a id="__codelineno-204-12" name="__codelineno-204-12" href="#__codelineno-204-12"></a>            <span class="c1"># post.created_at = timezone.now()     # 当前时间</span>
</span><span id="__span-204-13"><a id="__codelineno-204-13" name="__codelineno-204-13" href="#__codelineno-204-13"></a>
</span><span id="__span-204-14"><a id="__codelineno-204-14" name="__codelineno-204-14" href="#__codelineno-204-14"></a>            <span class="c1"># 遍历form字段</span>
</span><span id="__span-204-15"><a id="__codelineno-204-15" name="__codelineno-204-15" href="#__codelineno-204-15"></a>            <span class="c1"># for field_name in form.cleaned_data:</span>
</span><span id="__span-204-16"><a id="__codelineno-204-16" name="__codelineno-204-16" href="#__codelineno-204-16"></a>            <span class="c1">#     if field_name in [&#39;sorce&#39;, &#39;result&#39;]:</span>
</span><span id="__span-204-17"><a id="__codelineno-204-17" name="__codelineno-204-17" href="#__codelineno-204-17"></a>            <span class="c1">#         field_value = form.cleaned_data[field_name]</span>
</span><span id="__span-204-18"><a id="__codelineno-204-18" name="__codelineno-204-18" href="#__codelineno-204-18"></a>
</span><span id="__span-204-19"><a id="__codelineno-204-19" name="__codelineno-204-19" href="#__codelineno-204-19"></a>            <span class="c1"># # 保存到数据库</span>
</span><span id="__span-204-20"><a id="__codelineno-204-20" name="__codelineno-204-20" href="#__codelineno-204-20"></a>            <span class="c1"># post.save()</span>
</span><span id="__span-204-21"><a id="__codelineno-204-21" name="__codelineno-204-21" href="#__codelineno-204-21"></a>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;post_list&#39;</span><span class="p">)</span>
</span><span id="__span-204-22"><a id="__codelineno-204-22" name="__codelineno-204-22" href="#__codelineno-204-22"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-204-23"><a id="__codelineno-204-23" name="__codelineno-204-23" href="#__codelineno-204-23"></a>        <span class="n">form</span> <span class="o">=</span> <span class="n">PostForm</span><span class="p">()</span>
</span><span id="__span-204-24"><a id="__codelineno-204-24" name="__codelineno-204-24" href="#__codelineno-204-24"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;blog/create_post.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span>
</span></code></pre></div>
<p>路由中添加：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-205-1"><a id="__codelineno-205-1" name="__codelineno-205-1" href="#__codelineno-205-1"></a><span class="n">path</span><span class="p">(</span><span class="s1">&#39;create/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">create_post</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;create_post&#39;</span><span class="p">),</span>
</span></code></pre></div>
<div class="language-html highlight"><pre><span></span><code><span id="__span-206-1"><a id="__codelineno-206-1" name="__codelineno-206-1" href="#__codelineno-206-1"></a><span class="cm">&lt;!-- blog/create_post.html --&gt;</span>
</span><span id="__span-206-2"><a id="__codelineno-206-2" name="__codelineno-206-2" href="#__codelineno-206-2"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span id="__span-206-3"><a id="__codelineno-206-3" name="__codelineno-206-3" href="#__codelineno-206-3"></a><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span><span id="__span-206-4"><a id="__codelineno-206-4" name="__codelineno-206-4" href="#__codelineno-206-4"></a><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span><span id="__span-206-5"><a id="__codelineno-206-5" name="__codelineno-206-5" href="#__codelineno-206-5"></a>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>创建帖子<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span><span id="__span-206-6"><a id="__codelineno-206-6" name="__codelineno-206-6" href="#__codelineno-206-6"></a><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span><span id="__span-206-7"><a id="__codelineno-206-7" name="__codelineno-206-7" href="#__codelineno-206-7"></a><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span><span id="__span-206-8"><a id="__codelineno-206-8" name="__codelineno-206-8" href="#__codelineno-206-8"></a>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>创建新帖子<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span><span id="__span-206-9"><a id="__codelineno-206-9" name="__codelineno-206-9" href="#__codelineno-206-9"></a>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span> <span class="na">enctype</span><span class="o">=</span><span class="s">&quot;multipart/form-data&quot;</span><span class="p">&gt;</span>
</span><span id="__span-206-10"><a id="__codelineno-206-10" name="__codelineno-206-10" href="#__codelineno-206-10"></a>        {% csrf_token %}
</span><span id="__span-206-11"><a id="__codelineno-206-11" name="__codelineno-206-11" href="#__codelineno-206-11"></a>
</span><span id="__span-206-12"><a id="__codelineno-206-12" name="__codelineno-206-12" href="#__codelineno-206-12"></a>        {{ form.as_p }}
</span><span id="__span-206-13"><a id="__codelineno-206-13" name="__codelineno-206-13" href="#__codelineno-206-13"></a>
</span><span id="__span-206-14"><a id="__codelineno-206-14" name="__codelineno-206-14" href="#__codelineno-206-14"></a>        {% if form.errors %}
</span><span id="__span-206-15"><a id="__codelineno-206-15" name="__codelineno-206-15" href="#__codelineno-206-15"></a>            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;color: red;&quot;</span><span class="p">&gt;</span>
</span><span id="__span-206-16"><a id="__codelineno-206-16" name="__codelineno-206-16" href="#__codelineno-206-16"></a>                {% for field in form %}
</span><span id="__span-206-17"><a id="__codelineno-206-17" name="__codelineno-206-17" href="#__codelineno-206-17"></a>                    {% for error in field.errors %}
</span><span id="__span-206-18"><a id="__codelineno-206-18" name="__codelineno-206-18" href="#__codelineno-206-18"></a>                        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ field.label }}: {{ error }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span><span id="__span-206-19"><a id="__codelineno-206-19" name="__codelineno-206-19" href="#__codelineno-206-19"></a>                    {% endfor %}
</span><span id="__span-206-20"><a id="__codelineno-206-20" name="__codelineno-206-20" href="#__codelineno-206-20"></a>                {% endfor %}
</span><span id="__span-206-21"><a id="__codelineno-206-21" name="__codelineno-206-21" href="#__codelineno-206-21"></a>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-206-22"><a id="__codelineno-206-22" name="__codelineno-206-22" href="#__codelineno-206-22"></a>        {% endif %}
</span><span id="__span-206-23"><a id="__codelineno-206-23" name="__codelineno-206-23" href="#__codelineno-206-23"></a>
</span><span id="__span-206-24"><a id="__codelineno-206-24" name="__codelineno-206-24" href="#__codelineno-206-24"></a>        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>提交<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span><span id="__span-206-25"><a id="__codelineno-206-25" name="__codelineno-206-25" href="#__codelineno-206-25"></a>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;post_list&#39; %}&quot;</span><span class="p">&gt;</span>返回列表<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span><span id="__span-206-26"><a id="__codelineno-206-26" name="__codelineno-206-26" href="#__codelineno-206-26"></a>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span><span id="__span-206-27"><a id="__codelineno-206-27" name="__codelineno-206-27" href="#__codelineno-206-27"></a><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span><span id="__span-206-28"><a id="__codelineno-206-28" name="__codelineno-206-28" href="#__codelineno-206-28"></a><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></code></pre></div>
<p><code>{{ form.as_p }}</code> 是一个用于快速渲染表单的模板语法，它会将 Django 表单的字段自动转换为 HTML 的 <code>&lt;p&gt;</code> 标签包裹的段落格式。
手动渲染字段:</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-207-1"><a id="__codelineno-207-1" name="__codelineno-207-1" href="#__codelineno-207-1"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;field&quot;</span><span class="p">&gt;</span>
</span><span id="__span-207-2"><a id="__codelineno-207-2" name="__codelineno-207-2" href="#__codelineno-207-2"></a>        {{ form.title.label_tag }}
</span><span id="__span-207-3"><a id="__codelineno-207-3" name="__codelineno-207-3" href="#__codelineno-207-3"></a>        {{ form.title }}
</span><span id="__span-207-4"><a id="__codelineno-207-4" name="__codelineno-207-4" href="#__codelineno-207-4"></a>        {{ form.title.errors }}
</span><span id="__span-207-5"><a id="__codelineno-207-5" name="__codelineno-207-5" href="#__codelineno-207-5"></a>    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-207-6"><a id="__codelineno-207-6" name="__codelineno-207-6" href="#__codelineno-207-6"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;field&quot;</span><span class="p">&gt;</span>
</span><span id="__span-207-7"><a id="__codelineno-207-7" name="__codelineno-207-7" href="#__codelineno-207-7"></a>        {{ form.content.label_tag }}
</span><span id="__span-207-8"><a id="__codelineno-207-8" name="__codelineno-207-8" href="#__codelineno-207-8"></a>        {{ form.content }}
</span><span id="__span-207-9"><a id="__codelineno-207-9" name="__codelineno-207-9" href="#__codelineno-207-9"></a>        {{ form.content.errors }}
</span><span id="__span-207-10"><a id="__codelineno-207-10" name="__codelineno-207-10" href="#__codelineno-207-10"></a>    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-207-11"><a id="__codelineno-207-11" name="__codelineno-207-11" href="#__codelineno-207-11"></a>
</span><span id="__span-207-12"><a id="__codelineno-207-12" name="__codelineno-207-12" href="#__codelineno-207-12"></a>
</span><span id="__span-207-13"><a id="__codelineno-207-13" name="__codelineno-207-13" href="#__codelineno-207-13"></a>    {% for radio in form.gender %}
</span><span id="__span-207-14"><a id="__codelineno-207-14" name="__codelineno-207-14" href="#__codelineno-207-14"></a>      <span class="p">&lt;</span><span class="nt">label</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;radio&quot;</span><span class="p">&gt;</span>
</span><span id="__span-207-15"><a id="__codelineno-207-15" name="__codelineno-207-15" href="#__codelineno-207-15"></a>        {{ radio.tag }} {{ radio.choice_label }}
</span><span id="__span-207-16"><a id="__codelineno-207-16" name="__codelineno-207-16" href="#__codelineno-207-16"></a>      <span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span><span id="__span-207-17"><a id="__codelineno-207-17" name="__codelineno-207-17" href="#__codelineno-207-17"></a>    {% endfor %}
</span><span id="__span-207-18"><a id="__codelineno-207-18" name="__codelineno-207-18" href="#__codelineno-207-18"></a>
</span><span id="__span-207-19"><a id="__codelineno-207-19" name="__codelineno-207-19" href="#__codelineno-207-19"></a>    {% for choice in form.gender %}
</span><span id="__span-207-20"><a id="__codelineno-207-20" name="__codelineno-207-20" href="#__codelineno-207-20"></a>      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;radio-option&quot;</span><span class="p">&gt;</span>
</span><span id="__span-207-21"><a id="__codelineno-207-21" name="__codelineno-207-21" href="#__codelineno-207-21"></a>        {{ choice.tag }}
</span><span id="__span-207-22"><a id="__codelineno-207-22" name="__codelineno-207-22" href="#__codelineno-207-22"></a>        <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;{{ choice.id_for_label }}&quot;</span><span class="p">&gt;</span>{{ choice.choice_label }}<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span><span id="__span-207-23"><a id="__codelineno-207-23" name="__codelineno-207-23" href="#__codelineno-207-23"></a>      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-207-24"><a id="__codelineno-207-24" name="__codelineno-207-24" href="#__codelineno-207-24"></a>    {% endfor %}
</span></code></pre></div>
<p>如果==不使用 Django 的表单类==，可以直接在视图 <code>views.py</code>中手动处理表单数据：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-208-1"><a id="__codelineno-208-1" name="__codelineno-208-1" href="#__codelineno-208-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">redirect</span>
</span><span id="__span-208-2"><a id="__codelineno-208-2" name="__codelineno-208-2" href="#__codelineno-208-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Post</span>
</span><span id="__span-208-3"><a id="__codelineno-208-3" name="__codelineno-208-3" href="#__codelineno-208-3"></a>
</span><span id="__span-208-4"><a id="__codelineno-208-4" name="__codelineno-208-4" href="#__codelineno-208-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_post</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span id="__span-208-5"><a id="__codelineno-208-5" name="__codelineno-208-5" href="#__codelineno-208-5"></a>    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-208-6"><a id="__codelineno-208-6" name="__codelineno-208-6" href="#__codelineno-208-6"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
</span><span id="__span-208-7"><a id="__codelineno-208-7" name="__codelineno-208-7" href="#__codelineno-208-7"></a>        <span class="n">title</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
</span><span id="__span-208-8"><a id="__codelineno-208-8" name="__codelineno-208-8" href="#__codelineno-208-8"></a>        <span class="n">content</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span>
</span><span id="__span-208-9"><a id="__codelineno-208-9" name="__codelineno-208-9" href="#__codelineno-208-9"></a>        <span class="n">file</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">FILES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">)</span>  <span class="c1"># 获取上传的文件</span>
</span><span id="__span-208-10"><a id="__codelineno-208-10" name="__codelineno-208-10" href="#__codelineno-208-10"></a>
</span><span id="__span-208-11"><a id="__codelineno-208-11" name="__codelineno-208-11" href="#__codelineno-208-11"></a>        <span class="c1"># 验证字段</span>
</span><span id="__span-208-12"><a id="__codelineno-208-12" name="__codelineno-208-12" href="#__codelineno-208-12"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span><span class="p">:</span>
</span><span id="__span-208-13"><a id="__codelineno-208-13" name="__codelineno-208-13" href="#__codelineno-208-13"></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;标题不能为空&quot;</span><span class="p">)</span>
</span><span id="__span-208-14"><a id="__codelineno-208-14" name="__codelineno-208-14" href="#__codelineno-208-14"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">content</span><span class="p">:</span>
</span><span id="__span-208-15"><a id="__codelineno-208-15" name="__codelineno-208-15" href="#__codelineno-208-15"></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;内容不能为空&quot;</span><span class="p">)</span>
</span><span id="__span-208-16"><a id="__codelineno-208-16" name="__codelineno-208-16" href="#__codelineno-208-16"></a>
</span><span id="__span-208-17"><a id="__codelineno-208-17" name="__codelineno-208-17" href="#__codelineno-208-17"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">errors</span><span class="p">:</span>
</span><span id="__span-208-18"><a id="__codelineno-208-18" name="__codelineno-208-18" href="#__codelineno-208-18"></a>            <span class="c1"># 保存到数据库</span>
</span><span id="__span-208-19"><a id="__codelineno-208-19" name="__codelineno-208-19" href="#__codelineno-208-19"></a>            <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">)</span>
</span><span id="__span-208-20"><a id="__codelineno-208-20" name="__codelineno-208-20" href="#__codelineno-208-20"></a>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;post_list&#39;</span><span class="p">)</span>  <span class="c1"># 重定向到帖子列表页面</span>
</span><span id="__span-208-21"><a id="__codelineno-208-21" name="__codelineno-208-21" href="#__codelineno-208-21"></a>
</span><span id="__span-208-22"><a id="__codelineno-208-22" name="__codelineno-208-22" href="#__codelineno-208-22"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;blog/create_post.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;errors&#39;</span><span class="p">:</span> <span class="n">errors</span><span class="p">})</span>
</span></code></pre></div>
<p><strong><code>Post.objects.create()</code></strong>：
一行代码直接创建并保存对象到数据库，适合字段较少且无需中间操作的场景。</p>
<p><strong><code>post = Post()</code> + <code>post.save()</code></strong>：
分两步操作，适用于需要先修改对象属性再保存的情况</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-209-1"><a id="__codelineno-209-1" name="__codelineno-209-1" href="#__codelineno-209-1"></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-209-2"><a id="__codelineno-209-2" name="__codelineno-209-2" href="#__codelineno-209-2"></a>            <span class="s1">&#39;title&#39;</span> <span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">),</span>
</span><span id="__span-209-3"><a id="__codelineno-209-3" name="__codelineno-209-3" href="#__codelineno-209-3"></a>            <span class="s1">&#39;content&#39;</span> <span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">),</span>
</span><span id="__span-209-4"><a id="__codelineno-209-4" name="__codelineno-209-4" href="#__codelineno-209-4"></a>            <span class="s1">&#39;file&#39;</span> <span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">FILES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">),</span>
</span><span id="__span-209-5"><a id="__codelineno-209-5" name="__codelineno-209-5" href="#__codelineno-209-5"></a>        <span class="p">}</span>
</span><span id="__span-209-6"><a id="__codelineno-209-6" name="__codelineno-209-6" href="#__codelineno-209-6"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-209-7"><a id="__codelineno-209-7" name="__codelineno-209-7" href="#__codelineno-209-7"></a>            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="__span-209-8"><a id="__codelineno-209-8" name="__codelineno-209-8" href="#__codelineno-209-8"></a>                <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-209-9"><a id="__codelineno-209-9" name="__codelineno-209-9" href="#__codelineno-209-9"></a>        <span class="n">post</span> <span class="o">=</span> <span class="n">Post</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
</span><span id="__span-209-10"><a id="__codelineno-209-10" name="__codelineno-209-10" href="#__codelineno-209-10"></a>        <span class="n">post</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span></code></pre></div>
<p>还需修改create_post.html</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-210-1"><a id="__codelineno-210-1" name="__codelineno-210-1" href="#__codelineno-210-1"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span id="__span-210-2"><a id="__codelineno-210-2" name="__codelineno-210-2" href="#__codelineno-210-2"></a><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span><span id="__span-210-3"><a id="__codelineno-210-3" name="__codelineno-210-3" href="#__codelineno-210-3"></a><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span><span id="__span-210-4"><a id="__codelineno-210-4" name="__codelineno-210-4" href="#__codelineno-210-4"></a>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>创建帖子<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span><span id="__span-210-5"><a id="__codelineno-210-5" name="__codelineno-210-5" href="#__codelineno-210-5"></a><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span><span id="__span-210-6"><a id="__codelineno-210-6" name="__codelineno-210-6" href="#__codelineno-210-6"></a><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span><span id="__span-210-7"><a id="__codelineno-210-7" name="__codelineno-210-7" href="#__codelineno-210-7"></a>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>创建新帖子<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span><span id="__span-210-8"><a id="__codelineno-210-8" name="__codelineno-210-8" href="#__codelineno-210-8"></a>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span> <span class="na">enctype</span><span class="o">=</span><span class="s">&quot;multipart/form-data&quot;</span><span class="p">&gt;</span>
</span><span id="__span-210-9"><a id="__codelineno-210-9" name="__codelineno-210-9" href="#__codelineno-210-9"></a>        {% csrf_token %}
</span><span id="__span-210-10"><a id="__codelineno-210-10" name="__codelineno-210-10" href="#__codelineno-210-10"></a>
</span><span id="__span-210-11"><a id="__codelineno-210-11" name="__codelineno-210-11" href="#__codelineno-210-11"></a>        <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;title&quot;</span><span class="p">&gt;</span>标题:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span><span id="__span-210-12"><a id="__codelineno-210-12" name="__codelineno-210-12" href="#__codelineno-210-12"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;title&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;title&quot;</span> <span class="na">required</span><span class="p">&gt;</span>
</span><span id="__span-210-13"><a id="__codelineno-210-13" name="__codelineno-210-13" href="#__codelineno-210-13"></a>        <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span><span id="__span-210-14"><a id="__codelineno-210-14" name="__codelineno-210-14" href="#__codelineno-210-14"></a>
</span><span id="__span-210-15"><a id="__codelineno-210-15" name="__codelineno-210-15" href="#__codelineno-210-15"></a>        <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;content&quot;</span><span class="p">&gt;</span>内容:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span><span id="__span-210-16"><a id="__codelineno-210-16" name="__codelineno-210-16" href="#__codelineno-210-16"></a>        <span class="p">&lt;</span><span class="nt">textarea</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;content&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;content&quot;</span> <span class="na">rows</span><span class="o">=</span><span class="s">&quot;5&quot;</span> <span class="na">required</span><span class="p">&gt;&lt;/</span><span class="nt">textarea</span><span class="p">&gt;</span>
</span><span id="__span-210-17"><a id="__codelineno-210-17" name="__codelineno-210-17" href="#__codelineno-210-17"></a>        <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span><span id="__span-210-18"><a id="__codelineno-210-18" name="__codelineno-210-18" href="#__codelineno-210-18"></a>
</span><span id="__span-210-19"><a id="__codelineno-210-19" name="__codelineno-210-19" href="#__codelineno-210-19"></a>        <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;file&quot;</span><span class="p">&gt;</span>上传文件:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span><span id="__span-210-20"><a id="__codelineno-210-20" name="__codelineno-210-20" href="#__codelineno-210-20"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;file&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;file&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;file&quot;</span><span class="p">&gt;</span>
</span><span id="__span-210-21"><a id="__codelineno-210-21" name="__codelineno-210-21" href="#__codelineno-210-21"></a>        <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span><span id="__span-210-22"><a id="__codelineno-210-22" name="__codelineno-210-22" href="#__codelineno-210-22"></a>
</span><span id="__span-210-23"><a id="__codelineno-210-23" name="__codelineno-210-23" href="#__codelineno-210-23"></a>        {% if errors %}
</span><span id="__span-210-24"><a id="__codelineno-210-24" name="__codelineno-210-24" href="#__codelineno-210-24"></a>            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;color: red;&quot;</span><span class="p">&gt;</span>
</span><span id="__span-210-25"><a id="__codelineno-210-25" name="__codelineno-210-25" href="#__codelineno-210-25"></a>                {% for error in errors %}
</span><span id="__span-210-26"><a id="__codelineno-210-26" name="__codelineno-210-26" href="#__codelineno-210-26"></a>                    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ error }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span><span id="__span-210-27"><a id="__codelineno-210-27" name="__codelineno-210-27" href="#__codelineno-210-27"></a>                {% endfor %}
</span><span id="__span-210-28"><a id="__codelineno-210-28" name="__codelineno-210-28" href="#__codelineno-210-28"></a>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-210-29"><a id="__codelineno-210-29" name="__codelineno-210-29" href="#__codelineno-210-29"></a>        {% endif %}
</span><span id="__span-210-30"><a id="__codelineno-210-30" name="__codelineno-210-30" href="#__codelineno-210-30"></a>
</span><span id="__span-210-31"><a id="__codelineno-210-31" name="__codelineno-210-31" href="#__codelineno-210-31"></a>        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>提交<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span><span id="__span-210-32"><a id="__codelineno-210-32" name="__codelineno-210-32" href="#__codelineno-210-32"></a>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;post_list&#39; %}&quot;</span><span class="p">&gt;</span>返回列表<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span><span id="__span-210-33"><a id="__codelineno-210-33" name="__codelineno-210-33" href="#__codelineno-210-33"></a>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span><span id="__span-210-34"><a id="__codelineno-210-34" name="__codelineno-210-34" href="#__codelineno-210-34"></a><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span><span id="__span-210-35"><a id="__codelineno-210-35" name="__codelineno-210-35" href="#__codelineno-210-35"></a><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>==自定义表单模板==：新建一个文件，在views.py中导入，再处理逻辑</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-211-1"><a id="__codelineno-211-1" name="__codelineno-211-1" href="#__codelineno-211-1"></a><span class="c1"># dynamic_fields.py</span>
</span><span id="__span-211-2"><a id="__codelineno-211-2" name="__codelineno-211-2" href="#__codelineno-211-2"></a><span class="n">dynamic_fields</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-211-3"><a id="__codelineno-211-3" name="__codelineno-211-3" href="#__codelineno-211-3"></a>    <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;用户名&quot;</span><span class="p">,</span> <span class="s2">&quot;vlaue&quot;</span><span class="p">:</span> <span class="s2">&quot;请输入用户名&quot;</span><span class="p">},</span>
</span><span id="__span-211-4"><a id="__codelineno-211-4" name="__codelineno-211-4" href="#__codelineno-211-4"></a>    <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;密码&quot;</span><span class="p">},</span>
</span><span id="__span-211-5"><a id="__codelineno-211-5" name="__codelineno-211-5" href="#__codelineno-211-5"></a>    <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;年龄&quot;</span><span class="p">},</span>
</span><span id="__span-211-6"><a id="__codelineno-211-6" name="__codelineno-211-6" href="#__codelineno-211-6"></a>    <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;checkbox&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;subscribe&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;性别&quot;</span><span class="p">,</span> <span class="s2">&quot;checked&quot;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span><span id="__span-211-7"><a id="__codelineno-211-7" name="__codelineno-211-7" href="#__codelineno-211-7"></a>    <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;radio&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;性别&quot;</span><span class="p">,</span> <span class="s2">&quot;choices&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;male&quot;</span><span class="p">,</span> <span class="s2">&quot;female&quot;</span><span class="p">],</span> <span class="s2">&quot;choices_label&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;男&quot;</span><span class="p">,</span> <span class="s2">&quot;女&quot;</span><span class="p">],</span> <span class="s2">&quot;checked&quot;</span><span class="p">:</span> <span class="s2">&quot;female&quot;</span><span class="p">},</span>
</span><span id="__span-211-8"><a id="__codelineno-211-8" name="__codelineno-211-8" href="#__codelineno-211-8"></a>    <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;select&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;性别&quot;</span><span class="p">,</span> <span class="s2">&quot;choices&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CN&quot;</span><span class="p">,</span> <span class="s2">&quot;USA&quot;</span><span class="p">]},</span>
</span><span id="__span-211-9"><a id="__codelineno-211-9" name="__codelineno-211-9" href="#__codelineno-211-9"></a>    <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;textarea&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;bio&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;个人简介&quot;</span><span class="p">},</span>
</span><span id="__span-211-10"><a id="__codelineno-211-10" name="__codelineno-211-10" href="#__codelineno-211-10"></a>    <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;profile_picture&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;头像&quot;</span><span class="p">,</span> <span class="s2">&quot;multiple&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
</span><span id="__span-211-11"><a id="__codelineno-211-11" name="__codelineno-211-11" href="#__codelineno-211-11"></a><span class="p">]</span>
</span><span id="__span-211-12"><a id="__codelineno-211-12" name="__codelineno-211-12" href="#__codelineno-211-12"></a><span class="c1"># 可以通过循环生成</span>
</span><span id="__span-211-13"><a id="__codelineno-211-13" name="__codelineno-211-13" href="#__codelineno-211-13"></a><span class="c1"># dynamic_fields = []</span>
</span><span id="__span-211-14"><a id="__codelineno-211-14" name="__codelineno-211-14" href="#__codelineno-211-14"></a><span class="c1"># dynamic_fields.append()</span>
</span><span id="__span-211-15"><a id="__codelineno-211-15" name="__codelineno-211-15" href="#__codelineno-211-15"></a>
</span><span id="__span-211-16"><a id="__codelineno-211-16" name="__codelineno-211-16" href="#__codelineno-211-16"></a><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
</span><span id="__span-211-17"><a id="__codelineno-211-17" name="__codelineno-211-17" href="#__codelineno-211-17"></a>
</span><span id="__span-211-18"><a id="__codelineno-211-18" name="__codelineno-211-18" href="#__codelineno-211-18"></a><span class="c1"># 预编译正则表达式（提高效率）</span>
</span><span id="__span-211-19"><a id="__codelineno-211-19" name="__codelineno-211-19" href="#__codelineno-211-19"></a><span class="n">invalid_char_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[/</span><span class="se">\\</span><span class="s1">:*?&quot;&lt;&gt;|#. ]+&#39;</span><span class="p">)</span>  <span class="c1"># 非法字符集</span>
</span><span id="__span-211-20"><a id="__codelineno-211-20" name="__codelineno-211-20" href="#__codelineno-211-20"></a><span class="n">valid_var_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[a-zA-Z_][a-zA-Z0-9_]*$&#39;</span><span class="p">)</span>  <span class="c1"># 合法变量名规则</span>
</span><span id="__span-211-21"><a id="__codelineno-211-21" name="__codelineno-211-21" href="#__codelineno-211-21"></a>
</span><span id="__span-211-22"><a id="__codelineno-211-22" name="__codelineno-211-22" href="#__codelineno-211-22"></a><span class="k">for</span> <span class="n">dynamic_field</span> <span class="ow">in</span> <span class="n">dynamic_fields</span><span class="p">:</span>
</span><span id="__span-211-23"><a id="__codelineno-211-23" name="__codelineno-211-23" href="#__codelineno-211-23"></a>    <span class="c1"># 1. 替换非法字符为下划线，并合并连续下划线</span>
</span><span id="__span-211-24"><a id="__codelineno-211-24" name="__codelineno-211-24" href="#__codelineno-211-24"></a>    <span class="n">cleaned</span> <span class="o">=</span> <span class="n">invalid_char_pattern</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">dynamic_field</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
</span><span id="__span-211-25"><a id="__codelineno-211-25" name="__codelineno-211-25" href="#__codelineno-211-25"></a>    <span class="c1"># 2. 去除首尾下划线</span>
</span><span id="__span-211-26"><a id="__codelineno-211-26" name="__codelineno-211-26" href="#__codelineno-211-26"></a>    <span class="n">cleaned</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="__span-211-27"><a id="__codelineno-211-27" name="__codelineno-211-27" href="#__codelineno-211-27"></a>    <span class="c1"># 3. 处理空值（例如原名为纯非法字符）</span>
</span><span id="__span-211-28"><a id="__codelineno-211-28" name="__codelineno-211-28" href="#__codelineno-211-28"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">cleaned</span><span class="p">:</span>
</span><span id="__span-211-29"><a id="__codelineno-211-29" name="__codelineno-211-29" href="#__codelineno-211-29"></a>        <span class="n">cleaned</span> <span class="o">=</span> <span class="s1">&#39;field&#39;</span>  <span class="c1"># 默认值</span>
</span><span id="__span-211-30"><a id="__codelineno-211-30" name="__codelineno-211-30" href="#__codelineno-211-30"></a>
</span><span id="__span-211-31"><a id="__codelineno-211-31" name="__codelineno-211-31" href="#__codelineno-211-31"></a>    <span class="c1"># 4. 检查变量名合法性，仅在需要时添加前缀/后缀</span>
</span><span id="__span-211-32"><a id="__codelineno-211-32" name="__codelineno-211-32" href="#__codelineno-211-32"></a>    <span class="k">if</span> <span class="n">valid_var_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">cleaned</span><span class="p">):</span>
</span><span id="__span-211-33"><a id="__codelineno-211-33" name="__codelineno-211-33" href="#__codelineno-211-33"></a>        <span class="c1"># 已经是合法变量名，无需处理</span>
</span><span id="__span-211-34"><a id="__codelineno-211-34" name="__codelineno-211-34" href="#__codelineno-211-34"></a>        <span class="n">final_name</span> <span class="o">=</span> <span class="n">cleaned</span>
</span><span id="__span-211-35"><a id="__codelineno-211-35" name="__codelineno-211-35" href="#__codelineno-211-35"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-211-36"><a id="__codelineno-211-36" name="__codelineno-211-36" href="#__codelineno-211-36"></a>        <span class="c1"># 不合法时添加前缀和后缀</span>
</span><span id="__span-211-37"><a id="__codelineno-211-37" name="__codelineno-211-37" href="#__codelineno-211-37"></a>        <span class="n">final_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">cleaned</span><span class="si">}</span><span class="s1">y&#39;</span>  <span class="c1"># 添加 d 和 y 确保合法性</span>
</span><span id="__span-211-38"><a id="__codelineno-211-38" name="__codelineno-211-38" href="#__codelineno-211-38"></a>
</span><span id="__span-211-39"><a id="__codelineno-211-39" name="__codelineno-211-39" href="#__codelineno-211-39"></a>    <span class="n">dynamic_field</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">final_name</span>
</span><span id="__span-211-40"><a id="__codelineno-211-40" name="__codelineno-211-40" href="#__codelineno-211-40"></a><span class="c1"># with open(&#39;dynamic_fields.py&#39;, &#39;w&#39;, encoding= &#39;utf-8&#39;) as fs:</span>
</span><span id="__span-211-41"><a id="__codelineno-211-41" name="__codelineno-211-41" href="#__codelineno-211-41"></a><span class="c1">#     fs.write(&#39;dynamic_fields = &#39;+str(dynamic_fields))</span>
</span><span id="__span-211-42"><a id="__codelineno-211-42" name="__codelineno-211-42" href="#__codelineno-211-42"></a>
</span><span id="__span-211-43"><a id="__codelineno-211-43" name="__codelineno-211-43" href="#__codelineno-211-43"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span><span id="__span-211-44"><a id="__codelineno-211-44" name="__codelineno-211-44" href="#__codelineno-211-44"></a>    <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-211-45"><a id="__codelineno-211-45" name="__codelineno-211-45" href="#__codelineno-211-45"></a><span class="s1">from django.db import models</span>
</span><span id="__span-211-46"><a id="__codelineno-211-46" name="__codelineno-211-46" href="#__codelineno-211-46"></a><span class="s1">import hashlib</span>
</span><span id="__span-211-47"><a id="__codelineno-211-47" name="__codelineno-211-47" href="#__codelineno-211-47"></a><span class="s1">from django.utils import timezone</span>
</span><span id="__span-211-48"><a id="__codelineno-211-48" name="__codelineno-211-48" href="#__codelineno-211-48"></a><span class="s1">import os</span>
</span><span id="__span-211-49"><a id="__codelineno-211-49" name="__codelineno-211-49" href="#__codelineno-211-49"></a>
</span><span id="__span-211-50"><a id="__codelineno-211-50" name="__codelineno-211-50" href="#__codelineno-211-50"></a><span class="s1">def hash_filename(instance, filename):</span>
</span><span id="__span-211-51"><a id="__codelineno-211-51" name="__codelineno-211-51" href="#__codelineno-211-51"></a><span class="s1">    return f&#39;files/{timezone.now().year}/{timezone.now().month}/{timezone.now().day}/{hashlib.md5(filename.encode()).hexdigest()[:6]}.{filename.split(&quot;.&quot;)[-1]}&#39;</span>
</span><span id="__span-211-52"><a id="__codelineno-211-52" name="__codelineno-211-52" href="#__codelineno-211-52"></a>
</span><span id="__span-211-53"><a id="__codelineno-211-53" name="__codelineno-211-53" href="#__codelineno-211-53"></a><span class="s1">class Post(models.Model):</span>
</span><span id="__span-211-54"><a id="__codelineno-211-54" name="__codelineno-211-54" href="#__codelineno-211-54"></a>
</span><span id="__span-211-55"><a id="__codelineno-211-55" name="__codelineno-211-55" href="#__codelineno-211-55"></a><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-211-56"><a id="__codelineno-211-56" name="__codelineno-211-56" href="#__codelineno-211-56"></a>
</span><span id="__span-211-57"><a id="__codelineno-211-57" name="__codelineno-211-57" href="#__codelineno-211-57"></a>    <span class="k">for</span> <span class="n">dynamic_field</span> <span class="ow">in</span> <span class="n">dynamic_fields</span><span class="p">:</span>
</span><span id="__span-211-58"><a id="__codelineno-211-58" name="__codelineno-211-58" href="#__codelineno-211-58"></a>        <span class="nb">type</span> <span class="o">=</span> <span class="n">dynamic_field</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
</span><span id="__span-211-59"><a id="__codelineno-211-59" name="__codelineno-211-59" href="#__codelineno-211-59"></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">dynamic_field</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</span><span id="__span-211-60"><a id="__codelineno-211-60" name="__codelineno-211-60" href="#__codelineno-211-60"></a>        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;text&#39;</span><span class="p">:</span>
</span><span id="__span-211-61"><a id="__codelineno-211-61" name="__codelineno-211-61" href="#__codelineno-211-61"></a>            <span class="nb">str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;    </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> = models.CharField(max_length=255, null=True, blank=Tru, verbose_name= &quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&quot;)</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="__span-211-62"><a id="__codelineno-211-62" name="__codelineno-211-62" href="#__codelineno-211-62"></a>        <span class="k">elif</span> <span class="nb">type</span>  <span class="o">==</span> <span class="s1">&#39;radio&#39;</span><span class="p">:</span>
</span><span id="__span-211-63"><a id="__codelineno-211-63" name="__codelineno-211-63" href="#__codelineno-211-63"></a>            <span class="nb">str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;    </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> = models.CharField(max_length=255, choices=[(&quot;A&quot;, &quot;A&quot;), (&quot;B&quot;, &quot;B&quot;), (&quot;C&quot;, &quot;C&quot;), (&quot;D&quot;, &quot;D&quot;), (&quot;NA&quot;, &quot;NA&quot;)], verbose_name= &quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&quot;, blank=False,  default=&quot;A&quot;)</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="__span-211-64"><a id="__codelineno-211-64" name="__codelineno-211-64" href="#__codelineno-211-64"></a>        <span class="k">elif</span> <span class="nb">type</span>  <span class="o">==</span> <span class="s1">&#39;textarea&#39;</span><span class="p">:</span>
</span><span id="__span-211-65"><a id="__codelineno-211-65" name="__codelineno-211-65" href="#__codelineno-211-65"></a>            <span class="nb">str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;    </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> = models.TextField(null=True, blank=True, verbose_name= &quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&quot;)</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="__span-211-66"><a id="__codelineno-211-66" name="__codelineno-211-66" href="#__codelineno-211-66"></a>        <span class="k">elif</span> <span class="nb">type</span>  <span class="o">==</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span>
</span><span id="__span-211-67"><a id="__codelineno-211-67" name="__codelineno-211-67" href="#__codelineno-211-67"></a>            <span class="nb">str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;    </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> = models.FileField(upload_to=hash_filename , null=True, blank=True, verbose_name= &quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&quot;)</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="__span-211-68"><a id="__codelineno-211-68" name="__codelineno-211-68" href="#__codelineno-211-68"></a>
</span><span id="__span-211-69"><a id="__codelineno-211-69" name="__codelineno-211-69" href="#__codelineno-211-69"></a>    <span class="c1"># print(str)</span>
</span><span id="__span-211-70"><a id="__codelineno-211-70" name="__codelineno-211-70" href="#__codelineno-211-70"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;models.py&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fs</span><span class="p">:</span>
</span><span id="__span-211-71"><a id="__codelineno-211-71" name="__codelineno-211-71" href="#__codelineno-211-71"></a>        <span class="n">fs</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="__span-211-72"><a id="__codelineno-211-72" name="__codelineno-211-72" href="#__codelineno-211-72"></a>
</span><span id="__span-211-73"><a id="__codelineno-211-73" name="__codelineno-211-73" href="#__codelineno-211-73"></a>
</span><span id="__span-211-74"><a id="__codelineno-211-74" name="__codelineno-211-74" href="#__codelineno-211-74"></a>
</span><span id="__span-211-75"><a id="__codelineno-211-75" name="__codelineno-211-75" href="#__codelineno-211-75"></a><span class="c1"># views.py</span>
</span><span id="__span-211-76"><a id="__codelineno-211-76" name="__codelineno-211-76" href="#__codelineno-211-76"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mqsa.dynamic_fields</span><span class="w"> </span><span class="kn">import</span> <span class="n">dynamic_fields</span> 
</span><span id="__span-211-77"><a id="__codelineno-211-77" name="__codelineno-211-77" href="#__codelineno-211-77"></a>
</span><span id="__span-211-78"><a id="__codelineno-211-78" name="__codelineno-211-78" href="#__codelineno-211-78"></a>        <span class="o">...</span>
</span><span id="__span-211-79"><a id="__codelineno-211-79" name="__codelineno-211-79" href="#__codelineno-211-79"></a>        <span class="k">for</span> <span class="n">dynamic_field</span> <span class="ow">in</span> <span class="n">dynamic_fields</span><span class="p">:</span>
</span><span id="__span-211-80"><a id="__codelineno-211-80" name="__codelineno-211-80" href="#__codelineno-211-80"></a>            <span class="nb">type</span> <span class="o">=</span> <span class="n">dynamic_field</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
</span><span id="__span-211-81"><a id="__codelineno-211-81" name="__codelineno-211-81" href="#__codelineno-211-81"></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">dynamic_field</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-211-82"><a id="__codelineno-211-82" name="__codelineno-211-82" href="#__codelineno-211-82"></a>            <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;text&#39;</span><span class="p">:</span>
</span><span id="__span-211-83"><a id="__codelineno-211-83" name="__codelineno-211-83" href="#__codelineno-211-83"></a>                <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">name</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)})</span>
</span><span id="__span-211-84"><a id="__codelineno-211-84" name="__codelineno-211-84" href="#__codelineno-211-84"></a>        <span class="o">...</span>
</span><span id="__span-211-85"><a id="__codelineno-211-85" name="__codelineno-211-85" href="#__codelineno-211-85"></a>        <span class="c1"># 创建 Post 实例</span>
</span><span id="__span-211-86"><a id="__codelineno-211-86" name="__codelineno-211-86" href="#__codelineno-211-86"></a>        <span class="n">post</span> <span class="o">=</span> <span class="n">Post</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">sorces</span><span class="p">,</span> <span class="o">**</span><span class="n">files</span><span class="p">)</span>
</span><span id="__span-211-87"><a id="__codelineno-211-87" name="__codelineno-211-87" href="#__codelineno-211-87"></a>        <span class="n">post</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span></code></pre></div>
<p>html可以如下，当然也可以使用django表单更方便</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-212-1"><a id="__codelineno-212-1" name="__codelineno-212-1" href="#__codelineno-212-1"></a>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span> <span class="na">enctype</span><span class="o">=</span><span class="s">&quot;multipart/form-data&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;create-post-form&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-2"><a id="__codelineno-212-2" name="__codelineno-212-2" href="#__codelineno-212-2"></a>        {% csrf_token %}
</span><span id="__span-212-3"><a id="__codelineno-212-3" name="__codelineno-212-3" href="#__codelineno-212-3"></a>
</span><span id="__span-212-4"><a id="__codelineno-212-4" name="__codelineno-212-4" href="#__codelineno-212-4"></a>        {% for field in fields %}
</span><span id="__span-212-5"><a id="__codelineno-212-5" name="__codelineno-212-5" href="#__codelineno-212-5"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-6"><a id="__codelineno-212-6" name="__codelineno-212-6" href="#__codelineno-212-6"></a>        <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span><span class="p">&gt;</span>{{ field.label }}<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span><span id="__span-212-7"><a id="__codelineno-212-7" name="__codelineno-212-7" href="#__codelineno-212-7"></a>        {% if field.type == &quot;text&quot; %}
</span><span id="__span-212-8"><a id="__codelineno-212-8" name="__codelineno-212-8" href="#__codelineno-212-8"></a>            {% if field.value %}
</span><span id="__span-212-9"><a id="__codelineno-212-9" name="__codelineno-212-9" href="#__codelineno-212-9"></a>            {% if field.required %}
</span><span id="__span-212-10"><a id="__codelineno-212-10" name="__codelineno-212-10" href="#__codelineno-212-10"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ field.value }}&quot;</span> <span class="na">required</span><span class="p">&gt;</span>
</span><span id="__span-212-11"><a id="__codelineno-212-11" name="__codelineno-212-11" href="#__codelineno-212-11"></a>            {% else %}
</span><span id="__span-212-12"><a id="__codelineno-212-12" name="__codelineno-212-12" href="#__codelineno-212-12"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-13"><a id="__codelineno-212-13" name="__codelineno-212-13" href="#__codelineno-212-13"></a>            {% endif %}
</span><span id="__span-212-14"><a id="__codelineno-212-14" name="__codelineno-212-14" href="#__codelineno-212-14"></a>        {% else %}
</span><span id="__span-212-15"><a id="__codelineno-212-15" name="__codelineno-212-15" href="#__codelineno-212-15"></a>            {% if field.required %}
</span><span id="__span-212-16"><a id="__codelineno-212-16" name="__codelineno-212-16" href="#__codelineno-212-16"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">required</span><span class="p">&gt;</span>
</span><span id="__span-212-17"><a id="__codelineno-212-17" name="__codelineno-212-17" href="#__codelineno-212-17"></a>            {% else %}
</span><span id="__span-212-18"><a id="__codelineno-212-18" name="__codelineno-212-18" href="#__codelineno-212-18"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-19"><a id="__codelineno-212-19" name="__codelineno-212-19" href="#__codelineno-212-19"></a>            {% endif %}
</span><span id="__span-212-20"><a id="__codelineno-212-20" name="__codelineno-212-20" href="#__codelineno-212-20"></a>        {% endif %}
</span><span id="__span-212-21"><a id="__codelineno-212-21" name="__codelineno-212-21" href="#__codelineno-212-21"></a>        {% elif field.type == &quot;password&quot; %}
</span><span id="__span-212-22"><a id="__codelineno-212-22" name="__codelineno-212-22" href="#__codelineno-212-22"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-23"><a id="__codelineno-212-23" name="__codelineno-212-23" href="#__codelineno-212-23"></a>        {% elif field.type == &quot;number&quot; %}
</span><span id="__span-212-24"><a id="__codelineno-212-24" name="__codelineno-212-24" href="#__codelineno-212-24"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;number&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-25"><a id="__codelineno-212-25" name="__codelineno-212-25" href="#__codelineno-212-25"></a>        {% elif field.type == &quot;file&quot; %}
</span><span id="__span-212-26"><a id="__codelineno-212-26" name="__codelineno-212-26" href="#__codelineno-212-26"></a>            {% if field.multiple %}
</span><span id="__span-212-27"><a id="__codelineno-212-27" name="__codelineno-212-27" href="#__codelineno-212-27"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;file&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">multiple</span><span class="p">&gt;</span>
</span><span id="__span-212-28"><a id="__codelineno-212-28" name="__codelineno-212-28" href="#__codelineno-212-28"></a>            {% else %}
</span><span id="__span-212-29"><a id="__codelineno-212-29" name="__codelineno-212-29" href="#__codelineno-212-29"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;file&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-30"><a id="__codelineno-212-30" name="__codelineno-212-30" href="#__codelineno-212-30"></a>            {% endif %}
</span><span id="__span-212-31"><a id="__codelineno-212-31" name="__codelineno-212-31" href="#__codelineno-212-31"></a>        {% elif field.type == &quot;checkbox&quot; %}
</span><span id="__span-212-32"><a id="__codelineno-212-32" name="__codelineno-212-32" href="#__codelineno-212-32"></a>            {% if field.checked %}
</span><span id="__span-212-33"><a id="__codelineno-212-33" name="__codelineno-212-33" href="#__codelineno-212-33"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">checked</span><span class="p">&gt;</span>
</span><span id="__span-212-34"><a id="__codelineno-212-34" name="__codelineno-212-34" href="#__codelineno-212-34"></a>            {% else %}
</span><span id="__span-212-35"><a id="__codelineno-212-35" name="__codelineno-212-35" href="#__codelineno-212-35"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-36"><a id="__codelineno-212-36" name="__codelineno-212-36" href="#__codelineno-212-36"></a>            {% endif %}
</span><span id="__span-212-37"><a id="__codelineno-212-37" name="__codelineno-212-37" href="#__codelineno-212-37"></a>        {% elif field.type == &quot;radio&quot; %}
</span><span id="__span-212-38"><a id="__codelineno-212-38" name="__codelineno-212-38" href="#__codelineno-212-38"></a>            {% for choice in field.choices %}
</span><span id="__span-212-39"><a id="__codelineno-212-39" name="__codelineno-212-39" href="#__codelineno-212-39"></a>                {% if choice == field.checked %}
</span><span id="__span-212-40"><a id="__codelineno-212-40" name="__codelineno-212-40" href="#__codelineno-212-40"></a>                <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;radio&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ choice }}&quot;</span> <span class="na">checked</span><span class="p">&gt;</span>{{ choice }}
</span><span id="__span-212-41"><a id="__codelineno-212-41" name="__codelineno-212-41" href="#__codelineno-212-41"></a>                {% else %}
</span><span id="__span-212-42"><a id="__codelineno-212-42" name="__codelineno-212-42" href="#__codelineno-212-42"></a>                <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;radio&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ choice }}&quot;</span><span class="p">&gt;</span>{{ choice }}
</span><span id="__span-212-43"><a id="__codelineno-212-43" name="__codelineno-212-43" href="#__codelineno-212-43"></a>                {% endif %}
</span><span id="__span-212-44"><a id="__codelineno-212-44" name="__codelineno-212-44" href="#__codelineno-212-44"></a>            {% endfor %}
</span><span id="__span-212-45"><a id="__codelineno-212-45" name="__codelineno-212-45" href="#__codelineno-212-45"></a>        {% elif field.type == &quot;select&quot; %}
</span><span id="__span-212-46"><a id="__codelineno-212-46" name="__codelineno-212-46" href="#__codelineno-212-46"></a>        <span class="p">&lt;</span><span class="nt">select</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-47"><a id="__codelineno-212-47" name="__codelineno-212-47" href="#__codelineno-212-47"></a>            {% for choice in field.choices %}
</span><span id="__span-212-48"><a id="__codelineno-212-48" name="__codelineno-212-48" href="#__codelineno-212-48"></a>            <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ choice }}&quot;</span><span class="p">&gt;</span>{{ choice }}<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
</span><span id="__span-212-49"><a id="__codelineno-212-49" name="__codelineno-212-49" href="#__codelineno-212-49"></a>            {% endfor %}
</span><span id="__span-212-50"><a id="__codelineno-212-50" name="__codelineno-212-50" href="#__codelineno-212-50"></a>        <span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
</span><span id="__span-212-51"><a id="__codelineno-212-51" name="__codelineno-212-51" href="#__codelineno-212-51"></a>        {% elif field.type == &quot;textarea&quot; %}
</span><span id="__span-212-52"><a id="__codelineno-212-52" name="__codelineno-212-52" href="#__codelineno-212-52"></a>            {% if field.rows %}
</span><span id="__span-212-53"><a id="__codelineno-212-53" name="__codelineno-212-53" href="#__codelineno-212-53"></a>            <span class="p">&lt;</span><span class="nt">textarea</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">rows</span><span class="o">=</span><span class="s">&quot;{{ field.rows }}&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">textarea</span><span class="p">&gt;</span>
</span><span id="__span-212-54"><a id="__codelineno-212-54" name="__codelineno-212-54" href="#__codelineno-212-54"></a>            {% else %}
</span><span id="__span-212-55"><a id="__codelineno-212-55" name="__codelineno-212-55" href="#__codelineno-212-55"></a>            <span class="p">&lt;</span><span class="nt">textarea</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">textarea</span><span class="p">&gt;</span>
</span><span id="__span-212-56"><a id="__codelineno-212-56" name="__codelineno-212-56" href="#__codelineno-212-56"></a>            {% endif %}
</span><span id="__span-212-57"><a id="__codelineno-212-57" name="__codelineno-212-57" href="#__codelineno-212-57"></a>        {% elif field.type == &quot;email&quot; %}
</span><span id="__span-212-58"><a id="__codelineno-212-58" name="__codelineno-212-58" href="#__codelineno-212-58"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;email&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-59"><a id="__codelineno-212-59" name="__codelineno-212-59" href="#__codelineno-212-59"></a>        {% elif field.type == &quot;hidden&quot; %}
</span><span id="__span-212-60"><a id="__codelineno-212-60" name="__codelineno-212-60" href="#__codelineno-212-60"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ field.value }}&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-61"><a id="__codelineno-212-61" name="__codelineno-212-61" href="#__codelineno-212-61"></a>        {% elif field.type == &quot;range&quot; %}
</span><span id="__span-212-62"><a id="__codelineno-212-62" name="__codelineno-212-62" href="#__codelineno-212-62"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;range&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-63"><a id="__codelineno-212-63" name="__codelineno-212-63" href="#__codelineno-212-63"></a>        {% elif field.type == &quot;search&quot; %}
</span><span id="__span-212-64"><a id="__codelineno-212-64" name="__codelineno-212-64" href="#__codelineno-212-64"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;search&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-65"><a id="__codelineno-212-65" name="__codelineno-212-65" href="#__codelineno-212-65"></a>        {% elif field.type == &quot;datetime-local&quot; %}
</span><span id="__span-212-66"><a id="__codelineno-212-66" name="__codelineno-212-66" href="#__codelineno-212-66"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;datetime-local&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-67"><a id="__codelineno-212-67" name="__codelineno-212-67" href="#__codelineno-212-67"></a>        {% elif field.type == &quot;time&quot; %}
</span><span id="__span-212-68"><a id="__codelineno-212-68" name="__codelineno-212-68" href="#__codelineno-212-68"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;time&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-69"><a id="__codelineno-212-69" name="__codelineno-212-69" href="#__codelineno-212-69"></a>        {% elif field.type == &quot;datetime&quot; %}
</span><span id="__span-212-70"><a id="__codelineno-212-70" name="__codelineno-212-70" href="#__codelineno-212-70"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;datetime&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-71"><a id="__codelineno-212-71" name="__codelineno-212-71" href="#__codelineno-212-71"></a>        {% elif field.type == &quot;month&quot; %}
</span><span id="__span-212-72"><a id="__codelineno-212-72" name="__codelineno-212-72" href="#__codelineno-212-72"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;month&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-73"><a id="__codelineno-212-73" name="__codelineno-212-73" href="#__codelineno-212-73"></a>        {% elif field.type == &quot;week&quot; %}
</span><span id="__span-212-74"><a id="__codelineno-212-74" name="__codelineno-212-74" href="#__codelineno-212-74"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;week&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-75"><a id="__codelineno-212-75" name="__codelineno-212-75" href="#__codelineno-212-75"></a>        {% elif field.type == &quot;color&quot; %}
</span><span id="__span-212-76"><a id="__codelineno-212-76" name="__codelineno-212-76" href="#__codelineno-212-76"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;color&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-77"><a id="__codelineno-212-77" name="__codelineno-212-77" href="#__codelineno-212-77"></a>        {% elif field.type == &quot;url&quot; %}
</span><span id="__span-212-78"><a id="__codelineno-212-78" name="__codelineno-212-78" href="#__codelineno-212-78"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;url&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-79"><a id="__codelineno-212-79" name="__codelineno-212-79" href="#__codelineno-212-79"></a>        {% elif field.type == &quot;tel&quot; %}
</span><span id="__span-212-80"><a id="__codelineno-212-80" name="__codelineno-212-80" href="#__codelineno-212-80"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;tel&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;{{ field.name }}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-81"><a id="__codelineno-212-81" name="__codelineno-212-81" href="#__codelineno-212-81"></a>        {% endif %}
</span><span id="__span-212-82"><a id="__codelineno-212-82" name="__codelineno-212-82" href="#__codelineno-212-82"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-212-83"><a id="__codelineno-212-83" name="__codelineno-212-83" href="#__codelineno-212-83"></a>        {% endfor %}
</span><span id="__span-212-84"><a id="__codelineno-212-84" name="__codelineno-212-84" href="#__codelineno-212-84"></a>
</span><span id="__span-212-85"><a id="__codelineno-212-85" name="__codelineno-212-85" href="#__codelineno-212-85"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-actions&quot;</span><span class="p">&gt;</span>
</span><span id="__span-212-86"><a id="__codelineno-212-86" name="__codelineno-212-86" href="#__codelineno-212-86"></a>            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-primary&quot;</span><span class="p">&gt;</span>提交<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span><span id="__span-212-87"><a id="__codelineno-212-87" name="__codelineno-212-87" href="#__codelineno-212-87"></a>            <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;post_list&#39; %}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-secondary&quot;</span><span class="p">&gt;</span>返回列表<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span><span id="__span-212-88"><a id="__codelineno-212-88" name="__codelineno-212-88" href="#__codelineno-212-88"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-212-89"><a id="__codelineno-212-89" name="__codelineno-212-89" href="#__codelineno-212-89"></a>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>return render(request, 'blog/create_post.html', {"fields": dynamic_fields.dynamic_fields})</p>
<p><strong>CSRF（跨站请求伪造）保护机制</strong>：
确保 <code>settings.py</code> 中启用了 <code>CsrfViewMiddleware</code>中间件
确保表单的 <code>action</code> 属性指向正确的 URL，并且该 URL 与 CSRF Token 的作用域一致。</p>
<p>确保表单包含 <code>{% csrf_token %}</code>CSRF 防护</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-213-1"><a id="__codelineno-213-1" name="__codelineno-213-1" href="#__codelineno-213-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.views.decorators.csrf</span><span class="w"> </span><span class="kn">import</span> <span class="n">csrf_protect</span>
</span><span id="__span-213-2"><a id="__codelineno-213-2" name="__codelineno-213-2" href="#__codelineno-213-2"></a>
</span><span id="__span-213-3"><a id="__codelineno-213-3" name="__codelineno-213-3" href="#__codelineno-213-3"></a><span class="nd">@csrf_protect</span>
</span><span id="__span-213-4"><a id="__codelineno-213-4" name="__codelineno-213-4" href="#__codelineno-213-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span></code></pre></div>
<p>为特定视图禁用 CSRF（仅用于测试）</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-214-1"><a id="__codelineno-214-1" name="__codelineno-214-1" href="#__codelineno-214-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.views.decorators.csrf</span><span class="w"> </span><span class="kn">import</span> <span class="n">csrf_exempt</span>
</span><span id="__span-214-2"><a id="__codelineno-214-2" name="__codelineno-214-2" href="#__codelineno-214-2"></a>
</span><span id="__span-214-3"><a id="__codelineno-214-3" name="__codelineno-214-3" href="#__codelineno-214-3"></a><span class="nd">@csrf_exempt</span>
</span><span id="__span-214-4"><a id="__codelineno-214-4" name="__codelineno-214-4" href="#__codelineno-214-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span></code></pre></div>
<p><strong>分页展示</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-215-1"><a id="__codelineno-215-1" name="__codelineno-215-1" href="#__codelineno-215-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.paginator</span><span class="w"> </span><span class="kn">import</span> <span class="n">Paginator</span>
</span><span id="__span-215-2"><a id="__codelineno-215-2" name="__codelineno-215-2" href="#__codelineno-215-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span>
</span><span id="__span-215-3"><a id="__codelineno-215-3" name="__codelineno-215-3" href="#__codelineno-215-3"></a>
</span><span id="__span-215-4"><a id="__codelineno-215-4" name="__codelineno-215-4" href="#__codelineno-215-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">post_list</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span id="__span-215-5"><a id="__codelineno-215-5" name="__codelineno-215-5" href="#__codelineno-215-5"></a>    <span class="n">posts</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="__span-215-6"><a id="__codelineno-215-6" name="__codelineno-215-6" href="#__codelineno-215-6"></a>    <span class="c1"># posts = Post.objects.all().order_by(&#39;-id&#39;) # 按照 ID 倒序排列，从新到旧</span>
</span><span id="__span-215-7"><a id="__codelineno-215-7" name="__codelineno-215-7" href="#__codelineno-215-7"></a>    <span class="n">paginator</span> <span class="o">=</span> <span class="n">Paginator</span><span class="p">(</span><span class="n">posts</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># 每页显示 10 条数据</span>
</span><span id="__span-215-8"><a id="__codelineno-215-8" name="__codelineno-215-8" href="#__codelineno-215-8"></a>    <span class="n">page_number</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">)</span>
</span><span id="__span-215-9"><a id="__codelineno-215-9" name="__codelineno-215-9" href="#__codelineno-215-9"></a>    <span class="n">page_obj</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">get_page</span><span class="p">(</span><span class="n">page_number</span><span class="p">)</span>
</span><span id="__span-215-10"><a id="__codelineno-215-10" name="__codelineno-215-10" href="#__codelineno-215-10"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;blog/post_list.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;posts&#39;</span><span class="p">:</span> <span class="n">page_obj</span><span class="p">})</span>
</span></code></pre></div>
<div class="language-html highlight"><pre><span></span><code><span id="__span-216-1"><a id="__codelineno-216-1" name="__codelineno-216-1" href="#__codelineno-216-1"></a>{% for post in posts %}
</span><span id="__span-216-2"><a id="__codelineno-216-2" name="__codelineno-216-2" href="#__codelineno-216-2"></a># ......
</span><span id="__span-216-3"><a id="__codelineno-216-3" name="__codelineno-216-3" href="#__codelineno-216-3"></a>{% endif %}
</span><span id="__span-216-4"><a id="__codelineno-216-4" name="__codelineno-216-4" href="#__codelineno-216-4"></a>
</span><span id="__span-216-5"><a id="__codelineno-216-5" name="__codelineno-216-5" href="#__codelineno-216-5"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;pagination&quot;</span><span class="p">&gt;</span>
</span><span id="__span-216-6"><a id="__codelineno-216-6" name="__codelineno-216-6" href="#__codelineno-216-6"></a>    {% if posts.has_previous %}
</span><span id="__span-216-7"><a id="__codelineno-216-7" name="__codelineno-216-7" href="#__codelineno-216-7"></a>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;?page=1&quot;</span><span class="p">&gt;</span>« First<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span><span id="__span-216-8"><a id="__codelineno-216-8" name="__codelineno-216-8" href="#__codelineno-216-8"></a>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;?page={{ posts.previous_page_number }}&quot;</span><span class="p">&gt;</span>Previous<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span><span id="__span-216-9"><a id="__codelineno-216-9" name="__codelineno-216-9" href="#__codelineno-216-9"></a>    {% endif %}
</span><span id="__span-216-10"><a id="__codelineno-216-10" name="__codelineno-216-10" href="#__codelineno-216-10"></a>
</span><span id="__span-216-11"><a id="__codelineno-216-11" name="__codelineno-216-11" href="#__codelineno-216-11"></a>    {% for num in posts.paginator.page_range %}
</span><span id="__span-216-12"><a id="__codelineno-216-12" name="__codelineno-216-12" href="#__codelineno-216-12"></a>        {% if posts.number == num %}
</span><span id="__span-216-13"><a id="__codelineno-216-13" name="__codelineno-216-13" href="#__codelineno-216-13"></a>            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;active&quot;</span><span class="p">&gt;</span>{{ num }}<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span><span id="__span-216-14"><a id="__codelineno-216-14" name="__codelineno-216-14" href="#__codelineno-216-14"></a>        {% else %}
</span><span id="__span-216-15"><a id="__codelineno-216-15" name="__codelineno-216-15" href="#__codelineno-216-15"></a>            <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;?page={{ num }}&quot;</span><span class="p">&gt;</span>{{ num }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span><span id="__span-216-16"><a id="__codelineno-216-16" name="__codelineno-216-16" href="#__codelineno-216-16"></a>        {% endif %}
</span><span id="__span-216-17"><a id="__codelineno-216-17" name="__codelineno-216-17" href="#__codelineno-216-17"></a>    {% endfor %}
</span><span id="__span-216-18"><a id="__codelineno-216-18" name="__codelineno-216-18" href="#__codelineno-216-18"></a>
</span><span id="__span-216-19"><a id="__codelineno-216-19" name="__codelineno-216-19" href="#__codelineno-216-19"></a>    {% if posts.has_next %}
</span><span id="__span-216-20"><a id="__codelineno-216-20" name="__codelineno-216-20" href="#__codelineno-216-20"></a>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;?page={{ posts.next_page_number }}&quot;</span><span class="p">&gt;</span>Next<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span><span id="__span-216-21"><a id="__codelineno-216-21" name="__codelineno-216-21" href="#__codelineno-216-21"></a>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;?page={{ posts.paginator.num_pages }}&quot;</span><span class="p">&gt;</span>Last »<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span><span id="__span-216-22"><a id="__codelineno-216-22" name="__codelineno-216-22" href="#__codelineno-216-22"></a>    {% endif %}
</span></code></pre></div>
<p><strong>添加编号</strong>
编号规则是 <code>QSA&lt;YYYYMMDD&gt;&lt;两位编号&gt;-&lt;复制次数&gt;</code></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-217-1"><a id="__codelineno-217-1" name="__codelineno-217-1" href="#__codelineno-217-1"></a><span class="c1"># models.py</span>
</span><span id="__span-217-2"><a id="__codelineno-217-2" name="__codelineno-217-2" href="#__codelineno-217-2"></a><span class="n">qsa_number</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># 新增字段，用于保存编号</span>
</span><span id="__span-217-3"><a id="__codelineno-217-3" name="__codelineno-217-3" href="#__codelineno-217-3"></a>
</span><span id="__span-217-4"><a id="__codelineno-217-4" name="__codelineno-217-4" href="#__codelineno-217-4"></a><span class="c1"># views.py</span>
</span><span id="__span-217-5"><a id="__codelineno-217-5" name="__codelineno-217-5" href="#__codelineno-217-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
</span><span id="__span-217-6"><a id="__codelineno-217-6" name="__codelineno-217-6" href="#__codelineno-217-6"></a>
</span><span id="__span-217-7"><a id="__codelineno-217-7" name="__codelineno-217-7" href="#__codelineno-217-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_qsa_number</span><span class="p">():</span>
</span><span id="__span-217-8"><a id="__codelineno-217-8" name="__codelineno-217-8" href="#__codelineno-217-8"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-217-9"><a id="__codelineno-217-9" name="__codelineno-217-9" href="#__codelineno-217-9"></a><span class="sd">    生成唯一的 QSA 编号，格式为 QSA&lt;YYYYMMDD&gt;&lt;两位编号&gt;_1</span>
</span><span id="__span-217-10"><a id="__codelineno-217-10" name="__codelineno-217-10" href="#__codelineno-217-10"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-217-11"><a id="__codelineno-217-11" name="__codelineno-217-11" href="#__codelineno-217-11"></a>    <span class="n">today</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># 获取当前日期，格式为 YYYYMMDD</span>
</span><span id="__span-217-12"><a id="__codelineno-217-12" name="__codelineno-217-12" href="#__codelineno-217-12"></a>    <span class="n">prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;QSA</span><span class="si">{</span><span class="n">today</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># 编号前缀</span>
</span><span id="__span-217-13"><a id="__codelineno-217-13" name="__codelineno-217-13" href="#__codelineno-217-13"></a>
</span><span id="__span-217-14"><a id="__codelineno-217-14" name="__codelineno-217-14" href="#__codelineno-217-14"></a>    <span class="c1"># 查询当天已有编号</span>
</span><span id="__span-217-15"><a id="__codelineno-217-15" name="__codelineno-217-15" href="#__codelineno-217-15"></a>    <span class="n">existing_qsas</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">qsa_number__startswith</span><span class="o">=</span><span class="n">prefix</span><span class="p">)</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s1">&#39;qsa_number&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-217-16"><a id="__codelineno-217-16" name="__codelineno-217-16" href="#__codelineno-217-16"></a>
</span><span id="__span-217-17"><a id="__codelineno-217-17" name="__codelineno-217-17" href="#__codelineno-217-17"></a>    <span class="c1"># 提取当天的最大编号</span>
</span><span id="__span-217-18"><a id="__codelineno-217-18" name="__codelineno-217-18" href="#__codelineno-217-18"></a>    <span class="n">max_number</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-217-19"><a id="__codelineno-217-19" name="__codelineno-217-19" href="#__codelineno-217-19"></a>    <span class="k">for</span> <span class="n">qsa_number</span> <span class="ow">in</span> <span class="n">existing_qsas</span><span class="p">:</span>
</span><span id="__span-217-20"><a id="__codelineno-217-20" name="__codelineno-217-20" href="#__codelineno-217-20"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-217-21"><a id="__codelineno-217-21" name="__codelineno-217-21" href="#__codelineno-217-21"></a>            <span class="n">main_part</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">qsa_number</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># 分离主部分和复制次数</span>
</span><span id="__span-217-22"><a id="__codelineno-217-22" name="__codelineno-217-22" href="#__codelineno-217-22"></a>            <span class="n">number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">main_part</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">):])</span>  <span class="c1"># 提取两位编号</span>
</span><span id="__span-217-23"><a id="__codelineno-217-23" name="__codelineno-217-23" href="#__codelineno-217-23"></a>            <span class="n">max_number</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_number</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
</span><span id="__span-217-24"><a id="__codelineno-217-24" name="__codelineno-217-24" href="#__codelineno-217-24"></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="__span-217-25"><a id="__codelineno-217-25" name="__codelineno-217-25" href="#__codelineno-217-25"></a>            <span class="k">continue</span>  <span class="c1"># 忽略格式不正确的编号</span>
</span><span id="__span-217-26"><a id="__codelineno-217-26" name="__codelineno-217-26" href="#__codelineno-217-26"></a>
</span><span id="__span-217-27"><a id="__codelineno-217-27" name="__codelineno-217-27" href="#__codelineno-217-27"></a>    <span class="c1"># 生成新的编号</span>
</span><span id="__span-217-28"><a id="__codelineno-217-28" name="__codelineno-217-28" href="#__codelineno-217-28"></a>    <span class="n">new_number</span> <span class="o">=</span> <span class="n">max_number</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-217-29"><a id="__codelineno-217-29" name="__codelineno-217-29" href="#__codelineno-217-29"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="nb">str</span><span class="p">(</span><span class="n">new_number</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">-1&quot;</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-218-1"><a id="__codelineno-218-1" name="__codelineno-218-1" href="#__codelineno-218-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.forms.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">model_to_dict</span>
</span><span id="__span-218-2"><a id="__codelineno-218-2" name="__codelineno-218-2" href="#__codelineno-218-2"></a>
</span><span id="__span-218-3"><a id="__codelineno-218-3" name="__codelineno-218-3" href="#__codelineno-218-3"></a><span class="nd">@permission_required</span><span class="p">(</span><span class="s1">&#39;mqsa.add_post&#39;</span><span class="p">)</span>
</span><span id="__span-218-4"><a id="__codelineno-218-4" name="__codelineno-218-4" href="#__codelineno-218-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">qsa_copy</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
</span><span id="__span-218-5"><a id="__codelineno-218-5" name="__codelineno-218-5" href="#__codelineno-218-5"></a>    <span class="c1"># 获取原始对象</span>
</span><span id="__span-218-6"><a id="__codelineno-218-6" name="__codelineno-218-6" href="#__codelineno-218-6"></a>    <span class="n">original_post</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Post</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span>
</span><span id="__span-218-7"><a id="__codelineno-218-7" name="__codelineno-218-7" href="#__codelineno-218-7"></a>
</span><span id="__span-218-8"><a id="__codelineno-218-8" name="__codelineno-218-8" href="#__codelineno-218-8"></a>    <span class="c1"># 检查原始对象是否有编号</span>
</span><span id="__span-218-9"><a id="__codelineno-218-9" name="__codelineno-218-9" href="#__codelineno-218-9"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">original_post</span><span class="o">.</span><span class="n">qsa_number</span><span class="p">:</span>
</span><span id="__span-218-10"><a id="__codelineno-218-10" name="__codelineno-218-10" href="#__codelineno-218-10"></a>        <span class="c1"># 如果编号不存在，生成一个新的编号</span>
</span><span id="__span-218-11"><a id="__codelineno-218-11" name="__codelineno-218-11" href="#__codelineno-218-11"></a>        <span class="n">original_post</span><span class="o">.</span><span class="n">qsa_number</span> <span class="o">=</span> <span class="n">generate_qsa_number</span><span class="p">()</span>
</span><span id="__span-218-12"><a id="__codelineno-218-12" name="__codelineno-218-12" href="#__codelineno-218-12"></a>        <span class="n">original_post</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="__span-218-13"><a id="__codelineno-218-13" name="__codelineno-218-13" href="#__codelineno-218-13"></a>
</span><span id="__span-218-14"><a id="__codelineno-218-14" name="__codelineno-218-14" href="#__codelineno-218-14"></a>    <span class="c1"># 提取原始编号</span>
</span><span id="__span-218-15"><a id="__codelineno-218-15" name="__codelineno-218-15" href="#__codelineno-218-15"></a>    <span class="n">original_number</span> <span class="o">=</span> <span class="n">original_post</span><span class="o">.</span><span class="n">qsa_number</span>
</span><span id="__span-218-16"><a id="__codelineno-218-16" name="__codelineno-218-16" href="#__codelineno-218-16"></a>
</span><span id="__span-218-17"><a id="__codelineno-218-17" name="__codelineno-218-17" href="#__codelineno-218-17"></a>    <span class="c1"># 分离编号的主部分和复制次数</span>
</span><span id="__span-218-18"><a id="__codelineno-218-18" name="__codelineno-218-18" href="#__codelineno-218-18"></a>    <span class="n">main_part</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="n">original_number</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-218-19"><a id="__codelineno-218-19" name="__codelineno-218-19" href="#__codelineno-218-19"></a>    <span class="n">new_suffix</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># 复制次数递增</span>
</span><span id="__span-218-20"><a id="__codelineno-218-20" name="__codelineno-218-20" href="#__codelineno-218-20"></a>    <span class="n">new_qsa_number</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">main_part</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">new_suffix</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># 生成新的编号</span>
</span><span id="__span-218-21"><a id="__codelineno-218-21" name="__codelineno-218-21" href="#__codelineno-218-21"></a>
</span><span id="__span-218-22"><a id="__codelineno-218-22" name="__codelineno-218-22" href="#__codelineno-218-22"></a>    <span class="c1"># 将对象转换为字典</span>
</span><span id="__span-218-23"><a id="__codelineno-218-23" name="__codelineno-218-23" href="#__codelineno-218-23"></a>    <span class="n">post_data</span> <span class="o">=</span> <span class="n">model_to_dict</span><span class="p">(</span><span class="n">original_post</span><span class="p">)</span>
</span><span id="__span-218-24"><a id="__codelineno-218-24" name="__codelineno-218-24" href="#__codelineno-218-24"></a>    <span class="n">post_data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># 移除主键字段以避免冲突</span>
</span><span id="__span-218-25"><a id="__codelineno-218-25" name="__codelineno-218-25" href="#__codelineno-218-25"></a>    <span class="n">post_data</span><span class="p">[</span><span class="s1">&#39;qsa_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_qsa_number</span>  <span class="c1"># 更新编号</span>
</span><span id="__span-218-26"><a id="__codelineno-218-26" name="__codelineno-218-26" href="#__codelineno-218-26"></a>
</span><span id="__span-218-27"><a id="__codelineno-218-27" name="__codelineno-218-27" href="#__codelineno-218-27"></a>    <span class="c1"># 创建新对象</span>
</span><span id="__span-218-28"><a id="__codelineno-218-28" name="__codelineno-218-28" href="#__codelineno-218-28"></a>    <span class="n">new_post</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="o">**</span><span class="n">post_data</span><span class="p">)</span>
</span><span id="__span-218-29"><a id="__codelineno-218-29" name="__codelineno-218-29" href="#__codelineno-218-29"></a>
</span><span id="__span-218-30"><a id="__codelineno-218-30" name="__codelineno-218-30" href="#__codelineno-218-30"></a>    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;qsa_edit&#39;</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">new_post</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>  <span class="c1"># 跳转到编辑页面</span>
</span></code></pre></div>
<p><strong>用户认证</strong>
登录视图示例：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-219-1"><a id="__codelineno-219-1" name="__codelineno-219-1" href="#__codelineno-219-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth</span><span class="w"> </span><span class="kn">import</span> <span class="n">authenticate</span><span class="p">,</span> <span class="n">login</span>
</span><span id="__span-219-2"><a id="__codelineno-219-2" name="__codelineno-219-2" href="#__codelineno-219-2"></a>
</span><span id="__span-219-3"><a id="__codelineno-219-3" name="__codelineno-219-3" href="#__codelineno-219-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">user_login</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span id="__span-219-4"><a id="__codelineno-219-4" name="__codelineno-219-4" href="#__codelineno-219-4"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
</span><span id="__span-219-5"><a id="__codelineno-219-5" name="__codelineno-219-5" href="#__codelineno-219-5"></a>        <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
</span><span id="__span-219-6"><a id="__codelineno-219-6" name="__codelineno-219-6" href="#__codelineno-219-6"></a>        <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>
</span><span id="__span-219-7"><a id="__codelineno-219-7" name="__codelineno-219-7" href="#__codelineno-219-7"></a>        <span class="n">user</span> <span class="o">=</span> <span class="n">authenticate</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
</span><span id="__span-219-8"><a id="__codelineno-219-8" name="__codelineno-219-8" href="#__codelineno-219-8"></a>        <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-219-9"><a id="__codelineno-219-9" name="__codelineno-219-9" href="#__codelineno-219-9"></a>            <span class="n">login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
</span><span id="__span-219-10"><a id="__codelineno-219-10" name="__codelineno-219-10" href="#__codelineno-219-10"></a>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">)</span>
</span><span id="__span-219-11"><a id="__codelineno-219-11" name="__codelineno-219-11" href="#__codelineno-219-11"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;login.html&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>REST API</strong> API用于前后端分离项目
使用Django REST Framework生成REST API风格的API
安装 DRF：<code>pip install djangorestframework</code></p>
<p><a href="https://www.postman.com/downloads/">Postman</a>是一款常用的 API 测试工具，可以方便地进行接口测试、调试和文档编写。</p>
<p>以books应用为例：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-220-1"><a id="__codelineno-220-1" name="__codelineno-220-1" href="#__codelineno-220-1"></a><span class="c1"># myproject/settings.py 配置项目设置</span>
</span><span id="__span-220-2"><a id="__codelineno-220-2" name="__codelineno-220-2" href="#__codelineno-220-2"></a><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-220-3"><a id="__codelineno-220-3" name="__codelineno-220-3" href="#__codelineno-220-3"></a>    <span class="o">...</span>
</span><span id="__span-220-4"><a id="__codelineno-220-4" name="__codelineno-220-4" href="#__codelineno-220-4"></a>    <span class="s1">&#39;rest_framework&#39;</span><span class="p">,</span>
</span><span id="__span-220-5"><a id="__codelineno-220-5" name="__codelineno-220-5" href="#__codelineno-220-5"></a>    <span class="s1">&#39;books.apps.BooksConfig&#39;</span>
</span><span id="__span-220-6"><a id="__codelineno-220-6" name="__codelineno-220-6" href="#__codelineno-220-6"></a><span class="p">]</span>
</span><span id="__span-220-7"><a id="__codelineno-220-7" name="__codelineno-220-7" href="#__codelineno-220-7"></a>
</span><span id="__span-220-8"><a id="__codelineno-220-8" name="__codelineno-220-8" href="#__codelineno-220-8"></a><span class="n">REST_FRAMEWORK</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-220-9"><a id="__codelineno-220-9" name="__codelineno-220-9" href="#__codelineno-220-9"></a>    <span class="s1">&#39;DEFAULT_PERMISSION_CLASSES&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-220-10"><a id="__codelineno-220-10" name="__codelineno-220-10" href="#__codelineno-220-10"></a>        <span class="s1">&#39;rest_framework.permissions.AllowAny&#39;</span>
</span><span id="__span-220-11"><a id="__codelineno-220-11" name="__codelineno-220-11" href="#__codelineno-220-11"></a>    <span class="p">]</span>
</span><span id="__span-220-12"><a id="__codelineno-220-12" name="__codelineno-220-12" href="#__codelineno-220-12"></a><span class="p">}</span>
</span><span id="__span-220-13"><a id="__codelineno-220-13" name="__codelineno-220-13" href="#__codelineno-220-13"></a>
</span><span id="__span-220-14"><a id="__codelineno-220-14" name="__codelineno-220-14" href="#__codelineno-220-14"></a><span class="c1"># books/models.py  定义数据模型</span>
</span><span id="__span-220-15"><a id="__codelineno-220-15" name="__codelineno-220-15" href="#__codelineno-220-15"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
</span><span id="__span-220-16"><a id="__codelineno-220-16" name="__codelineno-220-16" href="#__codelineno-220-16"></a>
</span><span id="__span-220-17"><a id="__codelineno-220-17" name="__codelineno-220-17" href="#__codelineno-220-17"></a><span class="k">class</span><span class="w"> </span><span class="nc">Book</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span><span id="__span-220-18"><a id="__codelineno-220-18" name="__codelineno-220-18" href="#__codelineno-220-18"></a>    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</span><span id="__span-220-19"><a id="__codelineno-220-19" name="__codelineno-220-19" href="#__codelineno-220-19"></a>    <span class="n">author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="__span-220-20"><a id="__codelineno-220-20" name="__codelineno-220-20" href="#__codelineno-220-20"></a>    <span class="n">published_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
</span><span id="__span-220-21"><a id="__codelineno-220-21" name="__codelineno-220-21" href="#__codelineno-220-21"></a>    <span class="n">isbn</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-220-22"><a id="__codelineno-220-22" name="__codelineno-220-22" href="#__codelineno-220-22"></a>    <span class="n">price</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DecimalField</span><span class="p">(</span><span class="n">max_digits</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-220-23"><a id="__codelineno-220-23" name="__codelineno-220-23" href="#__codelineno-220-23"></a>
</span><span id="__span-220-24"><a id="__codelineno-220-24" name="__codelineno-220-24" href="#__codelineno-220-24"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-220-25"><a id="__codelineno-220-25" name="__codelineno-220-25" href="#__codelineno-220-25"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
</span><span id="__span-220-26"><a id="__codelineno-220-26" name="__codelineno-220-26" href="#__codelineno-220-26"></a>
</span><span id="__span-220-27"><a id="__codelineno-220-27" name="__codelineno-220-27" href="#__codelineno-220-27"></a><span class="c1"># books/serializers.py  创建序列化器</span>
</span><span id="__span-220-28"><a id="__codelineno-220-28" name="__codelineno-220-28" href="#__codelineno-220-28"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">serializers</span>
</span><span id="__span-220-29"><a id="__codelineno-220-29" name="__codelineno-220-29" href="#__codelineno-220-29"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Book</span>
</span><span id="__span-220-30"><a id="__codelineno-220-30" name="__codelineno-220-30" href="#__codelineno-220-30"></a>
</span><span id="__span-220-31"><a id="__codelineno-220-31" name="__codelineno-220-31" href="#__codelineno-220-31"></a><span class="k">class</span><span class="w"> </span><span class="nc">BookSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
</span><span id="__span-220-32"><a id="__codelineno-220-32" name="__codelineno-220-32" href="#__codelineno-220-32"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
</span><span id="__span-220-33"><a id="__codelineno-220-33" name="__codelineno-220-33" href="#__codelineno-220-33"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">Book</span>
</span><span id="__span-220-34"><a id="__codelineno-220-34" name="__codelineno-220-34" href="#__codelineno-220-34"></a>        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="s1">&#39;published_date&#39;</span><span class="p">,</span> <span class="s1">&#39;isbn&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span>
</span><span id="__span-220-35"><a id="__codelineno-220-35" name="__codelineno-220-35" href="#__codelineno-220-35"></a>
</span><span id="__span-220-36"><a id="__codelineno-220-36" name="__codelineno-220-36" href="#__codelineno-220-36"></a><span class="c1"># books/views.py 构建视图集</span>
</span><span id="__span-220-37"><a id="__codelineno-220-37" name="__codelineno-220-37" href="#__codelineno-220-37"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">viewsets</span>
</span><span id="__span-220-38"><a id="__codelineno-220-38" name="__codelineno-220-38" href="#__codelineno-220-38"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Book</span>
</span><span id="__span-220-39"><a id="__codelineno-220-39" name="__codelineno-220-39" href="#__codelineno-220-39"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.serializers</span><span class="w"> </span><span class="kn">import</span> <span class="n">BookSerializer</span>
</span><span id="__span-220-40"><a id="__codelineno-220-40" name="__codelineno-220-40" href="#__codelineno-220-40"></a>
</span><span id="__span-220-41"><a id="__codelineno-220-41" name="__codelineno-220-41" href="#__codelineno-220-41"></a><span class="k">class</span><span class="w"> </span><span class="nc">BookViewSet</span><span class="p">(</span><span class="n">viewsets</span><span class="o">.</span><span class="n">ModelViewSet</span><span class="p">):</span>
</span><span id="__span-220-42"><a id="__codelineno-220-42" name="__codelineno-220-42" href="#__codelineno-220-42"></a>    <span class="n">queryset</span> <span class="o">=</span> <span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-published_date&#39;</span><span class="p">)</span>
</span><span id="__span-220-43"><a id="__codelineno-220-43" name="__codelineno-220-43" href="#__codelineno-220-43"></a>    <span class="n">serializer_class</span> <span class="o">=</span> <span class="n">BookSerializer</span>
</span><span id="__span-220-44"><a id="__codelineno-220-44" name="__codelineno-220-44" href="#__codelineno-220-44"></a>
</span><span id="__span-220-45"><a id="__codelineno-220-45" name="__codelineno-220-45" href="#__codelineno-220-45"></a><span class="c1"># books/urls.py  配置路由</span>
</span><span id="__span-220-46"><a id="__codelineno-220-46" name="__codelineno-220-46" href="#__codelineno-220-46"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">path</span>
</span><span id="__span-220-47"><a id="__codelineno-220-47" name="__codelineno-220-47" href="#__codelineno-220-47"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">routers</span>
</span><span id="__span-220-48"><a id="__codelineno-220-48" name="__codelineno-220-48" href="#__codelineno-220-48"></a><span class="kn">from</span><span class="w"> </span><span class="nn">books</span><span class="w"> </span><span class="kn">import</span> <span class="n">views</span>
</span><span id="__span-220-49"><a id="__codelineno-220-49" name="__codelineno-220-49" href="#__codelineno-220-49"></a>
</span><span id="__span-220-50"><a id="__codelineno-220-50" name="__codelineno-220-50" href="#__codelineno-220-50"></a><span class="n">router</span> <span class="o">=</span> <span class="n">routers</span><span class="o">.</span><span class="n">DefaultRouter</span><span class="p">()</span>
</span><span id="__span-220-51"><a id="__codelineno-220-51" name="__codelineno-220-51" href="#__codelineno-220-51"></a><span class="n">router</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;books&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">BookViewSet</span><span class="p">)</span>
</span><span id="__span-220-52"><a id="__codelineno-220-52" name="__codelineno-220-52" href="#__codelineno-220-52"></a>
</span><span id="__span-220-53"><a id="__codelineno-220-53" name="__codelineno-220-53" href="#__codelineno-220-53"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-220-54"><a id="__codelineno-220-54" name="__codelineno-220-54" href="#__codelineno-220-54"></a>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;api/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">router</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span>
</span><span id="__span-220-55"><a id="__codelineno-220-55" name="__codelineno-220-55" href="#__codelineno-220-55"></a>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;api-auth/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;rest_framework.urls&#39;</span><span class="p">))</span>
</span><span id="__span-220-56"><a id="__codelineno-220-56" name="__codelineno-220-56" href="#__codelineno-220-56"></a><span class="p">]</span>
</span><span id="__span-220-57"><a id="__codelineno-220-57" name="__codelineno-220-57" href="#__codelineno-220-57"></a>
</span><span id="__span-220-58"><a id="__codelineno-220-58" name="__codelineno-220-58" href="#__codelineno-220-58"></a><span class="c1"># myproject/urls.py</span>
</span><span id="__span-220-59"><a id="__codelineno-220-59" name="__codelineno-220-59" href="#__codelineno-220-59"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">path</span>
</span><span id="__span-220-60"><a id="__codelineno-220-60" name="__codelineno-220-60" href="#__codelineno-220-60"></a>
</span><span id="__span-220-61"><a id="__codelineno-220-61" name="__codelineno-220-61" href="#__codelineno-220-61"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-220-62"><a id="__codelineno-220-62" name="__codelineno-220-62" href="#__codelineno-220-62"></a>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
</span><span id="__span-220-63"><a id="__codelineno-220-63" name="__codelineno-220-63" href="#__codelineno-220-63"></a>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;api.urls&#39;</span><span class="p">)),</span>
</span><span id="__span-220-64"><a id="__codelineno-220-64" name="__codelineno-220-64" href="#__codelineno-220-64"></a><span class="p">]</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-221-1"><a id="__codelineno-221-1" name="__codelineno-221-1" href="#__codelineno-221-1"></a>python<span class="w"> </span>manage.py<span class="w"> </span>makemigrations
</span><span id="__span-221-2"><a id="__codelineno-221-2" name="__codelineno-221-2" href="#__codelineno-221-2"></a>python<span class="w"> </span>manage.py<span class="w"> </span>migrate
</span></code></pre></div>
<p>==RESTful API 端点说明==</p>
<table>
<thead>
<tr>
<th>HTTP方法</th>
<th>URL</th>
<th>功能描述</th>
<th>示例请求体 (JSON)</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/api/books/</td>
<td>获取所有书籍</td>
<td>无需请求体</td>
</tr>
<tr>
<td>POST</td>
<td>/api/books/</td>
<td>创建新书</td>
<td><code>{"title":"...", "author":"...", ...}</code></td>
</tr>
<tr>
<td>GET</td>
<td>/api/books/1/</td>
<td>获取ID=1的书籍</td>
<td>无需请求体</td>
</tr>
<tr>
<td>PUT</td>
<td>/api/books/1/</td>
<td>更新ID=1的书籍</td>
<td><code>{"title":"新版书名", ...}</code></td>
</tr>
<tr>
<td>DELETE</td>
<td>/api/books/1/</td>
<td>删除ID=1的书籍</td>
<td>无需请求体</td>
</tr>
</tbody>
</table>
<p>==前端调用示例 (JavaScript)==</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-222-1"><a id="__codelineno-222-1" name="__codelineno-222-1" href="#__codelineno-222-1"></a><span class="c1">// 获取所有书籍</span>
</span><span id="__span-222-2"><a id="__codelineno-222-2" name="__codelineno-222-2" href="#__codelineno-222-2"></a><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/books/&#39;</span><span class="p">)</span>
</span><span id="__span-222-3"><a id="__codelineno-222-3" name="__codelineno-222-3" href="#__codelineno-222-3"></a><span class="w">  </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
</span><span id="__span-222-4"><a id="__codelineno-222-4" name="__codelineno-222-4" href="#__codelineno-222-4"></a><span class="w">  </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-222-5"><a id="__codelineno-222-5" name="__codelineno-222-5" href="#__codelineno-222-5"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;所有书籍:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">);</span>
</span><span id="__span-222-6"><a id="__codelineno-222-6" name="__codelineno-222-6" href="#__codelineno-222-6"></a><span class="w">    </span><span class="c1">// 渲染到页面</span>
</span><span id="__span-222-7"><a id="__codelineno-222-7" name="__codelineno-222-7" href="#__codelineno-222-7"></a><span class="w">    </span><span class="nx">data</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">book</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-222-8"><a id="__codelineno-222-8" name="__codelineno-222-8" href="#__codelineno-222-8"></a><span class="w">      </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;book-list&#39;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sb">`</span>
</span><span id="__span-222-9"><a id="__codelineno-222-9" name="__codelineno-222-9" href="#__codelineno-222-9"></a><span class="sb">        &lt;div class=&quot;book-item&quot;&gt;</span>
</span><span id="__span-222-10"><a id="__codelineno-222-10" name="__codelineno-222-10" href="#__codelineno-222-10"></a><span class="sb">          &lt;h3&gt;</span><span class="si">${</span><span class="nx">book</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="sb">&lt;/h3&gt;</span>
</span><span id="__span-222-11"><a id="__codelineno-222-11" name="__codelineno-222-11" href="#__codelineno-222-11"></a><span class="sb">          &lt;p&gt;作者: </span><span class="si">${</span><span class="nx">book</span><span class="p">.</span><span class="nx">author</span><span class="si">}</span><span class="sb">&lt;/p&gt;</span>
</span><span id="__span-222-12"><a id="__codelineno-222-12" name="__codelineno-222-12" href="#__codelineno-222-12"></a><span class="sb">          &lt;p&gt;价格: ¥</span><span class="si">${</span><span class="nx">book</span><span class="p">.</span><span class="nx">price</span><span class="si">}</span><span class="sb">&lt;/p&gt;</span>
</span><span id="__span-222-13"><a id="__codelineno-222-13" name="__codelineno-222-13" href="#__codelineno-222-13"></a><span class="sb">        &lt;/div&gt;</span>
</span><span id="__span-222-14"><a id="__codelineno-222-14" name="__codelineno-222-14" href="#__codelineno-222-14"></a><span class="sb">      `</span><span class="p">;</span>
</span><span id="__span-222-15"><a id="__codelineno-222-15" name="__codelineno-222-15" href="#__codelineno-222-15"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-222-16"><a id="__codelineno-222-16" name="__codelineno-222-16" href="#__codelineno-222-16"></a><span class="w">  </span><span class="p">})</span>
</span><span id="__span-222-17"><a id="__codelineno-222-17" name="__codelineno-222-17" href="#__codelineno-222-17"></a><span class="w">  </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;获取失败:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">));</span>
</span><span id="__span-222-18"><a id="__codelineno-222-18" name="__codelineno-222-18" href="#__codelineno-222-18"></a>
</span><span id="__span-222-19"><a id="__codelineno-222-19" name="__codelineno-222-19" href="#__codelineno-222-19"></a><span class="c1">// 创建新书</span>
</span><span id="__span-222-20"><a id="__codelineno-222-20" name="__codelineno-222-20" href="#__codelineno-222-20"></a><span class="kd">const</span><span class="w"> </span><span class="nx">newBook</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-222-21"><a id="__codelineno-222-21" name="__codelineno-222-21" href="#__codelineno-222-21"></a><span class="w">  </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;JavaScript高级程序设计&#39;</span><span class="p">,</span>
</span><span id="__span-222-22"><a id="__codelineno-222-22" name="__codelineno-222-22" href="#__codelineno-222-22"></a><span class="w">  </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Nicholas C. Zakas&#39;</span><span class="p">,</span>
</span><span id="__span-222-23"><a id="__codelineno-222-23" name="__codelineno-222-23" href="#__codelineno-222-23"></a><span class="w">  </span><span class="nx">published_date</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;2023-10-01&#39;</span><span class="p">,</span>
</span><span id="__span-222-24"><a id="__codelineno-222-24" name="__codelineno-222-24" href="#__codelineno-222-24"></a><span class="w">  </span><span class="nx">isbn</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;9787121430879&#39;</span><span class="p">,</span>
</span><span id="__span-222-25"><a id="__codelineno-222-25" name="__codelineno-222-25" href="#__codelineno-222-25"></a><span class="w">  </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="mf">99.80</span>
</span><span id="__span-222-26"><a id="__codelineno-222-26" name="__codelineno-222-26" href="#__codelineno-222-26"></a><span class="p">};</span>
</span><span id="__span-222-27"><a id="__codelineno-222-27" name="__codelineno-222-27" href="#__codelineno-222-27"></a>
</span><span id="__span-222-28"><a id="__codelineno-222-28" name="__codelineno-222-28" href="#__codelineno-222-28"></a><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/books/&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-222-29"><a id="__codelineno-222-29" name="__codelineno-222-29" href="#__codelineno-222-29"></a><span class="w">  </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span><span id="__span-222-30"><a id="__codelineno-222-30" name="__codelineno-222-30" href="#__codelineno-222-30"></a><span class="w">  </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-222-31"><a id="__codelineno-222-31" name="__codelineno-222-31" href="#__codelineno-222-31"></a><span class="w">    </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
</span><span id="__span-222-32"><a id="__codelineno-222-32" name="__codelineno-222-32" href="#__codelineno-222-32"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-222-33"><a id="__codelineno-222-33" name="__codelineno-222-33" href="#__codelineno-222-33"></a><span class="w">  </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">newBook</span><span class="p">)</span>
</span><span id="__span-222-34"><a id="__codelineno-222-34" name="__codelineno-222-34" href="#__codelineno-222-34"></a><span class="p">})</span>
</span><span id="__span-222-35"><a id="__codelineno-222-35" name="__codelineno-222-35" href="#__codelineno-222-35"></a><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-222-36"><a id="__codelineno-222-36" name="__codelineno-222-36" href="#__codelineno-222-36"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;创建失败&#39;</span><span class="p">);</span>
</span><span id="__span-222-37"><a id="__codelineno-222-37" name="__codelineno-222-37" href="#__codelineno-222-37"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span><span id="__span-222-38"><a id="__codelineno-222-38" name="__codelineno-222-38" href="#__codelineno-222-38"></a><span class="p">})</span>
</span><span id="__span-222-39"><a id="__codelineno-222-39" name="__codelineno-222-39" href="#__codelineno-222-39"></a><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;创建成功:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">))</span>
</span><span id="__span-222-40"><a id="__codelineno-222-40" name="__codelineno-222-40" href="#__codelineno-222-40"></a><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;错误:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">));</span>
</span><span id="__span-222-41"><a id="__codelineno-222-41" name="__codelineno-222-41" href="#__codelineno-222-41"></a>
</span><span id="__span-222-42"><a id="__codelineno-222-42" name="__codelineno-222-42" href="#__codelineno-222-42"></a><span class="c1">// 更新书籍</span>
</span><span id="__span-222-43"><a id="__codelineno-222-43" name="__codelineno-222-43" href="#__codelineno-222-43"></a><span class="kd">const</span><span class="w"> </span><span class="nx">updatedData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-222-44"><a id="__codelineno-222-44" name="__codelineno-222-44" href="#__codelineno-222-44"></a><span class="w">  </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="mf">89.90</span><span class="w">  </span><span class="c1">// 调整价格</span>
</span><span id="__span-222-45"><a id="__codelineno-222-45" name="__codelineno-222-45" href="#__codelineno-222-45"></a><span class="p">};</span>
</span><span id="__span-222-46"><a id="__codelineno-222-46" name="__codelineno-222-46" href="#__codelineno-222-46"></a>
</span><span id="__span-222-47"><a id="__codelineno-222-47" name="__codelineno-222-47" href="#__codelineno-222-47"></a><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/books/1/&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// 假设ID=1</span>
</span><span id="__span-222-48"><a id="__codelineno-222-48" name="__codelineno-222-48" href="#__codelineno-222-48"></a><span class="w">  </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
</span><span id="__span-222-49"><a id="__codelineno-222-49" name="__codelineno-222-49" href="#__codelineno-222-49"></a><span class="w">  </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-222-50"><a id="__codelineno-222-50" name="__codelineno-222-50" href="#__codelineno-222-50"></a><span class="w">    </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
</span><span id="__span-222-51"><a id="__codelineno-222-51" name="__codelineno-222-51" href="#__codelineno-222-51"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-222-52"><a id="__codelineno-222-52" name="__codelineno-222-52" href="#__codelineno-222-52"></a><span class="w">  </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">updatedData</span><span class="p">)</span>
</span><span id="__span-222-53"><a id="__codelineno-222-53" name="__codelineno-222-53" href="#__codelineno-222-53"></a><span class="p">})</span>
</span><span id="__span-222-54"><a id="__codelineno-222-54" name="__codelineno-222-54" href="#__codelineno-222-54"></a><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
</span><span id="__span-222-55"><a id="__codelineno-222-55" name="__codelineno-222-55" href="#__codelineno-222-55"></a><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;更新后数据:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">))</span>
</span><span id="__span-222-56"><a id="__codelineno-222-56" name="__codelineno-222-56" href="#__codelineno-222-56"></a><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;更新失败:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">));</span>
</span><span id="__span-222-57"><a id="__codelineno-222-57" name="__codelineno-222-57" href="#__codelineno-222-57"></a>
</span><span id="__span-222-58"><a id="__codelineno-222-58" name="__codelineno-222-58" href="#__codelineno-222-58"></a><span class="c1">// 删除书籍</span>
</span><span id="__span-222-59"><a id="__codelineno-222-59" name="__codelineno-222-59" href="#__codelineno-222-59"></a><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/books/1/&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-222-60"><a id="__codelineno-222-60" name="__codelineno-222-60" href="#__codelineno-222-60"></a><span class="w">  </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DELETE&#39;</span>
</span><span id="__span-222-61"><a id="__codelineno-222-61" name="__codelineno-222-61" href="#__codelineno-222-61"></a><span class="p">})</span>
</span><span id="__span-222-62"><a id="__codelineno-222-62" name="__codelineno-222-62" href="#__codelineno-222-62"></a><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-222-63"><a id="__codelineno-222-63" name="__codelineno-222-63" href="#__codelineno-222-63"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">204</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-222-64"><a id="__codelineno-222-64" name="__codelineno-222-64" href="#__codelineno-222-64"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;删除成功&#39;</span><span class="p">);</span>
</span><span id="__span-222-65"><a id="__codelineno-222-65" name="__codelineno-222-65" href="#__codelineno-222-65"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-222-66"><a id="__codelineno-222-66" name="__codelineno-222-66" href="#__codelineno-222-66"></a><span class="p">})</span>
</span><span id="__span-222-67"><a id="__codelineno-222-67" name="__codelineno-222-67" href="#__codelineno-222-67"></a><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;删除失败:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">));</span>
</span></code></pre></div>
<p>html示例：</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-223-1"><a id="__codelineno-223-1" name="__codelineno-223-1" href="#__codelineno-223-1"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span id="__span-223-2"><a id="__codelineno-223-2" name="__codelineno-223-2" href="#__codelineno-223-2"></a><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span><span id="__span-223-3"><a id="__codelineno-223-3" name="__codelineno-223-3" href="#__codelineno-223-3"></a><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span><span id="__span-223-4"><a id="__codelineno-223-4" name="__codelineno-223-4" href="#__codelineno-223-4"></a>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>图书管理系统<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span><span id="__span-223-5"><a id="__codelineno-223-5" name="__codelineno-223-5" href="#__codelineno-223-5"></a><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span><span id="__span-223-6"><a id="__codelineno-223-6" name="__codelineno-223-6" href="#__codelineno-223-6"></a><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span><span id="__span-223-7"><a id="__codelineno-223-7" name="__codelineno-223-7" href="#__codelineno-223-7"></a>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>图书列表<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span><span id="__span-223-8"><a id="__codelineno-223-8" name="__codelineno-223-8" href="#__codelineno-223-8"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;book-list&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-223-9"><a id="__codelineno-223-9" name="__codelineno-223-9" href="#__codelineno-223-9"></a>
</span><span id="__span-223-10"><a id="__codelineno-223-10" name="__codelineno-223-10" href="#__codelineno-223-10"></a>    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-223-11"><a id="__codelineno-223-11" name="__codelineno-223-11" href="#__codelineno-223-11"></a><span class="w">        </span><span class="c1">// 获取所有书籍</span>
</span><span id="__span-223-12"><a id="__codelineno-223-12" name="__codelineno-223-12" href="#__codelineno-223-12"></a><span class="w">        </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://127.0.0.1:8000/api/books/&#39;</span><span class="p">)</span>
</span><span id="__span-223-13"><a id="__codelineno-223-13" name="__codelineno-223-13" href="#__codelineno-223-13"></a><span class="w">            </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
</span><span id="__span-223-14"><a id="__codelineno-223-14" name="__codelineno-223-14" href="#__codelineno-223-14"></a><span class="w">            </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-223-15"><a id="__codelineno-223-15" name="__codelineno-223-15" href="#__codelineno-223-15"></a><span class="w">                </span><span class="kd">const</span><span class="w"> </span><span class="nx">listDiv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;book-list&#39;</span><span class="p">);</span>
</span><span id="__span-223-16"><a id="__codelineno-223-16" name="__codelineno-223-16" href="#__codelineno-223-16"></a><span class="w">                </span><span class="nx">data</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">book</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-223-17"><a id="__codelineno-223-17" name="__codelineno-223-17" href="#__codelineno-223-17"></a><span class="w">                    </span><span class="nx">listDiv</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sb">`</span>
</span><span id="__span-223-18"><a id="__codelineno-223-18" name="__codelineno-223-18" href="#__codelineno-223-18"></a><span class="sb">                        &lt;div style=&quot;border:1px solid #ccc; padding:10px; margin:10px&quot;&gt;</span>
</span><span id="__span-223-19"><a id="__codelineno-223-19" name="__codelineno-223-19" href="#__codelineno-223-19"></a><span class="sb">                            &lt;h3&gt;</span><span class="si">${</span><span class="nx">book</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="sb">&lt;/h3&gt;</span>
</span><span id="__span-223-20"><a id="__codelineno-223-20" name="__codelineno-223-20" href="#__codelineno-223-20"></a><span class="sb">                            &lt;p&gt;作者：</span><span class="si">${</span><span class="nx">book</span><span class="p">.</span><span class="nx">author</span><span class="si">}</span><span class="sb">&lt;/p&gt;</span>
</span><span id="__span-223-21"><a id="__codelineno-223-21" name="__codelineno-223-21" href="#__codelineno-223-21"></a><span class="sb">                            &lt;p&gt;价格：¥</span><span class="si">${</span><span class="nx">book</span><span class="p">.</span><span class="nx">price</span><span class="si">}</span><span class="sb">&lt;/p&gt;</span>
</span><span id="__span-223-22"><a id="__codelineno-223-22" name="__codelineno-223-22" href="#__codelineno-223-22"></a><span class="sb">                        &lt;/div&gt;</span>
</span><span id="__span-223-23"><a id="__codelineno-223-23" name="__codelineno-223-23" href="#__codelineno-223-23"></a><span class="sb">                    `</span><span class="p">;</span>
</span><span id="__span-223-24"><a id="__codelineno-223-24" name="__codelineno-223-24" href="#__codelineno-223-24"></a><span class="w">                </span><span class="p">});</span>
</span><span id="__span-223-25"><a id="__codelineno-223-25" name="__codelineno-223-25" href="#__codelineno-223-25"></a><span class="w">            </span><span class="p">})</span>
</span><span id="__span-223-26"><a id="__codelineno-223-26" name="__codelineno-223-26" href="#__codelineno-223-26"></a><span class="w">            </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;错误:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">));</span>
</span><span id="__span-223-27"><a id="__codelineno-223-27" name="__codelineno-223-27" href="#__codelineno-223-27"></a><span class="w">    </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-223-28"><a id="__codelineno-223-28" name="__codelineno-223-28" href="#__codelineno-223-28"></a><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span><span id="__span-223-29"><a id="__codelineno-223-29" name="__codelineno-223-29" href="#__codelineno-223-29"></a><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></code></pre></div>
<h5 id="_65">生产环境部署</h5>
<p><strong>使用 Gunicorn 运行 Django</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-224-1"><a id="__codelineno-224-1" name="__codelineno-224-1" href="#__codelineno-224-1"></a>pip<span class="w"> </span>install<span class="w"> </span>gunicorn
</span><span id="__span-224-2"><a id="__codelineno-224-2" name="__codelineno-224-2" href="#__codelineno-224-2"></a>gunicorn<span class="w"> </span>myproject.wsgi:application<span class="w"> </span>--bind<span class="w"> </span><span class="m">0</span>.0.0.0:8000<span class="w"> </span>--workers<span class="w"> </span><span class="m">4</span>
</span></code></pre></div>
<p><strong>配置 Nginx 反向代理</strong>
在 <code>/etc/nginx/sites-available/myproject</code> 中添加配置：</p>
<div class="language-nginx highlight"><pre><span></span><code><span id="__span-225-1"><a id="__codelineno-225-1" name="__codelineno-225-1" href="#__codelineno-225-1"></a><span class="k">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-225-2"><a id="__codelineno-225-2" name="__codelineno-225-2" href="#__codelineno-225-2"></a><span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span>
</span><span id="__span-225-3"><a id="__codelineno-225-3" name="__codelineno-225-3" href="#__codelineno-225-3"></a><span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.com</span><span class="p">;</span>
</span><span id="__span-225-4"><a id="__codelineno-225-4" name="__codelineno-225-4" href="#__codelineno-225-4"></a>
</span><span id="__span-225-5"><a id="__codelineno-225-5" name="__codelineno-225-5" href="#__codelineno-225-5"></a><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/static/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-225-6"><a id="__codelineno-225-6" name="__codelineno-225-6" href="#__codelineno-225-6"></a><span class="w">        </span><span class="kn">root</span><span class="w"> </span><span class="s">/path/to/your/project</span><span class="p">;</span>
</span><span id="__span-225-7"><a id="__codelineno-225-7" name="__codelineno-225-7" href="#__codelineno-225-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-225-8"><a id="__codelineno-225-8" name="__codelineno-225-8" href="#__codelineno-225-8"></a>
</span><span id="__span-225-9"><a id="__codelineno-225-9" name="__codelineno-225-9" href="#__codelineno-225-9"></a><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-225-10"><a id="__codelineno-225-10" name="__codelineno-225-10" href="#__codelineno-225-10"></a><span class="w">        </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://localhost:8000</span><span class="p">;</span>
</span><span id="__span-225-11"><a id="__codelineno-225-11" name="__codelineno-225-11" href="#__codelineno-225-11"></a><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
</span><span id="__span-225-12"><a id="__codelineno-225-12" name="__codelineno-225-12" href="#__codelineno-225-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-225-13"><a id="__codelineno-225-13" name="__codelineno-225-13" href="#__codelineno-225-13"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>安全设置</strong>
关闭 Debug 模式：修改 <code>settings.py</code></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-226-1"><a id="__codelineno-226-1" name="__codelineno-226-1" href="#__codelineno-226-1"></a><span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-226-2"><a id="__codelineno-226-2" name="__codelineno-226-2" href="#__codelineno-226-2"></a><span class="n">ALLOWED_HOSTS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;example.com&#39;</span><span class="p">]</span>
</span></code></pre></div>
<p>配置 HTTPS：使用 Let's Encrypt 生成 SSL 证书。</p>
<p><strong>跨域问题（CORS）</strong></p>
<p>安装 <code>django-cors-headers</code> 并配置：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-227-1"><a id="__codelineno-227-1" name="__codelineno-227-1" href="#__codelineno-227-1"></a><span class="c1"># settings.py</span>
</span><span id="__span-227-2"><a id="__codelineno-227-2" name="__codelineno-227-2" href="#__codelineno-227-2"></a><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-227-3"><a id="__codelineno-227-3" name="__codelineno-227-3" href="#__codelineno-227-3"></a>    <span class="o">...</span>
</span><span id="__span-227-4"><a id="__codelineno-227-4" name="__codelineno-227-4" href="#__codelineno-227-4"></a>    <span class="s1">&#39;corsheaders&#39;</span><span class="p">,</span>
</span><span id="__span-227-5"><a id="__codelineno-227-5" name="__codelineno-227-5" href="#__codelineno-227-5"></a><span class="p">]</span>
</span><span id="__span-227-6"><a id="__codelineno-227-6" name="__codelineno-227-6" href="#__codelineno-227-6"></a>
</span><span id="__span-227-7"><a id="__codelineno-227-7" name="__codelineno-227-7" href="#__codelineno-227-7"></a><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-227-8"><a id="__codelineno-227-8" name="__codelineno-227-8" href="#__codelineno-227-8"></a>    <span class="o">...</span>
</span><span id="__span-227-9"><a id="__codelineno-227-9" name="__codelineno-227-9" href="#__codelineno-227-9"></a>    <span class="s1">&#39;corsheaders.middleware.CorsMiddleware&#39;</span><span class="p">,</span>
</span><span id="__span-227-10"><a id="__codelineno-227-10" name="__codelineno-227-10" href="#__codelineno-227-10"></a><span class="p">]</span>
</span><span id="__span-227-11"><a id="__codelineno-227-11" name="__codelineno-227-11" href="#__codelineno-227-11"></a>
</span><span id="__span-227-12"><a id="__codelineno-227-12" name="__codelineno-227-12" href="#__codelineno-227-12"></a><span class="n">CORS_ALLOWED_ORIGINS</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-227-13"><a id="__codelineno-227-13" name="__codelineno-227-13" href="#__codelineno-227-13"></a>    <span class="s1">&#39;https:example.com&#39;</span><span class="p">,</span>  <span class="c1"># 添加你的域名</span>
</span><span id="__span-227-14"><a id="__codelineno-227-14" name="__codelineno-227-14" href="#__codelineno-227-14"></a><span class="p">]</span>
</span><span id="__span-227-15"><a id="__codelineno-227-15" name="__codelineno-227-15" href="#__codelineno-227-15"></a><span class="c1"># CORS_ALLOW_ALL_ORIGINS = True  # 开发环境临时允许所有域名</span>
</span></code></pre></div>
<p><strong>用户认证系统</strong>
Django 的 <code>django.contrib.auth</code> 已提供完整的用户认证和权限管理模块，无需额外创建应用即可直接使用。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-228-1"><a id="__codelineno-228-1" name="__codelineno-228-1" href="#__codelineno-228-1"></a><span class="c1"># settings.py</span>
</span><span id="__span-228-2"><a id="__codelineno-228-2" name="__codelineno-228-2" href="#__codelineno-228-2"></a><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-228-3"><a id="__codelineno-228-3" name="__codelineno-228-3" href="#__codelineno-228-3"></a>    <span class="c1"># ...</span>
</span><span id="__span-228-4"><a id="__codelineno-228-4" name="__codelineno-228-4" href="#__codelineno-228-4"></a>    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>     <span class="c1"># 用户认证核心功能</span>
</span><span id="__span-228-5"><a id="__codelineno-228-5" name="__codelineno-228-5" href="#__codelineno-228-5"></a>    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>  <span class="c1"># 权限依赖</span>
</span><span id="__span-228-6"><a id="__codelineno-228-6" name="__codelineno-228-6" href="#__codelineno-228-6"></a>    <span class="c1"># ...</span>
</span><span id="__span-228-7"><a id="__codelineno-228-7" name="__codelineno-228-7" href="#__codelineno-228-7"></a><span class="p">]</span>
</span><span id="__span-228-8"><a id="__codelineno-228-8" name="__codelineno-228-8" href="#__codelineno-228-8"></a>
</span><span id="__span-228-9"><a id="__codelineno-228-9" name="__codelineno-228-9" href="#__codelineno-228-9"></a><span class="c1"># 登录后重定向路径 如果没有设置，默认重定向到/accounts/login/页面</span>
</span><span id="__span-228-10"><a id="__codelineno-228-10" name="__codelineno-228-10" href="#__codelineno-228-10"></a><span class="n">LOGIN_REDIRECT_URL</span> <span class="o">=</span> <span class="s1">&#39;/dashboard/&#39;</span>
</span><span id="__span-228-11"><a id="__codelineno-228-11" name="__codelineno-228-11" href="#__codelineno-228-11"></a><span class="c1"># 登录页面路径</span>
</span><span id="__span-228-12"><a id="__codelineno-228-12" name="__codelineno-228-12" href="#__codelineno-228-12"></a><span class="n">LOGIN_URL</span> <span class="o">=</span> <span class="s1">&#39;/login/&#39;</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-229-1"><a id="__codelineno-229-1" name="__codelineno-229-1" href="#__codelineno-229-1"></a><span class="c1"># 项目的urls.py</span>
</span><span id="__span-229-2"><a id="__codelineno-229-2" name="__codelineno-229-2" href="#__codelineno-229-2"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-229-3"><a id="__codelineno-229-3" name="__codelineno-229-3" href="#__codelineno-229-3"></a>    <span class="c1"># 其他 URL 配置...</span>
</span><span id="__span-229-4"><a id="__codelineno-229-4" name="__codelineno-229-4" href="#__codelineno-229-4"></a>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;accounts/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;django.contrib.auth.urls&#39;</span><span class="p">)),</span>  <span class="c1"># 引入认证相关 URL</span>
</span><span id="__span-229-5"><a id="__codelineno-229-5" name="__codelineno-229-5" href="#__codelineno-229-5"></a><span class="p">]</span>
</span></code></pre></div>
<p>这会自动提供以下视图：</p>
<ul>
<li><code>/accounts/login/</code>：登录页面</li>
<li><code>/accounts/logout/</code>：登出页面</li>
<li><code>/accounts/password_change/</code>：修改密码页面</li>
<li><code>/accounts/password_reset/</code>：重置密码页面</li>
</ul>
<p>直接在现有视图函数或类视图上使用装饰器即可实现权限控制
如 <code>@login_required</code>、<code>@permission_required</code></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-230-1"><a id="__codelineno-230-1" name="__codelineno-230-1" href="#__codelineno-230-1"></a><span class="c1"># views.py（现有应用的视图文件）</span>
</span><span id="__span-230-2"><a id="__codelineno-230-2" name="__codelineno-230-2" href="#__codelineno-230-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">login_required</span><span class="p">,</span> <span class="n">permission_required</span>
</span><span id="__span-230-3"><a id="__codelineno-230-3" name="__codelineno-230-3" href="#__codelineno-230-3"></a>
</span><span id="__span-230-4"><a id="__codelineno-230-4" name="__codelineno-230-4" href="#__codelineno-230-4"></a><span class="nd">@login_required</span>   <span class="c1"># 必须登录</span>
</span><span id="__span-230-5"><a id="__codelineno-230-5" name="__codelineno-230-5" href="#__codelineno-230-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">dashboard</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span id="__span-230-6"><a id="__codelineno-230-6" name="__codelineno-230-6" href="#__codelineno-230-6"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;dashboard.html&#39;</span><span class="p">)</span>
</span><span id="__span-230-7"><a id="__codelineno-230-7" name="__codelineno-230-7" href="#__codelineno-230-7"></a>
</span><span id="__span-230-8"><a id="__codelineno-230-8" name="__codelineno-230-8" href="#__codelineno-230-8"></a><span class="nd">@permission_required</span><span class="p">(</span><span class="s1">&#39;blog.publish_post&#39;</span><span class="p">)</span>   <span class="c1"># 需要特定权限</span>
</span><span id="__span-230-9"><a id="__codelineno-230-9" name="__codelineno-230-9" href="#__codelineno-230-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">publish_post</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span id="__span-230-10"><a id="__codelineno-230-10" name="__codelineno-230-10" href="#__codelineno-230-10"></a>    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;文章已发布&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>Django 会为每个模型自动生成以下默认权限：使用 <code>应用名.权限</code> 指定</p>
<ol>
<li><code>add_&lt;modelname&gt;</code>：添加模型实例的权限。</li>
<li><code>change_&lt;modelname&gt;</code>：更改模型实例的权限。</li>
<li><code>delete_&lt;modelname&gt;</code>：删除模型实例的权限。</li>
<li><code>view_&lt;modelname&gt;</code>（从 Django 2.1 开始）：查看模型实例的权限</li>
</ol>
<p>Django 默认会寻找 login.html 作为登录页面模板</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-231-1"><a id="__codelineno-231-1" name="__codelineno-231-1" href="#__codelineno-231-1"></a><span class="cm">&lt;!-- templates\registration\login.html --&gt;</span>
</span><span id="__span-231-2"><a id="__codelineno-231-2" name="__codelineno-231-2" href="#__codelineno-231-2"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span id="__span-231-3"><a id="__codelineno-231-3" name="__codelineno-231-3" href="#__codelineno-231-3"></a><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span><span id="__span-231-4"><a id="__codelineno-231-4" name="__codelineno-231-4" href="#__codelineno-231-4"></a><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span><span id="__span-231-5"><a id="__codelineno-231-5" name="__codelineno-231-5" href="#__codelineno-231-5"></a>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Login<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span><span id="__span-231-6"><a id="__codelineno-231-6" name="__codelineno-231-6" href="#__codelineno-231-6"></a>    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
</span><span id="__span-231-7"><a id="__codelineno-231-7" name="__codelineno-231-7" href="#__codelineno-231-7"></a><span class="w">        </span><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-231-8"><a id="__codelineno-231-8" name="__codelineno-231-8" href="#__codelineno-231-8"></a><span class="w">            </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="n">Arial</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>
</span><span id="__span-231-9"><a id="__codelineno-231-9" name="__codelineno-231-9" href="#__codelineno-231-9"></a><span class="w">            </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#f4f4f9</span><span class="p">;</span>
</span><span id="__span-231-10"><a id="__codelineno-231-10" name="__codelineno-231-10" href="#__codelineno-231-10"></a><span class="w">            </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-231-11"><a id="__codelineno-231-11" name="__codelineno-231-11" href="#__codelineno-231-11"></a><span class="w">            </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-231-12"><a id="__codelineno-231-12" name="__codelineno-231-12" href="#__codelineno-231-12"></a><span class="w">            </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
</span><span id="__span-231-13"><a id="__codelineno-231-13" name="__codelineno-231-13" href="#__codelineno-231-13"></a><span class="w">            </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
</span><span id="__span-231-14"><a id="__codelineno-231-14" name="__codelineno-231-14" href="#__codelineno-231-14"></a><span class="w">            </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
</span><span id="__span-231-15"><a id="__codelineno-231-15" name="__codelineno-231-15" href="#__codelineno-231-15"></a><span class="w">            </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">vh</span><span class="p">;</span>
</span><span id="__span-231-16"><a id="__codelineno-231-16" name="__codelineno-231-16" href="#__codelineno-231-16"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-231-17"><a id="__codelineno-231-17" name="__codelineno-231-17" href="#__codelineno-231-17"></a><span class="w">        </span><span class="p">.</span><span class="nc">login-container</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-231-18"><a id="__codelineno-231-18" name="__codelineno-231-18" href="#__codelineno-231-18"></a><span class="w">            </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#ffffff</span><span class="p">;</span>
</span><span id="__span-231-19"><a id="__codelineno-231-19" name="__codelineno-231-19" href="#__codelineno-231-19"></a><span class="w">            </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-231-20"><a id="__codelineno-231-20" name="__codelineno-231-20" href="#__codelineno-231-20"></a><span class="w">            </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-231-21"><a id="__codelineno-231-21" name="__codelineno-231-21" href="#__codelineno-231-21"></a><span class="w">            </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
</span><span id="__span-231-22"><a id="__codelineno-231-22" name="__codelineno-231-22" href="#__codelineno-231-22"></a><span class="w">            </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-231-23"><a id="__codelineno-231-23" name="__codelineno-231-23" href="#__codelineno-231-23"></a><span class="w">            </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
</span><span id="__span-231-24"><a id="__codelineno-231-24" name="__codelineno-231-24" href="#__codelineno-231-24"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-231-25"><a id="__codelineno-231-25" name="__codelineno-231-25" href="#__codelineno-231-25"></a><span class="w">        </span><span class="p">.</span><span class="nc">login-container</span><span class="w"> </span><span class="nt">h2</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-231-26"><a id="__codelineno-231-26" name="__codelineno-231-26" href="#__codelineno-231-26"></a><span class="w">            </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-231-27"><a id="__codelineno-231-27" name="__codelineno-231-27" href="#__codelineno-231-27"></a><span class="w">            </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#333333</span><span class="p">;</span>
</span><span id="__span-231-28"><a id="__codelineno-231-28" name="__codelineno-231-28" href="#__codelineno-231-28"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-231-29"><a id="__codelineno-231-29" name="__codelineno-231-29" href="#__codelineno-231-29"></a><span class="w">        </span><span class="p">.</span><span class="nc">login-container</span><span class="w"> </span><span class="nt">form</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-231-30"><a id="__codelineno-231-30" name="__codelineno-231-30" href="#__codelineno-231-30"></a><span class="w">            </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
</span><span id="__span-231-31"><a id="__codelineno-231-31" name="__codelineno-231-31" href="#__codelineno-231-31"></a><span class="w">            </span><span class="k">flex-direction</span><span class="p">:</span><span class="w"> </span><span class="kc">column</span><span class="p">;</span>
</span><span id="__span-231-32"><a id="__codelineno-231-32" name="__codelineno-231-32" href="#__codelineno-231-32"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-231-33"><a id="__codelineno-231-33" name="__codelineno-231-33" href="#__codelineno-231-33"></a><span class="w">        </span><span class="p">.</span><span class="nc">login-container</span><span class="w"> </span><span class="nt">form</span><span class="w"> </span><span class="nt">input</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-231-34"><a id="__codelineno-231-34" name="__codelineno-231-34" href="#__codelineno-231-34"></a><span class="w">            </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-231-35"><a id="__codelineno-231-35" name="__codelineno-231-35" href="#__codelineno-231-35"></a><span class="w">            </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-231-36"><a id="__codelineno-231-36" name="__codelineno-231-36" href="#__codelineno-231-36"></a><span class="w">            </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#cccccc</span><span class="p">;</span>
</span><span id="__span-231-37"><a id="__codelineno-231-37" name="__codelineno-231-37" href="#__codelineno-231-37"></a><span class="w">            </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-231-38"><a id="__codelineno-231-38" name="__codelineno-231-38" href="#__codelineno-231-38"></a><span class="w">            </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-231-39"><a id="__codelineno-231-39" name="__codelineno-231-39" href="#__codelineno-231-39"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-231-40"><a id="__codelineno-231-40" name="__codelineno-231-40" href="#__codelineno-231-40"></a><span class="w">        </span><span class="p">.</span><span class="nc">login-container</span><span class="w"> </span><span class="nt">form</span><span class="w"> </span><span class="nt">button</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-231-41"><a id="__codelineno-231-41" name="__codelineno-231-41" href="#__codelineno-231-41"></a><span class="w">            </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-231-42"><a id="__codelineno-231-42" name="__codelineno-231-42" href="#__codelineno-231-42"></a><span class="w">            </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4CAF50</span><span class="p">;</span>
</span><span id="__span-231-43"><a id="__codelineno-231-43" name="__codelineno-231-43" href="#__codelineno-231-43"></a><span class="w">            </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span>
</span><span id="__span-231-44"><a id="__codelineno-231-44" name="__codelineno-231-44" href="#__codelineno-231-44"></a><span class="w">            </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
</span><span id="__span-231-45"><a id="__codelineno-231-45" name="__codelineno-231-45" href="#__codelineno-231-45"></a><span class="w">            </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-231-46"><a id="__codelineno-231-46" name="__codelineno-231-46" href="#__codelineno-231-46"></a><span class="w">            </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-231-47"><a id="__codelineno-231-47" name="__codelineno-231-47" href="#__codelineno-231-47"></a><span class="w">            </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
</span><span id="__span-231-48"><a id="__codelineno-231-48" name="__codelineno-231-48" href="#__codelineno-231-48"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-231-49"><a id="__codelineno-231-49" name="__codelineno-231-49" href="#__codelineno-231-49"></a><span class="w">        </span><span class="p">.</span><span class="nc">login-container</span><span class="w"> </span><span class="nt">form</span><span class="w"> </span><span class="nt">button</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-231-50"><a id="__codelineno-231-50" name="__codelineno-231-50" href="#__codelineno-231-50"></a><span class="w">            </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#45a049</span><span class="p">;</span>
</span><span id="__span-231-51"><a id="__codelineno-231-51" name="__codelineno-231-51" href="#__codelineno-231-51"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-231-52"><a id="__codelineno-231-52" name="__codelineno-231-52" href="#__codelineno-231-52"></a><span class="w">        </span><span class="p">.</span><span class="nc">login-container</span><span class="w"> </span><span class="nt">a</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-231-53"><a id="__codelineno-231-53" name="__codelineno-231-53" href="#__codelineno-231-53"></a><span class="w">            </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
</span><span id="__span-231-54"><a id="__codelineno-231-54" name="__codelineno-231-54" href="#__codelineno-231-54"></a><span class="w">            </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-231-55"><a id="__codelineno-231-55" name="__codelineno-231-55" href="#__codelineno-231-55"></a><span class="w">            </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4CAF50</span><span class="p">;</span>
</span><span id="__span-231-56"><a id="__codelineno-231-56" name="__codelineno-231-56" href="#__codelineno-231-56"></a><span class="w">            </span><span class="k">text-decoration</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
</span><span id="__span-231-57"><a id="__codelineno-231-57" name="__codelineno-231-57" href="#__codelineno-231-57"></a><span class="w">            </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-231-58"><a id="__codelineno-231-58" name="__codelineno-231-58" href="#__codelineno-231-58"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-231-59"><a id="__codelineno-231-59" name="__codelineno-231-59" href="#__codelineno-231-59"></a><span class="w">        </span><span class="p">.</span><span class="nc">login-container</span><span class="w"> </span><span class="nt">a</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-231-60"><a id="__codelineno-231-60" name="__codelineno-231-60" href="#__codelineno-231-60"></a><span class="w">            </span><span class="k">text-decoration</span><span class="p">:</span><span class="w"> </span><span class="kc">underline</span><span class="p">;</span>
</span><span id="__span-231-61"><a id="__codelineno-231-61" name="__codelineno-231-61" href="#__codelineno-231-61"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-231-62"><a id="__codelineno-231-62" name="__codelineno-231-62" href="#__codelineno-231-62"></a><span class="w">    </span><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span><span id="__span-231-63"><a id="__codelineno-231-63" name="__codelineno-231-63" href="#__codelineno-231-63"></a><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span><span id="__span-231-64"><a id="__codelineno-231-64" name="__codelineno-231-64" href="#__codelineno-231-64"></a><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span><span id="__span-231-65"><a id="__codelineno-231-65" name="__codelineno-231-65" href="#__codelineno-231-65"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;login-container&quot;</span><span class="p">&gt;</span>
</span><span id="__span-231-66"><a id="__codelineno-231-66" name="__codelineno-231-66" href="#__codelineno-231-66"></a>        <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Login<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
</span><span id="__span-231-67"><a id="__codelineno-231-67" name="__codelineno-231-67" href="#__codelineno-231-67"></a>        <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span><span class="p">&gt;</span>
</span><span id="__span-231-68"><a id="__codelineno-231-68" name="__codelineno-231-68" href="#__codelineno-231-68"></a>            {% csrf_token %}
</span><span id="__span-231-69"><a id="__codelineno-231-69" name="__codelineno-231-69" href="#__codelineno-231-69"></a>            {{ form.as_p }}
</span><span id="__span-231-70"><a id="__codelineno-231-70" name="__codelineno-231-70" href="#__codelineno-231-70"></a>            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>Login<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span><span id="__span-231-71"><a id="__codelineno-231-71" name="__codelineno-231-71" href="#__codelineno-231-71"></a>        <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span><span id="__span-231-72"><a id="__codelineno-231-72" name="__codelineno-231-72" href="#__codelineno-231-72"></a>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;password_reset&#39; %}&quot;</span><span class="p">&gt;</span>Forgot Password?<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span><span id="__span-231-73"><a id="__codelineno-231-73" name="__codelineno-231-73" href="#__codelineno-231-73"></a>    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-231-74"><a id="__codelineno-231-74" name="__codelineno-231-74" href="#__codelineno-231-74"></a><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span><span id="__span-231-75"><a id="__codelineno-231-75" name="__codelineno-231-75" href="#__codelineno-231-75"></a><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>登录的有效期取决于后端会话配置，通常由 Django 的会话框架控制。默认情况下，Django 使用基于 cookie 的会话，默认有效期为浏览器关闭时失效（会话 cookie）。 如果需要更改会话有效期，可以在 Django 的 <code>settings.py</code> 文件中设置 <code>SESSION_COOKIE_AGE</code>，以秒为单位。例如：<code>SESSION_COOKIE_AGE = 3600</code> 表示会话有效期为 1 小时。
Django 的默认登出视图 (<code>LogoutView</code>) 只接受 <code>POST</code> 请求，模板中使用表单而不是登出链接，确保登出操作通过 <code>POST</code> 请求完成</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-232-1"><a id="__codelineno-232-1" name="__codelineno-232-1" href="#__codelineno-232-1"></a><span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;{% url &#39;logout&#39; %}&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;display: inline;&quot;</span><span class="p">&gt;</span>
</span><span id="__span-232-2"><a id="__codelineno-232-2" name="__codelineno-232-2" href="#__codelineno-232-2"></a>    {% csrf_token %}
</span><span id="__span-232-3"><a id="__codelineno-232-3" name="__codelineno-232-3" href="#__codelineno-232-3"></a>    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn&quot;</span><span class="p">&gt;</span>登出<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span><span id="__span-232-4"><a id="__codelineno-232-4" name="__codelineno-232-4" href="#__codelineno-232-4"></a><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>可以通过 Django 管理后台（<code>/admin/</code>）为用户分配权限或分组</p>
<p>如果项目需要 ==高度定制化用户系统==（如扩展用户字段、自定义权限逻辑），可以新建一个应用（如 <code>users</code>）来集中管理
如果默认权限不足，你可以为模型定义自定义权限。
修改登出后的界面</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-233-1"><a id="__codelineno-233-1" name="__codelineno-233-1" href="#__codelineno-233-1"></a><span class="c1"># users/views.py</span>
</span><span id="__span-233-2"><a id="__codelineno-233-2" name="__codelineno-233-2" href="#__codelineno-233-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span>
</span><span id="__span-233-3"><a id="__codelineno-233-3" name="__codelineno-233-3" href="#__codelineno-233-3"></a>
</span><span id="__span-233-4"><a id="__codelineno-233-4" name="__codelineno-233-4" href="#__codelineno-233-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">logout_success</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span id="__span-233-5"><a id="__codelineno-233-5" name="__codelineno-233-5" href="#__codelineno-233-5"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;registration/logout_success.html&#39;</span><span class="p">)</span>
</span><span id="__span-233-6"><a id="__codelineno-233-6" name="__codelineno-233-6" href="#__codelineno-233-6"></a>
</span><span id="__span-233-7"><a id="__codelineno-233-7" name="__codelineno-233-7" href="#__codelineno-233-7"></a><span class="c1"># users/urls.py</span>
</span><span id="__span-233-8"><a id="__codelineno-233-8" name="__codelineno-233-8" href="#__codelineno-233-8"></a>    <span class="c1"># ...</span>
</span><span id="__span-233-9"><a id="__codelineno-233-9" name="__codelineno-233-9" href="#__codelineno-233-9"></a>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;logout/success/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">logout_success</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;logout_success&#39;</span><span class="p">),</span>
</span></code></pre></div>
<div class="language-html highlight"><pre><span></span><code><span id="__span-234-1"><a id="__codelineno-234-1" name="__codelineno-234-1" href="#__codelineno-234-1"></a><span class="cm">&lt;!-- templates/registration/logout_success.html --&gt;</span>
</span><span id="__span-234-2"><a id="__codelineno-234-2" name="__codelineno-234-2" href="#__codelineno-234-2"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span id="__span-234-3"><a id="__codelineno-234-3" name="__codelineno-234-3" href="#__codelineno-234-3"></a><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span><span id="__span-234-4"><a id="__codelineno-234-4" name="__codelineno-234-4" href="#__codelineno-234-4"></a><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span><span id="__span-234-5"><a id="__codelineno-234-5" name="__codelineno-234-5" href="#__codelineno-234-5"></a>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>登出成功<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span><span id="__span-234-6"><a id="__codelineno-234-6" name="__codelineno-234-6" href="#__codelineno-234-6"></a><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span><span id="__span-234-7"><a id="__codelineno-234-7" name="__codelineno-234-7" href="#__codelineno-234-7"></a><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span><span id="__span-234-8"><a id="__codelineno-234-8" name="__codelineno-234-8" href="#__codelineno-234-8"></a>    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>您已成功登出<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
</span><span id="__span-234-9"><a id="__codelineno-234-9" name="__codelineno-234-9" href="#__codelineno-234-9"></a>    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;login&#39; %}&quot;</span><span class="p">&gt;</span>重新登录<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span><span id="__span-234-10"><a id="__codelineno-234-10" name="__codelineno-234-10" href="#__codelineno-234-10"></a><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span><span id="__span-234-11"><a id="__codelineno-234-11" name="__codelineno-234-11" href="#__codelineno-234-11"></a><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>实现注册功能</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-235-1"><a id="__codelineno-235-1" name="__codelineno-235-1" href="#__codelineno-235-1"></a><span class="c1"># users/models.py</span>
</span><span id="__span-235-2"><a id="__codelineno-235-2" name="__codelineno-235-2" href="#__codelineno-235-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractUser</span>
</span><span id="__span-235-3"><a id="__codelineno-235-3" name="__codelineno-235-3" href="#__codelineno-235-3"></a>
</span><span id="__span-235-4"><a id="__codelineno-235-4" name="__codelineno-235-4" href="#__codelineno-235-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">CustomUser</span><span class="p">(</span><span class="n">AbstractUser</span><span class="p">):</span>
</span><span id="__span-235-5"><a id="__codelineno-235-5" name="__codelineno-235-5" href="#__codelineno-235-5"></a>    <span class="n">phone</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;手机号&#39;</span><span class="p">)</span>
</span><span id="__span-235-6"><a id="__codelineno-235-6" name="__codelineno-235-6" href="#__codelineno-235-6"></a>
</span><span id="__span-235-7"><a id="__codelineno-235-7" name="__codelineno-235-7" href="#__codelineno-235-7"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
</span><span id="__span-235-8"><a id="__codelineno-235-8" name="__codelineno-235-8" href="#__codelineno-235-8"></a>        <span class="n">verbose_name</span> <span class="o">=</span> <span class="s1">&#39;用户&#39;</span>
</span><span id="__span-235-9"><a id="__codelineno-235-9" name="__codelineno-235-9" href="#__codelineno-235-9"></a>        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s1">&#39;用户管理&#39;</span>
</span><span id="__span-235-10"><a id="__codelineno-235-10" name="__codelineno-235-10" href="#__codelineno-235-10"></a>        <span class="n">permissions</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-235-11"><a id="__codelineno-235-11" name="__codelineno-235-11" href="#__codelineno-235-11"></a>            <span class="p">(</span><span class="s2">&quot;publish_post&quot;</span><span class="p">,</span> <span class="s2">&quot;允许发布文章&quot;</span><span class="p">),</span>
</span><span id="__span-235-12"><a id="__codelineno-235-12" name="__codelineno-235-12" href="#__codelineno-235-12"></a>            <span class="p">(</span><span class="s2">&quot;edit_others_post&quot;</span><span class="p">,</span> <span class="s2">&quot;可编辑他人文章&quot;</span><span class="p">),</span>
</span><span id="__span-235-13"><a id="__codelineno-235-13" name="__codelineno-235-13" href="#__codelineno-235-13"></a>        <span class="p">]</span>
</span><span id="__span-235-14"><a id="__codelineno-235-14" name="__codelineno-235-14" href="#__codelineno-235-14"></a>
</span><span id="__span-235-15"><a id="__codelineno-235-15" name="__codelineno-235-15" href="#__codelineno-235-15"></a>
</span><span id="__span-235-16"><a id="__codelineno-235-16" name="__codelineno-235-16" href="#__codelineno-235-16"></a><span class="c1"># settings.py</span>
</span><span id="__span-235-17"><a id="__codelineno-235-17" name="__codelineno-235-17" href="#__codelineno-235-17"></a><span class="n">AUTH_USER_MODEL</span> <span class="o">=</span> <span class="s1">&#39;users.CustomUser&#39;</span>
</span><span id="__span-235-18"><a id="__codelineno-235-18" name="__codelineno-235-18" href="#__codelineno-235-18"></a>
</span><span id="__span-235-19"><a id="__codelineno-235-19" name="__codelineno-235-19" href="#__codelineno-235-19"></a>
</span><span id="__span-235-20"><a id="__codelineno-235-20" name="__codelineno-235-20" href="#__codelineno-235-20"></a><span class="c1"># users/views.py</span>
</span><span id="__span-235-21"><a id="__codelineno-235-21" name="__codelineno-235-21" href="#__codelineno-235-21"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.views</span><span class="w"> </span><span class="kn">import</span> <span class="n">LoginView</span>
</span><span id="__span-235-22"><a id="__codelineno-235-22" name="__codelineno-235-22" href="#__codelineno-235-22"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.views.generic</span><span class="w"> </span><span class="kn">import</span> <span class="n">CreateView</span>
</span><span id="__span-235-23"><a id="__codelineno-235-23" name="__codelineno-235-23" href="#__codelineno-235-23"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.forms</span><span class="w"> </span><span class="kn">import</span> <span class="n">CustomUserCreationForm</span>
</span><span id="__span-235-24"><a id="__codelineno-235-24" name="__codelineno-235-24" href="#__codelineno-235-24"></a>
</span><span id="__span-235-25"><a id="__codelineno-235-25" name="__codelineno-235-25" href="#__codelineno-235-25"></a><span class="k">class</span><span class="w"> </span><span class="nc">CustomLoginView</span><span class="p">(</span><span class="n">LoginView</span><span class="p">):</span>
</span><span id="__span-235-26"><a id="__codelineno-235-26" name="__codelineno-235-26" href="#__codelineno-235-26"></a>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;users/login.html&#39;</span>
</span><span id="__span-235-27"><a id="__codelineno-235-27" name="__codelineno-235-27" href="#__codelineno-235-27"></a>
</span><span id="__span-235-28"><a id="__codelineno-235-28" name="__codelineno-235-28" href="#__codelineno-235-28"></a><span class="k">class</span><span class="w"> </span><span class="nc">SignUpView</span><span class="p">(</span><span class="n">CreateView</span><span class="p">):</span>
</span><span id="__span-235-29"><a id="__codelineno-235-29" name="__codelineno-235-29" href="#__codelineno-235-29"></a>    <span class="n">form_class</span> <span class="o">=</span> <span class="n">CustomUserCreationForm</span>
</span><span id="__span-235-30"><a id="__codelineno-235-30" name="__codelineno-235-30" href="#__codelineno-235-30"></a>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;users/signup.html&#39;</span>
</span><span id="__span-235-31"><a id="__codelineno-235-31" name="__codelineno-235-31" href="#__codelineno-235-31"></a>    <span class="n">success_url</span> <span class="o">=</span> <span class="s1">&#39;/login/&#39;</span>
</span></code></pre></div>
<div class="language-html highlight"><pre><span></span><code><span id="__span-236-1"><a id="__codelineno-236-1" name="__codelineno-236-1" href="#__codelineno-236-1"></a><span class="cm">&lt;!-- templates/auth/login.html --&gt;</span>
</span><span id="__span-236-2"><a id="__codelineno-236-2" name="__codelineno-236-2" href="#__codelineno-236-2"></a><span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span><span class="p">&gt;</span>
</span><span id="__span-236-3"><a id="__codelineno-236-3" name="__codelineno-236-3" href="#__codelineno-236-3"></a>  {% csrf_token %}
</span><span id="__span-236-4"><a id="__codelineno-236-4" name="__codelineno-236-4" href="#__codelineno-236-4"></a>  {{ form.as_p }}
</span><span id="__span-236-5"><a id="__codelineno-236-5" name="__codelineno-236-5" href="#__codelineno-236-5"></a>  <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>登录<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span><span id="__span-236-6"><a id="__codelineno-236-6" name="__codelineno-236-6" href="#__codelineno-236-6"></a><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>django用户管理模块基本操作</p>
<p>用户注册</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-237-1"><a id="__codelineno-237-1" name="__codelineno-237-1" href="#__codelineno-237-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">redirect</span>
</span><span id="__span-237-2"><a id="__codelineno-237-2" name="__codelineno-237-2" href="#__codelineno-237-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.forms</span><span class="w"> </span><span class="kn">import</span> <span class="n">UserCreationForm</span>
</span><span id="__span-237-3"><a id="__codelineno-237-3" name="__codelineno-237-3" href="#__codelineno-237-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth</span><span class="w"> </span><span class="kn">import</span> <span class="n">login</span>
</span><span id="__span-237-4"><a id="__codelineno-237-4" name="__codelineno-237-4" href="#__codelineno-237-4"></a>
</span><span id="__span-237-5"><a id="__codelineno-237-5" name="__codelineno-237-5" href="#__codelineno-237-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">signup</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span id="__span-237-6"><a id="__codelineno-237-6" name="__codelineno-237-6" href="#__codelineno-237-6"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
</span><span id="__span-237-7"><a id="__codelineno-237-7" name="__codelineno-237-7" href="#__codelineno-237-7"></a>        <span class="n">form</span> <span class="o">=</span> <span class="n">UserCreationForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
</span><span id="__span-237-8"><a id="__codelineno-237-8" name="__codelineno-237-8" href="#__codelineno-237-8"></a>        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
</span><span id="__span-237-9"><a id="__codelineno-237-9" name="__codelineno-237-9" href="#__codelineno-237-9"></a>            <span class="n">user</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="__span-237-10"><a id="__codelineno-237-10" name="__codelineno-237-10" href="#__codelineno-237-10"></a>            <span class="n">login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
</span><span id="__span-237-11"><a id="__codelineno-237-11" name="__codelineno-237-11" href="#__codelineno-237-11"></a>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;mqsa_list&#39;</span><span class="p">)</span>  <span class="c1"># 登录后跳转到某个页面</span>
</span><span id="__span-237-12"><a id="__codelineno-237-12" name="__codelineno-237-12" href="#__codelineno-237-12"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-237-13"><a id="__codelineno-237-13" name="__codelineno-237-13" href="#__codelineno-237-13"></a>        <span class="n">form</span> <span class="o">=</span> <span class="n">UserCreationForm</span><span class="p">()</span>
</span><span id="__span-237-14"><a id="__codelineno-237-14" name="__codelineno-237-14" href="#__codelineno-237-14"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;registration/signup.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-238-1"><a id="__codelineno-238-1" name="__codelineno-238-1" href="#__codelineno-238-1"></a><span class="c1">#注册新用户</span>
</span><span id="__span-238-2"><a id="__codelineno-238-2" name="__codelineno-238-2" href="#__codelineno-238-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span>
</span><span id="__span-238-3"><a id="__codelineno-238-3" name="__codelineno-238-3" href="#__codelineno-238-3"></a><span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;123&#39;</span><span class="p">)</span>
</span><span id="__span-238-4"><a id="__codelineno-238-4" name="__codelineno-238-4" href="#__codelineno-238-4"></a><span class="n">user</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-239-1"><a id="__codelineno-239-1" name="__codelineno-239-1" href="#__codelineno-239-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Group</span><span class="p">,</span> <span class="n">Permission</span>
</span><span id="__span-239-2"><a id="__codelineno-239-2" name="__codelineno-239-2" href="#__codelineno-239-2"></a>
</span><span id="__span-239-3"><a id="__codelineno-239-3" name="__codelineno-239-3" href="#__codelineno-239-3"></a><span class="c1"># 创建编辑组并分配权限</span>
</span><span id="__span-239-4"><a id="__codelineno-239-4" name="__codelineno-239-4" href="#__codelineno-239-4"></a><span class="n">editors_group</span><span class="p">,</span> <span class="n">created</span> <span class="o">=</span> <span class="n">Group</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;编辑组&#39;</span><span class="p">)</span>
</span><span id="__span-239-5"><a id="__codelineno-239-5" name="__codelineno-239-5" href="#__codelineno-239-5"></a><span class="n">edit_permission</span> <span class="o">=</span> <span class="n">Permission</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s1">&#39;edit_others_post&#39;</span><span class="p">)</span>
</span><span id="__span-239-6"><a id="__codelineno-239-6" name="__codelineno-239-6" href="#__codelineno-239-6"></a><span class="n">editors_group</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">edit_permission</span><span class="p">)</span>
</span><span id="__span-239-7"><a id="__codelineno-239-7" name="__codelineno-239-7" href="#__codelineno-239-7"></a>
</span><span id="__span-239-8"><a id="__codelineno-239-8" name="__codelineno-239-8" href="#__codelineno-239-8"></a>
</span><span id="__span-239-9"><a id="__codelineno-239-9" name="__codelineno-239-9" href="#__codelineno-239-9"></a><span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;john&#39;</span><span class="p">)</span>
</span><span id="__span-239-10"><a id="__codelineno-239-10" name="__codelineno-239-10" href="#__codelineno-239-10"></a><span class="n">user</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">editors_group</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>异步文件上传</strong></p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-240-1"><a id="__codelineno-240-1" name="__codelineno-240-1" href="#__codelineno-240-1"></a><span class="cm">&lt;!-- HTML部分 --&gt;</span>
</span><span id="__span-240-2"><a id="__codelineno-240-2" name="__codelineno-240-2" href="#__codelineno-240-2"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;upload-group&quot;</span><span class="p">&gt;</span>
</span><span id="__span-240-3"><a id="__codelineno-240-3" name="__codelineno-240-3" href="#__codelineno-240-3"></a>  <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>合同附件：<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span><span id="__span-240-4"><a id="__codelineno-240-4" name="__codelineno-240-4" href="#__codelineno-240-4"></a>  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;drop-zone&quot;</span><span class="p">&gt;</span>
</span><span id="__span-240-5"><a id="__codelineno-240-5" name="__codelineno-240-5" href="#__codelineno-240-5"></a>    拖拽文件到这里或点击选择
</span><span id="__span-240-6"><a id="__codelineno-240-6" name="__codelineno-240-6" href="#__codelineno-240-6"></a>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;file&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;async-upload&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;display:none;&quot;</span> <span class="na">multiple</span><span class="p">&gt;</span>
</span><span id="__span-240-7"><a id="__codelineno-240-7" name="__codelineno-240-7" href="#__codelineno-240-7"></a>  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-240-8"><a id="__codelineno-240-8" name="__codelineno-240-8" href="#__codelineno-240-8"></a>  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;upload-status&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-240-9"><a id="__codelineno-240-9" name="__codelineno-240-9" href="#__codelineno-240-9"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-240-10"><a id="__codelineno-240-10" name="__codelineno-240-10" href="#__codelineno-240-10"></a>
</span><span id="__span-240-11"><a id="__codelineno-240-11" name="__codelineno-240-11" href="#__codelineno-240-11"></a><span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
</span><span id="__span-240-12"><a id="__codelineno-240-12" name="__codelineno-240-12" href="#__codelineno-240-12"></a><span class="c">/* 基础样式 */</span>
</span><span id="__span-240-13"><a id="__codelineno-240-13" name="__codelineno-240-13" href="#__codelineno-240-13"></a><span class="p">.</span><span class="nc">upload-group</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-14"><a id="__codelineno-240-14" name="__codelineno-240-14" href="#__codelineno-240-14"></a><span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-240-15"><a id="__codelineno-240-15" name="__codelineno-240-15" href="#__codelineno-240-15"></a><span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-240-16"><a id="__codelineno-240-16" name="__codelineno-240-16" href="#__codelineno-240-16"></a><span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#ddd</span><span class="p">;</span>
</span><span id="__span-240-17"><a id="__codelineno-240-17" name="__codelineno-240-17" href="#__codelineno-240-17"></a><span class="p">}</span>
</span><span id="__span-240-18"><a id="__codelineno-240-18" name="__codelineno-240-18" href="#__codelineno-240-18"></a>
</span><span id="__span-240-19"><a id="__codelineno-240-19" name="__codelineno-240-19" href="#__codelineno-240-19"></a><span class="p">.</span><span class="nc">drop-zone</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-20"><a id="__codelineno-240-20" name="__codelineno-240-20" href="#__codelineno-240-20"></a><span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="w"> </span><span class="kc">dashed</span><span class="w"> </span><span class="mh">#ccc</span><span class="p">;</span>
</span><span id="__span-240-21"><a id="__codelineno-240-21" name="__codelineno-240-21" href="#__codelineno-240-21"></a><span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-240-22"><a id="__codelineno-240-22" name="__codelineno-240-22" href="#__codelineno-240-22"></a><span class="w">  </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
</span><span id="__span-240-23"><a id="__codelineno-240-23" name="__codelineno-240-23" href="#__codelineno-240-23"></a><span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-240-24"><a id="__codelineno-240-24" name="__codelineno-240-24" href="#__codelineno-240-24"></a><span class="w">  </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="kc">all</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="p">;</span>
</span><span id="__span-240-25"><a id="__codelineno-240-25" name="__codelineno-240-25" href="#__codelineno-240-25"></a><span class="p">}</span>
</span><span id="__span-240-26"><a id="__codelineno-240-26" name="__codelineno-240-26" href="#__codelineno-240-26"></a>
</span><span id="__span-240-27"><a id="__codelineno-240-27" name="__codelineno-240-27" href="#__codelineno-240-27"></a><span class="p">.</span><span class="nc">drop-zone</span><span class="p">.</span><span class="nc">dragover</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-28"><a id="__codelineno-240-28" name="__codelineno-240-28" href="#__codelineno-240-28"></a><span class="w">  </span><span class="k">border-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#2196F3</span><span class="p">;</span>
</span><span id="__span-240-29"><a id="__codelineno-240-29" name="__codelineno-240-29" href="#__codelineno-240-29"></a><span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#f5fbff</span><span class="p">;</span>
</span><span id="__span-240-30"><a id="__codelineno-240-30" name="__codelineno-240-30" href="#__codelineno-240-30"></a><span class="p">}</span>
</span><span id="__span-240-31"><a id="__codelineno-240-31" name="__codelineno-240-31" href="#__codelineno-240-31"></a>
</span><span id="__span-240-32"><a id="__codelineno-240-32" name="__codelineno-240-32" href="#__codelineno-240-32"></a><span class="p">.</span><span class="nc">upload-item</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-33"><a id="__codelineno-240-33" name="__codelineno-240-33" href="#__codelineno-240-33"></a><span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-240-34"><a id="__codelineno-240-34" name="__codelineno-240-34" href="#__codelineno-240-34"></a><span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-240-35"><a id="__codelineno-240-35" name="__codelineno-240-35" href="#__codelineno-240-35"></a><span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#eee</span><span class="p">;</span>
</span><span id="__span-240-36"><a id="__codelineno-240-36" name="__codelineno-240-36" href="#__codelineno-240-36"></a><span class="p">}</span>
</span><span id="__span-240-37"><a id="__codelineno-240-37" name="__codelineno-240-37" href="#__codelineno-240-37"></a>
</span><span id="__span-240-38"><a id="__codelineno-240-38" name="__codelineno-240-38" href="#__codelineno-240-38"></a><span class="p">.</span><span class="nc">progress-bar</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-39"><a id="__codelineno-240-39" name="__codelineno-240-39" href="#__codelineno-240-39"></a><span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-240-40"><a id="__codelineno-240-40" name="__codelineno-240-40" href="#__codelineno-240-40"></a><span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-240-41"><a id="__codelineno-240-41" name="__codelineno-240-41" href="#__codelineno-240-41"></a><span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#f0f0f0</span><span class="p">;</span>
</span><span id="__span-240-42"><a id="__codelineno-240-42" name="__codelineno-240-42" href="#__codelineno-240-42"></a><span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">inline-block</span><span class="p">;</span>
</span><span id="__span-240-43"><a id="__codelineno-240-43" name="__codelineno-240-43" href="#__codelineno-240-43"></a><span class="w">  </span><span class="k">vertical-align</span><span class="p">:</span><span class="w"> </span><span class="kc">middle</span><span class="p">;</span>
</span><span id="__span-240-44"><a id="__codelineno-240-44" name="__codelineno-240-44" href="#__codelineno-240-44"></a><span class="p">}</span>
</span><span id="__span-240-45"><a id="__codelineno-240-45" name="__codelineno-240-45" href="#__codelineno-240-45"></a>
</span><span id="__span-240-46"><a id="__codelineno-240-46" name="__codelineno-240-46" href="#__codelineno-240-46"></a><span class="p">.</span><span class="nc">progress</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-47"><a id="__codelineno-240-47" name="__codelineno-240-47" href="#__codelineno-240-47"></a><span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="kt">%</span><span class="p">;</span>
</span><span id="__span-240-48"><a id="__codelineno-240-48" name="__codelineno-240-48" href="#__codelineno-240-48"></a><span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span><span id="__span-240-49"><a id="__codelineno-240-49" name="__codelineno-240-49" href="#__codelineno-240-49"></a><span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4CAF50</span><span class="p">;</span>
</span><span id="__span-240-50"><a id="__codelineno-240-50" name="__codelineno-240-50" href="#__codelineno-240-50"></a><span class="w">  </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">width</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
</span><span id="__span-240-51"><a id="__codelineno-240-51" name="__codelineno-240-51" href="#__codelineno-240-51"></a><span class="p">}</span>
</span><span id="__span-240-52"><a id="__codelineno-240-52" name="__codelineno-240-52" href="#__codelineno-240-52"></a>
</span><span id="__span-240-53"><a id="__codelineno-240-53" name="__codelineno-240-53" href="#__codelineno-240-53"></a><span class="p">.</span><span class="nc">btn-cancel</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-54"><a id="__codelineno-240-54" name="__codelineno-240-54" href="#__codelineno-240-54"></a><span class="w">  </span><span class="k">margin-left</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-240-55"><a id="__codelineno-240-55" name="__codelineno-240-55" href="#__codelineno-240-55"></a><span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-240-56"><a id="__codelineno-240-56" name="__codelineno-240-56" href="#__codelineno-240-56"></a><span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#ff4444</span><span class="p">;</span>
</span><span id="__span-240-57"><a id="__codelineno-240-57" name="__codelineno-240-57" href="#__codelineno-240-57"></a><span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span>
</span><span id="__span-240-58"><a id="__codelineno-240-58" name="__codelineno-240-58" href="#__codelineno-240-58"></a><span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
</span><span id="__span-240-59"><a id="__codelineno-240-59" name="__codelineno-240-59" href="#__codelineno-240-59"></a><span class="w">  </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
</span><span id="__span-240-60"><a id="__codelineno-240-60" name="__codelineno-240-60" href="#__codelineno-240-60"></a><span class="p">}</span>
</span><span id="__span-240-61"><a id="__codelineno-240-61" name="__codelineno-240-61" href="#__codelineno-240-61"></a><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span><span id="__span-240-62"><a id="__codelineno-240-62" name="__codelineno-240-62" href="#__codelineno-240-62"></a>
</span><span id="__span-240-63"><a id="__codelineno-240-63" name="__codelineno-240-63" href="#__codelineno-240-63"></a><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-240-64"><a id="__codelineno-240-64" name="__codelineno-240-64" href="#__codelineno-240-64"></a><span class="c1">// 初始化所有上传控件</span>
</span><span id="__span-240-65"><a id="__codelineno-240-65" name="__codelineno-240-65" href="#__codelineno-240-65"></a><span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;.async-upload&#39;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">input</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-66"><a id="__codelineno-240-66" name="__codelineno-240-66" href="#__codelineno-240-66"></a><span class="w">  </span><span class="nx">initFileUpload</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
</span><span id="__span-240-67"><a id="__codelineno-240-67" name="__codelineno-240-67" href="#__codelineno-240-67"></a><span class="p">});</span>
</span><span id="__span-240-68"><a id="__codelineno-240-68" name="__codelineno-240-68" href="#__codelineno-240-68"></a>
</span><span id="__span-240-69"><a id="__codelineno-240-69" name="__codelineno-240-69" href="#__codelineno-240-69"></a><span class="kd">function</span><span class="w"> </span><span class="nx">initFileUpload</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-70"><a id="__codelineno-240-70" name="__codelineno-240-70" href="#__codelineno-240-70"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">container</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">closest</span><span class="p">(</span><span class="s1">&#39;.upload-group&#39;</span><span class="p">);</span>
</span><span id="__span-240-71"><a id="__codelineno-240-71" name="__codelineno-240-71" href="#__codelineno-240-71"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">dropZone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.drop-zone&#39;</span><span class="p">);</span>
</span><span id="__span-240-72"><a id="__codelineno-240-72" name="__codelineno-240-72" href="#__codelineno-240-72"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">statusDiv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.upload-status&#39;</span><span class="p">);</span>
</span><span id="__span-240-73"><a id="__codelineno-240-73" name="__codelineno-240-73" href="#__codelineno-240-73"></a>
</span><span id="__span-240-74"><a id="__codelineno-240-74" name="__codelineno-240-74" href="#__codelineno-240-74"></a><span class="w">  </span><span class="c1">// 点击触发文件选择</span>
</span><span id="__span-240-75"><a id="__codelineno-240-75" name="__codelineno-240-75" href="#__codelineno-240-75"></a><span class="w">  </span><span class="nx">dropZone</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">click</span><span class="p">());</span>
</span><span id="__span-240-76"><a id="__codelineno-240-76" name="__codelineno-240-76" href="#__codelineno-240-76"></a>
</span><span id="__span-240-77"><a id="__codelineno-240-77" name="__codelineno-240-77" href="#__codelineno-240-77"></a><span class="w">  </span><span class="c1">// 拖拽事件处理</span>
</span><span id="__span-240-78"><a id="__codelineno-240-78" name="__codelineno-240-78" href="#__codelineno-240-78"></a><span class="w">  </span><span class="nx">dropZone</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;dragover&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-79"><a id="__codelineno-240-79" name="__codelineno-240-79" href="#__codelineno-240-79"></a><span class="w">    </span><span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span id="__span-240-80"><a id="__codelineno-240-80" name="__codelineno-240-80" href="#__codelineno-240-80"></a><span class="w">    </span><span class="nx">dropZone</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;dragover&#39;</span><span class="p">);</span>
</span><span id="__span-240-81"><a id="__codelineno-240-81" name="__codelineno-240-81" href="#__codelineno-240-81"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-240-82"><a id="__codelineno-240-82" name="__codelineno-240-82" href="#__codelineno-240-82"></a>
</span><span id="__span-240-83"><a id="__codelineno-240-83" name="__codelineno-240-83" href="#__codelineno-240-83"></a><span class="w">  </span><span class="nx">dropZone</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;dragleave&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-84"><a id="__codelineno-240-84" name="__codelineno-240-84" href="#__codelineno-240-84"></a><span class="w">    </span><span class="nx">dropZone</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s1">&#39;dragover&#39;</span><span class="p">);</span>
</span><span id="__span-240-85"><a id="__codelineno-240-85" name="__codelineno-240-85" href="#__codelineno-240-85"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-240-86"><a id="__codelineno-240-86" name="__codelineno-240-86" href="#__codelineno-240-86"></a>
</span><span id="__span-240-87"><a id="__codelineno-240-87" name="__codelineno-240-87" href="#__codelineno-240-87"></a><span class="w">  </span><span class="nx">dropZone</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;drop&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-88"><a id="__codelineno-240-88" name="__codelineno-240-88" href="#__codelineno-240-88"></a><span class="w">    </span><span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span id="__span-240-89"><a id="__codelineno-240-89" name="__codelineno-240-89" href="#__codelineno-240-89"></a><span class="w">    </span><span class="nx">dropZone</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s1">&#39;dragover&#39;</span><span class="p">);</span>
</span><span id="__span-240-90"><a id="__codelineno-240-90" name="__codelineno-240-90" href="#__codelineno-240-90"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">files</span><span class="p">);</span>
</span><span id="__span-240-91"><a id="__codelineno-240-91" name="__codelineno-240-91" href="#__codelineno-240-91"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">files</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-92"><a id="__codelineno-240-92" name="__codelineno-240-92" href="#__codelineno-240-92"></a><span class="w">      </span><span class="nx">handleFileUpload</span><span class="p">(</span><span class="nx">files</span><span class="p">,</span><span class="w"> </span><span class="nx">statusDiv</span><span class="p">,</span><span class="w"> </span><span class="nx">getUploadOptions</span><span class="p">(</span><span class="nx">input</span><span class="p">));</span>
</span><span id="__span-240-93"><a id="__codelineno-240-93" name="__codelineno-240-93" href="#__codelineno-240-93"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-240-94"><a id="__codelineno-240-94" name="__codelineno-240-94" href="#__codelineno-240-94"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-240-95"><a id="__codelineno-240-95" name="__codelineno-240-95" href="#__codelineno-240-95"></a>
</span><span id="__span-240-96"><a id="__codelineno-240-96" name="__codelineno-240-96" href="#__codelineno-240-96"></a><span class="w">  </span><span class="c1">// 文件选择事件</span>
</span><span id="__span-240-97"><a id="__codelineno-240-97" name="__codelineno-240-97" href="#__codelineno-240-97"></a><span class="w">  </span><span class="nx">input</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-98"><a id="__codelineno-240-98" name="__codelineno-240-98" href="#__codelineno-240-98"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span><span class="p">);</span>
</span><span id="__span-240-99"><a id="__codelineno-240-99" name="__codelineno-240-99" href="#__codelineno-240-99"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">files</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-240-100"><a id="__codelineno-240-100" name="__codelineno-240-100" href="#__codelineno-240-100"></a><span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">handleFileUpload</span><span class="p">(</span><span class="nx">files</span><span class="p">,</span><span class="w"> </span><span class="nx">statusDiv</span><span class="p">,</span><span class="w"> </span><span class="nx">getUploadOptions</span><span class="p">(</span><span class="nx">input</span><span class="p">));</span>
</span><span id="__span-240-101"><a id="__codelineno-240-101" name="__codelineno-240-101" href="#__codelineno-240-101"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-240-102"><a id="__codelineno-240-102" name="__codelineno-240-102" href="#__codelineno-240-102"></a><span class="p">}</span>
</span><span id="__span-240-103"><a id="__codelineno-240-103" name="__codelineno-240-103" href="#__codelineno-240-103"></a>
</span><span id="__span-240-104"><a id="__codelineno-240-104" name="__codelineno-240-104" href="#__codelineno-240-104"></a><span class="c1">// 获取上传配置</span>
</span><span id="__span-240-105"><a id="__codelineno-240-105" name="__codelineno-240-105" href="#__codelineno-240-105"></a><span class="kd">function</span><span class="w"> </span><span class="nx">getUploadOptions</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-106"><a id="__codelineno-240-106" name="__codelineno-240-106" href="#__codelineno-240-106"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-107"><a id="__codelineno-240-107" name="__codelineno-240-107" href="#__codelineno-240-107"></a><span class="w">    </span><span class="nx">fileType</span><span class="o">:</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">fileType</span><span class="p">,</span>
</span><span id="__span-240-108"><a id="__codelineno-240-108" name="__codelineno-240-108" href="#__codelineno-240-108"></a><span class="w">    </span><span class="nx">maxSize</span><span class="o">:</span><span class="w"> </span><span class="mf">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1024</span><span class="p">,</span><span class="w"> </span><span class="c1">// 10MB</span>
</span><span id="__span-240-109"><a id="__codelineno-240-109" name="__codelineno-240-109" href="#__codelineno-240-109"></a><span class="w">    </span><span class="nx">allowedTypes</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;image/&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;application/pdf&#39;</span><span class="p">],</span>
</span><span id="__span-240-110"><a id="__codelineno-240-110" name="__codelineno-240-110" href="#__codelineno-240-110"></a><span class="w">    </span><span class="nx">endpoint</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;/async_upload/&#39;</span><span class="w"> </span><span class="c1">// Django上传端点</span>
</span><span id="__span-240-111"><a id="__codelineno-240-111" name="__codelineno-240-111" href="#__codelineno-240-111"></a><span class="w">  </span><span class="p">};</span>
</span><span id="__span-240-112"><a id="__codelineno-240-112" name="__codelineno-240-112" href="#__codelineno-240-112"></a><span class="p">}</span>
</span><span id="__span-240-113"><a id="__codelineno-240-113" name="__codelineno-240-113" href="#__codelineno-240-113"></a>
</span><span id="__span-240-114"><a id="__codelineno-240-114" name="__codelineno-240-114" href="#__codelineno-240-114"></a><span class="c1">// 完整的上传处理函数</span>
</span><span id="__span-240-115"><a id="__codelineno-240-115" name="__codelineno-240-115" href="#__codelineno-240-115"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">handleFileUpload</span><span class="p">(</span><span class="nx">files</span><span class="p">,</span><span class="w"> </span><span class="nx">statusDiv</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-116"><a id="__codelineno-240-116" name="__codelineno-240-116" href="#__codelineno-240-116"></a><span class="w">  </span><span class="c1">// 清空之前的错误提示</span>
</span><span id="__span-240-117"><a id="__codelineno-240-117" name="__codelineno-240-117" href="#__codelineno-240-117"></a><span class="w">  </span><span class="nx">statusDiv</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;.error&#39;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">el</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">el</span><span class="p">.</span><span class="nx">remove</span><span class="p">());</span>
</span><span id="__span-240-118"><a id="__codelineno-240-118" name="__codelineno-240-118" href="#__codelineno-240-118"></a>
</span><span id="__span-240-119"><a id="__codelineno-240-119" name="__codelineno-240-119" href="#__codelineno-240-119"></a><span class="w">  </span><span class="c1">// 验证文件</span>
</span><span id="__span-240-120"><a id="__codelineno-240-120" name="__codelineno-240-120" href="#__codelineno-240-120"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">files</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-121"><a id="__codelineno-240-121" name="__codelineno-240-121" href="#__codelineno-240-121"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">options</span><span class="p">.</span><span class="nx">maxSize</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-122"><a id="__codelineno-240-122" name="__codelineno-240-122" href="#__codelineno-240-122"></a><span class="w">      </span><span class="nx">showError</span><span class="p">(</span><span class="nx">statusDiv</span><span class="p">,</span><span class="w"> </span><span class="sb">`文件 </span><span class="si">${</span><span class="nx">file</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb"> 超过</span><span class="si">${</span><span class="nx">options</span><span class="p">.</span><span class="nx">maxSize</span><span class="o">/</span><span class="mf">1024</span><span class="o">/</span><span class="mf">1024</span><span class="si">}</span><span class="sb">MB限制`</span><span class="p">);</span>
</span><span id="__span-240-123"><a id="__codelineno-240-123" name="__codelineno-240-123" href="#__codelineno-240-123"></a><span class="w">      </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-240-124"><a id="__codelineno-240-124" name="__codelineno-240-124" href="#__codelineno-240-124"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-240-125"><a id="__codelineno-240-125" name="__codelineno-240-125" href="#__codelineno-240-125"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">allowedTypes</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">type</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">file</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="nx">type</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-126"><a id="__codelineno-240-126" name="__codelineno-240-126" href="#__codelineno-240-126"></a><span class="w">      </span><span class="nx">showError</span><span class="p">(</span><span class="nx">statusDiv</span><span class="p">,</span><span class="w"> </span><span class="sb">`文件类型 </span><span class="si">${</span><span class="nx">file</span><span class="p">.</span><span class="nx">type</span><span class="si">}</span><span class="sb"> 不被支持`</span><span class="p">);</span>
</span><span id="__span-240-127"><a id="__codelineno-240-127" name="__codelineno-240-127" href="#__codelineno-240-127"></a><span class="w">      </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-240-128"><a id="__codelineno-240-128" name="__codelineno-240-128" href="#__codelineno-240-128"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-240-129"><a id="__codelineno-240-129" name="__codelineno-240-129" href="#__codelineno-240-129"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-240-130"><a id="__codelineno-240-130" name="__codelineno-240-130" href="#__codelineno-240-130"></a>
</span><span id="__span-240-131"><a id="__codelineno-240-131" name="__codelineno-240-131" href="#__codelineno-240-131"></a><span class="w">  </span><span class="c1">// 逐个上传文件</span>
</span><span id="__span-240-132"><a id="__codelineno-240-132" name="__codelineno-240-132" href="#__codelineno-240-132"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">files</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-133"><a id="__codelineno-240-133" name="__codelineno-240-133" href="#__codelineno-240-133"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">formData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">FormData</span><span class="p">();</span>
</span><span id="__span-240-134"><a id="__codelineno-240-134" name="__codelineno-240-134" href="#__codelineno-240-134"></a><span class="w">    </span><span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">file</span><span class="p">);</span>
</span><span id="__span-240-135"><a id="__codelineno-240-135" name="__codelineno-240-135" href="#__codelineno-240-135"></a><span class="w">    </span><span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;file_type&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="p">.</span><span class="nx">fileType</span><span class="p">);</span>
</span><span id="__span-240-136"><a id="__codelineno-240-136" name="__codelineno-240-136" href="#__codelineno-240-136"></a>
</span><span id="__span-240-137"><a id="__codelineno-240-137" name="__codelineno-240-137" href="#__codelineno-240-137"></a><span class="w">    </span><span class="c1">// 创建上传状态条目</span>
</span><span id="__span-240-138"><a id="__codelineno-240-138" name="__codelineno-240-138" href="#__codelineno-240-138"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">statusItem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createStatusItem</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
</span><span id="__span-240-139"><a id="__codelineno-240-139" name="__codelineno-240-139" href="#__codelineno-240-139"></a><span class="w">    </span><span class="nx">statusDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">statusItem</span><span class="p">);</span>
</span><span id="__span-240-140"><a id="__codelineno-240-140" name="__codelineno-240-140" href="#__codelineno-240-140"></a>
</span><span id="__span-240-141"><a id="__codelineno-240-141" name="__codelineno-240-141" href="#__codelineno-240-141"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-142"><a id="__codelineno-240-142" name="__codelineno-240-142" href="#__codelineno-240-142"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">xhr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">XMLHttpRequest</span><span class="p">();</span>
</span><span id="__span-240-143"><a id="__codelineno-240-143" name="__codelineno-240-143" href="#__codelineno-240-143"></a><span class="w">      </span><span class="nx">statusItem</span><span class="p">.</span><span class="nx">xhr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">xhr</span><span class="p">;</span><span class="w"> </span><span class="c1">// 存储xhr引用</span>
</span><span id="__span-240-144"><a id="__codelineno-240-144" name="__codelineno-240-144" href="#__codelineno-240-144"></a>
</span><span id="__span-240-145"><a id="__codelineno-240-145" name="__codelineno-240-145" href="#__codelineno-240-145"></a><span class="w">      </span><span class="c1">// 创建取消按钮</span>
</span><span id="__span-240-146"><a id="__codelineno-240-146" name="__codelineno-240-146" href="#__codelineno-240-146"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">cancelBtn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">statusItem</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.btn-cancel&#39;</span><span class="p">);</span>
</span><span id="__span-240-147"><a id="__codelineno-240-147" name="__codelineno-240-147" href="#__codelineno-240-147"></a><span class="w">      </span><span class="nx">cancelBtn</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-148"><a id="__codelineno-240-148" name="__codelineno-240-148" href="#__codelineno-240-148"></a><span class="w">        </span><span class="nx">xhr</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span>
</span><span id="__span-240-149"><a id="__codelineno-240-149" name="__codelineno-240-149" href="#__codelineno-240-149"></a><span class="w">        </span><span class="nx">statusItem</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
</span><span id="__span-240-150"><a id="__codelineno-240-150" name="__codelineno-240-150" href="#__codelineno-240-150"></a><span class="w">      </span><span class="p">};</span>
</span><span id="__span-240-151"><a id="__codelineno-240-151" name="__codelineno-240-151" href="#__codelineno-240-151"></a>
</span><span id="__span-240-152"><a id="__codelineno-240-152" name="__codelineno-240-152" href="#__codelineno-240-152"></a><span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="nx">reject</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-153"><a id="__codelineno-240-153" name="__codelineno-240-153" href="#__codelineno-240-153"></a><span class="w">        </span><span class="nx">xhr</span><span class="p">.</span><span class="nx">upload</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;progress&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-154"><a id="__codelineno-240-154" name="__codelineno-240-154" href="#__codelineno-240-154"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">lengthComputable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-155"><a id="__codelineno-240-155" name="__codelineno-240-155" href="#__codelineno-240-155"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">percent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="nx">e</span><span class="p">.</span><span class="nx">loaded</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">total</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100</span><span class="p">);</span>
</span><span id="__span-240-156"><a id="__codelineno-240-156" name="__codelineno-240-156" href="#__codelineno-240-156"></a><span class="w">            </span><span class="nx">updateProgress</span><span class="p">(</span><span class="nx">statusItem</span><span class="p">,</span><span class="w"> </span><span class="nx">percent</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;上传中...&#39;</span><span class="p">);</span>
</span><span id="__span-240-157"><a id="__codelineno-240-157" name="__codelineno-240-157" href="#__codelineno-240-157"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-240-158"><a id="__codelineno-240-158" name="__codelineno-240-158" href="#__codelineno-240-158"></a><span class="w">        </span><span class="p">});</span>
</span><span id="__span-240-159"><a id="__codelineno-240-159" name="__codelineno-240-159" href="#__codelineno-240-159"></a>
</span><span id="__span-240-160"><a id="__codelineno-240-160" name="__codelineno-240-160" href="#__codelineno-240-160"></a><span class="w">        </span><span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-161"><a id="__codelineno-240-161" name="__codelineno-240-161" href="#__codelineno-240-161"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">XMLHttpRequest</span><span class="p">.</span><span class="nx">DONE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-162"><a id="__codelineno-240-162" name="__codelineno-240-162" href="#__codelineno-240-162"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-163"><a id="__codelineno-240-163" name="__codelineno-240-163" href="#__codelineno-240-163"></a><span class="w">              </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
</span><span id="__span-240-164"><a id="__codelineno-240-164" name="__codelineno-240-164" href="#__codelineno-240-164"></a><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-165"><a id="__codelineno-240-165" name="__codelineno-240-165" href="#__codelineno-240-165"></a><span class="w">                </span><span class="nx">statusItem</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">fileKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">file_key</span><span class="p">;</span>
</span><span id="__span-240-166"><a id="__codelineno-240-166" name="__codelineno-240-166" href="#__codelineno-240-166"></a><span class="w">                </span><span class="nx">updateProgress</span><span class="p">(</span><span class="nx">statusItem</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;上传完成&#39;</span><span class="p">);</span>
</span><span id="__span-240-167"><a id="__codelineno-240-167" name="__codelineno-240-167" href="#__codelineno-240-167"></a><span class="w">                </span><span class="nx">resolve</span><span class="p">();</span>
</span><span id="__span-240-168"><a id="__codelineno-240-168" name="__codelineno-240-168" href="#__codelineno-240-168"></a><span class="w">              </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-169"><a id="__codelineno-240-169" name="__codelineno-240-169" href="#__codelineno-240-169"></a><span class="w">                </span><span class="nx">updateProgress</span><span class="p">(</span><span class="nx">statusItem</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="__span-240-170"><a id="__codelineno-240-170" name="__codelineno-240-170" href="#__codelineno-240-170"></a><span class="w">                </span><span class="nx">reject</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">message</span><span class="p">));</span>
</span><span id="__span-240-171"><a id="__codelineno-240-171" name="__codelineno-240-171" href="#__codelineno-240-171"></a><span class="w">              </span><span class="p">}</span>
</span><span id="__span-240-172"><a id="__codelineno-240-172" name="__codelineno-240-172" href="#__codelineno-240-172"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-173"><a id="__codelineno-240-173" name="__codelineno-240-173" href="#__codelineno-240-173"></a><span class="w">              </span><span class="nx">updateProgress</span><span class="p">(</span><span class="nx">statusItem</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="sb">`上传失败: </span><span class="si">${</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="__span-240-174"><a id="__codelineno-240-174" name="__codelineno-240-174" href="#__codelineno-240-174"></a><span class="w">              </span><span class="nx">reject</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`HTTP错误: </span><span class="si">${</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span><span class="si">}</span><span class="sb">`</span><span class="p">));</span>
</span><span id="__span-240-175"><a id="__codelineno-240-175" name="__codelineno-240-175" href="#__codelineno-240-175"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-240-176"><a id="__codelineno-240-176" name="__codelineno-240-176" href="#__codelineno-240-176"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-240-177"><a id="__codelineno-240-177" name="__codelineno-240-177" href="#__codelineno-240-177"></a><span class="w">        </span><span class="p">};</span>
</span><span id="__span-240-178"><a id="__codelineno-240-178" name="__codelineno-240-178" href="#__codelineno-240-178"></a>
</span><span id="__span-240-179"><a id="__codelineno-240-179" name="__codelineno-240-179" href="#__codelineno-240-179"></a><span class="w">        </span><span class="nx">xhr</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-180"><a id="__codelineno-240-180" name="__codelineno-240-180" href="#__codelineno-240-180"></a><span class="w">          </span><span class="nx">updateProgress</span><span class="p">(</span><span class="nx">statusItem</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;网络错误&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="__span-240-181"><a id="__codelineno-240-181" name="__codelineno-240-181" href="#__codelineno-240-181"></a><span class="w">          </span><span class="nx">reject</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;网络错误&#39;</span><span class="p">));</span>
</span><span id="__span-240-182"><a id="__codelineno-240-182" name="__codelineno-240-182" href="#__codelineno-240-182"></a><span class="w">        </span><span class="p">};</span>
</span><span id="__span-240-183"><a id="__codelineno-240-183" name="__codelineno-240-183" href="#__codelineno-240-183"></a>
</span><span id="__span-240-184"><a id="__codelineno-240-184" name="__codelineno-240-184" href="#__codelineno-240-184"></a><span class="w">        </span><span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="p">.</span><span class="nx">endpoint</span><span class="p">);</span>
</span><span id="__span-240-185"><a id="__codelineno-240-185" name="__codelineno-240-185" href="#__codelineno-240-185"></a><span class="w">        </span><span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s1">&#39;X-Requested-With&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;XMLHttpRequest&#39;</span><span class="p">);</span>
</span><span id="__span-240-186"><a id="__codelineno-240-186" name="__codelineno-240-186" href="#__codelineno-240-186"></a><span class="w">        </span><span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">formData</span><span class="p">);</span>
</span><span id="__span-240-187"><a id="__codelineno-240-187" name="__codelineno-240-187" href="#__codelineno-240-187"></a><span class="w">      </span><span class="p">});</span>
</span><span id="__span-240-188"><a id="__codelineno-240-188" name="__codelineno-240-188" href="#__codelineno-240-188"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-189"><a id="__codelineno-240-189" name="__codelineno-240-189" href="#__codelineno-240-189"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;上传失败:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-240-190"><a id="__codelineno-240-190" name="__codelineno-240-190" href="#__codelineno-240-190"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;abort&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-191"><a id="__codelineno-240-191" name="__codelineno-240-191" href="#__codelineno-240-191"></a><span class="w">        </span><span class="nx">showError</span><span class="p">(</span><span class="nx">statusDiv</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
</span><span id="__span-240-192"><a id="__codelineno-240-192" name="__codelineno-240-192" href="#__codelineno-240-192"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-240-193"><a id="__codelineno-240-193" name="__codelineno-240-193" href="#__codelineno-240-193"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-240-194"><a id="__codelineno-240-194" name="__codelineno-240-194" href="#__codelineno-240-194"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-240-195"><a id="__codelineno-240-195" name="__codelineno-240-195" href="#__codelineno-240-195"></a><span class="p">}</span>
</span><span id="__span-240-196"><a id="__codelineno-240-196" name="__codelineno-240-196" href="#__codelineno-240-196"></a>
</span><span id="__span-240-197"><a id="__codelineno-240-197" name="__codelineno-240-197" href="#__codelineno-240-197"></a><span class="c1">// 创建状态条目</span>
</span><span id="__span-240-198"><a id="__codelineno-240-198" name="__codelineno-240-198" href="#__codelineno-240-198"></a><span class="kd">function</span><span class="w"> </span><span class="nx">createStatusItem</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-199"><a id="__codelineno-240-199" name="__codelineno-240-199" href="#__codelineno-240-199"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
</span><span id="__span-240-200"><a id="__codelineno-240-200" name="__codelineno-240-200" href="#__codelineno-240-200"></a><span class="w">  </span><span class="nx">div</span><span class="p">.</span><span class="nx">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;upload-item&#39;</span><span class="p">;</span>
</span><span id="__span-240-201"><a id="__codelineno-240-201" name="__codelineno-240-201" href="#__codelineno-240-201"></a><span class="w">  </span><span class="nx">div</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span>
</span><span id="__span-240-202"><a id="__codelineno-240-202" name="__codelineno-240-202" href="#__codelineno-240-202"></a><span class="sb">    &lt;div class=&quot;file-info&quot;&gt;</span>
</span><span id="__span-240-203"><a id="__codelineno-240-203" name="__codelineno-240-203" href="#__codelineno-240-203"></a><span class="sb">      &lt;span class=&quot;filename&quot;&gt;</span><span class="si">${</span><span class="nx">file</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">&lt;/span&gt;</span>
</span><span id="__span-240-204"><a id="__codelineno-240-204" name="__codelineno-240-204" href="#__codelineno-240-204"></a><span class="sb">      &lt;span class=&quot;file-size&quot;&gt;(</span><span class="si">${</span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">size</span><span class="o">/</span><span class="mf">1024</span><span class="o">/</span><span class="mf">1024</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span><span class="si">}</span><span class="sb">MB)&lt;/span&gt;</span>
</span><span id="__span-240-205"><a id="__codelineno-240-205" name="__codelineno-240-205" href="#__codelineno-240-205"></a><span class="sb">    &lt;/div&gt;</span>
</span><span id="__span-240-206"><a id="__codelineno-240-206" name="__codelineno-240-206" href="#__codelineno-240-206"></a><span class="sb">    &lt;div class=&quot;progress-container&quot;&gt;</span>
</span><span id="__span-240-207"><a id="__codelineno-240-207" name="__codelineno-240-207" href="#__codelineno-240-207"></a><span class="sb">      &lt;div class=&quot;progress-bar&quot;&gt;</span>
</span><span id="__span-240-208"><a id="__codelineno-240-208" name="__codelineno-240-208" href="#__codelineno-240-208"></a><span class="sb">        &lt;div class=&quot;progress&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;</span>
</span><span id="__span-240-209"><a id="__codelineno-240-209" name="__codelineno-240-209" href="#__codelineno-240-209"></a><span class="sb">      &lt;/div&gt;</span>
</span><span id="__span-240-210"><a id="__codelineno-240-210" name="__codelineno-240-210" href="#__codelineno-240-210"></a><span class="sb">      &lt;span class=&quot;status-text&quot;&gt;等待上传...&lt;/span&gt;</span>
</span><span id="__span-240-211"><a id="__codelineno-240-211" name="__codelineno-240-211" href="#__codelineno-240-211"></a><span class="sb">      &lt;button class=&quot;btn-cancel&quot;&gt;取消&lt;/button&gt;</span>
</span><span id="__span-240-212"><a id="__codelineno-240-212" name="__codelineno-240-212" href="#__codelineno-240-212"></a><span class="sb">    &lt;/div&gt;</span>
</span><span id="__span-240-213"><a id="__codelineno-240-213" name="__codelineno-240-213" href="#__codelineno-240-213"></a><span class="sb">  `</span><span class="p">;</span>
</span><span id="__span-240-214"><a id="__codelineno-240-214" name="__codelineno-240-214" href="#__codelineno-240-214"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">div</span><span class="p">;</span>
</span><span id="__span-240-215"><a id="__codelineno-240-215" name="__codelineno-240-215" href="#__codelineno-240-215"></a><span class="p">}</span>
</span><span id="__span-240-216"><a id="__codelineno-240-216" name="__codelineno-240-216" href="#__codelineno-240-216"></a>
</span><span id="__span-240-217"><a id="__codelineno-240-217" name="__codelineno-240-217" href="#__codelineno-240-217"></a><span class="c1">// 更新进度显示</span>
</span><span id="__span-240-218"><a id="__codelineno-240-218" name="__codelineno-240-218" href="#__codelineno-240-218"></a><span class="kd">function</span><span class="w"> </span><span class="nx">updateProgress</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span><span class="w"> </span><span class="nx">percent</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">,</span><span class="w"> </span><span class="nx">isError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-219"><a id="__codelineno-240-219" name="__codelineno-240-219" href="#__codelineno-240-219"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">progressBar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.progress&#39;</span><span class="p">);</span>
</span><span id="__span-240-220"><a id="__codelineno-240-220" name="__codelineno-240-220" href="#__codelineno-240-220"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">statusText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.status-text&#39;</span><span class="p">);</span>
</span><span id="__span-240-221"><a id="__codelineno-240-221" name="__codelineno-240-221" href="#__codelineno-240-221"></a>
</span><span id="__span-240-222"><a id="__codelineno-240-222" name="__codelineno-240-222" href="#__codelineno-240-222"></a><span class="w">  </span><span class="nx">progressBar</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">percent</span><span class="si">}</span><span class="sb">%`</span><span class="p">;</span>
</span><span id="__span-240-223"><a id="__codelineno-240-223" name="__codelineno-240-223" href="#__codelineno-240-223"></a><span class="w">  </span><span class="nx">statusText</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">;</span>
</span><span id="__span-240-224"><a id="__codelineno-240-224" name="__codelineno-240-224" href="#__codelineno-240-224"></a><span class="w">  </span><span class="nx">statusText</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">isError</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;#ff4444&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;#666&#39;</span><span class="p">;</span>
</span><span id="__span-240-225"><a id="__codelineno-240-225" name="__codelineno-240-225" href="#__codelineno-240-225"></a>
</span><span id="__span-240-226"><a id="__codelineno-240-226" name="__codelineno-240-226" href="#__codelineno-240-226"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">percent</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-227"><a id="__codelineno-240-227" name="__codelineno-240-227" href="#__codelineno-240-227"></a><span class="w">    </span><span class="nx">item</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.btn-cancel&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
</span><span id="__span-240-228"><a id="__codelineno-240-228" name="__codelineno-240-228" href="#__codelineno-240-228"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-240-229"><a id="__codelineno-240-229" name="__codelineno-240-229" href="#__codelineno-240-229"></a><span class="p">}</span>
</span><span id="__span-240-230"><a id="__codelineno-240-230" name="__codelineno-240-230" href="#__codelineno-240-230"></a>
</span><span id="__span-240-231"><a id="__codelineno-240-231" name="__codelineno-240-231" href="#__codelineno-240-231"></a><span class="c1">// 显示错误信息</span>
</span><span id="__span-240-232"><a id="__codelineno-240-232" name="__codelineno-240-232" href="#__codelineno-240-232"></a><span class="kd">function</span><span class="w"> </span><span class="nx">showError</span><span class="p">(</span><span class="nx">container</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-233"><a id="__codelineno-240-233" name="__codelineno-240-233" href="#__codelineno-240-233"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
</span><span id="__span-240-234"><a id="__codelineno-240-234" name="__codelineno-240-234" href="#__codelineno-240-234"></a><span class="w">  </span><span class="nx">div</span><span class="p">.</span><span class="nx">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
</span><span id="__span-240-235"><a id="__codelineno-240-235" name="__codelineno-240-235" href="#__codelineno-240-235"></a><span class="w">  </span><span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;#ff4444&#39;</span><span class="p">;</span>
</span><span id="__span-240-236"><a id="__codelineno-240-236" name="__codelineno-240-236" href="#__codelineno-240-236"></a><span class="w">  </span><span class="nx">div</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">message</span><span class="p">;</span>
</span><span id="__span-240-237"><a id="__codelineno-240-237" name="__codelineno-240-237" href="#__codelineno-240-237"></a><span class="w">  </span><span class="nx">container</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
</span><span id="__span-240-238"><a id="__codelineno-240-238" name="__codelineno-240-238" href="#__codelineno-240-238"></a><span class="p">}</span>
</span><span id="__span-240-239"><a id="__codelineno-240-239" name="__codelineno-240-239" href="#__codelineno-240-239"></a>
</span><span id="__span-240-240"><a id="__codelineno-240-240" name="__codelineno-240-240" href="#__codelineno-240-240"></a><span class="c1">// 表单提交时收集所有file_key</span>
</span><span id="__span-240-241"><a id="__codelineno-240-241" name="__codelineno-240-241" href="#__codelineno-240-241"></a><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">).</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;submit&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-242"><a id="__codelineno-240-242" name="__codelineno-240-242" href="#__codelineno-240-242"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">fileKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-240-243"><a id="__codelineno-240-243" name="__codelineno-240-243" href="#__codelineno-240-243"></a><span class="w">  </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;.upload-item&#39;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">item</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-244"><a id="__codelineno-240-244" name="__codelineno-240-244" href="#__codelineno-240-244"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">fileKey</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-240-245"><a id="__codelineno-240-245" name="__codelineno-240-245" href="#__codelineno-240-245"></a><span class="w">      </span><span class="nx">fileKeys</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">fileKey</span><span class="p">);</span>
</span><span id="__span-240-246"><a id="__codelineno-240-246" name="__codelineno-240-246" href="#__codelineno-240-246"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-240-247"><a id="__codelineno-240-247" name="__codelineno-240-247" href="#__codelineno-240-247"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-240-248"><a id="__codelineno-240-248" name="__codelineno-240-248" href="#__codelineno-240-248"></a>
</span><span id="__span-240-249"><a id="__codelineno-240-249" name="__codelineno-240-249" href="#__codelineno-240-249"></a><span class="w">  </span><span class="c1">// 添加隐藏字段</span>
</span><span id="__span-240-250"><a id="__codelineno-240-250" name="__codelineno-240-250" href="#__codelineno-240-250"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
</span><span id="__span-240-251"><a id="__codelineno-240-251" name="__codelineno-240-251" href="#__codelineno-240-251"></a><span class="w">  </span><span class="nx">input</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;hidden&#39;</span><span class="p">;</span>
</span><span id="__span-240-252"><a id="__codelineno-240-252" name="__codelineno-240-252" href="#__codelineno-240-252"></a><span class="w">  </span><span class="nx">input</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;file_keys&#39;</span><span class="p">;</span>
</span><span id="__span-240-253"><a id="__codelineno-240-253" name="__codelineno-240-253" href="#__codelineno-240-253"></a><span class="w">  </span><span class="nx">input</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">fileKeys</span><span class="p">);</span>
</span><span id="__span-240-254"><a id="__codelineno-240-254" name="__codelineno-240-254" href="#__codelineno-240-254"></a><span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
</span><span id="__span-240-255"><a id="__codelineno-240-255" name="__codelineno-240-255" href="#__codelineno-240-255"></a><span class="p">});</span>
</span><span id="__span-240-256"><a id="__codelineno-240-256" name="__codelineno-240-256" href="#__codelineno-240-256"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-241-1"><a id="__codelineno-241-1" name="__codelineno-241-1" href="#__codelineno-241-1"></a><span class="c1"># views.py</span>
</span><span id="__span-241-2"><a id="__codelineno-241-2" name="__codelineno-241-2" href="#__codelineno-241-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.views.decorators.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">require_POST</span>
</span><span id="__span-241-3"><a id="__codelineno-241-3" name="__codelineno-241-3" href="#__codelineno-241-3"></a>
</span><span id="__span-241-4"><a id="__codelineno-241-4" name="__codelineno-241-4" href="#__codelineno-241-4"></a><span class="nd">@require_POST</span>
</span><span id="__span-241-5"><a id="__codelineno-241-5" name="__codelineno-241-5" href="#__codelineno-241-5"></a><span class="nd">@login_required</span>
</span><span id="__span-241-6"><a id="__codelineno-241-6" name="__codelineno-241-6" href="#__codelineno-241-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">submit_form</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span id="__span-241-7"><a id="__codelineno-241-7" name="__codelineno-241-7" href="#__codelineno-241-7"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-241-8"><a id="__codelineno-241-8" name="__codelineno-241-8" href="#__codelineno-241-8"></a>        <span class="n">file_keys</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file_keys&#39;</span><span class="p">,</span> <span class="s1">&#39;[]&#39;</span><span class="p">))</span>
</span><span id="__span-241-9"><a id="__codelineno-241-9" name="__codelineno-241-9" href="#__codelineno-241-9"></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">file_keys</span><span class="p">:</span>
</span><span id="__span-241-10"><a id="__codelineno-241-10" name="__codelineno-241-10" href="#__codelineno-241-10"></a>            <span class="c1"># 验证并移动文件</span>
</span><span id="__span-241-11"><a id="__codelineno-241-11" name="__codelineno-241-11" href="#__codelineno-241-11"></a>            <span class="n">record</span> <span class="o">=</span> <span class="n">TempUpload</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="__span-241-12"><a id="__codelineno-241-12" name="__codelineno-241-12" href="#__codelineno-241-12"></a>                <span class="n">file_key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
</span><span id="__span-241-13"><a id="__codelineno-241-13" name="__codelineno-241-13" href="#__codelineno-241-13"></a>                <span class="n">user</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">user</span>
</span><span id="__span-241-14"><a id="__codelineno-241-14" name="__codelineno-241-14" href="#__codelineno-241-14"></a>            <span class="p">)</span>
</span><span id="__span-241-15"><a id="__codelineno-241-15" name="__codelineno-241-15" href="#__codelineno-241-15"></a>            <span class="c1"># 实际移动操作（示例使用本地文件系统）</span>
</span><span id="__span-241-16"><a id="__codelineno-241-16" name="__codelineno-241-16" href="#__codelineno-241-16"></a>            <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
</span><span id="__span-241-17"><a id="__codelineno-241-17" name="__codelineno-241-17" href="#__codelineno-241-17"></a>                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">TEMP_FILE_ROOT</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">file_path</span><span class="p">),</span>
</span><span id="__span-241-18"><a id="__codelineno-241-18" name="__codelineno-241-18" href="#__codelineno-241-18"></a>                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">MEDIA_ROOT</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="__span-241-19"><a id="__codelineno-241-19" name="__codelineno-241-19" href="#__codelineno-241-19"></a>            <span class="p">)</span>
</span><span id="__span-241-20"><a id="__codelineno-241-20" name="__codelineno-241-20" href="#__codelineno-241-20"></a>            <span class="c1"># 创建业务模型记录</span>
</span><span id="__span-241-21"><a id="__codelineno-241-21" name="__codelineno-241-21" href="#__codelineno-241-21"></a>            <span class="n">Document</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
</span><span id="__span-241-22"><a id="__codelineno-241-22" name="__codelineno-241-22" href="#__codelineno-241-22"></a>                <span class="n">user</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span id="__span-241-23"><a id="__codelineno-241-23" name="__codelineno-241-23" href="#__codelineno-241-23"></a>                <span class="n">file_type</span><span class="o">=</span><span class="n">record</span><span class="o">.</span><span class="n">file_type</span><span class="p">,</span>
</span><span id="__span-241-24"><a id="__codelineno-241-24" name="__codelineno-241-24" href="#__codelineno-241-24"></a>                <span class="n">file</span><span class="o">=</span><span class="n">record</span><span class="o">.</span><span class="n">file_path</span>
</span><span id="__span-241-25"><a id="__codelineno-241-25" name="__codelineno-241-25" href="#__codelineno-241-25"></a>            <span class="p">)</span>
</span><span id="__span-241-26"><a id="__codelineno-241-26" name="__codelineno-241-26" href="#__codelineno-241-26"></a>            <span class="n">record</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</span><span id="__span-241-27"><a id="__codelineno-241-27" name="__codelineno-241-27" href="#__codelineno-241-27"></a>        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="s1">&#39;/success/&#39;</span><span class="p">)</span>
</span><span id="__span-241-28"><a id="__codelineno-241-28" name="__codelineno-241-28" href="#__codelineno-241-28"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-241-29"><a id="__codelineno-241-29" name="__codelineno-241-29" href="#__codelineno-241-29"></a>        <span class="k">return</span> <span class="n">JsonResponse</span><span class="p">({</span><span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)})</span>
</span></code></pre></div>
<h5 id="_66">完整的示例</h5>
<p>完整的示例，并进行了改进和美化，仅供测试
后续可参考REST API、更改数据库和生产环境部署的部分</p>
<p>初始化项目：<code>django-admin startproject myproject</code>
创建应用 ：<code>python manage.py startapp blog</code></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-242-1"><a id="__codelineno-242-1" name="__codelineno-242-1" href="#__codelineno-242-1"></a>myproject/
</span><span id="__span-242-2"><a id="__codelineno-242-2" name="__codelineno-242-2" href="#__codelineno-242-2"></a>│  # 手动创建，保存资源文件.myproject/settings.py、templates/blog/xxx.html
</span><span id="__span-242-3"><a id="__codelineno-242-3" name="__codelineno-242-3" href="#__codelineno-242-3"></a>├─ assets/
</span><span id="__span-242-4"><a id="__codelineno-242-4" name="__codelineno-242-4" href="#__codelineno-242-4"></a>│   ├─ css/
</span><span id="__span-242-5"><a id="__codelineno-242-5" name="__codelineno-242-5" href="#__codelineno-242-5"></a>│   ├─ fonts/
</span><span id="__span-242-6"><a id="__codelineno-242-6" name="__codelineno-242-6" href="#__codelineno-242-6"></a>│   ├─ images/
</span><span id="__span-242-7"><a id="__codelineno-242-7" name="__codelineno-242-7" href="#__codelineno-242-7"></a>│   └─ js/
</span><span id="__span-242-8"><a id="__codelineno-242-8" name="__codelineno-242-8" href="#__codelineno-242-8"></a>├─ myproject/
</span><span id="__span-242-9"><a id="__codelineno-242-9" name="__codelineno-242-9" href="#__codelineno-242-9"></a>│   ├─ __init__.py
</span><span id="__span-242-10"><a id="__codelineno-242-10" name="__codelineno-242-10" href="#__codelineno-242-10"></a>│   ├─ asgi.py 
</span><span id="__span-242-11"><a id="__codelineno-242-11" name="__codelineno-242-11" href="#__codelineno-242-11"></a>│   ├─ settings.py
</span><span id="__span-242-12"><a id="__codelineno-242-12" name="__codelineno-242-12" href="#__codelineno-242-12"></a>│   ├─ urls.py
</span><span id="__span-242-13"><a id="__codelineno-242-13" name="__codelineno-242-13" href="#__codelineno-242-13"></a>│   └─ wsgi.py
</span><span id="__span-242-14"><a id="__codelineno-242-14" name="__codelineno-242-14" href="#__codelineno-242-14"></a>├─ blog/        # 应用目录
</span><span id="__span-242-15"><a id="__codelineno-242-15" name="__codelineno-242-15" href="#__codelineno-242-15"></a>│   ├─ migrations
</span><span id="__span-242-16"><a id="__codelineno-242-16" name="__codelineno-242-16" href="#__codelineno-242-16"></a>│   │      └─ __init__.py
</span><span id="__span-242-17"><a id="__codelineno-242-17" name="__codelineno-242-17" href="#__codelineno-242-17"></a>│   ├─ __init__.py
</span><span id="__span-242-18"><a id="__codelineno-242-18" name="__codelineno-242-18" href="#__codelineno-242-18"></a>│   ├─ admin.py
</span><span id="__span-242-19"><a id="__codelineno-242-19" name="__codelineno-242-19" href="#__codelineno-242-19"></a>│   ├─ apps.py
</span><span id="__span-242-20"><a id="__codelineno-242-20" name="__codelineno-242-20" href="#__codelineno-242-20"></a>│   ├─ models.py
</span><span id="__span-242-21"><a id="__codelineno-242-21" name="__codelineno-242-21" href="#__codelineno-242-21"></a>│   ├─ tests.py
</span><span id="__span-242-22"><a id="__codelineno-242-22" name="__codelineno-242-22" href="#__codelineno-242-22"></a>│   ├─ views.py
</span><span id="__span-242-23"><a id="__codelineno-242-23" name="__codelineno-242-23" href="#__codelineno-242-23"></a>│   │  # 手动创建，保存表单.blog/views.py、models.py、templates/blog/xxx.html
</span><span id="__span-242-24"><a id="__codelineno-242-24" name="__codelineno-242-24" href="#__codelineno-242-24"></a>│   ├─ dynamic_fields.py
</span><span id="__span-242-25"><a id="__codelineno-242-25" name="__codelineno-242-25" href="#__codelineno-242-25"></a>│   └─ urls.py   # 手动创建，分路由文件.myproject/urls.py
</span><span id="__span-242-26"><a id="__codelineno-242-26" name="__codelineno-242-26" href="#__codelineno-242-26"></a>├─ files/        # 手动创建，保存用户上传的文件.blog/views.py、models.py
</span><span id="__span-242-27"><a id="__codelineno-242-27" name="__codelineno-242-27" href="#__codelineno-242-27"></a>├─ temp_files/   # 手动创建，保存临时文件.blog/views.py、models.py
</span><span id="__span-242-28"><a id="__codelineno-242-28" name="__codelineno-242-28" href="#__codelineno-242-28"></a>│   # 手动创建，保存各应用的模板文件.myproject/settings.py、blog/views.py
</span><span id="__span-242-29"><a id="__codelineno-242-29" name="__codelineno-242-29" href="#__codelineno-242-29"></a>├─ templates/  
</span><span id="__span-242-30"><a id="__codelineno-242-30" name="__codelineno-242-30" href="#__codelineno-242-30"></a>│    └─ blog/
</span><span id="__span-242-31"><a id="__codelineno-242-31" name="__codelineno-242-31" href="#__codelineno-242-31"></a>└─ manage.py 
</span></code></pre></div>
<p>修改myproject/settings.py文件：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-243-1"><a id="__codelineno-243-1" name="__codelineno-243-1" href="#__codelineno-243-1"></a><span class="c1"># 测试环境可以填*，允许所有ip</span>
</span><span id="__span-243-2"><a id="__codelineno-243-2" name="__codelineno-243-2" href="#__codelineno-243-2"></a><span class="n">ALLOWED_HOSTS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">]</span>
</span><span id="__span-243-3"><a id="__codelineno-243-3" name="__codelineno-243-3" href="#__codelineno-243-3"></a>
</span><span id="__span-243-4"><a id="__codelineno-243-4" name="__codelineno-243-4" href="#__codelineno-243-4"></a><span class="c1"># 注册应用</span>
</span><span id="__span-243-5"><a id="__codelineno-243-5" name="__codelineno-243-5" href="#__codelineno-243-5"></a><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-243-6"><a id="__codelineno-243-6" name="__codelineno-243-6" href="#__codelineno-243-6"></a>    <span class="o">...</span>
</span><span id="__span-243-7"><a id="__codelineno-243-7" name="__codelineno-243-7" href="#__codelineno-243-7"></a>    <span class="s1">&#39;blog&#39;</span><span class="p">,</span>
</span><span id="__span-243-8"><a id="__codelineno-243-8" name="__codelineno-243-8" href="#__codelineno-243-8"></a><span class="p">]</span>
</span><span id="__span-243-9"><a id="__codelineno-243-9" name="__codelineno-243-9" href="#__codelineno-243-9"></a>
</span><span id="__span-243-10"><a id="__codelineno-243-10" name="__codelineno-243-10" href="#__codelineno-243-10"></a><span class="n">TEMPLATES</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-243-11"><a id="__codelineno-243-11" name="__codelineno-243-11" href="#__codelineno-243-11"></a>    <span class="p">{</span>
</span><span id="__span-243-12"><a id="__codelineno-243-12" name="__codelineno-243-12" href="#__codelineno-243-12"></a>        <span class="o">...</span>
</span><span id="__span-243-13"><a id="__codelineno-243-13" name="__codelineno-243-13" href="#__codelineno-243-13"></a>        <span class="s1">&#39;DIRS&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;templates&#39;</span><span class="p">),</span>
</span><span id="__span-243-14"><a id="__codelineno-243-14" name="__codelineno-243-14" href="#__codelineno-243-14"></a>         <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;static&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)],</span>
</span><span id="__span-243-15"><a id="__codelineno-243-15" name="__codelineno-243-15" href="#__codelineno-243-15"></a>        <span class="o">...</span>
</span><span id="__span-243-16"><a id="__codelineno-243-16" name="__codelineno-243-16" href="#__codelineno-243-16"></a>    <span class="p">},</span>
</span><span id="__span-243-17"><a id="__codelineno-243-17" name="__codelineno-243-17" href="#__codelineno-243-17"></a><span class="p">]</span>
</span><span id="__span-243-18"><a id="__codelineno-243-18" name="__codelineno-243-18" href="#__codelineno-243-18"></a>
</span><span id="__span-243-19"><a id="__codelineno-243-19" name="__codelineno-243-19" href="#__codelineno-243-19"></a><span class="c1"># 静态文件的 URL 前缀</span>
</span><span id="__span-243-20"><a id="__codelineno-243-20" name="__codelineno-243-20" href="#__codelineno-243-20"></a><span class="n">STATIC_URL</span> <span class="o">=</span> <span class="s1">&#39;/static/&#39;</span>
</span><span id="__span-243-21"><a id="__codelineno-243-21" name="__codelineno-243-21" href="#__codelineno-243-21"></a><span class="c1"># 静态文件的根目录（可选，通常用于 collectstatic）</span>
</span><span id="__span-243-22"><a id="__codelineno-243-22" name="__codelineno-243-22" href="#__codelineno-243-22"></a><span class="n">STATIC_ROOT</span> <span class="o">=</span> <span class="n">BASE_DIR</span> <span class="o">/</span> <span class="s1">&#39;staticfiles&#39;</span>
</span><span id="__span-243-23"><a id="__codelineno-243-23" name="__codelineno-243-23" href="#__codelineno-243-23"></a><span class="c1"># 额外的静态文件目录（可选）</span>
</span><span id="__span-243-24"><a id="__codelineno-243-24" name="__codelineno-243-24" href="#__codelineno-243-24"></a><span class="n">STATICFILES_DIRS</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-243-25"><a id="__codelineno-243-25" name="__codelineno-243-25" href="#__codelineno-243-25"></a>    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;assets&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">),</span>
</span><span id="__span-243-26"><a id="__codelineno-243-26" name="__codelineno-243-26" href="#__codelineno-243-26"></a><span class="p">]</span>
</span></code></pre></div>
<h3 id="_67">网络爬虫</h3>
<p>requests
  <strong>scrapy</strong>
  pyspider
  beautifuisoup4
  selenium
  lxml</p>
<h4 id="requests">requests（网络爬虫）</h4>
<p>见[[../../../计算机安全/网络安全/Python网络爬虫|Python网络爬虫]]</p>
<h4 id="beautifulsoup">beautifulsoup</h4>
<h3 id="dill">dill（对象序列化）</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-244-1"><a id="__codelineno-244-1" name="__codelineno-244-1" href="#__codelineno-244-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dill</span>
</span><span id="__span-244-2"><a id="__codelineno-244-2" name="__codelineno-244-2" href="#__codelineno-244-2"></a>
</span><span id="__span-244-3"><a id="__codelineno-244-3" name="__codelineno-244-3" href="#__codelineno-244-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Person</span><span class="p">:</span>
</span><span id="__span-244-4"><a id="__codelineno-244-4" name="__codelineno-244-4" href="#__codelineno-244-4"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
</span><span id="__span-244-5"><a id="__codelineno-244-5" name="__codelineno-244-5" href="#__codelineno-244-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="__span-244-6"><a id="__codelineno-244-6" name="__codelineno-244-6" href="#__codelineno-244-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>
</span><span id="__span-244-7"><a id="__codelineno-244-7" name="__codelineno-244-7" href="#__codelineno-244-7"></a>
</span><span id="__span-244-8"><a id="__codelineno-244-8" name="__codelineno-244-8" href="#__codelineno-244-8"></a><span class="c1"># 创建一个Person实例</span>
</span><span id="__span-244-9"><a id="__codelineno-244-9" name="__codelineno-244-9" href="#__codelineno-244-9"></a><span class="n">person</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</span><span id="__span-244-10"><a id="__codelineno-244-10" name="__codelineno-244-10" href="#__codelineno-244-10"></a>
</span><span id="__span-244-11"><a id="__codelineno-244-11" name="__codelineno-244-11" href="#__codelineno-244-11"></a><span class="c1"># 序列化实例到文件</span>
</span><span id="__span-244-12"><a id="__codelineno-244-12" name="__codelineno-244-12" href="#__codelineno-244-12"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;person_instance.dill&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-244-13"><a id="__codelineno-244-13" name="__codelineno-244-13" href="#__codelineno-244-13"></a>    <span class="n">dill</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">person</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="__span-244-14"><a id="__codelineno-244-14" name="__codelineno-244-14" href="#__codelineno-244-14"></a>
</span><span id="__span-244-15"><a id="__codelineno-244-15" name="__codelineno-244-15" href="#__codelineno-244-15"></a><span class="c1"># 反序列化实例</span>
</span><span id="__span-244-16"><a id="__codelineno-244-16" name="__codelineno-244-16" href="#__codelineno-244-16"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;person_instance.dill&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-244-17"><a id="__codelineno-244-17" name="__codelineno-244-17" href="#__codelineno-244-17"></a>    <span class="n">new_person</span> <span class="o">=</span> <span class="n">dill</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="pywin32">pywin32</h3>
<p>提供对windows win32 api的调用</p>
<h3 id="_68">打包</h3>
<p>py2exe</p>
<p>打包时最好使用包虚拟环境，减小Size</p>
<h4 id="pyinstaller">PyInstaller</h4>
<p>PyInstaller是一个开源的Python打包工具，可以将Python程序转换为独立的可执行文件。它支持Windows、Linux和macOS平台，能够将Python程序打包成一个或多个文件，这些文件可以在没有Python解释器的环境中运行。<code>pip install pyinstaller</code></p>
<p>命令行界面，切换到Python脚本所在的目录，运行 <code>pyinstaller -F app.py</code></p>
<h4 id="auto-py-to-exe">auto-py-to-exe</h4>
<p>auto-py-to-exe是一个图形用户界面(GUI)工具，它简化了使用PyInstaller打包Python程序的过程。它提供了一个直观的界面，用户可以通过简单的操作来配置和打包Python程序。 <code>pip install auto-py-to-exe</code></p>
<p>命令行界面，运行 <code>auto-py-to-exe</code>  即可打开图形化界面</p>
<h4 id="buildozer">Buildozer</h4>
<p>Buildozer 是一个将[[#Kivy]] 应用程序打包成 APK 的工具</p>
<p>Buildozer 主要是为 Linux 和 macOS 设计的，在 Windows 系统上可以使用：WSL、Docker、虚拟机</p>
<p>更新系统并安装依赖项:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-245-1"><a id="__codelineno-245-1" name="__codelineno-245-1" href="#__codelineno-245-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
</span><span id="__span-245-2"><a id="__codelineno-245-2" name="__codelineno-245-2" href="#__codelineno-245-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>upgrade<span class="w"> </span>-y
</span><span id="__span-245-3"><a id="__codelineno-245-3" name="__codelineno-245-3" href="#__codelineno-245-3"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>python3-pip<span class="w"> </span>python3-setuptools<span class="w"> </span>python3-virtualenv<span class="w"> </span>git<span class="w"> </span>zip<span class="w"> </span>unzip<span class="w"> </span>openjdk-17-jdk
</span><span id="__span-245-4"><a id="__codelineno-245-4" name="__codelineno-245-4" href="#__codelineno-245-4"></a>
</span><span id="__span-245-5"><a id="__codelineno-245-5" name="__codelineno-245-5" href="#__codelineno-245-5"></a>pip<span class="w"> </span>install<span class="w"> </span>buildozer
</span></code></pre></div>
<p>初始化 Buildozer：
在项目目录下运行命令 <code>buildozer init</code>（老版本linux使用 <code>python3 -m buildozer init</code>）
这会生成一个 buildozer.spec 文件。</p>
<div class="language-ini highlight"><pre><span></span><code><span id="__span-246-1"><a id="__codelineno-246-1" name="__codelineno-246-1" href="#__codelineno-246-1"></a><span class="na">`source.include_exts`：确保包含所有需要的文件</span>
</span><span id="__span-246-2"><a id="__codelineno-246-2" name="__codelineno-246-2" href="#__codelineno-246-2"></a><span class="na">`requirements`：添加 `kivy` 和其他依赖项</span>
</span><span id="__span-246-3"><a id="__codelineno-246-3" name="__codelineno-246-3" href="#__codelineno-246-3"></a><span class="na">`title` 和 `package.name`：设置应用程序的名称和包名</span>
</span></code></pre></div>
<p>运行命令 <code>buildozer -v android debug</code> 打包 APK：这会在 <code>bin</code> 目录下生成一个 APK 文件</p>
<h3 id="rich">rich（终端美化）</h3>
<blockquote>
<p>Rich 是一个 Python 库，用于向终端写入带颜色和样式的丰富文本，以及显示高级内容，如表格、Markdown 和语法高亮的代码。</p>
</blockquote>
<p>基于 rich 的 print 方法输出的内容都是带颜色、带重点的，相比于Python自带的 print 有明显的优势</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-247-1"><a id="__codelineno-247-1" name="__codelineno-247-1" href="#__codelineno-247-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich</span><span class="w"> </span><span class="kn">import</span> <span class="nb">print</span> <span class="k">as</span> <span class="n">rprint</span>
</span><span id="__span-247-2"><a id="__codelineno-247-2" name="__codelineno-247-2" href="#__codelineno-247-2"></a><span class="n">rprint</span><span class="p">(</span><span class="s2">&quot;Hello, [bold magenta]World[/bold magenta]!&quot;</span><span class="p">,</span> <span class="s2">&quot;:vampire:&quot;</span><span class="p">,</span> <span class="nb">locals</span><span class="p">())</span>
</span></code></pre></div>
<h4 id="_69">控制台</h4>
<p><strong>Console 控制台输出</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-248-1"><a id="__codelineno-248-1" name="__codelineno-248-1" href="#__codelineno-248-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
</span><span id="__span-248-2"><a id="__codelineno-248-2" name="__codelineno-248-2" href="#__codelineno-248-2"></a><span class="c1"># 构造一个控制台对象</span>
</span><span id="__span-248-3"><a id="__codelineno-248-3" name="__codelineno-248-3" href="#__codelineno-248-3"></a><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
</span><span id="__span-248-4"><a id="__codelineno-248-4" name="__codelineno-248-4" href="#__codelineno-248-4"></a>
</span><span id="__span-248-5"><a id="__codelineno-248-5" name="__codelineno-248-5" href="#__codelineno-248-5"></a><span class="c1"># console.print会将文字自动换行以适合终端宽度。可以通过style自定义颜色和样式</span>
</span><span id="__span-248-6"><a id="__codelineno-248-6" name="__codelineno-248-6" href="#__codelineno-248-6"></a><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">,</span> <span class="s2">&quot;World!&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold red&quot;</span><span class="p">)</span>
</span><span id="__span-248-7"><a id="__codelineno-248-7" name="__codelineno-248-7" href="#__codelineno-248-7"></a><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;FOO&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;white on blue&quot;</span><span class="p">)</span>
</span><span id="__span-248-8"><a id="__codelineno-248-8" name="__codelineno-248-8" href="#__codelineno-248-8"></a><span class="c1"># 可以使用类似bbcode的标记语言</span>
</span><span id="__span-248-9"><a id="__codelineno-248-9" name="__codelineno-248-9" href="#__codelineno-248-9"></a><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;[blue underline]Looks like a link&quot;</span><span class="p">)</span>
</span><span id="__span-248-10"><a id="__codelineno-248-10" name="__codelineno-248-10" href="#__codelineno-248-10"></a><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;Where there is a [bold cyan]Will[/bold cyan] there [u]is[/u] a [i]way[/i].&quot;</span><span class="p">)</span>
</span><span id="__span-248-11"><a id="__codelineno-248-11" name="__codelineno-248-11" href="#__codelineno-248-11"></a><span class="c1"># 将名称放在两个冒号之间即可在控制台输出中插入表情符号，或使用Unicode编码</span>
</span><span id="__span-248-12"><a id="__codelineno-248-12" name="__codelineno-248-12" href="#__codelineno-248-12"></a><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;:smiley: :vampire: :pile_of_poo: :thumbs_up: </span><span class="se">\U0001F600</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-248-13"><a id="__codelineno-248-13" name="__codelineno-248-13" href="#__codelineno-248-13"></a><span class="c1"># 创建一个可点击的链接</span>
</span><span id="__span-248-14"><a id="__codelineno-248-14" name="__codelineno-248-14" href="#__codelineno-248-14"></a><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;Google&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;link https://google.com&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Console 控制台记录</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-249-1"><a id="__codelineno-249-1" name="__codelineno-249-1" href="#__codelineno-249-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
</span><span id="__span-249-2"><a id="__codelineno-249-2" name="__codelineno-249-2" href="#__codelineno-249-2"></a><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
</span><span id="__span-249-3"><a id="__codelineno-249-3" name="__codelineno-249-3" href="#__codelineno-249-3"></a>
</span><span id="__span-249-4"><a id="__codelineno-249-4" name="__codelineno-249-4" href="#__codelineno-249-4"></a><span class="n">test_data</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-249-5"><a id="__codelineno-249-5" name="__codelineno-249-5" href="#__codelineno-249-5"></a>    <span class="p">{</span><span class="s2">&quot;jsonrpc&quot;</span><span class="p">:</span> <span class="s2">&quot;2.0&quot;</span><span class="p">,</span> <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,},</span>
</span><span id="__span-249-6"><a id="__codelineno-249-6" name="__codelineno-249-6" href="#__codelineno-249-6"></a>    <span class="p">{</span><span class="s2">&quot;jsonrpc&quot;</span><span class="p">:</span> <span class="s2">&quot;2.0&quot;</span><span class="p">,</span> <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;notify_hello&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">]},</span>
</span><span id="__span-249-7"><a id="__codelineno-249-7" name="__codelineno-249-7" href="#__codelineno-249-7"></a>    <span class="p">{</span><span class="s2">&quot;jsonrpc&quot;</span><span class="p">:</span> <span class="s2">&quot;2.0&quot;</span><span class="p">,</span> <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;subtract&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">},</span>
</span><span id="__span-249-8"><a id="__codelineno-249-8" name="__codelineno-249-8" href="#__codelineno-249-8"></a><span class="p">]</span>
</span><span id="__span-249-9"><a id="__codelineno-249-9" name="__codelineno-249-9" href="#__codelineno-249-9"></a>
</span><span id="__span-249-10"><a id="__codelineno-249-10" name="__codelineno-249-10" href="#__codelineno-249-10"></a><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">log_locals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>打印 JSON</strong>
<code>print_json()</code> 方法将格式化和样式化包含 JSON 的字符串</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-250-1"><a id="__codelineno-250-1" name="__codelineno-250-1" href="#__codelineno-250-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
</span><span id="__span-250-2"><a id="__codelineno-250-2" name="__codelineno-250-2" href="#__codelineno-250-2"></a><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
</span><span id="__span-250-3"><a id="__codelineno-250-3" name="__codelineno-250-3" href="#__codelineno-250-3"></a><span class="n">console</span><span class="o">.</span><span class="n">print_json</span><span class="p">(</span><span class="s1">&#39;[false, true, null, &quot;foo&quot;]&#39;</span><span class="p">)</span>
</span><span id="__span-250-4"><a id="__codelineno-250-4" name="__codelineno-250-4" href="#__codelineno-250-4"></a><span class="c1"># 也可以记录一个 `JSON` 对象并打印</span>
</span><span id="__span-250-5"><a id="__codelineno-250-5" name="__codelineno-250-5" href="#__codelineno-250-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.json</span><span class="w"> </span><span class="kn">import</span> <span class="n">JSON</span>
</span><span id="__span-250-6"><a id="__codelineno-250-6" name="__codelineno-250-6" href="#__codelineno-250-6"></a><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">JSON</span><span class="p">(</span><span class="s1">&#39;[&quot;foo&quot;, &quot;bar&quot;]&#39;</span><span class="p">))</span>
</span></code></pre></div>
<p>也可以通过命令行使用 <code>python -m rich.json cats.json</code> 美化打印 JSON</p>
<p>低级输出
console.out("Locals", locals())</p>
<p>Rules
console.rule("[bold red]Chapter 2")</p>
<p>Status
python -m rich.status</p>
<p>打印print和日志log支持一个 <code>justify</code> 参数，“default、“left”、“right”、“center”或“full”。
左对齐会将文本右侧填充空格，而默认对齐则不会。只有当您使用 style 参数设置背景颜色时，您才会注意到这种差别。
打印print支持 <code>overflow</code>参数，“fold”，“crop”，“ellipsis”或“ignore”。当打印的文本大于可用空间时，把任何多余的字符放在下一行；在行尾截断文本；在行尾截断文本并插入省略号字符...；忽视</p>
<p>控制台样式
 控制台有一个 style 属性，您可以使用它来应用您打印的所有内容的样式。默认情况下 style 为 None</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-251-1"><a id="__codelineno-251-1" name="__codelineno-251-1" href="#__codelineno-251-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
</span><span id="__span-251-2"><a id="__codelineno-251-2" name="__codelineno-251-2" href="#__codelineno-251-2"></a><span class="n">blue_console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;white on blue&quot;</span><span class="p">)</span>
</span><span id="__span-251-3"><a id="__codelineno-251-3" name="__codelineno-251-3" href="#__codelineno-251-3"></a><span class="n">blue_console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;I&#39;m blue&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>控制台类有一个 <code>input()</code> 方法，它的工作方式与 Python 内置的 <code>input()</code> 函数相同，但可以使用 Rich 可以打印的任何内容作为提示</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-252-1"><a id="__codelineno-252-1" name="__codelineno-252-1" href="#__codelineno-252-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
</span><span id="__span-252-2"><a id="__codelineno-252-2" name="__codelineno-252-2" href="#__codelineno-252-2"></a><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
</span><span id="__span-252-3"><a id="__codelineno-252-3" name="__codelineno-252-3" href="#__codelineno-252-3"></a><span class="n">console</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s2">&quot;What is [i]your[/i] [bold red]name[/]? :smiley: &quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>控制台类可以将写入的内容导出为文本、svg 或 html。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-253-1"><a id="__codelineno-253-1" name="__codelineno-253-1" href="#__codelineno-253-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
</span><span id="__span-253-2"><a id="__codelineno-253-2" name="__codelineno-253-2" href="#__codelineno-253-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.terminal_theme</span><span class="w"> </span><span class="kn">import</span> <span class="n">MONOKAI</span>
</span><span id="__span-253-3"><a id="__codelineno-253-3" name="__codelineno-253-3" href="#__codelineno-253-3"></a>
</span><span id="__span-253-4"><a id="__codelineno-253-4" name="__codelineno-253-4" href="#__codelineno-253-4"></a><span class="c1"># 告诉 Rich保存任何你 `print()` 或 `log()` 的数据的副本</span>
</span><span id="__span-253-5"><a id="__codelineno-253-5" name="__codelineno-253-5" href="#__codelineno-253-5"></a><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">(</span><span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-253-6"><a id="__codelineno-253-6" name="__codelineno-253-6" href="#__codelineno-253-6"></a><span class="c1"># 保存svg</span>
</span><span id="__span-253-7"><a id="__codelineno-253-7" name="__codelineno-253-7" href="#__codelineno-253-7"></a><span class="n">console</span><span class="o">.</span><span class="n">save_svg</span><span class="p">(</span><span class="s2">&quot;example.svg&quot;</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">MONOKAI</span><span class="p">)</span>
</span><span id="__span-253-8"><a id="__codelineno-253-8" name="__codelineno-253-8" href="#__codelineno-253-8"></a><span class="c1"># 设置主题为MONOKAI（可以自己构建rich.terminal_theme.TerminalTheme实例作为主题）</span>
</span><span id="__span-253-9"><a id="__codelineno-253-9" name="__codelineno-253-9" href="#__codelineno-253-9"></a><span class="c1"># 可以print(rich.terminal_theme)找到terminal_theme.py查看有哪些主题</span>
</span></code></pre></div>
<p>您可以告诉控制台对象将内容写入文件，通过在构造函数中设置 <code>file</code> 参数——它应该是一个用于写入文本的文件对象。您可以使用此方法将内容写入文件，而输出永远不会出现在终端上。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-254-1"><a id="__codelineno-254-1" name="__codelineno-254-1" href="#__codelineno-254-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-254-2"><a id="__codelineno-254-2" name="__codelineno-254-2" href="#__codelineno-254-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
</span><span id="__span-254-3"><a id="__codelineno-254-3" name="__codelineno-254-3" href="#__codelineno-254-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
</span><span id="__span-254-4"><a id="__codelineno-254-4" name="__codelineno-254-4" href="#__codelineno-254-4"></a>
</span><span id="__span-254-5"><a id="__codelineno-254-5" name="__codelineno-254-5" href="#__codelineno-254-5"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;report.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;wt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">report_file</span><span class="p">:</span>
</span><span id="__span-254-6"><a id="__codelineno-254-6" name="__codelineno-254-6" href="#__codelineno-254-6"></a>    <span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">report_file</span><span class="p">)</span>
</span><span id="__span-254-7"><a id="__codelineno-254-7" name="__codelineno-254-7" href="#__codelineno-254-7"></a>    <span class="n">console</span><span class="o">.</span><span class="n">rule</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Report Generated </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">ctime</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>如果您有一些长输出需要向用户展示，可以使用分页器来显示。分页器通常是操作系统上的一个应用程序，它至少支持按键滚动，但通常还支持上下滚动文本和其他功能。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-255-1"><a id="__codelineno-255-1" name="__codelineno-255-1" href="#__codelineno-255-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.__main__</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_test_card</span>
</span><span id="__span-255-2"><a id="__codelineno-255-2" name="__codelineno-255-2" href="#__codelineno-255-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
</span><span id="__span-255-3"><a id="__codelineno-255-3" name="__codelineno-255-3" href="#__codelineno-255-3"></a>
</span><span id="__span-255-4"><a id="__codelineno-255-4" name="__codelineno-255-4" href="#__codelineno-255-4"></a><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
</span><span id="__span-255-5"><a id="__codelineno-255-5" name="__codelineno-255-5" href="#__codelineno-255-5"></a><span class="k">with</span> <span class="n">console</span><span class="o">.</span><span class="n">pager</span><span class="p">():</span>
</span><span id="__span-255-6"><a id="__codelineno-255-6" name="__codelineno-255-6" href="#__codelineno-255-6"></a>    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">make_test_card</span><span class="p">())</span>
</span></code></pre></div>
<h4 id="_70">显示高级内容</h4>
<p><strong>表格</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-256-1"><a id="__codelineno-256-1" name="__codelineno-256-1" href="#__codelineno-256-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
</span><span id="__span-256-2"><a id="__codelineno-256-2" name="__codelineno-256-2" href="#__codelineno-256-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Table</span>
</span><span id="__span-256-3"><a id="__codelineno-256-3" name="__codelineno-256-3" href="#__codelineno-256-3"></a>
</span><span id="__span-256-4"><a id="__codelineno-256-4" name="__codelineno-256-4" href="#__codelineno-256-4"></a><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
</span><span id="__span-256-5"><a id="__codelineno-256-5" name="__codelineno-256-5" href="#__codelineno-256-5"></a>
</span><span id="__span-256-6"><a id="__codelineno-256-6" name="__codelineno-256-6" href="#__codelineno-256-6"></a><span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">show_header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">header_style</span><span class="o">=</span><span class="s2">&quot;bold magenta&quot;</span><span class="p">)</span>
</span><span id="__span-256-7"><a id="__codelineno-256-7" name="__codelineno-256-7" href="#__codelineno-256-7"></a><span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;dim&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="__span-256-8"><a id="__codelineno-256-8" name="__codelineno-256-8" href="#__codelineno-256-8"></a><span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Title&quot;</span><span class="p">)</span>
</span><span id="__span-256-9"><a id="__codelineno-256-9" name="__codelineno-256-9" href="#__codelineno-256-9"></a><span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Production Budget&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</span><span id="__span-256-10"><a id="__codelineno-256-10" name="__codelineno-256-10" href="#__codelineno-256-10"></a><span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Box Office&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</span><span id="__span-256-11"><a id="__codelineno-256-11" name="__codelineno-256-11" href="#__codelineno-256-11"></a><span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
</span><span id="__span-256-12"><a id="__codelineno-256-12" name="__codelineno-256-12" href="#__codelineno-256-12"></a>    <span class="s2">&quot;Dev 20, 2019&quot;</span><span class="p">,</span> <span class="s2">&quot;Star Wars: The Rise of Skywalker&quot;</span><span class="p">,</span> <span class="s2">&quot;$275,000,000&quot;</span><span class="p">,</span> <span class="s2">&quot;$375,126,118&quot;</span>
</span><span id="__span-256-13"><a id="__codelineno-256-13" name="__codelineno-256-13" href="#__codelineno-256-13"></a><span class="p">)</span>
</span><span id="__span-256-14"><a id="__codelineno-256-14" name="__codelineno-256-14" href="#__codelineno-256-14"></a><span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
</span><span id="__span-256-15"><a id="__codelineno-256-15" name="__codelineno-256-15" href="#__codelineno-256-15"></a>    <span class="s2">&quot;May 25, 2018&quot;</span><span class="p">,</span>
</span><span id="__span-256-16"><a id="__codelineno-256-16" name="__codelineno-256-16" href="#__codelineno-256-16"></a>    <span class="s2">&quot;[red]Solo[/red]: A Star Wars Story&quot;</span><span class="p">,</span>
</span><span id="__span-256-17"><a id="__codelineno-256-17" name="__codelineno-256-17" href="#__codelineno-256-17"></a>    <span class="s2">&quot;$275,000,000&quot;</span><span class="p">,</span>
</span><span id="__span-256-18"><a id="__codelineno-256-18" name="__codelineno-256-18" href="#__codelineno-256-18"></a>    <span class="s2">&quot;$393,151,347&quot;</span><span class="p">,</span>
</span><span id="__span-256-19"><a id="__codelineno-256-19" name="__codelineno-256-19" href="#__codelineno-256-19"></a><span class="p">)</span>
</span><span id="__span-256-20"><a id="__codelineno-256-20" name="__codelineno-256-20" href="#__codelineno-256-20"></a><span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
</span><span id="__span-256-21"><a id="__codelineno-256-21" name="__codelineno-256-21" href="#__codelineno-256-21"></a>    <span class="s2">&quot;Dec 15, 2017&quot;</span><span class="p">,</span>
</span><span id="__span-256-22"><a id="__codelineno-256-22" name="__codelineno-256-22" href="#__codelineno-256-22"></a>    <span class="s2">&quot;Star Wars Ep. VIII: The Last Jedi&quot;</span><span class="p">,</span>
</span><span id="__span-256-23"><a id="__codelineno-256-23" name="__codelineno-256-23" href="#__codelineno-256-23"></a>    <span class="s2">&quot;$262,000,000&quot;</span><span class="p">,</span>
</span><span id="__span-256-24"><a id="__codelineno-256-24" name="__codelineno-256-24" href="#__codelineno-256-24"></a>    <span class="s2">&quot;[bold]$1,332,539,889[/bold]&quot;</span><span class="p">,</span>
</span><span id="__span-256-25"><a id="__codelineno-256-25" name="__codelineno-256-25" href="#__codelineno-256-25"></a><span class="p">)</span>
</span><span id="__span-256-26"><a id="__codelineno-256-26" name="__codelineno-256-26" href="#__codelineno-256-26"></a>
</span><span id="__span-256-27"><a id="__codelineno-256-27" name="__codelineno-256-27" href="#__codelineno-256-27"></a><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Markdown</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-257-1"><a id="__codelineno-257-1" name="__codelineno-257-1" href="#__codelineno-257-1"></a><span class="n">MARKDOWN</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-257-2"><a id="__codelineno-257-2" name="__codelineno-257-2" href="#__codelineno-257-2"></a><span class="s2"># This is an h1</span>
</span><span id="__span-257-3"><a id="__codelineno-257-3" name="__codelineno-257-3" href="#__codelineno-257-3"></a>
</span><span id="__span-257-4"><a id="__codelineno-257-4" name="__codelineno-257-4" href="#__codelineno-257-4"></a><span class="s2">Rich can do a pretty *decent* job of rendering markdown.</span>
</span><span id="__span-257-5"><a id="__codelineno-257-5" name="__codelineno-257-5" href="#__codelineno-257-5"></a>
</span><span id="__span-257-6"><a id="__codelineno-257-6" name="__codelineno-257-6" href="#__codelineno-257-6"></a><span class="s2">1. This is a list item</span>
</span><span id="__span-257-7"><a id="__codelineno-257-7" name="__codelineno-257-7" href="#__codelineno-257-7"></a><span class="s2">2. This is another list item</span>
</span><span id="__span-257-8"><a id="__codelineno-257-8" name="__codelineno-257-8" href="#__codelineno-257-8"></a><span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-257-9"><a id="__codelineno-257-9" name="__codelineno-257-9" href="#__codelineno-257-9"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
</span><span id="__span-257-10"><a id="__codelineno-257-10" name="__codelineno-257-10" href="#__codelineno-257-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.markdown</span><span class="w"> </span><span class="kn">import</span> <span class="n">Markdown</span>
</span><span id="__span-257-11"><a id="__codelineno-257-11" name="__codelineno-257-11" href="#__codelineno-257-11"></a>
</span><span id="__span-257-12"><a id="__codelineno-257-12" name="__codelineno-257-12" href="#__codelineno-257-12"></a><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
</span><span id="__span-257-13"><a id="__codelineno-257-13" name="__codelineno-257-13" href="#__codelineno-257-13"></a><span class="n">md</span> <span class="o">=</span> <span class="n">Markdown</span><span class="p">(</span><span class="n">MARKDOWN</span><span class="p">)</span>
</span><span id="__span-257-14"><a id="__codelineno-257-14" name="__codelineno-257-14" href="#__codelineno-257-14"></a><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">md</span><span class="p">)</span>
</span></code></pre></div>
<p>在终端中显示了 readme 文件：<code>python -m rich.markdown README.md</code></p>
<p><strong>语法突出显示</strong>
构造一个 Syntax 对象并将其打印到控制台</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-258-1"><a id="__codelineno-258-1" name="__codelineno-258-1" href="#__codelineno-258-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
</span><span id="__span-258-2"><a id="__codelineno-258-2" name="__codelineno-258-2" href="#__codelineno-258-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.syntax</span><span class="w"> </span><span class="kn">import</span> <span class="n">Syntax</span>
</span><span id="__span-258-3"><a id="__codelineno-258-3" name="__codelineno-258-3" href="#__codelineno-258-3"></a>
</span><span id="__span-258-4"><a id="__codelineno-258-4" name="__codelineno-258-4" href="#__codelineno-258-4"></a><span class="n">my_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-258-5"><a id="__codelineno-258-5" name="__codelineno-258-5" href="#__codelineno-258-5"></a><span class="s1">def iter_first_last(values: Iterable[T]) -&gt; Iterable[Tuple[bool, bool, T]]:</span>
</span><span id="__span-258-6"><a id="__codelineno-258-6" name="__codelineno-258-6" href="#__codelineno-258-6"></a><span class="s1">    &quot;&quot;&quot;Iterate and generate a tuple with a flag for first and last value.&quot;&quot;&quot;</span>
</span><span id="__span-258-7"><a id="__codelineno-258-7" name="__codelineno-258-7" href="#__codelineno-258-7"></a><span class="s1">    iter_values = iter(values)</span>
</span><span id="__span-258-8"><a id="__codelineno-258-8" name="__codelineno-258-8" href="#__codelineno-258-8"></a><span class="s1">    try:</span>
</span><span id="__span-258-9"><a id="__codelineno-258-9" name="__codelineno-258-9" href="#__codelineno-258-9"></a><span class="s1">        previous_value = next(iter_values)</span>
</span><span id="__span-258-10"><a id="__codelineno-258-10" name="__codelineno-258-10" href="#__codelineno-258-10"></a><span class="s1">    except StopIteration:</span>
</span><span id="__span-258-11"><a id="__codelineno-258-11" name="__codelineno-258-11" href="#__codelineno-258-11"></a><span class="s1">        return</span>
</span><span id="__span-258-12"><a id="__codelineno-258-12" name="__codelineno-258-12" href="#__codelineno-258-12"></a><span class="s1">    first = True</span>
</span><span id="__span-258-13"><a id="__codelineno-258-13" name="__codelineno-258-13" href="#__codelineno-258-13"></a><span class="s1">    for value in iter_values:</span>
</span><span id="__span-258-14"><a id="__codelineno-258-14" name="__codelineno-258-14" href="#__codelineno-258-14"></a><span class="s1">        yield first, False, previous_value</span>
</span><span id="__span-258-15"><a id="__codelineno-258-15" name="__codelineno-258-15" href="#__codelineno-258-15"></a><span class="s1">        first = False</span>
</span><span id="__span-258-16"><a id="__codelineno-258-16" name="__codelineno-258-16" href="#__codelineno-258-16"></a><span class="s1">        previous_value = value</span>
</span><span id="__span-258-17"><a id="__codelineno-258-17" name="__codelineno-258-17" href="#__codelineno-258-17"></a><span class="s1">    yield first, True, previous_value</span>
</span><span id="__span-258-18"><a id="__codelineno-258-18" name="__codelineno-258-18" href="#__codelineno-258-18"></a><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-258-19"><a id="__codelineno-258-19" name="__codelineno-258-19" href="#__codelineno-258-19"></a><span class="n">syntax</span> <span class="o">=</span> <span class="n">Syntax</span><span class="p">(</span><span class="n">my_code</span><span class="p">,</span> <span class="s2">&quot;python&quot;</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;monokai&quot;</span><span class="p">,</span> <span class="n">line_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-258-20"><a id="__codelineno-258-20" name="__codelineno-258-20" href="#__codelineno-258-20"></a><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
</span><span id="__span-258-21"><a id="__codelineno-258-21" name="__codelineno-258-21" href="#__codelineno-258-21"></a><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">syntax</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="_71">进度条</h4>
<p>官方范例：<code>python -m rich.progress</code></p>
<p>简单进度条</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-259-1"><a id="__codelineno-259-1" name="__codelineno-259-1" href="#__codelineno-259-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-259-2"><a id="__codelineno-259-2" name="__codelineno-259-2" href="#__codelineno-259-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.progress</span><span class="w"> </span><span class="kn">import</span> <span class="n">track</span>
</span><span id="__span-259-3"><a id="__codelineno-259-3" name="__codelineno-259-3" href="#__codelineno-259-3"></a>
</span><span id="__span-259-4"><a id="__codelineno-259-4" name="__codelineno-259-4" href="#__codelineno-259-4"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">track</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Processing...&quot;</span><span class="p">):</span>
</span><span id="__span-259-5"><a id="__codelineno-259-5" name="__codelineno-259-5" href="#__codelineno-259-5"></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Simulate work being done</span>
</span></code></pre></div>
<p>多进程进度条</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-260-1"><a id="__codelineno-260-1" name="__codelineno-260-1" href="#__codelineno-260-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-260-2"><a id="__codelineno-260-2" name="__codelineno-260-2" href="#__codelineno-260-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.progress</span><span class="w"> </span><span class="kn">import</span> <span class="n">Progress</span>
</span><span id="__span-260-3"><a id="__codelineno-260-3" name="__codelineno-260-3" href="#__codelineno-260-3"></a>
</span><span id="__span-260-4"><a id="__codelineno-260-4" name="__codelineno-260-4" href="#__codelineno-260-4"></a><span class="k">with</span> <span class="n">Progress</span><span class="p">()</span> <span class="k">as</span> <span class="n">progress</span><span class="p">:</span>
</span><span id="__span-260-5"><a id="__codelineno-260-5" name="__codelineno-260-5" href="#__codelineno-260-5"></a>    <span class="n">task1</span> <span class="o">=</span> <span class="n">progress</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="s2">&quot;[red]Downloading...&quot;</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="__span-260-6"><a id="__codelineno-260-6" name="__codelineno-260-6" href="#__codelineno-260-6"></a>    <span class="n">task2</span> <span class="o">=</span> <span class="n">progress</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="s2">&quot;[green]Processing...&quot;</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="__span-260-7"><a id="__codelineno-260-7" name="__codelineno-260-7" href="#__codelineno-260-7"></a>    <span class="n">task3</span> <span class="o">=</span> <span class="n">progress</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="s2">&quot;[cyan]Cooking...&quot;</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="__span-260-8"><a id="__codelineno-260-8" name="__codelineno-260-8" href="#__codelineno-260-8"></a>
</span><span id="__span-260-9"><a id="__codelineno-260-9" name="__codelineno-260-9" href="#__codelineno-260-9"></a>    <span class="k">while</span> <span class="ow">not</span> <span class="n">progress</span><span class="o">.</span><span class="n">finished</span><span class="p">:</span>
</span><span id="__span-260-10"><a id="__codelineno-260-10" name="__codelineno-260-10" href="#__codelineno-260-10"></a>        <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task1</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="__span-260-11"><a id="__codelineno-260-11" name="__codelineno-260-11" href="#__codelineno-260-11"></a>        <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task2</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</span><span id="__span-260-12"><a id="__codelineno-260-12" name="__codelineno-260-12" href="#__codelineno-260-12"></a>        <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task3</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</span><span id="__span-260-13"><a id="__codelineno-260-13" name="__codelineno-260-13" href="#__codelineno-260-13"></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
</span></code></pre></div>
<p>默认情况下，进度信息将每秒刷新 10 次。您可以通过在构造函数的 <code>Progress</code> 参数中使用 <code>refresh_per_second</code> 参数来设置刷新率。如果知道您的更新不会那么频繁，应将其设置为低于 10。</p>
<h3 id="_72">人工智能相关</h3>
<p>应用见[[../../../开发/应用/人工智能/Python神经网络编程#实际应用：手写数字MNIST|手写数字MNIST]]</p>
<p>scikit -learn、mxnet</p>
<p>sk擅长机器学习
Torch、tensor擅长深度学习
natural language toolkie 自然语言处理工具
spacy高级自然语言处理</p>
<h4 id="pytorch">PyTorch</h4>
<p>PyTorch 是一个开源的机器学习库，主要用于进行计算机视觉（CV）、自然语言处理（NLP）、语音识别等领域的研究和开发。</p>
<p><code>pip install torch</code></p>
<p>使用 <code>numpy_1=tensor_1.numpy()</code>将 Tensor 转换成NumPy数组
使用 <code>tensor_1 = torch.from_numpy(numpy_1)</code> 将NumPy数组转换成 Tensor</p>
<h5 id="_73">保存和加载模型</h5>
<p>在实际应用的时候不可能每次都先进行训练然后再使用，所以就得先将之前训练好的模型保存下来，然后在需要用到的时候加载一下直接使用。
模型的本质是一堆用某种结构存储起来的参数，所以在保存的时候有两种方式，一种方式是直接将整个模型保存下来，之后直接加载整个模型，但这样会比较耗内存；另一种是只保存模型的参数，之后用到的时候再创建一个同样结构的新模型，然后把所保存的参数导入新模型。</p>
<ol>
<li><code>torch.save</code>：把序列化的对象保存到硬盘。它利用了 Python 的 pickle 来实现序列化。模型、张量以及字典都可以用该函数进行保存；</li>
<li><code>torch.load</code>：采用 pickle 将反序列化的对象从存储中加载进来。</li>
<li><code>torch.nn.Module.load_state_dict</code>：采用一个反序列化的 state_dict加载一个模型的参数字典。</li>
</ol>
<p>在 PyTorch 2.6 中，将 <code>torch.load</code> 中的 <code>weights_only</code> 参数的默认值从 <code>False</code> 更改为 <code>True</code>。将 <code>torch.load</code> 重新运行并将 <code>weights_only</code> 设置为 <code>False</code> 可能会成功，但它可能导致任意代码执行。仅当您从可信来源获得文件时才这样做。</p>
<p><strong>加载/保存状态字典(推荐做法)</strong>：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-261-1"><a id="__codelineno-261-1" name="__codelineno-261-1" href="#__codelineno-261-1"></a><span class="c1"># 保存的代码：通常会用 .pt 或者 .pth 后缀来保存模型</span>
</span><span id="__span-261-2"><a id="__codelineno-261-2" name="__codelineno-261-2" href="#__codelineno-261-2"></a><span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">PATH</span><span class="p">)</span>
</span><span id="__span-261-3"><a id="__codelineno-261-3" name="__codelineno-261-3" href="#__codelineno-261-3"></a><span class="c1"># 加载的代码：</span>
</span><span id="__span-261-4"><a id="__codelineno-261-4" name="__codelineno-261-4" href="#__codelineno-261-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">TheModelClass</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-261-5"><a id="__codelineno-261-5" name="__codelineno-261-5" href="#__codelineno-261-5"></a><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">PATH</span><span class="p">))</span>
</span><span id="__span-261-6"><a id="__codelineno-261-6" name="__codelineno-261-6" href="#__codelineno-261-6"></a><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span></code></pre></div>
<p><strong>加载/保存整个模型</strong>：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-262-1"><a id="__codelineno-262-1" name="__codelineno-262-1" href="#__codelineno-262-1"></a><span class="c1"># 保存：</span>
</span><span id="__span-262-2"><a id="__codelineno-262-2" name="__codelineno-262-2" href="#__codelineno-262-2"></a><span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">PATH</span><span class="p">)</span>
</span><span id="__span-262-3"><a id="__codelineno-262-3" name="__codelineno-262-3" href="#__codelineno-262-3"></a><span class="c1"># 加载：</span>
</span><span id="__span-262-4"><a id="__codelineno-262-4" name="__codelineno-262-4" href="#__codelineno-262-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">PATH</span><span class="p">)</span>
</span><span id="__span-262-5"><a id="__codelineno-262-5" name="__codelineno-262-5" href="#__codelineno-262-5"></a><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span></code></pre></div>
<p>在 CPU 上加载在 GPU 上训练的模型：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-263-1"><a id="__codelineno-263-1" name="__codelineno-263-1" href="#__codelineno-263-1"></a><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</span><span id="__span-263-2"><a id="__codelineno-263-2" name="__codelineno-263-2" href="#__codelineno-263-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">TheModelClass</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-263-3"><a id="__codelineno-263-3" name="__codelineno-263-3" href="#__codelineno-263-3"></a><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">PATH</span><span class="p">,</span> <span class="n">map_location</span><span class="o">=</span><span class="n">device</span><span class="p">))</span>
</span></code></pre></div>
<p>在 GPU 上加载模型在GPU上保存模型:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-264-1"><a id="__codelineno-264-1" name="__codelineno-264-1" href="#__codelineno-264-1"></a><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
</span><span id="__span-264-2"><a id="__codelineno-264-2" name="__codelineno-264-2" href="#__codelineno-264-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">TheModelClass</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-264-3"><a id="__codelineno-264-3" name="__codelineno-264-3" href="#__codelineno-264-3"></a><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">PATH</span><span class="p">)</span>
</span><span id="__span-264-4"><a id="__codelineno-264-4" name="__codelineno-264-4" href="#__codelineno-264-4"></a><span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></code></pre></div>
<p>在 GPU 上加载模型在CPU上保存模型:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-265-1"><a id="__codelineno-265-1" name="__codelineno-265-1" href="#__codelineno-265-1"></a><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
</span><span id="__span-265-2"><a id="__codelineno-265-2" name="__codelineno-265-2" href="#__codelineno-265-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">TheModelClass</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-265-3"><a id="__codelineno-265-3" name="__codelineno-265-3" href="#__codelineno-265-3"></a><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">PATH</span><span class="p">,</span> <span class="n">map_location</span><span class="o">=</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">))</span>  <span class="c1"># Choose whatever GPU device number you want</span>
</span><span id="__span-265-4"><a id="__codelineno-265-4" name="__codelineno-265-4" href="#__codelineno-265-4"></a><span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="opencv">openCV</h4>
<h4 id="_74">数据集</h4>
<p><strong>sklearn</strong>(scikit-learn)
1、鸢尾花数据集（Iris Dataset）：包含150朵鸢尾花的数据集，每朵花属于三个不同的物种，可以用于各种分类任务的练习。
2、手写数字数据集（Digits Dataset）：包含8x8像素的手写数字图像数据集，涵盖数字0到9
3、乳腺癌数据集（Breast Cancer Dataset）：用于乳腺癌诊断的数据集，包含从乳腺块的数字化图像中计算的特征
4、葡萄酒数据集（Wine Dataset）：包含来自三种不同葡萄品种的葡萄酒的化学分析结果。
5、糖尿病数据集（Diabetes Dataset）：用于糖尿病患者的数据集，包含十个基线变量，如年龄、性别、体重指数、平均血压和六项血清测量。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-266-1"><a id="__codelineno-266-1" name="__codelineno-266-1" href="#__codelineno-266-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_iris</span>
</span><span id="__span-266-2"><a id="__codelineno-266-2" name="__codelineno-266-2" href="#__codelineno-266-2"></a><span class="c1"># load_iris/load_digits/load_breast_cancer/load_wine/load_diabetes</span>
</span><span id="__span-266-3"><a id="__codelineno-266-3" name="__codelineno-266-3" href="#__codelineno-266-3"></a>
</span><span id="__span-266-4"><a id="__codelineno-266-4" name="__codelineno-266-4" href="#__codelineno-266-4"></a><span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
</span><span id="__span-266-5"><a id="__codelineno-266-5" name="__codelineno-266-5" href="#__codelineno-266-5"></a><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>
</span></code></pre></div>
<p><strong>Statsmodels</strong></p>
<p><strong>PyTorch</strong>
1、MNIST 数据集:-包含手写数字（0到9）的灰度图像。
2、CIFAR-10 数据集:包含 10 个不同类别的彩色图像。
3、Fashion MNIST 数据集:包含了 10 种不同的时尚物品的灰度图像。
4、ImageNet 数据集:包含大量类别的图像，用于图像分类任务。</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-267-1"><a id="__codelineno-267-1" name="__codelineno-267-1" href="#__codelineno-267-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torchvision.datasets</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">datasets</span>
</span><span id="__span-267-2"><a id="__codelineno-267-2" name="__codelineno-267-2" href="#__codelineno-267-2"></a>
</span><span id="__span-267-3"><a id="__codelineno-267-3" name="__codelineno-267-3" href="#__codelineno-267-3"></a><span class="n">mnist_train</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s2">&quot;./data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-267-4"><a id="__codelineno-267-4" name="__codelineno-267-4" href="#__codelineno-267-4"></a><span class="n">mnist_test</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s2">&quot;./data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-267-5"><a id="__codelineno-267-5" name="__codelineno-267-5" href="#__codelineno-267-5"></a><span class="c1"># MNIST/CIFAR10/FashionMNIST/ImageNet</span>
</span></code></pre></div>
<p><strong>Tensorflow Datasets</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-268-1"><a id="__codelineno-268-1" name="__codelineno-268-1" href="#__codelineno-268-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow_datasets</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tfds</span>
</span><span id="__span-268-2"><a id="__codelineno-268-2" name="__codelineno-268-2" href="#__codelineno-268-2"></a><span class="n">mnist</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">tfds</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;mnist&quot;</span><span class="p">,</span> <span class="n">with_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-268-3"><a id="__codelineno-268-3" name="__codelineno-268-3" href="#__codelineno-268-3"></a><span class="c1"># mnist/cifar10/imdb_reviews/fashion_mnist/tf_flowers</span>
</span></code></pre></div>
<p><strong>Keras</strong></p>
<p><a href="http://yann.lecun.com/exdb/mnist/">MNIST 数据集</a>MNIST数据集来自美国国家标准与技术研究所, National Institute of Standards and Technology (NIST)。训练集（training set）由来自250个不同人手写的数字构成，其中50%是高中学生，50%来自人口普查局（the Census Bureau）的工作人员。测试集（test set）也是同样比例的手写数字数据，但保证了测试集和训练集的作者集不相交。
MNIST数据集一共有7万张图片，其中6万张是训练集，1万张是测试集。每张图片是28 × 28 的0 − 9的手写数字图片组成。每个图片是黑底白字的形式，黑底用0表示，白字用0-1之间的浮点数表示，越接近1，颜色越白。
MNIST是一个非常经典的手写数字数据集，许多库都包括它。当然除了导入库以外也可以自行下载对应的csv文件使用。</p>
<h4 id="jieba">jieba（中文分词）</h4>
<p>Jieba库是优秀的中文分词第三方库，中文文本需要通过分词获得单个的词语。</p>
<p>Jieba库的分词原理：利用一个中文词库，确定汉字之间的关联概率，汉字间概率大的组成词组，形成分词结果。除了分词，用户还可以添加自定义的词组。</p>
<p><strong>1）精确模式：</strong> 就是把一段文本精确地切分成若干个中文单词，若干个中文单词之间经过组合，就精确地还原为之前的文本。其中<strong>不存在冗余</strong>单词。</p>
<p><strong>2）全模式：</strong> 将一段文本中所有可能的词语都扫描出来，可能有一段文本它可以切分成不同的模式，或者有不同的角度来切分变成不同的词语，在全模式下，Jieba库会将各种不同的组合都挖掘出来。分词后的信息再组合起来 <strong>会有冗余</strong> ，不再是原来的文本。</p>
<p><strong>3）搜索引擎模式：</strong> 在精确模式基础上，对发现的那些长的词语，我们会对它再次切分，进而适合搜索引擎对短词语的索引和搜索。 <strong>也有冗余</strong> 。jieba.lcut(seg_str)   # 精简模式，返回一个列表类型的结果
jieba.lcut(seg_str, cut_all=True)   # 全模式，使用 'cut_all=True' 指定
jieba.lcut_for_search(seg_str)   # 搜索引擎模式</p>
<p>输入字符串，返回列表</p>
<h2 id="_75">调用其他编程语言</h2>
<h3 id="c">c语言</h3>
<p><strong>直接调用c的可执行程序</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-269-1"><a id="__codelineno-269-1" name="__codelineno-269-1" href="#__codelineno-269-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-269-2"><a id="__codelineno-269-2" name="__codelineno-269-2" href="#__codelineno-269-2"></a>
</span><span id="__span-269-3"><a id="__codelineno-269-3" name="__codelineno-269-3" href="#__codelineno-269-3"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span><span id="__span-269-4"><a id="__codelineno-269-4" name="__codelineno-269-4" href="#__codelineno-269-4"></a>    <span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;a.exe&#39;</span> <span class="o">//</span> <span class="n">windows</span> <span class="o">.</span><span class="n">exe</span> <span class="o">|</span> <span class="n">linux</span> <span class="o">.</span><span class="n">out</span>
</span><span id="__span-269-5"><a id="__codelineno-269-5" name="__codelineno-269-5" href="#__codelineno-269-5"></a>    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></code></pre></div>
<p>python调用c的lib库，可以调用c的函数</p>
<p>导入c动态库：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-270-1"><a id="__codelineno-270-1" name="__codelineno-270-1" href="#__codelineno-270-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">ctypes</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-270-2"><a id="__codelineno-270-2" name="__codelineno-270-2" href="#__codelineno-270-2"></a>
</span><span id="__span-270-3"><a id="__codelineno-270-3" name="__codelineno-270-3" href="#__codelineno-270-3"></a><span class="n">test</span> <span class="o">=</span> <span class="n">CDLL</span><span class="p">(</span><span class="s2">&quot;./a.dll&quot;</span><span class="p">)</span>
</span><span id="__span-270-4"><a id="__codelineno-270-4" name="__codelineno-270-4" href="#__codelineno-270-4"></a><span class="n">test</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>     <span class="o">//</span> <span class="n">可以调用c的函数</span><span class="err">，</span><span class="n">包括main函数</span>
</span><span id="__span-270-5"><a id="__codelineno-270-5" name="__codelineno-270-5" href="#__codelineno-270-5"></a><span class="o">//</span> <span class="n">需要稍微注意</span><span class="err">，</span><span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">main</span><span class="p">())</span><span class="n">会同时打印main中的printf函数以及返回值</span>
</span><span id="__span-270-6"><a id="__codelineno-270-6" name="__codelineno-270-6" href="#__codelineno-270-6"></a><span class="o">//</span> <span class="n">不知道为什么</span><span class="err">，</span><span class="n">int没有指定返回值在c中返回1</span><span class="err">，</span><span class="n">python返回</span><span class="o">-</span><span class="mi">1363263091</span> <span class="n">还有viod</span> 
</span><span id="__span-270-7"><a id="__codelineno-270-7" name="__codelineno-270-7" href="#__codelineno-270-7"></a><span class="o">//</span> <span class="n">不知道为什么</span><span class="err">，</span><span class="n">有时返回</span><span class="o">-</span><span class="mi">1462550131</span><span class="err">，</span><span class="n">无法复现</span>
</span><span id="__span-270-8"><a id="__codelineno-270-8" name="__codelineno-270-8" href="#__codelineno-270-8"></a><span class="o">//</span> <span class="n">而且传参数不对也不报错</span>
</span></code></pre></div>
<p>将C打包成模块</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-271-1"><a id="__codelineno-271-1" name="__codelineno-271-1" href="#__codelineno-271-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">distutils.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">setup</span><span class="p">,</span> <span class="n">Extension</span> <span class="c1">#这里要用到distutils库</span>
</span><span id="__span-271-2"><a id="__codelineno-271-2" name="__codelineno-271-2" href="#__codelineno-271-2"></a><span class="n">module1</span> <span class="o">=</span> <span class="n">Extension</span><span class="p">(</span><span class="s1">&#39;Test&#39;</span><span class="p">,</span> <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;test.c&#39;</span><span class="p">])</span> <span class="c1">#打包文件为test.c，这里没有设置路径，所有.c文件和setup.py放在同一目录下</span>
</span><span id="__span-271-3"><a id="__codelineno-271-3" name="__codelineno-271-3" href="#__codelineno-271-3"></a><span class="n">setup</span> <span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span><span class="p">,</span> <span class="c1">#打包名</span>
</span><span id="__span-271-4"><a id="__codelineno-271-4" name="__codelineno-271-4" href="#__codelineno-271-4"></a>       <span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="c1">#版本</span>
</span><span id="__span-271-5"><a id="__codelineno-271-5" name="__codelineno-271-5" href="#__codelineno-271-5"></a>       <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;This is a demo package&#39;</span><span class="p">,</span> <span class="c1">#说明文字</span>
</span><span id="__span-271-6"><a id="__codelineno-271-6" name="__codelineno-271-6" href="#__codelineno-271-6"></a>       <span class="n">ext_modules</span> <span class="o">=</span> <span class="p">[</span><span class="n">module1</span><span class="p">])</span>
</span></code></pre></div>
<p>python setup.py build --compiler msvc # 编译代码
python setup.py build --compiler msvc install # 编译代码并直接将包放入当前python环境的包的路径以供调用</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.sections", "navigation.tabs", "content.code.copy", "navigation.tracking"], "search": "../../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>